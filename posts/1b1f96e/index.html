<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>2024 全国大学生信息安全竞赛初赛 Misc Writeup - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="又是一年国赛，这次纯纯是被队友带飞了！！！
"><meta name=keywords content='CTF,Writeup'><meta itemprop=name content="2024 全国大学生信息安全竞赛初赛 Misc Writeup"><meta itemprop=description content="又是一年国赛，这次纯纯是被队友带飞了！！！"><meta itemprop=datePublished content="2024-05-19T21:10:44+08:00"><meta itemprop=dateModified content="2024-05-19T21:10:44+08:00"><meta itemprop=wordCount content="727"><meta itemprop=keywords content="CTF,Writeup"><meta property="og:url" content="https://goodlunatic.github.io/posts/1b1f96e/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="2024 全国大学生信息安全竞赛初赛 Misc Writeup"><meta property="og:description" content="又是一年国赛，这次纯纯是被队友带飞了！！！"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-19T21:10:44+08:00"><meta property="article:modified_time" content="2024-05-19T21:10:44+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Writeup"><meta name=twitter:card content="summary"><meta name=twitter:title content="2024 全国大学生信息安全竞赛初赛 Misc Writeup"><meta name=twitter:description content="又是一年国赛，这次纯纯是被队友带飞了！！！"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/1b1f96e/ title="2024 全国大学生信息安全竞赛初赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/9d73413/ title="2024 “天一永安杯”宁波市网络安全大赛 Misc Writeup"><link rel=next type=text/html href=https://goodlunatic.github.io/posts/a4ba07e/ title=CTF-密码学><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/1b1f96e/index.md title="2024 全国大学生信息安全竞赛初赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"2024 全国大学生信息安全竞赛初赛 Misc Writeup","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/1b1f96e\/"},"image":["https:\/\/www.nssctf.cn\/files\/2025\/8\/21\/8ce6223a1a.png"],"genre":"posts","keywords":"CTF, Writeup","wordcount":727,"url":"https:\/\/goodlunatic.github.io\/posts\/1b1f96e\/","datePublished":"2024-05-19T21:10:44+08:00","dateModified":"2024-05-19T21:10:44+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/9d73413/ title="2024 “天一永安杯”宁波市网络安全大赛 Misc Writeup">2024 “天一永安杯”宁波市网络安全大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/e0d44f3/ title="2024 NKCTF Misc Writeup">2024 NKCTF Misc Writeup</a></li><li class=related-item><a href=/posts/a907e2b/ title="2024 帕鲁杯 Misc Writeup">2024 帕鲁杯 Misc Writeup</a></li><li class=related-item><a href=/posts/e49ecc5/ title="2023&amp;2024 红明谷初赛 Misc Writeup">2023&amp;2024 红明谷初赛 Misc Writeup</a></li><li class=related-item><a href=/posts/bd957c3/ title="2024 长城杯信息安全铁人三项赛 Misc Writeup">2024 长城杯信息安全铁人三项赛 Misc Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>2024 全国大学生信息安全竞赛初赛 Misc Writeup</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/writeup/ class=post-category title="分类 - Writeup"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Writeup</a></span></div><div class=post-meta-line><span title="发布于 2024-05-19 21:10:44"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2024-05-19>2024-05-19</time></span>&nbsp;<span title="727 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 800 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 4 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="2024 全国大学生信息安全竞赛初赛 Misc Writeup"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#题目名称-火锅链观光打卡>题目名称 火锅链观光打卡</a></li><li><a href=#题目名称-power-trajectory-diagram>题目名称 Power Trajectory Diagram</a></li><li><a href=#题目名称-神秘文件>题目名称 神秘文件</a></li><li><a href=#题目名称-盗版软件>题目名称 盗版软件</a></li><li><a href=#题目名称-通风机>题目名称 通风机</a></li><li><a href=#题目名称-tough_dns>题目名称 Tough_DNS</a></li></ul></nav></div></div><div class=content id=content><p>又是一年国赛，这次纯纯是被队友带飞了！！！</p><h2 class=heading-element id=题目名称-火锅链观光打卡><span>题目名称 火锅链观光打卡</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%81%ab%e9%94%85%e9%93%be%e8%a7%82%e5%85%89%e6%89%93%e5%8d%a1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>浏览器下载一个MetaMask插件，连上题目的容器</p><p>然后领取一下空投，回答几道题拿到原料兑换 NFT 即可得到 flag</p><p><strong>flag{y0u_ar3_hotpot_K1ng}</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211441979.png alt=/posts/1b1f96e/imgs/image-20240519211441979.png height=1618 width=1937></p><h2 class=heading-element id=题目名称-power-trajectory-diagram><span>题目名称 Power Trajectory Diagram</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-power-trajectory-diagram class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211515633.png alt=/posts/1b1f96e/imgs/image-20240519211515633.png height=663 width=1234></p><p>下载附件并解压，得到一个 attachment.npz</p><p>发现有四部分的数据，通过查看 input 和 index 后可以知道</p><p>题目是一共爆破了13个字符，每个字符爆破了40次，然后每次爆破都会有一条 trace</p><p>写一个 python 脚本读取 trace 数据并画折线图，发现每条 trace 都会有一个最小值</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211535202.png alt=/posts/1b1f96e/imgs/image-20240519211535202.png height=480 width=640></p><p>因此我们先记录每条 trace 中的最小值</p><p>最后经过尝试，把每40条记录中的最大值连起来就是flag</p><p><strong>flag{_ciscn_2024_}</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;attachment.npz&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># print(data.files)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;index&#39;, &#39;input&#39;, &#39;output&#39;, &#39;trace&#39;]</span>
</span></span><span class=line><span class=cl><span class=n>trace</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;trace&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;input&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># print(len(input))</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># print(trace.shape)  # (520, 5000) 520/40=13</span>
</span></span><span class=line><span class=cl><span class=c1># 一共爆破了13个字符，每个字符爆破了40次，每次爆破都会有一条trace</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>12</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span> <span class=o>=</span> <span class=nb>input</span><span class=p>[:</span><span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>40</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 记录每条trace中的最小值</span>
</span></span><span class=line><span class=cl>        <span class=nb>min</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmin</span><span class=p>(</span><span class=n>trace</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>40</span><span class=o>+</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>min</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(res)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 通过提取res列表中的最大值来确定爆破出字符的index</span>
</span></span><span class=line><span class=cl>    <span class=n>index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>char</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>char</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># _ciscn_2024_</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-神秘文件><span>题目名称 神秘文件</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%a5%9e%e7%a7%98%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>下载附件并解压，得到一个 attachment.pptm</p><p>使用 exiftool 查看 pptm 的元信息，发现有一个 Bifid cipher</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211749072.png alt=/posts/1b1f96e/imgs/image-20240519211749072.png height=1368 width=2713></p><p>然后使用 CyberChef 解密即可得到：<strong>Part1:flag{e</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211803291.png alt=/posts/1b1f96e/imgs/image-20240519211803291.png height=1195 width=2231></p><p>把 .pptm 文件改后缀为 .zip 解压并打开</p><p>在 attachment\ppt\embeddings 路劲下发现有个 .docx 文件</p><p>改后缀为 .zip 并解压，打开word目录中的 document.xml</p><p>得到提示，原来似乎有什么，后来好像被小Caesar抱走了</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211817086.png alt=/posts/1b1f96e/imgs/image-20240519211817086.png height=1494 width=2543></p><p>然后直接使用 CyberChef 解密即可得到：<strong>part2:675efb</strong></p><p>Tips：这里在 CyberChef 中使用 ROT13 是因为解密后它会自动 magic 识别 base64，就比较方便</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211828408.png alt=/posts/1b1f96e/imgs/image-20240519211828408.png height=1205 width=2086></p><p>打开 PPT 发现发现有嵌入了 宏代码</p><p>直接使用 olevba 提取宏代码，然后问问GPT，发现是个RC4加密</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211839837.png alt=/posts/1b1f96e/imgs/image-20240519211839837.png height=1613 width=2562></p><p>直接使用 CyberChef 解密 RC4 即可得到：<strong>PArt3:3-34</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211850158.png alt=/posts/1b1f96e/imgs/image-20240519211850158.png height=1186 width=2486></p><p>在 PPT 的第三页中发现有 Base64编码后的字符串：UGF5dDQ6NmYtNDA=</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211901403.png alt=/posts/1b1f96e/imgs/image-20240519211901403.png height=2160 width=3842></p><p>使用 CyberChef 解密即可得到：<strong>Payt4:6f-40</strong></p><p>在 PPT 的最后一页中发现多次 Base64 编码后的字符串</p><p>直接使用 BaseCrack 解码即可得到：<strong>pArt5:5f-90d</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519211931656.png alt=/posts/1b1f96e/imgs/image-20240519211931656.png height=2160 width=3842></p><p>在 ppt 的第五页，缩小可以看到一串base64编码的字符串：UGFyVDY6ZC0y</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212032336.png alt=/posts/1b1f96e/imgs/image-20240519212032336.png height=2160 width=3842></p><p>CyberChef解码得到：<strong>part6:d-2</strong></p><p>在PPT的第四章打开选择窗口，可以得到提示：ROT13(All) HRSFIQp9ZwWvZj==</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212049388.png alt=/posts/1b1f96e/imgs/image-20240519212049388.png height=2160 width=3842></p><p>CyberChef 解密即可得到：<strong>PART7=22b3</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212103397.png alt=/posts/1b1f96e/imgs/image-20240519212103397.png height=1179 width=2102></p><p>在 pptm 解压出来的 ppt\slideLayouts\slideLayout2.xml 中得到如下提示</p><blockquote><p>c1GFSbd3Dg6BODbdl
Remove All
’B ’/’b’ /’1 ’/’3’&lt;</p></blockquote><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212125419.png alt=/posts/1b1f96e/imgs/image-20240519212125419.png height=2088 width=3836></p><p>根据提示，去除上面四个字符后得到：cGFSdDg6ODdl</p><p>CyberChef解密即可得到：<strong>paRt8:87e</strong></p><p>在 pptm 解压出来的 \ppt\media\image57.jpg 中发现一串base64编码：</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212142298.png alt=/posts/1b1f96e/imgs/image-20240519212142298.png height=1140 width=1697></p><p>cyberchef解码即可得到：<strong>parT9:dee</strong></p><p>在 pptm 解压出来的 comments/comment1.xml 中发现维吉尼亚密码</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212200225.png alt=/posts/1b1f96e/imgs/image-20240519212200225.png height=2160 width=3851></p><p>直接使用在线网站解密即可得到：<strong>PARt10:9}</strong></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212210606.png alt=/posts/1b1f96e/imgs/image-20240519212210606.png height=1174 width=2757></p><p>最后，把上面的10段 flag 连起来即可得到最后的flag：<strong>flag{e675efb3-346f-405f-90dd-222b387edee9}</strong></p><h2 class=heading-element id=题目名称-盗版软件><span>题目名称 盗版软件</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%9b%97%e7%89%88%e8%bd%af%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>下载附件并解压，得到一个 hackexe.exe 和一个 3842.dmp 内存转储文件</p><p>运行这个 exe 后可以会在.ss文件夹下生成一个 loader.exe 和一个 output.png</p><p>out.png 的上方有一些模糊的小块，感觉是隐写了</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212242988.png alt=/posts/1b1f96e/imgs/image-20240519212242988.png height=393 width=2104></p><p>用 stegsolve 打开，发现所有红色通道中都有明显的 LSB 痕迹</p><p>Data Extract preview 发现有一个压缩包，只不过每字节后都嵌入了垃圾数据</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212251450.png alt=/posts/1b1f96e/imgs/image-20240519212251450.png height=841 width=1083></p><p>写个Python脚本提取出来即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=c1># print(res)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>res</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>解压压缩包得到一个.b文件，里面内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>r()J$nEA&#39;r!!#;^5u:HM1&#34;&#39;W(Mc*q[&lt;_/-H(eBQ_+@m$P8kMf4a[h&gt;1:e3=VX?9p=!\&gt;H[_9!-P!Q!d_;F+/NMc([U69Id&gt;ct7iR(^gBUKlR.n!/lA`!!!!iKtqeC8-.(6Mb&#34;[QMa/CV!RTk-8H6e+1!)_&gt;1l+[&#39;ejqO2X?j\E%7($238erL9ERs6#Xpc$FkBeaMa/OZ!RPFEM[W-EMa/7R!RO,j&#34;Gf?G6!.Ga!ROtQ6!-EU6!?g3ll\Sls57!F=^&#34;@S&#39;&#39;W&#39;hs8Q@r^3=WR?SaG;!&#39;sXWM&lt;7?[m%=@Z!(i%/8\&gt;*)+T!Ns8F&amp;Q@8VuM%M=EmC9Qqfgs4&#39;f&#34;l=^2!!!$.f\g`/F!&lt;:Sa$:.up:e`[d9ejFSs1h0^_FX^B8;Y/K]&#39;9g`i;_=uM8s?B6!-g;i^eq%6+WJ\FCG4&#34;Ktqd;8cR(Yjlhm.!!#QBlju^Ei_;/LC&#39;6h)8;[..\cUR+?iSZ/p],bC8;&#34;i&#39;?A\Aj5XAOd!&#34;],16!-[7njkLW6+U0o;s&#34;&amp;08;Y5UM8r=Fa[q?Y8;Z%kM&gt;9HK!nkY%s4)bs!.?7t6!%3&amp;!&#39;gMa6!.k%&gt;!]_-0+Tc:eQ5m&gt;\ohmb@K4kLs3Bjks8W*i!Q.GW`^kgWFgOI7k?)I!=hET4.LJIugAf\</span></span></code></pre></td></tr></table></div></div><p>然后 CyberChef base85解码一下</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212411348.png alt=/posts/1b1f96e/imgs/image-20240519212411348.png height=1355 width=3769></p><p>下载解码后的内容，然后丢到微步云沙箱在线运行一下就可以得到题目中的 C2地址：39.100.72.235</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212421042.png alt=/posts/1b1f96e/imgs/image-20240519212421042.png height=1079 width=2176></p><p>dmp文件用vol好像提取不出来什么，但是R-stdio可以</p><p>在ctf用户的 download 文件夹下发现有一个 iFlylME Setup 3.0.1735.exe 安装程序</p><p>网上搜索后知道是讯飞输入法的安装程序，但是经过分析，题目中的盗版软件应该指的是 procexe.exe</p><p>因为 procexe.exe 和附件中的 hackexe.exe 大小是一样的</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212433285.png alt=/posts/1b1f96e/imgs/image-20240519212433285.png height=2160 width=3842></p><p>根据题面的内容，猜测是 firefox 浏览器取证，根据网上的参考文章firefox的历史记录会保存在以下路径中</p><p>Users\ctf\AppData\Roaming\Mozilla\Firefox\Profiles_gcqzno5i\palce.sqlite</p><p>但是这道题好像提取不出来，提示损坏了</p><p>因此我们直接在Linux系统中使用 strings 3842.dmp| grep https:// | uniq > http.txt 命令</p><p>查看得到的 txt 文件，发现出题人用百度搜索了很多东西</p><p>比如 process ko破解版、process破解版、winhack.exe、讯飞输入法 等等</p><p>但是还是无法得到具体下载盗版软件的地址，但是我们可以确定出题人一定访问了百度</p><p>因此我们使用 R-stdio 把整个 ctf 文件夹都导出来，然后使用 everything 的高级搜索</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212443482.png alt=/posts/1b1f96e/imgs/image-20240519212443482.png height=370 width=2079></p><p>然后在 28CBB9632C21E18AE4E9238F447E10907D5F0062 文件中发现几个可疑地址</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212452650.png alt=/posts/1b1f96e/imgs/image-20240519212452650.png height=418 width=2568></p><p>除去和百度以及讯飞有关系的网址后，得到下面两个网址</p><blockquote><p><a href=http://winhack.com target=_blank rel="external nofollow noopener noreferrer">http://winhack.com</a>
<a href=https://www.waodown.com/ target=_blank rel="external nofollow noopener noreferrer">https://www.waodown.com/</a></p></blockquote><p>经过尝试，发现 winhack 那个是正确答案</p><p>赛后和别的师傅交流后发现，这里直接把 dmp 文件后缀改成 .data 然后拖入 Gimp 调位移和宽高就能直接得到</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526181944495.png alt=/posts/1b1f96e/imgs/image-20240526181944495.png height=1606 width=2261></p><p>winhack.com39.100.72.235</p><p><strong>flag{096e8b0f9daf10869f013c1b7efda3fd}</strong></p><h2 class=heading-element id=题目名称-通风机><span>题目名称 通风机</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e9%80%9a%e9%a3%8e%e6%9c%ba class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>去网上下一个 STEP7 MicroWIN V4.0 SP9 软件，然后修复 mwp 的文件头</p><p>使用 STEP7 MicroWIN V4.0 SP9 软件打开 mwp 文件</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212534160.png alt=/posts/1b1f96e/imgs/image-20240519212534160.png height=1714 width=2011></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212538408.png alt=/posts/1b1f96e/imgs/image-20240519212538408.png height=2160 width=3841></p><p>然后在 symbol table 中发现 base64 编码后的 flag，CyberChef 解码即可得到 flag</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212545935.png alt=/posts/1b1f96e/imgs/image-20240519212545935.png height=963 width=1923></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240519212551458.png alt=/posts/1b1f96e/imgs/image-20240519212551458.png height=1213 width=2585></p><p><strong>flag{2467ce26-fff9-4008-8d55-17df83ecbfc2}</strong></p><h2 class=heading-element id=题目名称-tough_dns><span>题目名称 Tough_DNS</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-tough_dns class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526085935378.png alt=/posts/1b1f96e/imgs/image-20240526085935378.png height=635 width=1236></p><p>解压压缩包可以得到一个流量包，发现是都是 DNS 流量</p><p>首先我们用 tshark 把 OPT 解析记录中的二进制数据都提取出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tshark -r 1.pcapng -T fields -e dns.qry.name <span class=p>|</span> sed <span class=s1>&#39;/^\s*$/d&#39;</span> <span class=p>|</span> uniq &gt; 1.txt</span></span></code></pre></td></tr></table></div></div><p>删除重复的数据，然后转二维码，可以得到如下二维码，扫码后得到：15f9792dba5c</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526094755643.png alt=/posts/1b1f96e/imgs/image-20240526094755643.png height=105 width=105></p><p>然后查看 TXT 解析记录，发现根据 dns.id 的不同可以分为两类：0x4500 和 0x6421，使用如下命令把其中的数据分别提取出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tshark -r 1.pcapng -T fields -e dns.txt -Y <span class=s2>&#34;(dns.txt.length == 1) &amp;&amp; (dns.id == 0x4500)&#34;</span><span class=p>|</span>tr -d <span class=s2>&#34;\n&#34;</span>
</span></span><span class=line><span class=cl>tshark -r 1.pcapng -T fields -e dns.txt -Y <span class=s2>&#34;(dns.txt.length == 1) &amp;&amp; (dns.id == 0x6421)&#34;</span><span class=p>|</span>tr -d <span class=s2>&#34;\n&#34;</span></span></span></code></pre></td></tr></table></div></div><p>查看提取出来的数据，结合文件头发现有一个 zip 压缩包和一段未知数据</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526102314071.png alt=/posts/1b1f96e/imgs/image-20240526102314071.png height=496 width=1280></p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526102330561.png alt=/posts/1b1f96e/imgs/image-20240526102330561.png height=307 width=1280>
用 CyberChef 提取压缩包，打开发现需要密码，使用之前扫码得到的密码解压压缩包，得到一个 secret.gpg</p><p>所以猜测另一个未知数据应该就是 gpg 加密的内容，使用 CyberChef from hex 然后下载到本地</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526102931778.png alt=/posts/1b1f96e/imgs/image-20240526102931778.png height=207 width=1734></p><p>解密 gpg 加密文件需要私钥导入口令，因此猜测题面中给我们的那段数据就是私钥导入口令</p><p>发现那段数据中有 d2 ，因此猜测是十六进制数据，但是转为 Ascii 后发现不是所有都是可打印字符</p><p>但是把十六进制数据先逆置一下，然后十六进制转 Ascii 就可以得到全都是可打印字符的字符串</p><p>尝试使用得到的字符串：eab9f5ae-0b9e 解密 GPG，发现就是我们需要的私钥导入口令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>printable</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># for item in printable:</span>
</span></span><span class=line><span class=cl><span class=c1>#     print(ord(item), end=&#39; &#39;)</span>
</span></span><span class=line><span class=cl><span class=c1># 48 49 50 51 52 53 54 55 56 57 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 58 59 60 61 62 63 64 91 92 93 94 95 96 123 124 125 126 32 9 10 13 11 12</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>passwd</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>enc_passwds</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;56&#39;</span><span class=p>,</span> <span class=s1>&#39;16&#39;</span><span class=p>,</span> <span class=s1>&#39;26&#39;</span><span class=p>,</span> <span class=s1>&#39;93&#39;</span><span class=p>,</span> <span class=s1>&#39;66&#39;</span><span class=p>,</span> <span class=s1>&#39;53&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                   <span class=s1>&#39;16&#39;</span><span class=p>,</span> <span class=s1>&#39;56&#39;</span><span class=p>,</span> <span class=s1>&#39;d2&#39;</span><span class=p>,</span> <span class=s1>&#39;03&#39;</span><span class=p>,</span> <span class=s1>&#39;26&#39;</span><span class=p>,</span> <span class=s1>&#39;93&#39;</span><span class=p>,</span> <span class=s1>&#39;56&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># for item in enc_passwds:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     print(int(item, 16), end=&#34; &#34;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># # 86 22 38 147 102 83 22 86 210 3 38 147 86</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>enc_passwds</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>item</span> <span class=o>=</span> <span class=n>item</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(int(item,16),end=&#34; &#34;)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 101 97 98 57 102 53 97 101 45 48 98 57 101</span>
</span></span><span class=line><span class=cl>        <span class=n>passwd</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>passwd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>passwd</span> <span class=o>=</span> <span class=n>solve</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>passwd</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># eab9f5ae-0b9e</span></span></span></code></pre></td></tr></table></div></div><p>最后在 WSL 中按照以下步骤解密即可得到flag：flag{79830a47-faf7-4067-b585-145776f833cd}</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526103109588.png alt=/posts/1b1f96e/imgs/image-20240526103109588.png height=505 width=1734></p><p>当然，这里也可以在 Windows 下使用 Kleopatra 解密</p><p><img loading=lazy src=/posts/1b1f96e/imgs/image-20240526103713939.png alt=/posts/1b1f96e/imgs/image-20240526103713939.png height=1047 width=2052></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2024-05-19 21:10:44">更新于 2024-05-19&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/1b1f96e/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/1b1f96e/ data-title="2024 全国大学生信息安全竞赛初赛 Misc Writeup" data-hashtags=CTF,Writeup><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/1b1f96e/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/1b1f96e/ data-title="2024 全国大学生信息安全竞赛初赛 Misc Writeup"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/writeup/ class=post-tag title="标签 - Writeup">Writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/9d73413/ class=post-nav-item rel=prev title="2024 “天一永安杯”宁波市网络安全大赛 Misc Writeup"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>2024 “天一永安杯”宁波市网络安全大赛 Misc Writeup</a><a href=/posts/a4ba07e/ class=post-nav-item rel=next title=CTF-密码学>CTF-密码学<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2026</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/1b1f96e/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>