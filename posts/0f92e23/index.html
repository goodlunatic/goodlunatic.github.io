<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>CTF-Reverse学习记录 - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="未来的研究方向里有好多要用到逆向工程的地方
感觉是绕不开逆向了，因此打算猛猛突击一下
"><meta name=keywords content='CTF,Reverse'><meta itemprop=name content="CTF-Reverse学习记录"><meta itemprop=description content="未来的研究方向里有好多要用到逆向工程的地方
感觉是绕不开逆向了，因此打算猛猛突击一下"><meta itemprop=datePublished content="2025-08-16T14:15:38+08:00"><meta itemprop=dateModified content="2025-08-16T14:15:38+08:00"><meta itemprop=wordCount content="3569"><meta itemprop=keywords content="CTF,Reverse"><meta property="og:url" content="https://goodlunatic.github.io/posts/0f92e23/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="CTF-Reverse学习记录"><meta property="og:description" content="未来的研究方向里有好多要用到逆向工程的地方
感觉是绕不开逆向了，因此打算猛猛突击一下"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-16T14:15:38+08:00"><meta property="article:modified_time" content="2025-08-16T14:15:38+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><meta name=twitter:card content="summary"><meta name=twitter:title content="CTF-Reverse学习记录"><meta name=twitter:description content="未来的研究方向里有好多要用到逆向工程的地方
感觉是绕不开逆向了，因此打算猛猛突击一下"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/0f92e23/ title="CTF-Reverse学习记录 - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/ed6ecd5/ title="如何基于 srsRAN_4G 搭建 LTE 基站"><link rel=next type=text/html href=https://goodlunatic.github.io/posts/30d0764/ title="2025 “天一永安杯”宁波市网络安全大赛 Misc Writeup"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/0f92e23/index.md title="CTF-Reverse学习记录 - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"CTF-Reverse学习记录","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/0f92e23\/"},"genre":"posts","keywords":"CTF, Reverse","wordcount":3569,"url":"https:\/\/goodlunatic.github.io\/posts\/0f92e23\/","datePublished":"2025-08-16T14:15:38+08:00","dateModified":"2025-08-16T14:15:38+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/1a152f0/ title=强网杯-谍影重重系列赛题详解>强网杯-谍影重重系列赛题详解</a></li><li class=related-item><a href=/posts/ca974cb/ title="Frida Learning Record">Frida Learning Record</a></li><li class=related-item><a href=/posts/5422d65/ title=Misc-流量分析>Misc-流量分析</a></li><li class=related-item><a href=/posts/32c3b27/ title="DASCTF 2024最后一战 Misc Writeup">DASCTF 2024最后一战 Misc Writeup</a></li><li class=related-item><a href=/posts/87bd986/ title="2025 能源网络安全大赛 Misc Writeup">2025 能源网络安全大赛 Misc Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>CTF-Reverse学习记录</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/ctf/ class=post-category title="分类 - CTF"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CTF</a></span></div><div class=post-meta-line><span title="发布于 2025-08-16 14:15:38"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-08-16>2025-08-16</time></span>&nbsp;<span title="3569 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 3600 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 17 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=CTF-Reverse学习记录><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#ida使用基础>IDA使用基础</a><ul><li><a href=#常用快捷键>常用快捷键</a></li><li><a href=#正常显示中文字符串>正常显示中文字符串</a></li></ul></li><li><a href=#逆向中常见的数据类型>逆向中常见的数据类型</a></li><li><a href=#汇编基础>汇编基础</a></li><li><a href=#常见的编码与加密>常见的编码与加密</a><ul><li><a href=#base64>base64</a></li><li><a href=#rc4加密算法>RC4加密算法</a></li><li><a href=#tea系列加密算法>TEA系列加密算法</a><ul><li><a href=#tea>TEA</a></li><li><a href=#xtea>XTEA</a></li><li><a href=#xxtea>XXTEA</a></li></ul></li><li><a href=#md5>MD5</a></li><li><a href=#smc>SMC</a></li></ul></li><li><a href=#常见的混淆>常见的混淆</a><ul><li><a href=#花指令>花指令</a><ul><li><a href=#永恒跳转>永恒跳转</a></li><li><a href=#jnz和jz互补跳转>jnz和jz互补跳转</a></li></ul></li><li><a href=#控制流平坦化>控制流平坦化</a><ul><li><a href=#ollvm>OLLVM</a></li></ul></li></ul></li><li><a href=#常见的壳>常见的壳</a><ul><li><a href=#upx>upx</a></li></ul></li><li><a href=#python逆向>Python逆向</a></li><li><a href=#unity游戏逆向>Unity游戏逆向</a></li><li><a href=#常用的一些逆向工具>常用的一些逆向工具</a><ul><li><a href=#z3-约束求解器>Z3 约束求解器</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>未来的研究方向里有好多要用到逆向工程的地方</strong></p><p><strong>感觉是绕不开逆向了，因此打算猛猛突击一下</strong></p><h2 class=heading-element id=ida使用基础><span>IDA使用基础</span>
<a href=#ida%e4%bd%bf%e7%94%a8%e5%9f%ba%e7%a1%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=常用快捷键><span>常用快捷键</span>
<a href=#%e5%b8%b8%e7%94%a8%e5%bf%ab%e6%8d%b7%e9%94%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th style=text-align:center>快捷键</th><th style=text-align:center>功能</th></tr></thead><tbody><tr><td style=text-align:center>F2</td><td style=text-align:center>添加断点</td></tr><tr><td style=text-align:center>F4</td><td style=text-align:center>开始运行</td></tr><tr><td style=text-align:center>F5</td><td style=text-align:center>反编译成伪代码</td></tr><tr><td style=text-align:center>F7</td><td style=text-align:center>进入函数</td></tr><tr><td style=text-align:center>F8</td><td style=text-align:center>单步调试</td></tr><tr><td style=text-align:center>F9</td><td style=text-align:center>运行到下一个断点</td></tr><tr><td style=text-align:center>Space</td><td style=text-align:center>切换反汇编窗口(列表视图&图形视图)</td></tr><tr><td style=text-align:center>Tab</td><td style=text-align:center>返回栈视图</td></tr><tr><td style=text-align:center>ESC</td><td style=text-align:center>跳转到返回前的地址</td></tr><tr><td style=text-align:center>/</td><td style=text-align:center>添加注释</td></tr><tr><td style=text-align:center>N</td><td style=text-align:center>修改变量名</td></tr><tr><td style=text-align:center>D</td><td style=text-align:center>代码解析成数据</td></tr><tr><td style=text-align:center>C</td><td style=text-align:center>数据解析成代码</td></tr><tr><td style=text-align:center>G</td><td style=text-align:center>跳转到指定地址查看</td></tr><tr><td style=text-align:center>H</td><td style=text-align:center>转换为十进制数</td></tr><tr><td style=text-align:center>Q</td><td style=text-align:center>转换为十六进制数</td></tr><tr><td style=text-align:center>R</td><td style=text-align:center>转换为字符</td></tr><tr><td style=text-align:center>X</td><td style=text-align:center>查看函数的交叉引用</td></tr><tr><td style=text-align:center>Y</td><td style=text-align:center>指定当前函数的命名</td></tr><tr><td style=text-align:center>Shift+F12</td><td style=text-align:center>打开字符串窗口</td></tr><tr><td style=text-align:center>Shift+E</td><td style=text-align:center>批量复制数据为字符串或者c数组格式</td></tr></tbody></table><h3 class=heading-element id=正常显示中文字符串><span>正常显示中文字符串</span>
<a href=#%e6%ad%a3%e5%b8%b8%e6%98%be%e7%a4%ba%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%e4%b8%b2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Options → Strings → Default 8-bit</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816213936073.png alt=/posts/0f92e23/imgs/image-20250816213936073.png height=1776 width=3077></p><p>点击UTF-8然后右键新插入一个gbk，然后选中并保存</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816213950452.png alt=/posts/0f92e23/imgs/image-20250816213950452.png height=663 width=902></p><p>最后点击字符串，然后按键盘上的ALT+A，选中C-style即可</p><p>如果修改后中文没有正常显示，可以尝试点击反编译后的变量按F5重新反编译</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816214008432.png alt=/posts/0f92e23/imgs/image-20250816214008432.png height=1776 width=3077></p><p>例题-BUU-内涵的软件</p><h2 class=heading-element id=逆向中常见的数据类型><span>逆向中常见的数据类型</span>
<a href=#%e9%80%86%e5%90%91%e4%b8%ad%e5%b8%b8%e8%a7%81%e7%9a%84%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><table><thead><tr><th style=text-align:center>数据类型</th><th style=text-align:center>位数</th></tr></thead><tbody><tr><td style=text-align:center>1 byte = 8 bit</td><td style=text-align:center>8 位</td></tr><tr><td style=text-align:center>1 word = 2 byte</td><td style=text-align:center>16 位</td></tr><tr><td style=text-align:center>1 dword(Double Word) = 2 word = 4 byte</td><td style=text-align:center>32 位</td></tr><tr><td style=text-align:center>1 qword(Quadra Word) = 2 dword = 8 byte</td><td style=text-align:center>64 位</td></tr><tr><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td style=text-align:center>uint32_t</td><td style=text-align:center>32 位</td></tr><tr><td style=text-align:center>uint64_t</td><td style=text-align:center>64 位</td></tr><tr><td style=text-align:center>char （-127-128）</td><td style=text-align:center>8 位</td></tr><tr><td style=text-align:center>unsigned char （0-255）</td><td style=text-align:center>8 位</td></tr><tr><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td style=text-align:center>float</td><td style=text-align:center>32位</td></tr><tr><td style=text-align:center>double</td><td style=text-align:center>64 位</td></tr></tbody></table><h2 class=heading-element id=汇编基础><span>汇编基础</span>
<a href=#%e6%b1%87%e7%bc%96%e5%9f%ba%e7%a1%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><table><thead><tr><th style=text-align:center>汇编指令</th><th style=text-align:center>示例</th><th style=text-align:center>含义</th><th style=text-align:center>说明</th></tr></thead><tbody><tr><td style=text-align:center>MOV</td><td style=text-align:center>MOV EAX, ECX</td><td style=text-align:center>EAX = ECX</td><td style=text-align:center>将ECX的值赋给EAX</td></tr><tr><td style=text-align:center>ADD</td><td style=text-align:center>ADD EAX, ECX</td><td style=text-align:center>EAX += ECX</td><td style=text-align:center>将EAX的值加上ECX的值</td></tr><tr><td style=text-align:center>SUB</td><td style=text-align:center>SUB EAX, ECX</td><td style=text-align:center>EAX -= ECX</td><td style=text-align:center>将EAX的值减去ECX的值</td></tr><tr><td style=text-align:center>INC</td><td style=text-align:center>INC EAX</td><td style=text-align:center>EAX++</td><td style=text-align:center>将EAX的值+1</td></tr><tr><td style=text-align:center>DEC</td><td style=text-align:center>DEX EAX</td><td style=text-align:center>EAX&ndash;</td><td style=text-align:center>将EAX的值-1</td></tr><tr><td style=text-align:center>LEA</td><td style=text-align:center>LEA EAX, ECX</td><td style=text-align:center>EAX = ECX的地址</td><td style=text-align:center>将ECX的地址存入EAX</td></tr><tr><td style=text-align:center>AND</td><td style=text-align:center>AND EAX, ECX</td><td style=text-align:center>EAX = EAX & ECX</td><td style=text-align:center>EAX与ECX进行与运算</td></tr><tr><td style=text-align:center>OR</td><td style=text-align:center>OR EAX, ECX</td><td style=text-align:center>EAX = EAX | ECX</td><td style=text-align:center>EAX与ECX进行或运算</td></tr><tr><td style=text-align:center>XOR</td><td style=text-align:center>XOR EAX, ECX</td><td style=text-align:center>EAX = EAX ^ ECX</td><td style=text-align:center>EAX与ECX进行异或运算</td></tr><tr><td style=text-align:center>NOT</td><td style=text-align:center>NOT EAX</td><td style=text-align:center>EAX = ~EAX</td><td style=text-align:center>将EAX的值取反</td></tr><tr><td style=text-align:center>SHL</td><td style=text-align:center>SHL EAX, 3</td><td style=text-align:center>EAX = EAX &#171; 3</td><td style=text-align:center>将EAX的值左移三位</td></tr><tr><td style=text-align:center>SHR</td><td style=text-align:center>SHR EAX, 3</td><td style=text-align:center>EAX = EAX &#187; 3</td><td style=text-align:center>将EAX的值右移三位</td></tr><tr><td style=text-align:center>CMP</td><td style=text-align:center>CMP EAX, ECX</td><td style=text-align:center>if(EAX == ECX) ZF = 1<br>else ZF = 0</td><td style=text-align:center>对EAX和ECX的值进行比较并根据比较结果设置ZF标志的值</td></tr><tr><td style=text-align:center>TEST</td><td style=text-align:center>TEST EAX, EAX</td><td style=text-align:center>if(EAX == 0) ZF = 1<br>else ZF = 0</td><td style=text-align:center>将EAX的值与0进行比较并根据比较结果设置ZF标志的值</td></tr><tr><td style=text-align:center>JE[JZ]</td><td style=text-align:center>JZ 04001000</td><td style=text-align:center>if(ZF == 1)<br>GOTO 04001000</td><td style=text-align:center>若ZF为1则跳转至 04001000</td></tr><tr><td style=text-align:center>JNE[JNZ]</td><td style=text-align:center>JNZ 04001000</td><td style=text-align:center>if(ZF == 0)<br>GOTO 04001000</td><td style=text-align:center>若ZF为0则跳转至 04001000</td></tr><tr><td style=text-align:center>JMP</td><td style=text-align:center>JMP 04001000</td><td style=text-align:center>GOTO 04001000</td><td style=text-align:center>直接跳转至 04001000</td></tr><tr><td style=text-align:center>CALL</td><td style=text-align:center>CALL printf<br>CALL $+5</td><td style=text-align:center></td><td style=text-align:center>调用函数printf<br>跳转到下一条指令</td></tr><tr><td style=text-align:center>PUSH</td><td style=text-align:center>PUSH EAX</td><td style=text-align:center></td><td style=text-align:center>将EAX的值压入栈顶</td></tr><tr><td style=text-align:center>POP</td><td style=text-align:center>POP EAX</td><td style=text-align:center></td><td style=text-align:center>将栈顶的值弹给EAX</td></tr></tbody></table><p>一些常用的寄存器：</p><table><thead><tr><th><strong>32位 (x86)</strong></th><th><strong>64位 (x64)</strong></th><th><strong>用途</strong></th></tr></thead><tbody><tr><td><strong>EAX</strong></td><td><strong>RAX</strong></td><td>累加器（Accumulator），算术运算、函数返回值</td></tr><tr><td><strong>EBX</strong></td><td><strong>RBX</strong></td><td>基址寄存器（Base），常用于存储指针</td></tr><tr><td><strong>ECX</strong></td><td><strong>RCX</strong></td><td>计数器（Counter），LOOP指令、字符串操作</td></tr><tr><td><strong>EDX</strong></td><td><strong>RDX</strong></td><td>数据寄存器（Data），辅助EAX（如MUL/DIV）</td></tr><tr><td><strong>ESI</strong></td><td><strong>RSI</strong></td><td>源索引（Source Index），字符串/内存操作</td></tr><tr><td><strong>EDI</strong></td><td><strong>RDI</strong></td><td>目标索引（Destination Index），字符串/内存操作</td></tr><tr><td><strong>ESP</strong></td><td><strong>RSP</strong></td><td>栈指针（Stack Pointer），指向当前栈顶</td></tr><tr><td><strong>EBP</strong></td><td><strong>RBP</strong></td><td>基址指针（Base Pointer），函数栈帧</td></tr><tr><td></td><td></td><td></td></tr><tr><td><strong>EIP</strong></td><td><strong>RIP</strong></td><td>存储下一条要执行的指令地址</td></tr><tr><td><strong>EFLAGS</strong></td><td><strong>RFLAGS</strong></td><td>存储 CPU 状态标志（如 ZF, CF, SF 等）</td></tr></tbody></table><h2 class=heading-element id=常见的编码与加密><span>常见的编码与加密</span>
<a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e7%bc%96%e7%a0%81%e4%b8%8e%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=base64><span>base64</span>
<a href=#base64 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>char</span> <span class=n>base64_table</span><span class=p>[]</span> <span class=o>=</span> <span class=s>&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=n>base64_encode</span><span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=n>Str2</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>Str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// [rsp+24h] [rbp-1Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v4</span><span class=p>;</span> <span class=c1>// [rsp+34h] [rbp-Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v5</span><span class=p>;</span> <span class=c1>// [rsp+38h] [rbp-8h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v6</span><span class=p>;</span> <span class=c1>// [rsp+3Ch] [rbp-4h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>Str</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=o>%</span> <span class=mi>3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v6</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=n>v3</span> <span class=o>/</span> <span class=mi>3</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=n>v6</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=n>v3</span> <span class=o>/</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Str2</span><span class=p>[</span><span class=n>v6</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v5</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=n>v6</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>&gt;</span> <span class=n>v5</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span><span class=p>]</span> <span class=o>=</span> <span class=n>base64_table</span><span class=p>[(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>];</span> <span class=c1>// 右移2位，获得第一个字符前6位的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>base64_table</span><span class=p>[(</span><span class=mi>16</span> <span class=o>*</span> <span class=p>(</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>))</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)];</span> <span class=c1>// 获取第二个6位
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>base64_table</span><span class=p>[(</span><span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0xF</span><span class=p>))</span> <span class=o>|</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>6</span><span class=p>)];</span> <span class=c1>// 获得第三个6位
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>base64_table</span><span class=p>[</span><span class=n>Str</span><span class=p>[</span><span class=n>v4</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0x3F</span><span class=p>];</span> <span class=c1>// 获得第四个6位
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>v4</span> <span class=o>+=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v5</span> <span class=o>+=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=nf>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>2</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Str2</span><span class=p>[</span><span class=n>v5</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>putchar</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=rc4加密算法><span>RC4加密算法</span>
<a href=#rc4%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=tea系列加密算法><span>TEA系列加密算法</span>
<a href=#tea%e7%b3%bb%e5%88%97%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=tea><span>TEA</span>
<a href=#tea class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>加密和解密的示例代码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>void</span> <span class=nf>encrypt</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kt>int</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>r</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9e3779b9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>+=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>+=</span> <span class=p>((</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span> <span class=o>+</span> <span class=n>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>+=</span> <span class=p>((</span><span class=n>l</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>decrypt</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kt>int</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>r</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9e3779b9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>sum</span> <span class=o>=</span> <span class=n>delta</span> <span class=o>*</span><span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>-=</span> <span class=p>((</span><span class=n>l</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>-=</span> <span class=p>((</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span> <span class=o>+</span> <span class=n>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>-=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>解密脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include&lt;stdio.h&gt;
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span><span class=c1>//pw的个数
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>pw</span><span class=p>[]</span><span class=o>=</span><span class=p>{};</span><span class=c1>//可改
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=o>=</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>};</span><span class=c1>//可改
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>n</span><span class=o>/</span><span class=mi>2</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>v0</span><span class=o>=</span><span class=n>pw</span><span class=p>[</span><span class=mi>2</span><span class=o>*</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>		<span class=n>v1</span><span class=o>=</span><span class=n>pw</span><span class=p>[</span><span class=mi>2</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>		<span class=n>sum</span><span class=o>=-</span><span class=mi>32</span><span class=o>*</span><span class=mh>0x61C88647</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=mi>32</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>v1</span> <span class=o>-=</span> <span class=p>((</span><span class=n>v0</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=p>)</span><span class=o>^</span> <span class=p>(</span><span class=mi>16</span> <span class=o>*</span> <span class=n>v0</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>v0</span><span class=p>);</span><span class=c1>//容易魔改	
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=n>v0</span> <span class=o>-=</span> <span class=p>((</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=mi>16</span> <span class=o>*</span> <span class=n>v1</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>sum</span> <span class=o>+=</span> <span class=mh>0x61C88647</span><span class=p>;</span><span class=c1>//容易魔改
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span><span class=o>&lt;=</span><span class=mi>3</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v0</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span><span class=o>&lt;=</span><span class=mi>3</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>比赛中用到的一些代码</p><p>处理原始字节数据版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#include &lt;iostream&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#include &lt;cstdint&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>void</span> <span class=n>tea_decrypt</span><span class=p>(</span><span class=n>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=n>uint32_t</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>uint32_t</span> <span class=n>l</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>uint32_t</span> <span class=n>r</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>uint32_t</span> <span class=nb>sum</span> <span class=o>=</span> <span class=mi>32</span> <span class=o>*</span> <span class=mh>0x414554</span><span class=p>;</span> <span class=o>//</span> <span class=n>加密的总delta和</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>-=</span> <span class=p>((</span><span class=n>l</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=nb>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>-=</span> <span class=p>((</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span> <span class=o>+</span> <span class=nb>sum</span><span class=p>)</span> <span class=o>^</span> <span class=p>((</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=nb>sum</span> <span class=o>-=</span> <span class=mh>0x414554</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>int</span> <span class=n>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>加密后的数据</span><span class=err>（</span><span class=n>小端序</span><span class=err>）</span>
</span></span><span class=line><span class=cl>    <span class=n>uint8_t</span> <span class=n>encrypted</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mh>0xE4</span><span class=p>,</span> <span class=mh>0x6E</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xF0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x91</span><span class=p>,</span> <span class=mh>0x73</span><span class=p>,</span> <span class=mh>0x9A</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0xCA</span><span class=p>,</span> <span class=mh>0xF1</span><span class=p>,</span> <span class=mh>0x2A</span><span class=p>,</span> <span class=mh>0x60</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x0E</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x74</span><span class=p>,</span> <span class=mh>0x83</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xE0</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x6C</span><span class=p>,</span> <span class=mh>0x34</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xD7</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span> <span class=mh>0xDE</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x8B</span><span class=p>,</span> <span class=mh>0x86</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0x90</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xC2</span><span class=p>,</span> <span class=mh>0x0B</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0x59</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>密钥</span><span class=err>（</span><span class=n>小端序</span><span class=err>）</span>
</span></span><span class=line><span class=cl>    <span class=n>uint8_t</span> <span class=n>key_bytes</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xDE</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0xF0</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xBA</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xDE</span><span class=p>,</span> <span class=mh>0xC0</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xDE</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xCC</span><span class=p>,</span> <span class=mh>0x10</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xDE</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>将字节数组转换为4个32位整数</span><span class=err>（</span><span class=n>注意小端序</span><span class=err>）</span>
</span></span><span class=line><span class=cl>    <span class=n>uint32_t</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=mh>0xDEADBEEF</span> <span class=mh>0xBAADF00D</span> <span class=mh>0xDEADC0DE</span> <span class=mh>0xDEAD10CC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>int</span> <span class=n>num_blocks</span> <span class=o>=</span> <span class=n>sizeof</span><span class=p>(</span><span class=n>encrypted</span><span class=p>)</span> <span class=o>/</span> <span class=mi>8</span><span class=p>;</span> <span class=o>//</span> <span class=mi>8</span><span class=n>个32位整数</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>num_blocks</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>将加密数据转换为32位整数</span><span class=err>（</span><span class=n>小端序</span><span class=err>）</span>
</span></span><span class=line><span class=cl>        <span class=n>uint32_t</span> <span class=n>v</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>7</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>6</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>5</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>一次解密两个32位整数</span>
</span></span><span class=line><span class=cl>        <span class=n>tea_decrypt</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>输出解密结果</span><span class=err>（</span><span class=n>转换为字节</span><span class=err>）</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%c</span><span class=s2>&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nb>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%c</span><span class=s2>&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=xtea><span>XTEA</span>
<a href=#xtea class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>加密和解密的示例代码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xtea_encrypt</span><span class=p>(</span><span class=kt>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>uint32_t</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>v0</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>v1</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span> <span class=c1>//0x9E3779B9=-0x61C88647
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>v0</span> <span class=o>+=</span> <span class=p>(((</span><span class=n>v1</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>v1</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=n>sum</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>+=</span> <span class=n>delta</span><span class=p>;</span> <span class=c1>// 如果 delta=0x61C88647, 这里就是 sum -= delta
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>v1</span> <span class=o>+=</span> <span class=p>(((</span><span class=n>v0</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>v0</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>v0</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>key</span><span class=p>[(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>v0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>v1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xtea_decrypt</span><span class=p>(</span><span class=kt>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>uint32_t</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>v0</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>v1</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>32</span> <span class=o>*</span> <span class=mh>0x9E3779B9</span><span class=p>;</span> <span class=c1>// 加密的总和
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>v1</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>v0</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>v0</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>v0</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>key</span><span class=p>[(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>-=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>v0</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>v1</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>v1</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>v1</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>sum</span> <span class=o>+</span> <span class=n>key</span><span class=p>[</span><span class=n>sum</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>v0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>v1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>比赛中用到的一些脚本</p><p>处理原始字节数据版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;cstdint&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xtea_decrypt</span><span class=p>(</span><span class=kt>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>uint32_t</span><span class=o>*</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>l</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>r</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>32</span> <span class=o>*</span> <span class=mh>0x9E3779B9</span><span class=p>;</span> <span class=c1>// XTEA的总delta和（32轮）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>l</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>l</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>sum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>-=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=n>sum</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>sum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 加密后的数据（小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uint8_t</span> <span class=n>encrypted</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mh>0xD1</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0x59</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xE2</span><span class=p>,</span> <span class=mh>0xB5</span><span class=p>,</span> <span class=mh>0xA9</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0x90</span><span class=p>,</span> <span class=mh>0x71</span><span class=p>,</span> <span class=mh>0xDA</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xA0</span><span class=p>,</span> <span class=mh>0x0A</span><span class=p>,</span> <span class=mh>0x4B</span><span class=p>,</span> <span class=mh>0xC5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x54</span><span class=p>,</span> <span class=mh>0xED</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x84</span><span class=p>,</span> <span class=mh>0x7F</span><span class=p>,</span> <span class=mh>0xD0</span><span class=p>,</span> <span class=mh>0x4A</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0xC0</span><span class=p>,</span> <span class=mh>0xF3</span><span class=p>,</span> <span class=mh>0x4C</span><span class=p>,</span> <span class=mh>0x8A</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x2F</span><span class=p>,</span> <span class=mh>0xB2</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0x7F</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 密钥（小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uint8_t</span> <span class=n>key_bytes</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x07</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=mh>0x21</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 将字节数组转换为4个32位整数（小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uint32_t</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>key_bytes</span><span class=p>[</span><span class=mi>4</span><span class=o>*</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>num_blocks</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>encrypted</span><span class=p>)</span> <span class=o>/</span> <span class=mi>8</span><span class=p>;</span> <span class=c1>// 每个块8字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>num_blocks</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 将加密数据转换为32位整数（小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>uint32_t</span> <span class=n>v</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span> <span class=c1>// 数组元素每个为4字节
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>7</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>6</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>5</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>encrypted</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// XTEA解密
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>xtea_decrypt</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 输出解密结果（转换为字节，小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>处理32位整数版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xtea_decrypt</span><span class=p>(</span><span class=kt>uint32_t</span> <span class=o>*</span><span class=n>v</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=o>*</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint32_t</span> <span class=n>l</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint32_t</span> <span class=n>r</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint32_t</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>32</span> <span class=o>*</span> <span class=mh>0x9E3779B9</span><span class=p>;</span> <span class=c1>// XTEA的总delta和（32轮）
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>l</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>l</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>sum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>-=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span><span class=p>))</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=n>sum</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>sum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint32_t</span> <span class=n>enc</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=c1>// 4x8=32字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=mh>0x590D36D1</span><span class=p>,</span> <span class=mh>0x6FA9B5E2</span><span class=p>,</span> <span class=mh>0xDA7190AD</span><span class=p>,</span> <span class=mh>0xC54B0AA0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xADA5ED54</span><span class=p>,</span> <span class=mh>0x4AD07F84</span><span class=p>,</span> <span class=mh>0x8A4CF3C0</span><span class=p>,</span> <span class=mh>0x7FEFB22F</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=kt>uint32_t</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x0000000D</span><span class=p>,</span> <span class=mh>0x00000000</span><span class=p>,</span> <span class=mh>0x00000007</span><span class=p>,</span> <span class=mh>0x00000021</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>num_blocks</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>enc</span><span class=p>)</span> <span class=o>/</span> <span class=mi>8</span><span class=p>;</span> <span class=c1>// 每个块8字节, 所以这里的结果是4
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>num_blocks</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>v</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>enc</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>enc</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>xtea_decrypt</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 输出解密结果（转换为字节，小端序）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>*</span> <span class=mi>8</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=xxtea><span>XXTEA</span>
<a href=#xxtea class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>加密和解密的示例代码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xxtea_encrypt</span><span class=p>(</span><span class=kt>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span><span class=p>,</span> <span class=n>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>p</span><span class=p>,</span> <span class=n>rounds</span><span class=p>,</span> <span class=n>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>rounds</span> <span class=o>=</span> <span class=mi>6</span> <span class=o>+</span> <span class=mi>52</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>+=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span> <span class=o>=</span> <span class=p>(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>p</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>p</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>p</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>]</span> <span class=o>+=</span> <span class=p>((</span><span class=n>z</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>z</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))</span> <span class=o>^</span> <span class=p>((</span><span class=n>sum</span> <span class=o>^</span> <span class=n>y</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>^</span> <span class=n>e</span><span class=p>]</span> <span class=o>^</span> <span class=n>z</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=p>((</span><span class=n>z</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>z</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))</span> <span class=o>^</span> <span class=p>((</span><span class=n>sum</span> <span class=o>^</span> <span class=n>y</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>^</span> <span class=n>e</span><span class=p>]</span> <span class=o>^</span> <span class=n>z</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=o>--</span><span class=n>rounds</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>xxtea_decrypt</span><span class=p>(</span><span class=kt>uint32_t</span><span class=o>*</span> <span class=n>v</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span><span class=p>,</span> <span class=n>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>delta</span> <span class=o>=</span> <span class=mh>0x9E3779B9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>p</span><span class=p>,</span> <span class=n>rounds</span><span class=p>,</span> <span class=n>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>rounds</span> <span class=o>=</span> <span class=mi>6</span> <span class=o>+</span> <span class=mi>52</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>=</span> <span class=n>rounds</span> <span class=o>*</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span> <span class=o>=</span> <span class=p>(</span><span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>p</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>p</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=n>p</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>]</span> <span class=o>-=</span> <span class=p>((</span><span class=n>z</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>z</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))</span> <span class=o>^</span> <span class=p>((</span><span class=n>sum</span> <span class=o>^</span> <span class=n>y</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>^</span> <span class=n>e</span><span class=p>]</span> <span class=o>^</span> <span class=n>z</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=p>((</span><span class=n>z</span> <span class=o>&gt;&gt;</span> <span class=mi>5</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>z</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>^</span> <span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>))</span> <span class=o>^</span> <span class=p>((</span><span class=n>sum</span> <span class=o>^</span> <span class=n>y</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>^</span> <span class=n>e</span><span class=p>]</span> <span class=o>^</span> <span class=n>z</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>-=</span> <span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=o>--</span><span class=n>rounds</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>解密脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#define delta 0x9e3779b9
</span></span></span><span class=line><span class=cl><span class=cp></span> 
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x10BD3B47</span><span class=p>,</span> <span class=mh>0x6155E0F9</span><span class=p>,</span> <span class=mh>0x6AF7EBC5</span><span class=p>,</span> <span class=mh>0x8D23435F</span><span class=p>,</span> <span class=mh>0x1A091605</span><span class=p>,</span> <span class=mh>0xD43D40EF</span><span class=p>,</span> <span class=mh>0xB4B16A67</span><span class=p>,</span> <span class=mh>0x6B3578A9</span><span class=p>};</span><span class=c1>//可改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x00001234</span><span class=p>,</span> <span class=mh>0x00002345</span><span class=p>,</span> <span class=mh>0x00004567</span><span class=p>,</span> <span class=mh>0x00006789</span><span class=p>};</span><span class=c1>//可改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>y</span><span class=p>,</span><span class=n>z</span><span class=p>,</span><span class=n>p</span><span class=p>,</span><span class=n>rounds</span><span class=p>,</span><span class=n>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>8</span><span class=p>;</span><span class=c1>//v的个数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>rounds</span> <span class=o>=</span> <span class=mi>6</span> <span class=o>+</span> <span class=mi>52</span><span class=o>/</span><span class=n>n</span><span class=p>;</span><span class=c1>//容易魔改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>sum</span> <span class=o>=</span> <span class=n>rounds</span><span class=o>*</span><span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=k>do</span>
</span></span><span class=line><span class=cl>     <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=n>p</span><span class=o>=</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span><span class=n>p</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>;</span><span class=n>p</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>]</span> <span class=o>-=</span> <span class=p>((((</span><span class=n>z</span><span class=o>&gt;&gt;</span><span class=mi>5</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=n>y</span><span class=o>&lt;&lt;</span><span class=mi>2</span><span class=p>))</span><span class=o>+</span><span class=p>((</span><span class=n>y</span><span class=o>&gt;&gt;</span><span class=mi>3</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=n>z</span><span class=o>&lt;&lt;</span><span class=mi>4</span><span class=p>)))</span> <span class=o>^</span> <span class=p>((</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span><span class=o>&amp;</span><span class=mi>3</span><span class=p>)</span><span class=o>^</span><span class=n>e</span><span class=p>]</span><span class=o>^</span><span class=n>z</span><span class=p>)</span><span class=o>+</span><span class=p>(</span><span class=n>y</span> <span class=o>^</span> <span class=n>sum</span><span class=p>)));</span><span class=c1>//容易魔改
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>p</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=p>(((</span><span class=n>key</span><span class=p>[(</span><span class=n>p</span><span class=o>^</span><span class=n>e</span><span class=p>)</span><span class=o>&amp;</span><span class=mi>3</span><span class=p>]</span><span class=o>^</span><span class=n>z</span><span class=p>)</span><span class=o>+</span><span class=p>(</span><span class=n>y</span> <span class=o>^</span> <span class=n>sum</span><span class=p>))</span> <span class=o>^</span> <span class=p>(((</span><span class=n>y</span><span class=o>&lt;&lt;</span><span class=mi>2</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=n>z</span><span class=o>&gt;&gt;</span><span class=mi>5</span><span class=p>))</span><span class=o>+</span><span class=p>((</span><span class=n>z</span><span class=o>&lt;&lt;</span><span class=mi>4</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=n>y</span><span class=o>&gt;&gt;</span><span class=mi>3</span><span class=p>))));</span><span class=c1>//容易魔改
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>y</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>=</span> <span class=n>sum</span><span class=o>-</span><span class=n>delta</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span><span class=k>while</span><span class=p>(</span><span class=o>--</span><span class=n>rounds</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%c%c%c%c&#34;</span><span class=p>,</span><span class=o>*</span><span class=p>((</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=mi>0</span><span class=p>),</span><span class=o>*</span><span class=p>((</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=mi>1</span><span class=p>),</span><span class=o>*</span><span class=p>((</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=mi>2</span><span class=p>),</span><span class=o>*</span><span class=p>((</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=mi>3</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=c1>//printf(&#34;%c%c%c%c&#34;,*((char*)&amp;v[i]+3),*((char*)&amp;v[i]+2),*((char*)&amp;v[i]+1),*((char*)&amp;v[i]+0));
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=md5><span>MD5</span>
<a href=#md5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=smc><span>SMC</span>
<a href=#smc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>SMC，即Self Modifying Code，动态代码加密技术，指通过修改代码或数据，阻止别人直接静态分析，然后在动态运行程序时对代码进行解密，达到程序正常运行的效果。</p><p>SMC一般有俩种破解方法，第一种是找到对代码或数据加密的函数后通过idapython写解密脚本。第二种是动态调试到SMC解密结束的地方dump出来。</p></blockquote><h2 class=heading-element id=常见的混淆><span>常见的混淆</span>
<a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e6%b7%b7%e6%b7%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=花指令><span>花指令</span>
<a href=#%e8%8a%b1%e6%8c%87%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=永恒跳转><span>永恒跳转</span>
<a href=#%e6%b0%b8%e6%81%92%e8%b7%b3%e8%bd%ac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>构造代码如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>__asm {
</span></span><span class=line><span class=cl>    _emit 0xE8
</span></span><span class=line><span class=cl>    _emit 0xFF
</span></span><span class=line><span class=cl>   //_emit 立即数：代表在这个位置插入一个数据，这里插入的是0xe8
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div><p>插入这些代码后，IDA反汇编就会得到如下内容</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816214208423.png alt=/posts/0f92e23/imgs/image-20250816214208423.png height=396 width=1419></p><p>对于这种，我们只要将0xE8该成0x90(NOP指令)即可</p><h4 class=heading-element id=jnz和jz互补跳转><span>jnz和jz互补跳转</span>
<a href=#jnz%e5%92%8cjz%e4%ba%92%e8%a1%a5%e8%b7%b3%e8%bd%ac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>构造代码如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> __asm {
</span></span><span class=line><span class=cl>        jz Label;
</span></span><span class=line><span class=cl>		jnz Label;
</span></span><span class=line><span class=cl>		_emit 0xC7;
</span></span><span class=line><span class=cl>Label:</span></span></code></pre></td></tr></table></div></div><p>插入这些代码后，IDA反汇编就会得到如下内容</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816214221278.png alt=/posts/0f92e23/imgs/image-20250816214221278.png height=662 width=1420></p><p>去除花指令的方法：</p><p>在准备去除花指令之前，我们需要先调整操作码显示的字节数</p><p><img loading=lazy src=/posts/0f92e23/imgs/image-20250816214238985.png alt=/posts/0f92e23/imgs/image-20250816214238985.png height=662 width=1420></p><p>1、点到跳转的那一行，按键盘上的u键，将其解析为数据，然后在E8上右键选择NOP，再按键盘上的c键重新解析为代码，最后在函数名(main)上按一下p键然后F5重新反汇编即可</p><p>2、点到跳转的那一行，按键盘上的u键，将其解析为数据，然后点击菜单栏 Edit → Patch Program → Change byte，将0xE8改成0x90，再按键盘上的c键重新解析为代码，最后在函数名(main)上按一下p键然后F5重新反汇编即可</p><p>例题1-[HNCTF 2022 WEEK2]e@sy_flower</p><p>例题2-[NSSRound#3 Team]jump_by_jump_revenge</p><p>例题3-[MoeCTF 2022]chicken_soup</p><h3 class=heading-element id=控制流平坦化><span>控制流平坦化</span>
<a href=#%e6%8e%a7%e5%88%b6%e6%b5%81%e5%b9%b3%e5%9d%a6%e5%8c%96 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=ollvm><span>OLLVM</span>
<a href=#ollvm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h2 class=heading-element id=常见的壳><span>常见的壳</span>
<a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e5%a3%b3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>可以先把待逆向的文件拖入 <a href=https://github.com/horsicq/Detect-It-Easy target=_blank rel="external nofollow noopener noreferrer">DIE(Detect-It-Easy)</a> 中查看是用的什么壳</p><h3 class=heading-element id=upx><span>upx</span>
<a href=#upx class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>一种压缩壳，可以尝试直接用upx脱壳</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 下载</span>
</span></span><span class=line><span class=cl>upx: https://github.com/upx/upx
</span></span><span class=line><span class=cl><span class=c1># 使用方法</span>
</span></span><span class=line><span class=cl>upx -d re.exe</span></span></code></pre></td></tr></table></div></div><p>也可以尝试手动脱upx</p><h2 class=heading-element id=python逆向><span>Python逆向</span>
<a href=#python%e9%80%86%e5%90%91 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>有部分exe是由 pyinstaller 打包的，通常可以直接根据文件的图标看出来</p><p>针对这种exe的逆向，我可以按照如下步骤：</p><p>1、使用 pyinstxtractor 先进行解包</p><blockquote><p>pyinstxtractor: <a href=https://github.com/extremecoders-re/pyinstxtractor target=_blank rel="external nofollow noopener noreferrer">https://github.com/extremecoders-re/pyinstxtractor</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 可以用如下命令进行解包</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Usage: pyinstxtractor.py &lt;filename&gt;
</span></span><span class=line><span class=cl>python ~/CTF/Reverse/pyinstxtractor/pyinstxtractor.py pyc.exe
</span></span><span class=line><span class=cl><span class=c1># 这里要注意，如果本地版本和出题人打包用的版本不同，某些依赖可能无法正常解包</span></span></span></code></pre></td></tr></table></div></div><p>2、反编译解包后得到的 pyc 文件</p><p>第一种方法是用如下的在线网站反编译：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=k>tool</span><span class=o>.</span><span class=n>lu</span><span class=o>/</span><span class=n>pyc</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>lddgo</span><span class=o>.</span><span class=n>net</span><span class=o>/</span><span class=n>string</span><span class=o>/</span><span class=n>pyc</span><span class=o>-</span><span class=n>compile</span><span class=o>-</span><span class=n>decompile</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>toolkk</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>pyc</span><span class=o>-</span><span class=n>decomplie</span></span></span></code></pre></td></tr></table></div></div><p>第二中方法就是用本地工具进行反编译，这里有以下三个常用的反编译工具：</p><p>uncompyle6: <a href=https://github.com/rocky/python-uncompyle6 target=_blank rel="external nofollow noopener noreferrer">https://github.com/rocky/python-uncompyle6</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 直接 pip 安装即可</span>
</span></span><span class=line><span class=cl>pip3 install uncompyle6
</span></span><span class=line><span class=cl><span class=c1># 然后将 Script 目录添加到环境变量中</span>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\X</span>XX<span class=se>\A</span>ppData<span class=se>\L</span>ocal<span class=se>\P</span>rograms<span class=se>\P</span>ython<span class=se>\P</span>ython38<span class=se>\S</span>cripts
</span></span><span class=line><span class=cl><span class=c1># 之后就可以直接在终端中使用了</span>
</span></span><span class=line><span class=cl>uncompyle6 filename.pyc &gt; decompile.py</span></span></code></pre></td></tr></table></div></div><p>pyinstxtractor: <a href=https://github.com/extremecoders-re/pyinstxtractor target=_blank rel="external nofollow noopener noreferrer">https://github.com/extremecoders-re/pyinstxtractor</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python pyinstxtractor.py reverse_1_PyHaHa.pyc</span></span></code></pre></td></tr></table></div></div><p>pycdc: <a href=https://github.com/zrax/pycdc target=_blank rel="external nofollow noopener noreferrer">https://github.com/zrax/pycdc</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 下载并编译</span>
</span></span><span class=line><span class=cl>git clone https://github.com/zrax/pycdc.git
</span></span><span class=line><span class=cl>mkdir build <span class=o>&amp;&amp;</span> <span class=nb>cd</span> build
</span></span><span class=line><span class=cl>cmake ..
</span></span><span class=line><span class=cl>make -j<span class=k>$(</span>nproc<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用方法</span>
</span></span><span class=line><span class=cl>Usage:  ./pycdc <span class=o>[</span>options<span class=o>]</span> input.pyc
</span></span><span class=line><span class=cl>~/CTF/Reverse/pycdc/build/pycdc main.pyc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Options:
</span></span><span class=line><span class=cl>  -o &lt;filename&gt;  Write output to &lt;filename&gt; <span class=o>(</span>default: stdout<span class=o>)</span>
</span></span><span class=line><span class=cl>  -c             Specify loading a compiled code object. Requires the version to be <span class=nb>set</span>
</span></span><span class=line><span class=cl>  -v &lt;x.y&gt;       Specify a Python version <span class=k>for</span> loading a compiled code object
</span></span><span class=line><span class=cl>  --help         Show this <span class=nb>help</span> text and <span class=k>then</span> exit</span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips: 有时候会遇到pyc文件魔术头被修改的情况，可以复制解包后的struct.pyc到要反编译的pyc文件中（就是文件前16个字节）</p></blockquote><h2 class=heading-element id=unity游戏逆向><span>Unity游戏逆向</span>
<a href=#unity%e6%b8%b8%e6%88%8f%e9%80%86%e5%90%91 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>参考文章：https://forum.butian.net/share/1294</p><p>Unity 游戏的主逻辑一般都保存在 dll 文件中，因此我们需要下个 dnspy 来反编译</p><p>然后我们需要打开并反编译 <code>data/Managed/Assembly-CSarp.dll</code> 这个文件</p><p>我们可以在 dnspy 的编辑器中右键编辑类或者方法，编辑完后编译</p><p>然后左上角-文件-全部保存即可保存我们的修改</p><blockquote><p>一般就是修改分数或者判断逻辑等参数，从而获得 flag</p></blockquote><h2 class=heading-element id=常用的一些逆向工具><span>常用的一些逆向工具</span>
<a href=#%e5%b8%b8%e7%94%a8%e7%9a%84%e4%b8%80%e4%ba%9b%e9%80%86%e5%90%91%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=z3-约束求解器><span>Z3 约束求解器</span>
<a href=#z3-%e7%ba%a6%e6%9d%9f%e6%b1%82%e8%a7%a3%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>Z3-solver是微软开发的自动定理证明器和约束求解器，能够将复杂问题转化为数学约束条件，然后自动寻找满足所有条件的解。它特别擅长处理包含布尔逻辑、算术运算、位运算等多种约束的复杂问题，广泛应用于程序验证、网络安全、人工智能等领域。Z3通过先进的符号推理和约束求解技术，能够解决传统方法难以处理的非线性约束和复杂逻辑关系，是一个强大的数学问题求解工具。</p></blockquote><p>安装方法: <code>pip3 install z3-solver</code></p><p>基本用法如下，更多用法可以参考<a href=https://z3prover.github.io/api/html/index.html target=_blank rel="external nofollow noopener noreferrer">官方文档</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 创建变量</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>Int</span><span class=p>(</span><span class=s1>&#39;x&#39;</span><span class=p>)</span>      <span class=c1># 整型变量</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>Int</span><span class=p>(</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>      <span class=c1># 整型变量</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>Bool</span><span class=p>(</span><span class=s1>&#39;p&#39;</span><span class=p>)</span>     <span class=c1># 布尔变量p</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>Bool</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>)</span>     <span class=c1># 布尔变量q</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>Bool</span><span class=p>(</span><span class=s1>&#39;r&#39;</span><span class=p>)</span>     <span class=c1># 布尔变量r</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 创建求解器</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 添加约束条件</span>
</span></span><span class=line><span class=cl><span class=c1># 数值约束</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>                    <span class=c1># x必须大于0</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>y</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>                    <span class=c1># y必须大于0</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>y</span> <span class=o>==</span> <span class=mi>10</span><span class=p>)</span>              <span class=c1># x+y等于10</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Implies</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>x</span> <span class=o>&gt;</span> <span class=n>y</span><span class=p>))</span>        <span class=c1># 如果p为真，则x&gt;y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 逻辑约束</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Implies</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span>            <span class=c1># p → q (如果p为真，则q为真)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>r</span> <span class=o>==</span> <span class=n>Not</span><span class=p>(</span><span class=n>q</span><span class=p>))</span>              <span class=c1># r = ¬q (r等于q的否定)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Or</span><span class=p>(</span><span class=n>Not</span><span class=p>(</span><span class=n>p</span><span class=p>),</span> <span class=n>r</span><span class=p>))</span>            <span class=c1># ¬p ∨ r (p的否定或r为真)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. 检查约束是否可满足</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 5. 获取解</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;找到解：x = </span><span class=si>{</span><span class=n>m</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=si>}</span><span class=s2>, y = </span><span class=si>{</span><span class=n>m</span><span class=p>[</span><span class=n>y</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;逻辑变量：p = </span><span class=si>{</span><span class=n>m</span><span class=p>[</span><span class=n>p</span><span class=p>]</span><span class=si>}</span><span class=s2>, q = </span><span class=si>{</span><span class=n>m</span><span class=p>[</span><span class=n>q</span><span class=p>]</span><span class=si>}</span><span class=s2>, r = </span><span class=si>{</span><span class=n>m</span><span class=p>[</span><span class=n>r</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;约束不可满足&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>示例代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x0000B1B0</span><span class=p>,</span> <span class=mh>0x00005678</span><span class=p>,</span> <span class=mh>0x00007FF2</span><span class=p>,</span> <span class=mh>0x0000A332</span><span class=p>,</span> <span class=mh>0x0000A0E8</span><span class=p>,</span> <span class=mh>0x0000364C</span><span class=p>,</span> <span class=mh>0x00002BD4</span><span class=p>,</span> <span class=mh>0x0000C8FE</span><span class=p>,</span> <span class=mh>0x00004A7C</span><span class=p>,</span> <span class=mh>0x00000018</span><span class=p>,</span> <span class=mh>0x00002BE4</span><span class=p>,</span> <span class=mh>0x00004144</span><span class=p>,</span> <span class=mh>0x00003BA6</span><span class=p>,</span> <span class=mh>0x0000BE8C</span><span class=p>,</span> <span class=mh>0x00008F7E</span><span class=p>,</span> <span class=mh>0x000035F8</span><span class=p>,</span> <span class=mh>0x000061AA</span><span class=p>,</span> <span class=mh>0x00002B4A</span><span class=p>,</span> <span class=mh>0x00006828</span><span class=p>,</span> <span class=mh>0x0000B39E</span><span class=p>,</span> <span class=mh>0x0000B542</span><span class=p>,</span> <span class=mh>0x000033EC</span><span class=p>,</span> <span class=mh>0x0000C7D8</span><span class=p>,</span> <span class=mh>0x0000448C</span><span class=p>,</span> <span class=mh>0x00009310</span><span class=p>,</span> <span class=mh>0x00008808</span><span class=p>,</span> <span class=mh>0x0000ADD4</span><span class=p>,</span> <span class=mh>0x00003CC2</span><span class=p>,</span> <span class=mh>0x00000796</span><span class=p>,</span> <span class=mh>0x0000C940</span><span class=p>,</span> <span class=mh>0x00004E32</span><span class=p>,</span> <span class=mh>0x00004E2E</span><span class=p>,</span> <span class=mh>0x0000924A</span><span class=p>,</span> <span class=mh>0x00005B5C</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;input</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=mi>8</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>)]</span> <span class=c1># input0-input33 都是 0-255</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;var</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span><span class=mi>32</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>)]</span> <span class=c1># var0-var31 都是 0-4294967295</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 模拟加密算法</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>var</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>47806</span> <span class=o>*</span> <span class=p>(</span><span class=n>ZeroExt</span><span class=p>(</span><span class=mi>24</span><span class=p>,</span> <span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=c1># 高位补零，将8位扩展至32位</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>var</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=n>var</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>^</span> <span class=mh>0x114514</span>
</span></span><span class=line><span class=cl>    <span class=n>var</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>%=</span> <span class=mi>51966</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 添加约束条件</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>var</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>enc</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span> <span class=c1># 找到解</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>ascii_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>m</span><span class=p>[</span><span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span><span class=o>.</span><span class=n>as_long</span><span class=p>()</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>)]</span> <span class=c1># 将Z3的符号值转换为Python的普通整数</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;moectf{&#34;</span>  <span class=o>+</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>ascii_list</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>))</span> <span class=o>+</span> <span class=s2>&#34;}&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 添加阻塞条件，寻找下一个解</span>
</span></span><span class=line><span class=cl>        <span class=n>block</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>block</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>m</span><span class=p>[</span><span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Or</span><span class=p>(</span><span class=n>block</span><span class=p>))</span> <span class=c1># 至少有一个变量与当前解不同</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=n>Int</span><span class=p>(</span><span class=s1>&#39;a</span><span class=si>%d</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>3976</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5265</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5284</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5925</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>4048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5072</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2813</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5004</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>9</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>4490</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mi>8</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=mi>7</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5936</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>126</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>solution</span> <span class=o>=</span> <span class=p>[</span><span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>.</span><span class=n>as_long</span><span class=p>()</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>solution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>item</span><span class=p>),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-08-16 14:15:38">更新于 2025-08-16&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/0f92e23/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/0f92e23/ data-title=CTF-Reverse学习记录 data-hashtags=CTF,Reverse><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/0f92e23/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/0f92e23/ data-title=CTF-Reverse学习记录><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/reverse/ class=post-tag title="标签 - Reverse">Reverse</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/ed6ecd5/ class=post-nav-item rel=prev title="如何基于 SrsRAN_4G 搭建 LTE 基站"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>如何基于 SrsRAN_4G 搭建 LTE 基站</a><a href=/posts/30d0764/ class=post-nav-item rel=next title="2025 “天一永安杯”宁波市网络安全大赛 Misc Writeup">2025 “天一永安杯”宁波市网络安全大赛 Misc Writeup<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/0f92e23/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>