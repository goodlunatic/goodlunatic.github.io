<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Misc-数字取证 - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="This is a simple summary of digital forensics .
"><meta name=keywords content='CTF,Misc,Forensics'><meta itemprop=name content="Misc-数字取证"><meta itemprop=description content="This is a simple summary of digital forensics ."><meta itemprop=datePublished content="2025-08-30T22:50:12+08:00"><meta itemprop=dateModified content="2025-08-30T22:50:12+08:00"><meta itemprop=wordCount content="4547"><meta itemprop=keywords content="CTF,Misc,Forensics"><meta property="og:url" content="https://goodlunatic.github.io/posts/761da51/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="Misc-数字取证"><meta property="og:description" content="This is a simple summary of digital forensics ."><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-30T22:50:12+08:00"><meta property="article:modified_time" content="2025-08-30T22:50:12+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><meta property="article:tag" content="Forensics"><meta name=twitter:card content="summary"><meta name=twitter:title content="Misc-数字取证"><meta name=twitter:description content="This is a simple summary of digital forensics ."><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/761da51/ title="Misc-数字取证 - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/30d0764/ title="2025 “天一永安杯”宁波市赛初赛 Misc Writeup"><link rel=next type=text/html href=https://goodlunatic.github.io/posts/58b2135/ title="2025 泰山杯线下决赛 Misc Writeup"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/761da51/index.md title="Misc-数字取证 - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Misc-数字取证","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/761da51\/"},"genre":"posts","keywords":"CTF, Misc, Forensics","wordcount":4547,"url":"https:\/\/goodlunatic.github.io\/posts\/761da51\/","datePublished":"2025-08-30T22:50:12+08:00","dateModified":"2025-08-30T22:50:12+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=合集>CTF-Misc入门指南</span>
<span class=collection-count>6</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/posts/1ad9200/ title="[持续更新] CTF-Misc Guide">[持续更新] CTF-Misc Guide</a></li><li class=collection-item><a href=/posts/c5bc8a2/ title=Misc-AI安全>Misc-AI安全</a></li><li class=collection-item><span class=active title=Misc-数字取证>Misc-数字取证</span></li><li class=collection-item><a href=/posts/5422d65/ title=Misc-流量分析>Misc-流量分析</a></li><li class=collection-item><a href=/posts/c49ae8a/ title=Misc-数据安全>Misc-数据安全</a></li><li class=collection-item><a href=/posts/01ebd40/ title=Misc-工控安全>Misc-工控安全</a></li></ul><div class=collection-nav-simple><a href=/posts/c5bc8a2/ class=collection-nav-item rel=prev title=Misc-AI安全><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>3/6</span><a href=/posts/5422d65/ class=collection-nav-item rel=next title=Misc-流量分析><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/f002407/ title="2025 西湖论剑·中国杭州网络安全技能大赛 Misc Writeup">2025 西湖论剑·中国杭州网络安全技能大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/30d0764/ title="2025 “天一永安杯”宁波市赛初赛 Misc Writeup">2025 “天一永安杯”宁波市赛初赛 Misc Writeup</a></li><li class=related-item><a href=/posts/1a152f0/ title=强网杯-谍影重重系列赛题详解>强网杯-谍影重重系列赛题详解</a></li><li class=related-item><a href=/posts/5422d65/ title=Misc-流量分析>Misc-流量分析</a></li><li class=related-item><a href=/posts/32c3b27/ title="DASCTF 2024最后一战 Misc Writeup">DASCTF 2024最后一战 Misc Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Misc-数字取证</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/ctf/ class=post-category title="分类 - CTF"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CTF</a> 和 <a href=/collections/ctf-misc%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/ class=post-collection title="合集 - CTF-Misc入门指南"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> CTF-Misc入门指南</a></span></div><div class=post-meta-line><span title="发布于 2025-08-30 22:50:12"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-08-30>2025-08-30</time></span>&nbsp;<span title="4547 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 4600 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 22 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Misc-数字取证><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#使用的系统和环境>使用的系统和环境</a></li><li><a href=#获取hash值>获取Hash值</a></li><li><a href=#内存取证>内存取证</a><ul><li><a href=#windows内存取证>Windows内存取证</a><ul><li><a href=#volatility2>Volatility2</a></li><li><a href=#volatility3>Volatility3</a></li></ul></li><li><a href=#linux内存取证>Linux内存取证</a><ul><li><a href=#制作--profilevol2--的详细过程>制作 Profile(Vol2) 的详细过程</a><ul><li><a href=#2023-强网杯-你找到png了吗ubuntu2004>2023 强网杯-你找到PNG了吗(Ubuntu20.04)</a></li><li><a href=#2023-祥云杯-strange_forensicsubuntu1804>2023 祥云杯 strange_forensics(Ubuntu18.04)</a></li><li><a href=#安恒某比赛-flaggalfubuntu1604>安恒某比赛 flag^galf(Ubuntu16.04)</a></li><li><a href=#2022-sekai-symbolic-needs-1ubuntu2204>2022 SEKAI Symbolic Needs 1(Ubuntu22.04)</a></li><li><a href=#2022-wmctf-15debian10>2022 WMCTF 1!5!(Debian10)</a></li><li><a href=#2023-0xgame-oh-my-linuxdebian11>2023 0xGame oh-my-linux(Debian11)</a></li><li><a href=#某实验环境centos7>某实验环境(Centos7)</a></li></ul></li><li><a href=#制作--symbolsvol3--的详细过程>制作 symbols(Vol3) 的详细过程</a><ul><li><a href=#2023-强网杯-你找到png了吗ubuntu2004-1>2023 强网杯-你找到PNG了吗(Ubuntu20.04)</a></li><li><a href=#2023-祥云杯-strange_forensicsubuntu1804-1>2023 祥云杯 strange_forensics(Ubuntu18.04)</a></li><li><a href=#安恒某比赛-flaggalfubuntu1604-1>安恒某比赛 flag^galf(Ubuntu16.04)</a></li><li><a href=#2022-sekai-symbolic-needs-1ubuntu2204-1>2022 SEKAI Symbolic Needs 1(Ubuntu22.04)</a></li><li><a href=#2022-wmctf-15debian10-1>2022 WMCTF 1!5!(Debian10)</a></li><li><a href=#2023-0xgame-oh-my-linuxdebian11-1>2023 0xGame oh-my-linux(Debian11)</a></li><li><a href=#某实验环境centos7-1>某实验环境(Centos7)</a></li></ul></li><li><a href=#volatility2相关命令>Volatility2相关命令</a></li><li><a href=#volatility3相关命令>Volatility3相关命令</a></li></ul></li><li><a href=#macos内存取证>MacOS内存取证</a><ul><li><a href=#volatility2-1>Volatility2</a></li><li><a href=#volatility3-1>Volatility3</a></li></ul></li><li><a href=#识别不出内存镜像版本的取证>识别不出内存镜像版本的取证</a></li><li><a href=#用来制作内存镜像的工具>用来制作内存镜像的工具</a></li><li><a href=#dmp文件>dmp文件</a></li><li><a href=#lsassdmp文件>lsass.DMP文件</a></li><li><a href=#dump文件>dump文件</a></li><li><a href=#mem文件>mem文件</a></li><li><a href=#raw文件>raw文件</a></li></ul></li><li><a href=#磁盘取证>磁盘取证</a><ul><li><a href=#veracrypt>VeraCrypt</a></li><li><a href=#取证大师>取证大师</a></li><li><a href=#fat文件>fat文件</a></li><li><a href=#vmdk文件>VMDK文件</a></li><li><a href=#e01文件>E01文件</a></li><li><a href=#ad1文件>ad1文件</a></li><li><a href=#vhd文件>vhd文件</a></li><li><a href=#img文件>img文件</a><ul><li><a href=#raid0磁盘挂载>raid0磁盘挂载</a><ul><li><a href=#方法一ufs直接重组>方法一：(UFS直接重组)</a></li><li><a href=#方法二在ubuntu下用losetup和mdadm进行组装挂载>方法二：在Ubuntu下用losetup和mdadm进行组装挂载</a></li></ul></li></ul></li><li><a href=#btr文件>btr文件</a></li><li><a href=#磁盘取证的一些思路>磁盘取证的一些思路</a><ul><li><a href=#1-获取主机的系统名>1. 获取主机的系统名</a></li><li><a href=#2-查看powershell的历史记录>2. 查看Powershell的历史记录</a></li><li><a href=#3-获取用户的登录密码>3. 获取用户的登录密码</a></li><li><a href=#4-获取定时任务的内容>4. 获取定时任务的内容</a></li><li><a href=#5-获取docker容器中的关键信息>5. 获取Docker容器中的关键信息</a></li><li><a href=#6-获取主机的环境变量>6. 获取主机的环境变量</a></li><li><a href=#7-获取计算机注册时的用户名>7. 获取计算机注册时的用户名</a></li><li><a href=#8-获取计算机当前操作系统的产品名称>8. 获取计算机当前操作系统的产品名称</a></li><li><a href=#9-获取当前firefox浏览器的版本>9. 获取当前FireFox浏览器的版本</a></li></ul></li></ul></li><li><a href=#日志取证>日志取证</a><ul><li><a href=#evtx-文件>evtx 文件</a></li></ul></li><li><a href=#网站取证>网站取证</a></li><li><a href=#服务器取证>服务器取证</a><ul><li><a href=#mysql57-数据库从qpxb文件恢复数据>Mysql5.7 数据库从qp.xb文件恢复数据</a></li></ul></li><li><a href=#其他>其他</a><ul><li><a href=#1磁盘恢复>1、磁盘恢复</a><ul><li><a href=#恢复-ext3-或-ext4-文件系统中已删除的文件>恢复 ext3 或 ext4 文件系统中已删除的文件</a></li><li><a href=#直接diskgenius打开恢复文件>直接DiskGenius打开恢复文件</a></li></ul></li><li><a href=#2浏览器登录凭证破解>2、浏览器登录凭证破解</a></li><li><a href=#3邮件取证>3、邮件取证</a><ul><li><a href=#foxmail取证>FoxMail取证</a></li></ul></li><li><a href=#4dpapi破解>4、DPAPI破解</a></li><li><a href=#5veracrypt加密>5、VeraCrypt加密</a></li><li><a href=#6trueceypt加密>6、TrueCeypt加密</a></li><li><a href=#7encfs加密>7、Encfs加密</a></li><li><a href=#8gpg--pgp-加密>8、GPG / PGP 加密</a></li><li><a href=#9cipher加密>9、Cipher加密</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>This is a simple summary of digital forensics .</strong></p><h2 class=heading-element id=使用的系统和环境><span>使用的系统和环境</span>
<a href=#%e4%bd%bf%e7%94%a8%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%92%8c%e7%8e%af%e5%a2%83 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Win11-WSL-Ubuntu</span>
</span></span><span class=line><span class=cl>这个系统下面vol2和vol3都下载了
</span></span><span class=line><span class=cl>直接在终端输入vol.py或者vol3.py即可
</span></span><span class=line><span class=cl><span class=c1>#Vmware-Kali</span>
</span></span><span class=line><span class=cl>这个系统下面只安装了vol2
</span></span><span class=line><span class=cl>输入vol.py即可使用</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=获取hash值><span>获取Hash值</span>
<a href=#%e8%8e%b7%e5%8f%96hash%e5%80%bc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#获取sha1</span>
</span></span><span class=line><span class=cl>sha1sum filename
</span></span><span class=line><span class=cl><span class=c1>#h获取MD5</span>
</span></span><span class=line><span class=cl>md5sum filename</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=内存取证><span>内存取证</span>
<a href=#%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>常见文件后缀：.vmem / .dump / .raw / .img</p><p>内存取证除了常用的 Vol 以外，也可以尝试一下 R-Stdio 这个工具，提取文件的时候不一定哪个可以用</p><p>打开 R-Stdio -> 驱动器 -> 打开镜像 -> 扫描</p><p><img loading=lazy src=/posts/761da51/imgs/Rstdio1.png alt=/posts/761da51/imgs/Rstdio1.png height=1433 width=2104></p><p><img loading=lazy src=/posts/761da51/imgs/Rstdio2.png alt=/posts/761da51/imgs/Rstdio2.png height=2160 width=3842></p><p>拿到内存镜像后也可以先用<code>PasswareKit</code>先扫描一下密码</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250403103711312.png alt=/posts/761da51/imgs/image-20250403103711312.png height=2082 width=3833></p><p>vol.py &ndash;info 可以查看插件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#官方WIKI</span>
</span></span><span class=line><span class=cl>https://github.com/volatilityfoundation/volatility/wiki
</span></span><span class=line><span class=cl><span class=c1>#点击右侧的Command References来查看具体参数的用法</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=windows内存取证><span>Windows内存取证</span>
<a href=#windows%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>不是Windows10的内存镜像的话可以直接用 Vol_all_in_one 一键分析</p><p>取证过程中一定要记得查看镜像桌面上的文件！</p><h4 class=heading-element id=volatility2><span>Volatility2</span>
<a href=#volatility2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 识别操作系统的基本信息</span>
</span></span><span class=line><span class=cl>vol.py mem.dump imageinfo
</span></span><span class=line><span class=cl><span class=c1># 查看进程</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 pslist
</span></span><span class=line><span class=cl><span class=c1># 查看隐藏或者解链的进程</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 pstree
</span></span><span class=line><span class=cl><span class=c1># 通过memdump爆破出进程对应的信息</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 memdump -p <span class=m>3036</span> --dump-dir<span class=o>=</span>./
</span></span><span class=line><span class=cl><span class=c1># 扫描镜像中的服务</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f mem.raw --profile<span class=o>=</span>Win7SP1x64 svcscan
</span></span><span class=line><span class=cl><span class=c1># 扫描进程缓存的文件</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 filescan
</span></span><span class=line><span class=cl><span class=c1># 查找特定后缀的文件</span>
</span></span><span class=line><span class=cl>vol.py -f example.raw --profile<span class=o>=</span>Win7SP1x64 filescan <span class=p>|</span> grep -E <span class=s1>&#39;txt|png|jpg|gif|zip|rar|7z|pdf|doc&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 查找指定文件夹下的文件</span>
</span></span><span class=line><span class=cl>volatility -f example.raw --profile<span class=o>=</span>Win7SP1x64 filescan <span class=p>|</span> grep TMP_User
</span></span><span class=line><span class=cl><span class=c1># 使用dumpfiles爆破文件内容（有时可能会出现vol2提取不了但是vol3可以的情况，也可以使用 R-stdio 工具提取）</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 dumpfiles -Q 0x000000007e410890 --dump-dir<span class=o>=</span>./
</span></span><span class=line><span class=cl><span class=c1># 查看进程环境变量</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 envars
</span></span><span class=line><span class=cl><span class=c1># 扫描进程命令行参数</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 cmdscan
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 cmdline
</span></span><span class=line><span class=cl><span class=c1># 扫描动态库列表</span>
</span></span><span class=line><span class=cl><span class=c1># 可使用-p参数指定PID号</span>
</span></span><span class=line><span class=cl>vol.py -f memory.img --profile<span class=o>=</span>Win2003SP1x86 dlllist
</span></span><span class=line><span class=cl>vol.py -f memory.img --profile<span class=o>=</span>Win2003SP1x86 ldrmodules
</span></span><span class=line><span class=cl><span class=c1># 扫描系统中的恶意软件</span>
</span></span><span class=line><span class=cl>vol.py -f memory.img --profile<span class=o>=</span>Win2003SP1x86 malfind
</span></span><span class=line><span class=cl><span class=c1># 查看当前镜像中的用户</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f mem.raw --profile<span class=o>=</span>Win7SP1x64 printkey -K <span class=s2>&#34;SAM\Domains\Account\Users\Names&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 查看镜像中的用户名和密码(hash值)</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 hashdump
</span></span><span class=line><span class=cl><span class=c1># 使用mimikatz插件快速获取用户密码</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f mem.dump --profile<span class=o>=</span>Win7SP1x64 mimikatz
</span></span><span class=line><span class=cl><span class=c1># 扫描注册表数据</span>
</span></span><span class=line><span class=cl><span class=c1># 查看注册表配置单元</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 hivelist
</span></span><span class=line><span class=cl><span class=c1># 查看注册表键值</span>
</span></span><span class=line><span class=cl>vol.py -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 printkey
</span></span><span class=line><span class=cl><span class=c1># 查看注册表键名</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 hivedump -o 0xfffff8a001cce010<span class=o>(</span>注册表Volatility地址<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=c1># 查看网络连接状态</span>
</span></span><span class=line><span class=cl>vol.py -f memory.raw --profile<span class=o>=</span>Win7SP1x64 connscan
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f mem.raw --profile<span class=o>=</span>Win7SP1x64 netscan
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f mem.raw --profile<span class=o>=</span>Win7SP1x64 connections
</span></span><span class=line><span class=cl><span class=c1># 查看浏览器历史记录</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 iehistory
</span></span><span class=line><span class=cl><span class=c1># 显示有关编辑控件的信息</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 editbox
</span></span><span class=line><span class=cl><span class=c1># 查看当前展示的notepad的内容</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 notepad
</span></span><span class=line><span class=cl><span class=c1># 获取屏幕截图</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 screenshot --dump-dir<span class=o>=</span>./
</span></span><span class=line><span class=cl><span class=c1># 查看剪贴板信息</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 clipboard
</span></span><span class=line><span class=cl><span class=c1># 查看剪贴板信详细内容</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 clipboard -v
</span></span><span class=line><span class=cl><span class=c1># 查看运行程序相关的记录，比如最后一次更新时间，运行过的次数等</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 userassist
</span></span><span class=line><span class=cl><span class=c1># 最大程序提取信息</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 timeliner
</span></span><span class=line><span class=cl><span class=c1># 恢复被删除的文件</span>
</span></span><span class=line><span class=cl>vol.py -f 1.vmem --profile<span class=o>=</span>Win7SP1x64 mftparser
</span></span><span class=line><span class=cl><span class=c1># 使用ndispktscan插件搜索内核的网络流量包信息</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 ndispktscan
</span></span><span class=line><span class=cl><span class=c1># 使用usbstor插件获取USB连接信息</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 usbstor
</span></span><span class=line><span class=cl><span class=c1># 使用VolDiff进行恶意软件检测</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 voldiff
</span></span><span class=line><span class=cl><span class=c1># 使用bitlocker插件获取Bitlocker的加密密钥</span>
</span></span><span class=line><span class=cl>vol.py --plugins<span class=o>=</span>/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile<span class=o>=</span>Win7SP1x64 bitlocker</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=volatility3><span>Volatility3</span>
<a href=#volatility3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>识别内存的系统版本（这个有时候vol3识别不出来，但是vol2可以）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vol3.py -f dacong.raw banners.Banners</span></span></code></pre></td></tr></table></div></div><p>如果是windows10的内存镜像的话，vol2的某些功能可能用不了，因此需要vol3（例：2023 安洵杯 dacongのWindows）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看命令</span>
</span></span><span class=line><span class=cl>vol3.py -h
</span></span><span class=line><span class=cl><span class=c1># 扫描镜像中的文件</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.filescan
</span></span><span class=line><span class=cl><span class=c1># 查看桌面上的文件</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.filescan <span class=p>|</span> grep Desktop
</span></span><span class=line><span class=cl><span class=c1># 提取文件</span>
</span></span><span class=line><span class=cl>vol3.py -f mem.raw windows.dumpfiles --virtaddr<span class=o>=</span><span class=s2>&#34;0x0000e0007ad17f20&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 扫描注册表（感觉这个功能vol2的更好）</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.registry.printkey
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.registry.hivelist
</span></span><span class=line><span class=cl><span class=c1># 扫描命令行记录</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.cmdline
</span></span><span class=line><span class=cl><span class=c1># 查看网络使用状态、端口占用状态</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.netscan
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.netstat
</span></span><span class=line><span class=cl><span class=c1># 查看系统中的进程</span>
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.pslist
</span></span><span class=line><span class=cl>vol3.py -f dacong.raw windows.pstree</span></span></code></pre></td></tr></table></div></div><p><strong>一些特殊进程</strong></p><p>便签：StikyNot.exe （.snt 文件路径在C:\Users\XXX\AppData\Roaming\Microsoft\Sticky Notes\）【这个文件需要用Win7的便签或者记事本打开】</p><p>画图：mspaint.exe（这个进程可以用 <code>memdump -p &lt;PID> --dump-dir=./</code> 导出 dmp 文件，然后改后缀为.data拖入Gimp中调整位移和分辨率，例：2024 NKCTF）</p><p>联系人：wab.exe （.contact 文件）</p><p><strong>一些特殊文件</strong></p><p>evtx - Windows系统日志</p><p>dat - 无法导出可以加上 -u 参数：volatility -f mem.data dumpfiles -r pdf$ -i &ndash;name -D dumpfiles/ -u</p><h3 class=heading-element id=linux内存取证><span>Linux内存取证</span>
<a href=#linux%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>Linux内存取证这一块，网上的教程大都比较乱，因此打算自己好好写一篇教程</p></blockquote><p>取证过程中一定要记得查看镜像桌面上的文件！</p><p>不论是制作vol2还是vol3的符号文件，都可以先用vol3确定一下内存镜像的版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 volatility3/vol.py -f Ez_Linux.mem banner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Volatility <span class=m>3</span> Framework 2.26.2
</span></span><span class=line><span class=cl>Progress:  100.00		PDB scanning finished
</span></span><span class=line><span class=cl>Offset	Banner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0x536001a0	Linux version 5.4.0-100-generic <span class=o>(</span>buildd@lcy02-amd64-002<span class=o>)</span> <span class=o>(</span>gcc version 9.3.0 <span class=o>(</span>Ubuntu 9.3.0-17ubuntu1~20.04<span class=o>))</span> <span class=c1>#113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</span>
</span></span><span class=line><span class=cl>0x5459fe14	Linux version 5.4.0-100-generic <span class=o>(</span>buildd@lcy02-amd64-002<span class=o>)</span> <span class=o>(</span>gcc version 9.3.0 <span class=o>(</span>Ubuntu 9.3.0-17ubuntu1~20.04<span class=o>))</span> <span class=c1>#113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</span>
</span></span><span class=line><span class=cl>0x7272ccc8	Linux version 5.4.0-100-generic <span class=o>(</span>buildd@lcy02-amd64-002<span class=o>)</span> <span class=o>(</span>gcc version 9.3.0 <span class=o>(</span>Ubuntu 9.3.0-17ubuntu1~20.04<span class=o>))</span> <span class=c1>#113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</span>
</span></span><span class=line><span class=cl>0x7bd00010	Linux version 5.4.0-100-generic <span class=o>(</span>buildd@lcy02-amd64-002<span class=o>)</span> <span class=o>(</span>gcc version 9.3.0 <span class=o>(</span>Ubuntu 9.3.0-17ubuntu1~20.04<span class=o>))</span> <span class=c1>#113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</span></span></span></code></pre></td></tr></table></div></div><p>推荐制作 vol2 的符号前先做一下 vol3 的符号文件，并放到指定symbol目录下</p><p>因为 vol3 可以使用 <code>vol3.py IsfInfo</code> 命令查看我们找的内核文件是否与题目要求完全一致</p><h4 class=heading-element id=制作--profilevol2--的详细过程><span>制作 Profile(Vol2) 的详细过程</span>
<a href=#%e5%88%b6%e4%bd%9c--profilevol2--%e7%9a%84%e8%af%a6%e7%bb%86%e8%bf%87%e7%a8%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>由于官方的vol2自带的一些原因，原版的vol2不支持Ubuntu22.04及以上版本Profile的制作及使用，但是可以根据以下参考链接对vol2进行一些修改，以便对Ubuntu22.04及以上版本提供支持
参考链接：</p><p><a href=https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test target=_blank rel="external nofollow noopener noreferrer">https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test</a></p><p><a href=https://github.com/volatilityfoundation/volatility/issues/828 target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/issues/828</a></p><p><a href=https://github.com/volatilityfoundation/volatility/pull/852 target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/pull/852</a></p></blockquote><p><strong>在自己动手制作Profile前，可以先去这个仓库找找有没有已经做好的 <a href=https://github.com/volatilityfoundation/profiles/tree/master/Linux target=_blank rel="external nofollow noopener noreferrer">Github</a></strong></p><p><strong>如果很遗憾找不到需要的Profile，就需要进行下面的步骤，自己手动制作Profile了</strong></p><p>一个vol2的Profile的结构如下：其实一共就两个文件（system.map以及module.dwarf）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── Ubuntu_5.4.0-100_5.4.0-100.113
</span></span><span class=line><span class=cl>│   ├── module.dwarf
</span></span><span class=line><span class=cl>│   └── System.map-5.4.0-100-generic</span></span></code></pre></td></tr></table></div></div><p>将 <code>module.dwarf</code> 和 <code>System.map</code> 用deflate压缩算法压缩成一个zip压缩包放到<code>volatility/volatility/plugins/overlays/linux</code>目录下即可</p><p>因为懒得用Vmware虚拟机，所以我这里就用Docker来制作Profile了</p><p>为了帮助读者理解Profile的制作过程，我就举了下面这几个例子</p><p><strong>制作模版已开源在 <a href=https://github.com/goodlunatic/Docker-ProfileMaker-vol2 target=_blank rel="external nofollow noopener noreferrer">goodlunatic/Docker-ProfileMaker-vol2</a></strong></p><p><strong>这里制作的所有符号文件都已开源在 <a href=https://github.com/goodlunatic/Profile-and-SymbolTables-For-Volatility target=_blank rel="external nofollow noopener noreferrer">goodlunatic/Profile-and-SymbolTables-For-Volatility</a></strong></p><h5 class=heading-element id=2023-强网杯-你找到png了吗ubuntu2004><span>2023 强网杯-你找到PNG了吗(Ubuntu20.04)</span>
<a href=#2023-%e5%bc%ba%e7%bd%91%e6%9d%af-%e4%bd%a0%e6%89%be%e5%88%b0png%e4%ba%86%e5%90%97ubuntu2004 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.4.0-100-generic (buildd@lcy02-amd64-002) (gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)) #113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</p></blockquote><p>用Docker制作镜像一共需要以下几个文件，部分文件可以到下面这个链接中下载：</p><p><a href=https://mirrors.ustc.edu.cn/ubuntu/pool/main/l/linux/ target=_blank rel="external nofollow noopener noreferrer">https://mirrors.ustc.edu.cn/ubuntu/pool/main/l/linux/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── linux-headers-5.4.0-100_5.4.0-100.113_all.deb
</span></span><span class=line><span class=cl>    ├── linux-headers-5.4.0-100-generic_5.4.0-100.113_amd64.deb
</span></span><span class=line><span class=cl>    ├── linux-modules-5.4.0-100-generic_5.4.0-100.113_amd64.deb
</span></span><span class=line><span class=cl>    └── tools.zip
</span></span><span class=line><span class=cl><span class=c1># dockerfile是自己写的用于构建Docker镜像的脚本</span>
</span></span><span class=line><span class=cl><span class=c1># tools.zip 是从 volatility/tools 保存并压缩的</span>
</span></span><span class=line><span class=cl><span class=c1># linux-headers-5.4.0-100_5.4.0-100.113_all.deb 是通用内核头文件</span>
</span></span><span class=line><span class=cl><span class=c1># linux-headers-5.4.0-100-generic_5.4.0-100.113_amd64.deb 是特定架构的内核头文件</span>
</span></span><span class=line><span class=cl><span class=c1># linux-modules-5.4.0-100-generic_5.4.0-100.113_amd64.deb 是内核模块包</span></span></span></code></pre></td></tr></table></div></div><p>首先我们要去解压内核模块包：linux-modules-5.4.0-100-generic_5.4.0-100.113_amd64.deb</p><p>从 <code>data/boot/System.map-5.4.0-100-generic</code> 提取system.map</p><p>然后编写以下dockerfile构建镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:20.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip kmod linux-base<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.4.0-100_5.4.0-100.113_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.4.0-100-generic_5.4.0-100.113_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/5.4.0-100-generic/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 运行以下命令构建并运行容器，并把module.dwarf从/tmp目录中复制出来</span>
</span></span><span class=line><span class=cl><span class=c1># 我这里由于用的是ARM架构的Macbook，所以需要指定平台，x86的设备可以不写</span>
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t profile .
</span></span><span class=line><span class=cl>docker run --platform linux/amd64 --rm -it profile /bin/bash</span></span></code></pre></td></tr></table></div></div><p>这里如果不想敲命令行去复制Docker容器中/tmp目录下的module.dwarf，也可以使用vscode的Docker插件或者Docker-Desktop辅助</p><p>最后我们将 <code>module.dwarf</code> 和 <code>System.map</code> 用deflate压缩算法压缩成一个zip压缩包放到<code>volatility/volatility/plugins/overlays/linux</code>目录下即可</p><p>可以使用 <code>vol.py --info</code> 命令查看 Profile 是否能被成功识别</p><h5 class=heading-element id=2023-祥云杯-strange_forensicsubuntu1804><span>2023 祥云杯 strange_forensics(Ubuntu18.04)</span>
<a href=#2023-%e7%a5%a5%e4%ba%91%e6%9d%af-strange_forensicsubuntu1804 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.4.0-84-generic (buildd@lcy01-amd64-007) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1<sub>18.04)) #94</sub>18.04.1-Ubuntu SMP Thu Aug 26 23:17:46 UTC 2021 (Ubuntu 5.4.0-84.94~18.04.1-generic 5.4.133)</p></blockquote><p>首先我们需要解压 <code>linux-modules-5.4.0-84-generic_5.4.0-84.94_amd64.deb</code> 并提取system.map</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── linux-headers-5.4.0-84_5.4.0-84.94_all.deb
</span></span><span class=line><span class=cl>    ├── linux-headers-5.4.0-84-generic_5.4.0-84.94_amd64.deb
</span></span><span class=line><span class=cl>    ├── linux-modules-5.4.0-84-generic_5.4.0-84.94_amd64.deb
</span></span><span class=line><span class=cl>    └── tools.zip</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:18.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip kmod linux-base<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.4.0-84_5.4.0-84.94_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.4.0-84-generic_5.4.0-84.94_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/5.4.0-84-generic/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=安恒某比赛-flaggalfubuntu1604><span>安恒某比赛 flag^galf(Ubuntu16.04)</span>
<a href=#%e5%ae%89%e6%81%92%e6%9f%90%e6%af%94%e8%b5%9b-flaggalfubuntu1604 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 4.13.0-36-generic (buildd@lgw01-amd64-033) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1<sub>16.04.9)) #40</sub>16.04.1-Ubuntu SMP Fri Feb 16 23:25:58 UTC 2018 (Ubuntu 4.13.0-36.40~16.04.1-generic 4.13.13)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── linux-headers-4.13.0-36_4.13.0-36.40~16.04.1_all.deb
</span></span><span class=line><span class=cl>├── linux-headers-4.13.0-36-generic_4.13.0-36.40~16.04.1_amd64.deb
</span></span><span class=line><span class=cl>├── linux-image-4.13.0-36-generic_4.13.0-36.40~16.04.1_amd64.deb
</span></span><span class=line><span class=cl>└── tools.zip</span></span></code></pre></td></tr></table></div></div><p>从<code>linux-image-4.13.0-36-generic_4.13.0-36.40~16.04.1_amd64.deb</code>中提取system.map</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:16.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip kmod linux-base libssl1.0.0<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-4.13.0-36_4.13.0-36.40~16.04.1_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-4.13.0-36-generic_4.13.0-36.40~16.04.1_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/4.13.0-36-generic/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=2022-sekai-symbolic-needs-1ubuntu2204><span>2022 SEKAI Symbolic Needs 1(Ubuntu22.04)</span>
<a href=#2022-sekai-symbolic-needs-1ubuntu2204 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.15.0-43-generic (buildd@lcy02-amd64-076) (gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #46-Ubuntu SMP Tue Jul 12 10:30:17 UTC 2022 (Ubuntu 5.15.0-43.46-generic 5.15.39)</p></blockquote><p>这个版本其实是 Ubuntu22.04 的，然后这个版本的内核包不太好找，官方也删除了这个内核包，我最后也是根据版本代号 Jammy 去官网翻出来的：https://answers.launchpad.net/ubuntu/jammy/amd64/linux-image-unsigned-5.15.0-43-generic/</p><p>参考链接：https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/forensics/symbolic-needs/solution</p><p>首先也是从<code>linux-modules-5.15.0-43-generic_5.15.0-43.46_amd64.deb</code>中提取 system.map</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── linux-headers-5.15.0-43_5.15.0-43.46_all.deb
</span></span><span class=line><span class=cl>    ├── linux-headers-5.15.0-43-generic_5.15.0-43.46_amd64.deb
</span></span><span class=line><span class=cl>    ├── linux-modules-5.15.0-43-generic_5.15.0-43.46_amd64.deb
</span></span><span class=line><span class=cl>    └── tools.zip</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:22.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip kmod linux-base<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.15.0-43_5.15.0-43.46_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.15.0-43-generic_5.15.0-43.46_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/5.15.0-43-generic/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><p>构建好后运行容器，将 module.dwarf 提取出来，和 system.map 一起打包为 zip，然后放到 volatility/volatility/plugins/overlays/linux 目录下即可</p><p>但是这里要注意一点就是，官方的 vol2 对于新版 dwarfdump 生成的 dwarf 文件的支持性不够</p><p>因此需要参考<a href=https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test/ target=_blank rel="external nofollow noopener noreferrer">巨魔的这篇博客</a> 对 vol2 的源码进行一些修改</p><p>这里也可以直接下载<a href=https://github.com/goodlunatic/volatility2-enhanced target=_blank rel="external nofollow noopener noreferrer">修改好的项目</a></p><p>修改好后即可正常使用</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250830021517234.png alt=/posts/761da51/imgs/image-20250830021517234.png height=434 width=2580></p><p>参考链接：</p><p><a href=https://github.com/volatilityfoundation/volatility/issues/828 target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/issues/828</a></p><p><a href=https://github.com/volatilityfoundation/volatility/pull/852 target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/pull/852</a></p><p><a href=https://github.com/volatilityfoundation/volatility/pull/852/commits/9ff9e9bb9103d63cbb278e991209aa11cffc61ce target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/pull/852/commits/9ff9e9bb9103d63cbb278e991209aa11cffc61ce</a></p><p><a href=https://github.com/volatilityfoundation/volatility/pull/852/commits/d07c69a7811d8e18ab186c9fbdf5b050529d06d2 target=_blank rel="external nofollow noopener noreferrer">https://github.com/volatilityfoundation/volatility/pull/852/commits/d07c69a7811d8e18ab186c9fbdf5b050529d06d2</a></p><h5 class=heading-element id=2022-wmctf-15debian10><span>2022 WMCTF 1!5!(Debian10)</span>
<a href=#2022-wmctf-15debian10 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 4.19.0-21-amd64 (<a href=mailto:debian-kernel@lists.debian.org target=_blank rel="external nofollow noopener noreferrer">debian-kernel@lists.debian.org</a>) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.249-2 (2022-06-30)</p></blockquote><p>内核文件下载链接：</p><p><a href=https://debian.sipwise.com/debian-security/pool/main/l/linux/ target=_blank rel="external nofollow noopener noreferrer">https://debian.sipwise.com/debian-security/pool/main/l/linux/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── linux-headers-4.19.0-21-amd64_4.19.249-2_amd64.deb
</span></span><span class=line><span class=cl>    ├── linux-headers-4.19.0-21-common_4.19.249-2_all.deb
</span></span><span class=line><span class=cl>    ├── linux-image-4.19.0-21-amd64-unsigned_4.19.249-2_amd64.deb
</span></span><span class=line><span class=cl>    └── tools.zip</span></span></code></pre></td></tr></table></div></div><p>首先先从<code>linux-image-4.19.0-21-amd64-unsigned_4.19.249-2_amd64.deb</code>中提取 system.map</p><p>然后用 Docker 安装内核头文件并编译 <code>module.dwarf</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>debian:10.13</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 使用Debian官方存档源</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s2>&#34;deb http://archive.debian.org/debian/ buster main&#34;</span> &gt; /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;deb http://archive.debian.org/debian-security buster/updates main&#34;</span> &gt;&gt; /etc/apt/sources.list<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip linux-kbuild-4.19 linux-compiler-gcc-8-x86<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-4.19.0-21-common_4.19.249-2_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-4.19.0-21-amd64_4.19.249-2_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/4.19.0-21-amd64/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><p>最后将 <code>module.dwarf</code> 和 <code>System.map</code> 用deflate压缩算法压缩成一个zip压缩包放到<code>volatility/volatility/plugins/overlays/linux</code>目录下即可</p><h5 class=heading-element id=2023-0xgame-oh-my-linuxdebian11><span>2023 0xGame oh-my-linux(Debian11)</span>
<a href=#2023-0xgame-oh-my-linuxdebian11 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.10.0-21-amd64 (<a href=mailto:debian-kernel@lists.debian.org target=_blank rel="external nofollow noopener noreferrer">debian-kernel@lists.debian.org</a>) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP Debian 5.10.162-1 (2023-01-21)</p></blockquote><p>内核文件下载链接：</p><p><a href=https://debian.sipwise.com/debian-security/pool/main/l/linux/ target=_blank rel="external nofollow noopener noreferrer">https://debian.sipwise.com/debian-security/pool/main/l/linux/</a></p><p>制作这个Profile需要以下这几个文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb
</span></span><span class=line><span class=cl>    ├── linux-headers-5.10.0-21-common_5.10.162-1_all.deb
</span></span><span class=line><span class=cl>    ├── linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb
</span></span><span class=line><span class=cl>    └── tools.zip</span></span></code></pre></td></tr></table></div></div><p>首先我们需要从 <code>linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb</code> 获取system.map</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64\data\usr\lib\debug\boot\System.map-5.10.0-21-amd64</span></span></code></pre></td></tr></table></div></div><p>如果从<code>linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb</code>中获取system.map</p><p>我们会看到如下内容，很明显这个system.map是没法用的：</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250828000702794.png alt=/posts/761da51/imgs/image-20250828000702794.png height=170 width=1358></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># 因为debian10.2中科大源停止维护了，所以改用debian11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=w> </span><span class=s>debian:11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/deb.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip linux-kbuild-5.10 linux-compiler-gcc-10-x86<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=c1># 内核包存在依赖关系，安装时需要注意顺序</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.10.0-21-common_5.10.162-1_all.deb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> dpkg -i linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src/tools/linux</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    sed -i <span class=s1>&#39;s/$(shell uname -r)/5.10.0-21-amd64/g&#39;</span> Makefile <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    make <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    mv module.dwarf /tmp</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 运行以下命令构建并运行容器，并把module.dwarf从/tmp目录中复制出来</span>
</span></span><span class=line><span class=cl><span class=c1># 我这里由于用的是ARM架构的Macbook，所以需要指定平台，x86的设备可以不写</span>
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t profile .
</span></span><span class=line><span class=cl>docker run --platform linux/amd64 --rm -it profile /bin/bash</span></span></code></pre></td></tr></table></div></div><p>最后将 <code>module.dwarf</code> 和 <code>System.map</code> 用deflate压缩算法压缩成一个zip压缩包放到<code>volatility/volatility/plugins/overlays/linux</code>目录下即可</p><p>可以使用 <code>vol.py --info</code> 命令查看 Profile 是否能被成功识别</p><p><img loading=lazy src=/posts/761da51/imgs/profile1.png alt=/posts/761da51/imgs/profile1.png height=957 width=1734></p><h5 class=heading-element id=某实验环境centos7><span>某实验环境(Centos7)</span>
<a href=#%e6%9f%90%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83centos7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>CentOS_3_10_0-1160_108_1_el7_x86_64</p></blockquote><p>用以下命令解压<code>kernel-3.10.0-1160.el7.x86_64.rpm </code>并从<code>boot</code>中提取<code>System.map-3.10.0-1160.el7.x86_64</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir <span class=nb>test</span>
</span></span><span class=line><span class=cl>cp kernel-3.10.0-1160.el7.x86_64.rpm <span class=nb>test</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nb>test</span>
</span></span><span class=line><span class=cl>rpm2cpio kernel-3.10.0-1160.el7.x86_64.rpm <span class=p>|</span> cpio -idmv</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── kernel-3.10.0-1160.el7.x86_64.rpm
</span></span><span class=line><span class=cl>    ├── kernel-devel-3.10.0-1160.el7.x86_64.rpm
</span></span><span class=line><span class=cl>    ├── libdwarf-20201201.tar.gz
</span></span><span class=line><span class=cl>    └── tools.zip</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>centos:7</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/mirrorlist/#mirrorlist/g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s|#baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.aliyun.com/centos|g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s|baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.aliyun.com/centos|g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum clean all <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum makecache <span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum install -y gcc make unzip elfutils-libelf-devel<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum localinstall -y kernel-3.10.0-1160.el7.x86_64.rpm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum localinstall -y kernel-devel-3.10.0-1160.el7.x86_64.rpm<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> tar -xzvf libdwarf-20201201.tar.gz <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>cd</span> libdwarf-20201201 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x * <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> ./configure <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> make install <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>cd</span> .. <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> unzip tools.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>cd</span> /src/tools/linux <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;MODULE_LICENSE(&#34;GPL&#34;);&#39;</span> &gt;&gt; module.c <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/$(shell uname -r)/3.10.0-1160.el7.x86_64/g&#39;</span> Makefile <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> make <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv module.dwarf /tmp/module.dwarf<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 清理 yum 缓存以减小镜像体积</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum clean all</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=制作--symbolsvol3--的详细过程><span>制作 symbols(Vol3) 的详细过程</span>
<a href=#%e5%88%b6%e4%bd%9c--symbolsvol3--%e7%9a%84%e8%af%a6%e7%bb%86%e8%bf%87%e7%a8%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>一个vol3的SymbolTables其实就是一个json文件</p><p>因为懒得用Vmware虚拟机，所以我这里就用Docker来制作SymbolTables了</p><p>为了帮助读者理解SymbolTables的制作过程，我就举了下面这几个例子</p><p><strong>制作模版已开源在 <a href=https://github.com/goodlunatic/Docker-SymbolsMaker-vol3 target=_blank rel="external nofollow noopener noreferrer">goodlunatic/Docker-SymbolsMaker-vol3</a></strong></p><p><strong>这里制作的所有符号文件都已开源在 <a href=https://github.com/goodlunatic/Profile-and-SymbolTables-For-Volatility target=_blank rel="external nofollow noopener noreferrer">goodlunatic/Profile-and-SymbolTables-For-Volatility</a></strong></p><h5 class=heading-element id=2023-强网杯-你找到png了吗ubuntu2004-1><span>2023 强网杯-你找到PNG了吗(Ubuntu20.04)</span>
<a href=#2023-%e5%bc%ba%e7%bd%91%e6%9d%af-%e4%bd%a0%e6%89%be%e5%88%b0png%e4%ba%86%e5%90%97ubuntu2004-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.4.0-100-generic (buildd@lcy02-amd64-002) (gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)) #113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:20.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 下面这里的文件名需要根据系统版本进行修改，具体文件名可以通过解压上面的ddeb包得到</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.4.0-100-generic &gt; Ubuntu_5.4.0-100-generic.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Ubuntu_5.4.0-100-generic.json /tmp</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 运行以下命令构建并运行容器，并把json文件从/tmp目录中复制出来</span>
</span></span><span class=line><span class=cl><span class=c1># 我这里由于用的是ARM架构的Macbook，所以需要指定平台，x86的设备可以不写</span>
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t profile .
</span></span><span class=line><span class=cl>docker run --platform linux/amd64 --rm -it profile /bin/bash</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=2023-祥云杯-strange_forensicsubuntu1804-1><span>2023 祥云杯 strange_forensics(Ubuntu18.04)</span>
<a href=#2023-%e7%a5%a5%e4%ba%91%e6%9d%af-strange_forensicsubuntu1804-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.4.0-84-generic (buildd@lcy01-amd64-007) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1<sub>18.04)) #94</sub>18.04.1-Ubuntu SMP Thu Aug 26 23:17:46 UTC 2021 (Ubuntu 5.4.0-84.94~18.04.1-generic 5.4.133)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-unsigned-5.4.0-84-generic-dbgsym_5.4.0-84.94_amd64.ddeb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:20.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-unsigned-5.4.0-84-generic-dbgsym_5.4.0-84.94_amd64.ddeb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 下面这里的文件名需要根据系统版本进行修改，具体文件名可以通过解压上面的ddeb包得到</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.4.0-84-generic &gt; Ubuntu_5.4.0-84-generic.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Ubuntu_5.4.0-84-generic.json /tmp</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=安恒某比赛-flaggalfubuntu1604-1><span>安恒某比赛 flag^galf(Ubuntu16.04)</span>
<a href=#%e5%ae%89%e6%81%92%e6%9f%90%e6%af%94%e8%b5%9b-flaggalfubuntu1604-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 4.13.0-36-generic (buildd@lgw01-amd64-033) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1<sub>16.04.9)) #40</sub>16.04.1-Ubuntu SMP Fri Feb 16 23:25:58 UTC 2018 (Ubuntu 4.13.0-36.40~16.04.1-generic 4.13.13)</p></blockquote><p>内核相关文件可以到下面这个网址中下载：</p><p><a href=https://launchpad.net/~canonical-kernel-team/+archive/ubuntu/ppa/+build/14361744 target=_blank rel="external nofollow noopener noreferrer">https://launchpad.net/~canonical-kernel-team/+archive/ubuntu/ppa/+build/14361744</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-4.13.0-36-generic-dbgsym_4.13.0-36.40~16.04.1_amd64.ddeb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:16.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip libssl1.0.0<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-4.13.0-36-generic-dbgsym_4.13.0-36.40~16.04.1_amd64.ddeb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 下面这里的文件名需要根据系统版本进行修改，具体文件名可以通过解压上面的ddeb包得到</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-4.13.0-36-generic &gt; linux-image-4.13.0-36-generic.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv linux-image-4.13.0-36-generic.json /tmp</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 运行以下命令构建并运行容器，并把json文件从/tmp目录中复制出来</span>
</span></span><span class=line><span class=cl><span class=c1># 我这里由于用的是ARM架构的Macbook，所以需要指定平台，x86的设备可以不写</span>
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t profile .
</span></span><span class=line><span class=cl>docker run --platform linux/amd64 --rm -it profile /bin/bash</span></span></code></pre></td></tr></table></div></div><p>最后将得到的 json文件放到 volatility3/volatility3/framework/symbols/linux/ 目录下即可</p><h5 class=heading-element id=2022-sekai-symbolic-needs-1ubuntu2204-1><span>2022 SEKAI Symbolic Needs 1(Ubuntu22.04)</span>
<a href=#2022-sekai-symbolic-needs-1ubuntu2204-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.15.0-43-generic (buildd@lcy02-amd64-076) (gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #46-Ubuntu SMP Tue Jul 12 10:30:17 UTC 2022 (Ubuntu 5.15.0-43.46-generic 5.15.39)</p></blockquote><p>这个版本其实是 Ubuntu22.04 的，然后这个版本的内核包不太好找，官方也删除了这个内核包，我最后也是根据版本代号 Jammy 去官网翻出来的：https://answers.launchpad.net/ubuntu/jammy/amd64/linux-image-unsigned-5.15.0-43-generic/</p><p>参考链接：https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/forensics/symbolic-needs/solution</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-unsigned-5.15.0-43-generic-dbgsym_5.15.0-43.46_amd64.ddeb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:22.04</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt update --no-install-recommends <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip linux-base kmod<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-unsigned-5.15.0-43-generic-dbgsym_5.15.0-43.46_amd64.ddeb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.15.0-43-generic &gt; Ubuntu_5.15.0-43-generic.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Ubuntu_5.15.0-43-generic.json /tmp</span></span></code></pre></td></tr></table></div></div><p>找到正确的内核包后，即可完美适配</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250830014638054.png alt=/posts/761da51/imgs/image-20250830014638054.png height=882 width=2120></p><h5 class=heading-element id=2022-wmctf-15debian10-1><span>2022 WMCTF 1!5!(Debian10)</span>
<a href=#2022-wmctf-15debian10-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 4.19.0-21-amd64 (<a href=mailto:debian-kernel@lists.debian.org target=_blank rel="external nofollow noopener noreferrer">debian-kernel@lists.debian.org</a>) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.249-2 (2022-06-30)</p></blockquote><p>内核文件下载链接：</p><p><a href=https://debian.sipwise.com/debian-security/pool/main/l/linux/ target=_blank rel="external nofollow noopener noreferrer">https://debian.sipwise.com/debian-security/pool/main/l/linux/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-4.19.0-21-amd64-dbg_4.19.249-2_amd64.deb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># 因为debian10.2中科大源停止维护了，所以改用debian11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=w> </span><span class=s>debian:11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/deb.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip linux-kbuild-5.10 linux-compiler-gcc-10-x86<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-4.19.0-21-amd64-dbg_4.19.249-2_amd64.deb  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 下面这里的文件名需要根据系统版本进行修改，具体文件名可以通过解压上面的ddeb包得到</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-4.19.0-21-amd64 &gt; Debian_4.19.0-21-amd64.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Debian_4.19.0-21-amd64.json /tmp</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=2023-0xgame-oh-my-linuxdebian11-1><span>2023 0xGame oh-my-linux(Debian11)</span>
<a href=#2023-0xgame-oh-my-linuxdebian11-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>Linux version 5.10.0-21-amd64 (<a href=mailto:debian-kernel@lists.debian.org target=_blank rel="external nofollow noopener noreferrer">debian-kernel@lists.debian.org</a>) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP Debian 5.10.162-1 (2023-01-21)</p></blockquote><p>内核文件下载链接：</p><p><a href=https://debian.sipwise.com/debian-security/pool/main/l/linux/ target=_blank rel="external nofollow noopener noreferrer">https://debian.sipwise.com/debian-security/pool/main/l/linux/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    └── linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># 因为debian10.2中科大源停止维护了，所以改用debian11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=w> </span><span class=s>debian:11.2</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 将环境设置为非交互环境</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/deb.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/security.debian.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apt/sources.list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=o>&amp;&amp;</span> apt update --no-install-recommends<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> apt install -y gcc dwarfdump build-essential unzip linux-kbuild-5.10 linux-compiler-gcc-10-x86<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dpkg -i linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># 下面这里的文件名需要根据系统版本进行修改，具体文件名可以通过解压上面的ddeb包得到</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.10.0-21-amd64 &gt; Debian_5.10.0-21-amd64.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Debian_5.10.0-21-amd64.json /tmp</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=某实验环境centos7-1><span>某实验环境(Centos7)</span>
<a href=#%e6%9f%90%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83centos7-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── dockerfile
</span></span><span class=line><span class=cl>└── src
</span></span><span class=line><span class=cl>    ├── dwarf2json
</span></span><span class=line><span class=cl>    ├── kernel-debuginfo-3.10.0-1160.el7.x86_64.rpm
</span></span><span class=line><span class=cl>    └── kernel-debuginfo-common-x86_64-3.10.0-1160.el7.x86_64.rpm</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>centos:7</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./src/ /src/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s/mirrorlist/#mirrorlist/g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s|#baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.aliyun.com/centos|g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s|baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.aliyun.com/centos|g&#39;</span> /etc/yum.repos.d/CentOS-*.repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum clean all <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum makecache <span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum install -y gcc make unzip elfutils-libelf-devel<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=c1># 需要根据实际的内核版本修改此处</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum localinstall -y kernel-debuginfo-common-x86_64-3.10.0-1160.el7.x86_64.rpm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> yum localinstall -y kernel-debuginfo-3.10.0-1160.el7.x86_64.rpm<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chmod +x dwarf2json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> ./dwarf2json linux --elf /usr/lib/debug/usr/lib/modules/3.10.0-1160.el7.x86_64/vmlinux &gt; Centos_3.10.0-1160.el7.x86_64.json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> mv Centos_3.10.0-1160.el7.x86_64.json /tmp<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 清理 yum 缓存以减小镜像体积</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> yum clean all</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=volatility2相关命令><span>Volatility2相关命令</span>
<a href=#volatility2%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong><a href=https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference target=_blank rel="external nofollow noopener noreferrer">官方文档</a></strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看Profile是否载入成功</span>
</span></span><span class=line><span class=cl>vol.py --info <span class=p>|</span> grep Profile <span class=p>|</span> grep Linux
</span></span><span class=line><span class=cl><span class=c1># 查看内核和发行版信息</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_banner
</span></span><span class=line><span class=cl><span class=c1># 查看命令行记录</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_bash
</span></span><span class=line><span class=cl><span class=c1># 查看桌面上的文件</span>
</span></span><span class=line><span class=cl>vol.py -f 1.mem --profile<span class=o>=</span>LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_find_file -L <span class=p>|</span> grep <span class=s2>&#34;Desktop&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 提取文件</span>
</span></span><span class=line><span class=cl>vol.py -f 1.mem --profile<span class=o>=</span>LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_find_file -i 0xffff9ce28fe300e8 -O
</span></span><span class=line><span class=cl><span class=c1># 恢复文件系统</span>
</span></span><span class=line><span class=cl>sudo python2 ~/volatility/vol.py -f mem --profile<span class=o>=</span>LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_recover_filesystem --dump-dir<span class=o>=</span>./
</span></span><span class=line><span class=cl><span class=c1># 查看进程</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_pslist
</span></span><span class=line><span class=cl><span class=c1># 查看进程打开的文件</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_lsof
</span></span><span class=line><span class=cl><span class=c1># 查看正在运行的进程</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_psaux
</span></span><span class=line><span class=cl><span class=c1># 查看网络状态</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_netstat
</span></span><span class=line><span class=cl><span class=c1># 查看挂载了哪些文件系统</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_mount
</span></span><span class=line><span class=cl><span class=c1># 查看已加载的内核模块</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_lsmod
</span></span><span class=line><span class=cl><span class=c1># 查看隐藏的内核模块</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_hidden_modules
</span></span><span class=line><span class=cl><span class=c1># 查看可疑的进程</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_malfind
</span></span><span class=line><span class=cl><span class=c1># 恢复Truecrypt密钥(需要yara模块，然后使用上可能有点问题)</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_truecrypt_passphrase
</span></span><span class=line><span class=cl><span class=c1># 在内存转储中打开一个shell</span>
</span></span><span class=line><span class=cl>vol.py -f mem --profile<span class=o>=</span>LinuxDebian_5_10_0-21-amd64_profilex64 linux_volshell -v
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Volatility Foundation Volatility Framework 2.6.1
</span></span><span class=line><span class=cl>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes
</span></span><span class=line><span class=cl>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes
</span></span><span class=line><span class=cl>Current context: process systemd, <span class=nv>pid</span><span class=o>=</span><span class=m>1</span> <span class=nv>DTB</span><span class=o>=</span>0x2080000
</span></span><span class=line><span class=cl>Welcome to volshell! Current memory image is:
</span></span><span class=line><span class=cl>file:///mnt/c/Users/GoodLunatic/Desktop/1/mem
</span></span><span class=line><span class=cl>To get help, <span class=nb>type</span> <span class=s1>&#39;hh()&#39;</span>
</span></span><span class=line><span class=cl>&gt;&gt;&gt; hh<span class=o>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use addrspace<span class=o>()</span> <span class=k>for</span> Kernel/Virtual AS
</span></span><span class=line><span class=cl>Use addrspace<span class=o>()</span>.base <span class=k>for</span> Physical AS
</span></span><span class=line><span class=cl>Use proc<span class=o>()</span> to get the current process object
</span></span><span class=line><span class=cl>  and proc<span class=o>()</span>.get_process_address_space<span class=o>()</span> <span class=k>for</span> the current process AS
</span></span><span class=line><span class=cl>  and proc<span class=o>()</span>.get_load_modules<span class=o>()</span> <span class=k>for</span> the current process DLLs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>addrspace<span class=o>()</span>                              : Get the current kernel/virtual address space.
</span></span><span class=line><span class=cl>cc<span class=o>(</span><span class=nv>offset</span><span class=o>=</span>None, <span class=nv>pid</span><span class=o>=</span>None, <span class=nv>name</span><span class=o>=</span>None, <span class=nv>physical</span><span class=o>=</span>False<span class=o>)</span> : Change current shell context.
</span></span><span class=line><span class=cl>db<span class=o>(</span>address, <span class=nv>length</span><span class=o>=</span>128, <span class=nv>space</span><span class=o>=</span>None<span class=o>)</span>      : Print bytes as canonical hexdump.
</span></span><span class=line><span class=cl>dd<span class=o>(</span>address, <span class=nv>length</span><span class=o>=</span>128, <span class=nv>space</span><span class=o>=</span>None<span class=o>)</span>      : Print dwords at address.
</span></span><span class=line><span class=cl>dis<span class=o>(</span>address, <span class=nv>length</span><span class=o>=</span>128, <span class=nv>space</span><span class=o>=</span>None, <span class=nv>mode</span><span class=o>=</span>None<span class=o>)</span> : Disassemble code at a given address.
</span></span><span class=line><span class=cl>dq<span class=o>(</span>address, <span class=nv>length</span><span class=o>=</span>128, <span class=nv>space</span><span class=o>=</span>None<span class=o>)</span>      : Print qwords at address.
</span></span><span class=line><span class=cl>dt<span class=o>(</span>objct, <span class=nv>address</span><span class=o>=</span>None, <span class=nv>space</span><span class=o>=</span>None, <span class=nv>recursive</span><span class=o>=</span>False, <span class=nv>depth</span><span class=o>=</span>0<span class=o>)</span> : Describe an object or show <span class=nb>type</span> info.
</span></span><span class=line><span class=cl>find<span class=o>(</span>needle, <span class=nv>max</span><span class=o>=</span>1, <span class=nv>shift</span><span class=o>=</span>0, <span class=nv>skip</span><span class=o>=</span>0, <span class=nv>count</span><span class=o>=</span>False, <span class=nv>length</span><span class=o>=</span>128<span class=o>)</span> :
</span></span><span class=line><span class=cl>getmods<span class=o>()</span>                                : Generator <span class=k>for</span> kernel modules <span class=o>(</span>scripting<span class=o>)</span>.
</span></span><span class=line><span class=cl>getprocs<span class=o>()</span>                               : Generator of process objects <span class=o>(</span>scripting<span class=o>)</span>.
</span></span><span class=line><span class=cl>hh<span class=o>(</span><span class=nv>cmd</span><span class=o>=</span>None<span class=o>)</span>                             : Get <span class=nb>help</span> on a command.
</span></span><span class=line><span class=cl>list_entry<span class=o>(</span>head, objname, <span class=nv>offset</span><span class=o>=</span>-1, <span class=nv>fieldname</span><span class=o>=</span>None, <span class=nv>forward</span><span class=o>=</span>True, <span class=nv>space</span><span class=o>=</span>None<span class=o>)</span> : Traverse a _LIST_ENTRY.
</span></span><span class=line><span class=cl>modules<span class=o>()</span>                                : Print loaded modules in a table view.
</span></span><span class=line><span class=cl>proc<span class=o>()</span>                                   : Get the current process object.
</span></span><span class=line><span class=cl>ps<span class=o>()</span>                                     : Print active processes in a table view.
</span></span><span class=line><span class=cl>sc<span class=o>()</span>                                     : Show the current context.
</span></span><span class=line><span class=cl>For <span class=nb>help</span> on a specific command, <span class=nb>type</span> <span class=s1>&#39;hh(&lt;command&gt;)&#39;</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=volatility3相关命令><span>Volatility3相关命令</span>
<a href=#volatility3%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>	<span class=c1># 查看当前都有哪些 Profile 可用</span>
</span></span><span class=line><span class=cl>	vol3.py IsfInfo <span class=p>|</span> grep linux
</span></span><span class=line><span class=cl>	<span class=c1># 查看bash历史记录</span>
</span></span><span class=line><span class=cl>	vol3.py -f 1.mem linux.bash
</span></span><span class=line><span class=cl>	<span class=c1># 扫描进程</span>
</span></span><span class=line><span class=cl>	vol3.py -f 1.mem linux.pslist
</span></span><span class=line><span class=cl>	<span class=c1># 列出子进程</span>
</span></span><span class=line><span class=cl>	vol3.py -f 1.mem linux.pstree
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>    linux.bash.Bash     Recovers bash <span class=nb>command</span> <span class=nb>history</span> from memory.
</span></span><span class=line><span class=cl>    linux.capabilities.Capabilities
</span></span><span class=line><span class=cl>                        Lists process capabilities
</span></span><span class=line><span class=cl>    linux.check_afinfo.Check_afinfo
</span></span><span class=line><span class=cl>                        Verifies the operation <span class=k>function</span> pointers of network protocols.
</span></span><span class=line><span class=cl>    linux.check_creds.Check_creds
</span></span><span class=line><span class=cl>                        Checks <span class=k>if</span> any processes are sharing credential structures
</span></span><span class=line><span class=cl>    linux.check_idt.Check_idt
</span></span><span class=line><span class=cl>                        Checks <span class=k>if</span> the IDT has been altered
</span></span><span class=line><span class=cl>    linux.check_modules.Check_modules
</span></span><span class=line><span class=cl>                        Compares module list to sysfs info, <span class=k>if</span> available
</span></span><span class=line><span class=cl>    linux.check_syscall.Check_syscall
</span></span><span class=line><span class=cl>                        Check system call table <span class=k>for</span> hooks.
</span></span><span class=line><span class=cl>    linux.elfs.Elfs     Lists all memory mapped ELF files <span class=k>for</span> all processes.
</span></span><span class=line><span class=cl>    linux.envars.Envars
</span></span><span class=line><span class=cl>    linux.envvars.Envvars
</span></span><span class=line><span class=cl>                        Lists processes with their environment variables
</span></span><span class=line><span class=cl>    linux.iomem.IOMem   Generates an output similar to /proc/iomem on a running system.
</span></span><span class=line><span class=cl>    linux.keyboard_notifiers.Keyboard_notifiers
</span></span><span class=line><span class=cl>                        Parses the keyboard notifier call chain
</span></span><span class=line><span class=cl>    linux.kmsg.Kmsg     Kernel log buffer reader
</span></span><span class=line><span class=cl>    linux.lsmod.Lsmod   Lists loaded kernel modules.
</span></span><span class=line><span class=cl>    linux.lsof.Lsof     Lists all memory maps <span class=k>for</span> all processes.
</span></span><span class=line><span class=cl>    linux.malfind.Malfind
</span></span><span class=line><span class=cl>                        Lists process memory ranges that potentially contain injected code.
</span></span><span class=line><span class=cl>    linux.mountinfo.MountInfo
</span></span><span class=line><span class=cl>                        Lists mount points on processes mount namespaces
</span></span><span class=line><span class=cl>    linux.proc.Maps     Lists all memory maps <span class=k>for</span> all processes.
</span></span><span class=line><span class=cl>    linux.psaux.PsAux   Lists processes with their <span class=nb>command</span> line arguments
</span></span><span class=line><span class=cl>    linux.pslist.PsList
</span></span><span class=line><span class=cl>                        Lists the processes present in a particular linux memory image.
</span></span><span class=line><span class=cl>    linux.psscan.PsScan
</span></span><span class=line><span class=cl>                        Scans <span class=k>for</span> processes present in a particular linux image.
</span></span><span class=line><span class=cl>    linux.pstree.PsTree
</span></span><span class=line><span class=cl>                        Plugin <span class=k>for</span> listing processes in a tree based on their parent process ID.
</span></span><span class=line><span class=cl>    linux.sockstat.Sockstat
</span></span><span class=line><span class=cl>                        Lists all network connections <span class=k>for</span> all processes.
</span></span><span class=line><span class=cl>    linux.tty_check.tty_check
</span></span><span class=line><span class=cl>                        Checks tty devices <span class=k>for</span> hooks</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=macos内存取证><span>MacOS内存取证</span>
<a href=#macos%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=volatility2-1><span>Volatility2</span>
<a href=#volatility2-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=volatility3-1><span>Volatility3</span>
<a href=#volatility3-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h3 class=heading-element id=识别不出内存镜像版本的取证><span>识别不出内存镜像版本的取证</span>
<a href=#%e8%af%86%e5%88%ab%e4%b8%8d%e5%87%ba%e5%86%85%e5%ad%98%e9%95%9c%e5%83%8f%e7%89%88%e6%9c%ac%e7%9a%84%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接使用 010 手搓或者用 Strings 命令把可打印字符保存到文本文件中再手搓</p><p>需要从内存中找到 AES 解密的 key 的情况：可以使用 findaes.exe 工具辅助查找</p><p><img loading=lazy src=/posts/761da51/imgs/findaes.png alt=/posts/761da51/imgs/findaes.png height=343 width=1351></p><h3 class=heading-element id=用来制作内存镜像的工具><span>用来制作内存镜像的工具</span>
<a href=#%e7%94%a8%e6%9d%a5%e5%88%b6%e4%bd%9c%e5%86%85%e5%ad%98%e9%95%9c%e5%83%8f%e7%9a%84%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、Volatility
2、FTK Imager
3、Magnet RAM Capture
4、Belkasoft Live RAM Capturer
5、WinPMEM
6、Rekall
7、DumpIt
8、OSForensics</p><h3 class=heading-element id=dmp文件><span>dmp文件</span>
<a href=#dmp%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、拉入Passware Kit Forensic-Memory Analysis进行分析（用户名和密码）</p><p>2、使用vol分析</p><h3 class=heading-element id=lsassdmp文件><span>lsass.DMP文件</span>
<a href=#lsassdmp%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接使用<code>mimikatz</code>或者<code>pypykatz</code>分析</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sekurlsa::minidump lsass.dmp
</span></span><span class=line><span class=cl>sekurlsa::logonpasswords</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pypykatz lsa minidump lsass.DMP</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=dump文件><span>dump文件</span>
<a href=#dump%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;dmp&#34; 通常特指 Windows 的崩溃转储文件，而 &#34;dump&#34; 是一个更为通用的术语，可以用于描述各种数据转储操作或文件。</span></span></code></pre></td></tr></table></div></div><p>取证方法大致和dmp文件相同</p><h3 class=heading-element id=mem文件><span>mem文件</span>
<a href=#mem%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vol.py -f mem imageinfo</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=raw文件><span>raw文件</span>
<a href=#raw%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以直接使用 vol2 或者 vol3 进行内存取证</p><h2 class=heading-element id=磁盘取证><span>磁盘取证</span>
<a href=#%e7%a3%81%e7%9b%98%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>Tips：1、同一个镜像文件，不同的密码可以挂载出不同的盘，里面的数据也不同</p><h3 class=heading-element id=veracrypt><span>VeraCrypt</span>
<a href=#veracrypt class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>同一个VC加密卷，使用不同的密钥或者密钥文件，加载出来的卷可能不一样(存在隐藏卷的情况)</p></blockquote><p>例题1-DASCTF-2024最后一战 1z_F0r3ns1cs_1</p><p>解密&挂载磁盘的步骤：</p><p>1.选择要挂载的加密盘，然后选择一个没有被占用的盘符再点击左下角的加载</p><p><img loading=lazy src=/posts/761da51/imgs/VeraCrypt1-17142941155649.png alt=/posts/761da51/imgs/VeraCrypt1-17142941155649.png height=489 width=569></p><p>2.输入加密盘的密钥，或者直接使用密钥文件(图片文件也可以)</p><p>​ 如果这里加载失败，可以点击下面的加密卷工具，把密钥给改了，然后使用自己更改后的密钥挂载</p><p>3.如果不知道解密的密钥，也可以尝试用 <code>Forensics Passware Kit</code> 进行爆破</p><h3 class=heading-element id=取证大师><span>取证大师</span>
<a href=#%e5%8f%96%e8%af%81%e5%a4%a7%e5%b8%88 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>没啥好说的，直接把硬盘镜像文件拉进去梭就行</p><h3 class=heading-element id=fat文件><span>fat文件</span>
<a href=#fat%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>FAT格式： 即FAT16,这是MS－DOS和最早期的Win 95操作系统中最常见的磁盘分区格式。它采用16位的文件分配表，能支持最大为2GB的分区，几乎所有的操作系统都支持这一种格式。</span></span></code></pre></td></tr></table></div></div><p>1、可以使用veracrypt挂载到本地，然后用资源管理器打开</p><p>2、如果挂载后资源管理器打不开，可以使用winhex-工具-打开磁盘查看</p><h3 class=heading-element id=vmdk文件><span>VMDK文件</span>
<a href=#vmdk%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以用Imdisk挂载到本地</p><p>1、可以使用Diskgenius-磁盘-打开虚拟磁盘文件</p><p>2、可以使用Imdisk挂载到本地，然后用everything进行搜索</p><p>3、可以使用7zip打开然后解压缩</p><p>4、可以使用FTK、Vera挂载</p><p>5、如果Linux虚拟机不知道密码，可以尝试单用户修改密码</p><blockquote><p>开机长按shift进入GRUB，选择advanced options for ubuntu</p><p>选择recoverymode，进入菜单选择root，然后press enter</p><p>输入passwd you_passwd，输入密码，重启(reboot)</p></blockquote><h3 class=heading-element id=e01文件><span>E01文件</span>
<a href=#e01%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、若有BitLocker加密并提供了内存镜像，就拉入Passware Kit Forensic-Decrypt Disk-BitLocker进行爆破解密</p><p>​ 解密后会得到一个G-decrypted.dd，然后用 FTK image 打开</p><p>2、提供的 E01 文件可能有好几部分，BitLocker加密的密钥可能藏在其中一部分中，建议用 FTK image 查看一下</p><p>​ FTK image 直接提取文件可能会有点问题（加密压缩包、根目录文件看不到），建议还是直接 mount 到本地然后再提取</p><p>3、可以使用<code>AutoPsy</code>辅助进行取证，尤其在进行注册表<code>\Windows\System32\config</code>分析的时候</p><p>4、如果给了很多个很小的 E01 文件，可以尝试用<code>ewfinfo</code>命令查看元数据（里面可能有关键信息）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span> <span class=n>install</span> <span class=n>Libewf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看信息</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>ewfinfo</span> <span class=mf>0e564175</span><span class=o>-</span><span class=n>b059</span><span class=o>-</span><span class=mi>43</span><span class=n>de</span><span class=o>-</span><span class=n>b58a</span><span class=o>-</span><span class=n>abf7b036a503</span><span class=o>.</span><span class=n>E01</span>
</span></span><span class=line><span class=cl><span class=n>ewfinfo</span> <span class=mi>20140816</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Acquiry</span> <span class=n>information</span>
</span></span><span class=line><span class=cl>	<span class=n>Case</span> <span class=n>number</span><span class=p>:</span>		<span class=mi>007</span>
</span></span><span class=line><span class=cl>	<span class=n>Description</span><span class=p>:</span>		<span class=n>Hello</span><span class=p>,</span> <span class=ne>World</span>
</span></span><span class=line><span class=cl>	<span class=n>Examiner</span> <span class=n>name</span><span class=p>:</span>		<span class=n>Jim</span><span class=s1>&#39;s Forensics</span>
</span></span><span class=line><span class=cl>	<span class=n>Evidence</span> <span class=n>number</span><span class=p>:</span>	<span class=n>evidence_number</span>
</span></span><span class=line><span class=cl>	<span class=n>Notes</span><span class=p>:</span>			<span class=n>COMP6445</span><span class=p>{</span><span class=n>thank_g0odness_for_metadata</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=n>Acquisition</span> <span class=n>date</span><span class=p>:</span>	<span class=n>Mon</span> <span class=n>Sep</span> <span class=mi>22</span> <span class=mi>01</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mi>08</span> <span class=mi>2025</span>
</span></span><span class=line><span class=cl>	<span class=n>System</span> <span class=n>date</span><span class=p>:</span>		<span class=n>Mon</span> <span class=n>Sep</span> <span class=mi>22</span> <span class=mi>01</span><span class=p>:</span><span class=mi>09</span><span class=p>:</span><span class=mi>08</span> <span class=mi>2025</span>
</span></span><span class=line><span class=cl>	<span class=n>Operating</span> <span class=n>system</span> <span class=n>used</span><span class=p>:</span>	<span class=n>Linux</span>
</span></span><span class=line><span class=cl>	<span class=n>Software</span> <span class=n>version</span> <span class=n>used</span><span class=p>:</span>	<span class=mi>20140813</span>
</span></span><span class=line><span class=cl>	<span class=n>Password</span><span class=p>:</span>		<span class=n>N</span><span class=o>/</span><span class=n>A</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EWF</span> <span class=n>information</span>
</span></span><span class=line><span class=cl>	<span class=ne>File</span> <span class=n>format</span><span class=p>:</span>		<span class=n>EnCase</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>	<span class=n>Sectors</span> <span class=n>per</span> <span class=n>chunk</span><span class=p>:</span>	<span class=mi>64</span>
</span></span><span class=line><span class=cl>	<span class=n>Error</span> <span class=n>granularity</span><span class=p>:</span>	<span class=mi>64</span>
</span></span><span class=line><span class=cl>	<span class=n>Compression</span> <span class=n>method</span><span class=p>:</span>	<span class=n>deflate</span>
</span></span><span class=line><span class=cl>	<span class=n>Compression</span> <span class=n>level</span><span class=p>:</span>	<span class=n>no</span> <span class=n>compression</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Media</span> <span class=n>information</span>
</span></span><span class=line><span class=cl>	<span class=n>Media</span> <span class=n>type</span><span class=p>:</span>		<span class=n>fixed</span> <span class=n>disk</span>
</span></span><span class=line><span class=cl>	<span class=n>Is</span> <span class=n>physical</span><span class=p>:</span>		<span class=n>yes</span>
</span></span><span class=line><span class=cl>	<span class=n>Bytes</span> <span class=n>per</span> <span class=n>sector</span><span class=p>:</span>	<span class=mi>512</span>
</span></span><span class=line><span class=cl>	<span class=n>Number</span> <span class=n>of</span> <span class=n>sectors</span><span class=p>:</span>	<span class=mi>6</span>
</span></span><span class=line><span class=cl>	<span class=n>Media</span> <span class=n>size</span><span class=p>:</span>		<span class=mf>3.0</span> <span class=n>KiB</span> <span class=p>(</span><span class=mi>3072</span> <span class=n>bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Digest</span> <span class=nb>hash</span> <span class=n>information</span>
</span></span><span class=line><span class=cl>	<span class=n>MD5</span><span class=p>:</span>			<span class=mi>015976</span><span class=n>f7fbeba5c0b92e65da34da06c1</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl><span class=c1># 导出为 dd 文件</span>
</span></span><span class=line><span class=cl><span class=n>ewfexport</span> <span class=o>-</span><span class=n>t</span> <span class=mf>1.</span><span class=n>dd</span> <span class=mi>2</span><span class=n>cc29840</span><span class=o>-</span><span class=mi>6</span><span class=n>c84</span><span class=o>-</span><span class=mi>43</span><span class=n>a2</span><span class=o>-</span><span class=mi>9416</span><span class=o>-</span><span class=n>f898ebf6a4e0</span><span class=o>.</span><span class=n>E01</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2024国城杯-Just_F0r3n51Cs</p><h3 class=heading-element id=ad1文件><span>ad1文件</span>
<a href=#ad1%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>ad1文件是用 FTKimage 制作的磁盘镜像，因此可以使用 FTKimage 进行挂载</p><h3 class=heading-element id=vhd文件><span>vhd文件</span>
<a href=#vhd%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>vhd 是 Virtual Hard Disk 虚拟磁盘的缩写，是一种用于存储虚拟机磁盘镜像的文件格式</p><p>1、可以在 Windows 系统下直接挂载，也可以拉入 DiskGenius 打开查看</p><p>2、如果显示有BitLocker加密，可以先用<code>x-ways Forensics</code>转换为DD文件，然后用<code>PasswareKit</code>结合内存镜像爆破密钥
例题1-NewStarCTF Week4-擅长加密的小明</p><h3 class=heading-element id=img文件><span>img文件</span>
<a href=#img%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=raid0磁盘挂载><span>raid0磁盘挂载</span>
<a href=#raid0%e7%a3%81%e7%9b%98%e6%8c%82%e8%bd%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=方法一ufs直接重组><span>方法一：(UFS直接重组)</span>
<a href=#%e6%96%b9%e6%b3%95%e4%b8%80ufs%e7%9b%b4%e6%8e%a5%e9%87%8d%e7%bb%84 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>软件下载链接：<a href=https://cangshui.net/5257.html target=_blank rel="external nofollow noopener noreferrer">UFS Explorer Professional Recovery 9.18</a></p><p>直接用UFS打开五个img文件即可，软件会自动重组，然后点击最下面那个kali</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250228162941848.png alt=/posts/761da51/imgs/image-20250228162941848.png height=772 width=1202></p><h5 class=heading-element id=方法二在ubuntu下用losetup和mdadm进行组装挂载><span>方法二：在Ubuntu下用losetup和mdadm进行组装挂载</span>
<a href=#%e6%96%b9%e6%b3%95%e4%ba%8c%e5%9c%a8ubuntu%e4%b8%8b%e7%94%a8losetup%e5%92%8cmdadm%e8%bf%9b%e8%a1%8c%e7%bb%84%e8%a3%85%e6%8c%82%e8%bd%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>在WSL2(Ubuntu20.04)中运行一下命令即可成功挂载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo losetup -fP m8X4exzG.img  <span class=c1># 绑定第一个镜像文件到一个空闲的 loop 设备，并解析其分区表</span>
</span></span><span class=line><span class=cl>sudo losetup -fP Fsiq6lKn.img
</span></span><span class=line><span class=cl>sudo losetup -fP gSoNiXLC.img
</span></span><span class=line><span class=cl>sudo losetup -fP suPVGqm6.img
</span></span><span class=line><span class=cl>sudo losetup -fP uGZ85OzT.img
</span></span><span class=line><span class=cl>sudo losetup -a  <span class=c1># 查看当前所有已绑定的 loop 设备及其对应的文件</span>
</span></span><span class=line><span class=cl>cat /proc/mdstat  <span class=c1># 查看当前系统中已组装的 RAID 设备状态</span>
</span></span><span class=line><span class=cl>sudo mount /dev/md127 tmp  <span class=c1># 挂载 RAID 设备 md127 到 tmp 目录，尝试访问其内容</span>
</span></span><span class=line><span class=cl>ls -al tmp
</span></span><span class=line><span class=cl>sudo umount tmp  <span class=c1># 卸载 tmp 目录，释放 md127 设备的挂载</span>
</span></span><span class=line><span class=cl>sudo mdadm --stop /dev/md127  <span class=c1># 停止 RAID 设备 md127，释放相关 loop 设备的占用</span>
</span></span><span class=line><span class=cl>sudo losetup -d /dev/loop0  <span class=c1># 解除 loop0 设备的绑定</span>
</span></span><span class=line><span class=cl>sudo losetup -d /dev/loop1
</span></span><span class=line><span class=cl>sudo losetup -d /dev/loop2
</span></span><span class=line><span class=cl>sudo losetup -d /dev/loop3
</span></span><span class=line><span class=cl>sudo losetup -d /dev/loop4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 检查 /dev/loop0 至 /dev/loop4 上的每个设备的 RAID 元数据（查看设备是否是 RAID 阵列的一部分）</span>
</span></span><span class=line><span class=cl>sudo mdadm --examine /dev/loop0 /dev/loop1 /dev/loop2 /dev/loop3 /dev/loop4   
</span></span><span class=line><span class=cl><span class=c1># 创建一个名为 /dev/md127 的 RAID 0 阵列，包含 5 个设备（/dev/loop0 至 /dev/loop4）</span>
</span></span><span class=line><span class=cl>sudo mdadm --create /dev/md127 --level<span class=o>=</span><span class=m>0</span> --raid-devices<span class=o>=</span><span class=m>5</span> /dev/loop0 /dev/loop1 /dev/loop2 /dev/loop3 /dev/loop4   </span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips:这里我的WSL2可能启用了 <code>mdadm</code> 的 <strong>自动检测和组装</strong>，因此会在发现 <code>RAID</code> 元数据时自动创建 <code>/dev/md127</code></p></blockquote><p><img loading=lazy src=/posts/761da51/imgs/image-20250302105806686.png alt=/posts/761da51/imgs/image-20250302105806686.png height=927 width=1734></p><p>但是当我尝试在kali上执行以上操作的时候，它不会自动识别 <code>RAID</code> 阵列并自动挂载</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250302111821199.png alt=/posts/761da51/imgs/image-20250302111821199.png height=1539 width=2561></p><p>因此还是建议在Ubuntu系统下进行以上操作</p><p>例题1-2025西湖论剑-糟糕的磁盘</p><h3 class=heading-element id=btr文件><span>btr文件</span>
<a href=#btr%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>把文件拉到<code>Kali</code>虚拟机里(这里最好用<code>kali</code>，因为经过测试，发现我WSL2中的Ubuntu20.04是无法准备识别这几个文件的）</p><p><img loading=lazy src=/posts/761da51/imgs/image-20250302213331633.png alt=WSL2-Ubuntu20.04 height=279 width=1734></p><p><img loading=lazy src=/posts/761da51/imgs/image-20250302213429891.png alt=Kali-Linux height=289 width=1704>
然后我们使用以下几个命令挂载一下上面文件格式为<code>BTRFS</code>磁盘</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo losetup -fP Cr6cHso43mZM.btr
</span></span><span class=line><span class=cl>sudo losetup -fP LaQrxw9UCsuj.btr
</span></span><span class=line><span class=cl>sudo losetup -fP UljsvrCJUkfX.btr
</span></span><span class=line><span class=cl>sudo losetup -fP mkZEnww8DePD.btr
</span></span><span class=line><span class=cl>sudo losetup -fP yRvRjpac8Lxo.btr
</span></span><span class=line><span class=cl>sudo mkdir tmp
</span></span><span class=line><span class=cl>sudo mount -o degraded /dev/loop1 tmp <span class=c1># 用于强制挂载可能降级（设备丢失或损坏）的Btrfs文件系统</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/761da51/imgs/image-20250302231559934.png alt=/posts/761da51/imgs/image-20250302231559934.png height=1528 width=2560></p><p>例题1-2024强网拟态-Input Page Walk</p><h3 class=heading-element id=磁盘取证的一些思路><span>磁盘取证的一些思路</span>
<a href=#%e7%a3%81%e7%9b%98%e5%8f%96%e8%af%81%e7%9a%84%e4%b8%80%e4%ba%9b%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1-获取主机的系统名><span>1. 获取主机的系统名</span>
<a href=#1-%e8%8e%b7%e5%8f%96%e4%b8%bb%e6%9c%ba%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><code>/etc/issue</code>或<code>/usr/lib/os.release</code>下可以得到</p><h4 class=heading-element id=2-查看powershell的历史记录><span>2. 查看Powershell的历史记录</span>
<a href=#2-%e6%9f%a5%e7%9c%8bpowershell%e7%9a%84%e5%8e%86%e5%8f%b2%e8%ae%b0%e5%bd%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>用户的powershell历史记录会保存在这个路径下
<code>\Users\test\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code></p><h4 class=heading-element id=3-获取用户的登录密码><span>3. 获取用户的登录密码</span>
<a href=#3-%e8%8e%b7%e5%8f%96%e7%94%a8%e6%88%b7%e7%9a%84%e7%99%bb%e5%bd%95%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>Linux下密码以哈希的形式保存在<code>/etc/shadow</code>或者<code>/etc/passwd(老版本)</code>中</p><p>提取出来然后使用<code>Hashcat</code>爆破即可</p><p><code>shadow_hash.txt</code>内容及对应<code>hashcat</code>的命令如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>snowflakes:<span class=nv>$6$k6sgCBLM2Qzkreq6$l1OrqaIUNDxrv5g14BljA</span>.FkX.BQt5sulAlaR0QMyFR/wQMLA4Cebk1dw8xIiZU3tmMW9mKlOV2xeoXwrDnbk1:18760:0:99999:7:::
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hashcat -m <span class=m>1800</span> -a <span class=m>0</span> shadow_hash.txt rockyou.txt --force</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root:<span class=nv>$1$NAkZFH1u$byy9Vl8PSU3dJl5MicArx1</span>:18446:0:99999:7:::
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hashcat -m <span class=m>500</span> -a <span class=m>0</span> shadow_hash.txt rockyou.txt --force</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=4-获取定时任务的内容><span>4. 获取定时任务的内容</span>
<a href=#4-%e8%8e%b7%e5%8f%96%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1%e7%9a%84%e5%86%85%e5%ae%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>定时任务保存在 <code>/etc/crontab</code> 文件下，这里举个例子</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/crontab: system-wide crontab</span>
</span></span><span class=line><span class=cl><span class=c1># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># command to install the new version when you edit this file</span>
</span></span><span class=line><span class=cl><span class=c1># and files in /etc/cron.d. These files also have username fields,</span>
</span></span><span class=line><span class=cl><span class=c1># that none of the other crontabs do.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>SHELL</span><span class=o>=</span>/bin/sh
</span></span><span class=line><span class=cl><span class=c1># You can also override PATH, but by default, newer versions inherit it from the environment</span>
</span></span><span class=line><span class=cl><span class=c1>#PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example of job definition:</span>
</span></span><span class=line><span class=cl><span class=c1># .---------------- minute (0 - 59)</span>
</span></span><span class=line><span class=cl><span class=c1># |  .------------- hour (0 - 23)</span>
</span></span><span class=line><span class=cl><span class=c1># |  |  .---------- day of month (1 - 31)</span>
</span></span><span class=line><span class=cl><span class=c1># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span>
</span></span><span class=line><span class=cl><span class=c1># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span>
</span></span><span class=line><span class=cl><span class=c1># |  |  |  |  |</span>
</span></span><span class=line><span class=cl><span class=c1># *  *  *  *  * user-name command to be executed</span>
</span></span><span class=line><span class=cl><span class=m>17</span> *	* * *	root	<span class=nb>cd</span> / <span class=o>&amp;&amp;</span> run-parts --report /etc/cron.hourly
</span></span><span class=line><span class=cl><span class=m>25</span> 6	* * *	root	<span class=nb>test</span> -x /usr/sbin/anacron <span class=o>||</span> <span class=o>{</span> <span class=nb>cd</span> / <span class=o>&amp;&amp;</span> run-parts --report /etc/cron.daily<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=m>47</span> 6	* * 7	root	<span class=nb>test</span> -x /usr/sbin/anacron <span class=o>||</span> <span class=o>{</span> <span class=nb>cd</span> / <span class=o>&amp;&amp;</span> run-parts --report /etc/cron.weekly<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=m>52</span> 6	<span class=m>1</span> * *	root	<span class=nb>test</span> -x /usr/sbin/anacron <span class=o>||</span> <span class=o>{</span> <span class=nb>cd</span> / <span class=o>&amp;&amp;</span> run-parts --report /etc/cron.monthly<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>*/2 * * * * root /usr/bin/python3 /usr/local/share/xml/entities/a.py
</span></span><span class=line><span class=cl><span class=c1># 每 2 分钟执行一次 Python 脚本 /usr/local/share/xml/entities/a.py</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=5-获取docker容器中的关键信息><span>5. 获取Docker容器中的关键信息</span>
<a href=#5-%e8%8e%b7%e5%8f%96docker%e5%ae%b9%e5%99%a8%e4%b8%ad%e7%9a%84%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>Docker容器保存在<code>/var/lib/docker/containers/</code>路径下</p><h4 class=heading-element id=6-获取主机的环境变量><span>6. 获取主机的环境变量</span>
<a href=#6-%e8%8e%b7%e5%8f%96%e4%b8%bb%e6%9c%ba%e7%9a%84%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><code>Windows</code>的环境变量保存在<code>注册表SYSTEM\CurrentControlSet001\Control\Session Manager\Environment</code>中，注册表在<code>C:\Windows\System32\config</code>目录下</p><h4 class=heading-element id=7-获取计算机注册时的用户名><span>7. 获取计算机注册时的用户名</span>
<a href=#7-%e8%8e%b7%e5%8f%96%e8%ae%a1%e7%ae%97%e6%9c%ba%e6%b3%a8%e5%86%8c%e6%97%b6%e7%9a%84%e7%94%a8%e6%88%b7%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>该信息保存在<code>C:\Windows\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOwner</code></p><h4 class=heading-element id=8-获取计算机当前操作系统的产品名称><span>8. 获取计算机当前操作系统的产品名称</span>
<a href=#8-%e8%8e%b7%e5%8f%96%e8%ae%a1%e7%ae%97%e6%9c%ba%e5%bd%93%e5%89%8d%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%ba%a7%e5%93%81%e5%90%8d%e7%a7%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>该信息保存在<code>C:\Windows\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</code></p><h4 class=heading-element id=9-获取当前firefox浏览器的版本><span>9. 获取当前FireFox浏览器的版本</span>
<a href=#9-%e8%8e%b7%e5%8f%96%e5%bd%93%e5%89%8dfirefox%e6%b5%8f%e8%a7%88%e5%99%a8%e7%9a%84%e7%89%88%e6%9c%ac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>该信息保存在<code>C:\Windows\System32\Config\SOFTWARE\Mozilla\Mozilla Firefox\CurrentVersion</code></p><h2 class=heading-element id=日志取证><span>日志取证</span>
<a href=#%e6%97%a5%e5%bf%97%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=evtx-文件><span>evtx 文件</span>
<a href=#evtx-%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以用 windows 自带的事件查看器打开，然后可以重点关注 <code>Microsoft-Windows-PowerShell%4Operational</code> 这个文件中ID为4104这个执行远程命令的事件</p><h2 class=heading-element id=网站取证><span>网站取证</span>
<a href=#%e7%bd%91%e7%ab%99%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>1、直接拿D_safe扫描可疑文件</p><h2 class=heading-element id=服务器取证><span>服务器取证</span>
<a href=#%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>硬盘镜像文件后缀: .qcow2</p><h3 class=heading-element id=mysql57-数据库从qpxb文件恢复数据><span>Mysql5.7 数据库从qp.xb文件恢复数据</span>
<a href=#mysql57-%e6%95%b0%e6%8d%ae%e5%ba%93%e4%bb%8eqpxb%e6%96%87%e4%bb%b6%e6%81%a2%e5%a4%8d%e6%95%b0%e6%8d%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>需要安装并使用qpress和xtrabackup</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget <span class=s2>&#34;http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/attach/183466/cn_zh/1608011575185/qpress-11-linux-x64.tar&#34;</span>
</span></span><span class=line><span class=cl>wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.9/binary/redhat/7/x86_64/percona-xtrabackup-24-2.4.9-1.el7.x86_64.rpm</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>775</span> qpress
</span></span><span class=line><span class=cl>cp qpress /usr/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat filename.xb <span class=p>|</span> xbstream -x -v -C /www/server/data
</span></span><span class=line><span class=cl><span class=nb>cd</span> /www/server/data
</span></span><span class=line><span class=cl>innobackupex --decompress --remove-original /www/server/data 
</span></span><span class=line><span class=cl><span class=c1>#下一步可能会报错，但是不影响</span>
</span></span><span class=line><span class=cl>innobackupex --defaults-file<span class=o>=</span>/etc/my.cnf --apply-log /www/server/data
</span></span><span class=line><span class=cl><span class=c1># 修改该目录所属的用户和用户组</span>
</span></span><span class=line><span class=cl>chown -R mysql:mysql /www/server/data</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=其他><span>其他</span>
<a href=#%e5%85%b6%e4%bb%96 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=1磁盘恢复><span>1、磁盘恢复</span>
<a href=#1%e7%a3%81%e7%9b%98%e6%81%a2%e5%a4%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=恢复-ext3-或-ext4-文件系统中已删除的文件><span>恢复 ext3 或 ext4 文件系统中已删除的文件</span>
<a href=#%e6%81%a2%e5%a4%8d-ext3-%e6%88%96-ext4-%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e4%b8%ad%e5%b7%b2%e5%88%a0%e9%99%a4%e7%9a%84%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 拉到 kali 中用 extundelete</span>
</span></span><span class=line><span class=cl>extundelete --restore-all disk-image
</span></span><span class=line><span class=cl><span class=c1># 之后在所在目录会生成一个恢复文件</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=直接diskgenius打开恢复文件><span>直接DiskGenius打开恢复文件</span>
<a href=#%e7%9b%b4%e6%8e%a5diskgenius%e6%89%93%e5%bc%80%e6%81%a2%e5%a4%8d%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h3 class=heading-element id=2浏览器登录凭证破解><span>2、浏览器登录凭证破解</span>
<a href=#2%e6%b5%8f%e8%a7%88%e5%99%a8%e7%99%bb%e5%bd%95%e5%87%ad%e8%af%81%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Firefox登录凭证破解</p><p>使用<a href=https://github.com/lclevy/firepwd target=_blank rel="external nofollow noopener noreferrer">Firepwd工具</a>破解，将key4.db、logins.json复制到firepwd目录下，用firepwd.py破解</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>python</span> <span class=n>firepwd</span><span class=o>.</span><span class=n>py</span> <span class=n>logins</span><span class=o>.</span><span class=n>json</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=3邮件取证><span>3、邮件取证</span>
<a href=#3%e9%82%ae%e4%bb%b6%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=foxmail取证><span>FoxMail取证</span>
<a href=#foxmail%e5%8f%96%e8%af%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>本地下个Foxmail，然后在<code>Foxmail 7.2\FMstorage.list</code>中添加Storage的存储路径然后再启动就可以了</p><p>存储目录应该是一个以邮箱地址命名的文件夹</p><h3 class=heading-element id=4dpapi破解><span>4、DPAPI破解</span>
<a href=#4dpapi%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Windows DPAPI 是一种用于在 Windows 操作系统中存储和保护用户敏感数据的加密技术。它可以用于加密密码、证书、浏览器凭据等用户数据。</p><p>可以使用 DPAPImk2john.py 将这个数据转换为 john 可识别的格式，然后使用 john 爆破</p><p><img loading=lazy src=/posts/761da51/imgs/DPAPI1.png alt=/posts/761da51/imgs/DPAPI1.png height=421 width=1734></p><p><img loading=lazy src=/posts/761da51/imgs/DPAPI2.png alt=/posts/761da51/imgs/DPAPI2.png height=438 width=1353></p><p>DPAPI的应用：</p><pre><code>1、EFS文件加密(Cipher)
2、存储无线连接密码
3、Windows凭据管理器
4、IE&amp;Chrome Browser
5、Windows CardSpace
6、Windows Vault
</code></pre><h3 class=heading-element id=5veracrypt加密><span>5、VeraCrypt加密</span>
<a href=#5veracrypt%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>用 VeraCrypt 解密并挂载即可，加密的密钥可能是一串密码，也可能是某个密钥文件</p><p>也有可能同时需要密码+密钥文件才能正常解密并挂载（例题1-2024浙江省赛决赛-天命人）</p><blockquote><p>这里要注意VC版本大于1.19和小于1.19用的加密算法是不一样的</p></blockquote><h3 class=heading-element id=6trueceypt加密><span>6、TrueCeypt加密</span>
<a href=#6trueceypt%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>TrueCrypt 的加密卷也可以使用 VeraCrypt 解密并挂载，只要把模式调整成 TrueCrypt 即可</p><h3 class=heading-element id=7encfs加密><span>7、Encfs加密</span>
<a href=#7encfs%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在windows下用 Encfs4win 来挂载即可，解密这个加密卷，需要 .encfs6.xml和解密的密码</p><p>例题-2024 NKCTF cain_is_hacker</p><h3 class=heading-element id=8gpg--pgp-加密><span>8、GPG / PGP 加密</span>
<a href=#8gpg--pgp-%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>这个加密可以使用 Linux 下的 GPG 解密，也可以使用 Windows 下的 Kleopatra 解密</p><p>Linux 下解密的流程如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 导入公钥和私钥，导入私钥的时候需要输入密码</span>
</span></span><span class=line><span class=cl>gpg --import ciscnctf.asc
</span></span><span class=line><span class=cl>gpg --import ciscn2016.asc
</span></span><span class=line><span class=cl><span class=c1># 使用 gpg 解密，这里解密的时候还需要再输入一次密码</span>
</span></span><span class=line><span class=cl>gpg --decrypt SECRET.docx.pgp &gt; decryptfile
</span></span><span class=line><span class=cl><span class=c1># 查看已经导入的密钥</span>
</span></span><span class=line><span class=cl>gpg --list-keys
</span></span><span class=line><span class=cl><span class=c1># 删除密钥，这里需要先删除私钥再删除公钥</span>
</span></span><span class=line><span class=cl><span class=c1># 删除私钥</span>
</span></span><span class=line><span class=cl>gpg --delete-secret-keys ciscnctf2016@gmail.com
</span></span><span class=line><span class=cl><span class=c1>#删除公钥</span>
</span></span><span class=line><span class=cl>gpg --delete-keys CISCN2016@gmail.com</span></span></code></pre></td></tr></table></div></div><p>例题1-i春秋 Pretty Good Privacy</p><p>例题2-2024 CISCN初赛 Tough-DNS</p><h3 class=heading-element id=9cipher加密><span>9、Cipher加密</span>
<a href=#9cipher%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Windows自带的 Cipher 加密（EFS加密算法）</p><p>直接使用 Advanced efs data recovery 解密即可，解密需要密钥和密码</p><p>例题-2024 DubheCTF Cipher</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-08-30 22:50:12">更新于 2025-08-30&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/761da51/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/761da51/ data-title=Misc-数字取证 data-hashtags=CTF,Misc,Forensics><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/761da51/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/761da51/ data-title=Misc-数字取证><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/misc/ class=post-tag title="标签 - Misc">Misc</a><a href=/tags/forensics/ class=post-tag title="标签 - Forensics">Forensics</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/30d0764/ class=post-nav-item rel=prev title="2025 “天一永安杯”宁波市赛初赛 Misc Writeup"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>2025 “天一永安杯”宁波市赛初赛 Misc Writeup</a><a href=/posts/58b2135/ class=post-nav-item rel=next title="2025 泰山杯线下决赛 Misc Writeup">2025 泰山杯线下决赛 Misc Writeup<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/761da51/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>