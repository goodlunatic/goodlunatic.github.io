<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="这个比赛来问的师傅比较多，于是打算写篇文章详细复现一下
"><meta name=keywords content='CTF,Misc,Writeup'><meta itemprop=name content="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup"><meta itemprop=description content="这个比赛来问的师傅比较多，于是打算写篇文章详细复现一下"><meta itemprop=datePublished content="2026-01-10T21:53:27+08:00"><meta itemprop=dateModified content="2026-01-10T21:53:27+08:00"><meta itemprop=wordCount content="1791"><meta itemprop=keywords content="CTF,Misc,Writeup"><meta property="og:url" content="https://goodlunatic.github.io/posts/8bf5633/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup"><meta property="og:description" content="这个比赛来问的师傅比较多，于是打算写篇文章详细复现一下"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-10T21:53:27+08:00"><meta property="article:modified_time" content="2026-01-10T21:53:27+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><meta property="article:tag" content="Writeup"><meta name=twitter:card content="summary"><meta name=twitter:title content="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup"><meta name=twitter:description content="这个比赛来问的师傅比较多，于是打算写篇文章详细复现一下"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/8bf5633/ title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/6cc9a96/ title="2025 年终总结"><link rel=next type=text/html href=https://goodlunatic.github.io/posts/911b6a0/ title="[持续更新] 记录各种app关闭广告和推荐的方法"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/8bf5633/index.md title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/8bf5633\/"},"image":["https:\/\/www.nssctf.cn\/files\/2025\/8\/21\/8ce6223a1a.png"],"genre":"posts","keywords":"CTF, Misc, Writeup","wordcount":1791,"url":"https:\/\/goodlunatic.github.io\/posts\/8bf5633\/","datePublished":"2026-01-10T21:53:27+08:00","dateModified":"2026-01-10T21:53:27+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/380aa02/ title="2025 古剑山全国大学生网络攻防大赛 Misc Writeup">2025 古剑山全国大学生网络攻防大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/353513a/ title="2025 强网拟态防御国际精英挑战赛线下总决赛 Misc Writeup">2025 强网拟态防御国际精英挑战赛线下总决赛 Misc Writeup</a></li><li class=related-item><a href=/posts/8582ff7/ title="2025 浙江省大学生网络与信息安全竞赛 Misc Writeup">2025 浙江省大学生网络与信息安全竞赛 Misc Writeup</a></li><li class=related-item><a href=/posts/bfeb088/ title="2025 台州市网络安全大赛 Misc Writeup">2025 台州市网络安全大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/02298dd/ title="2025 华为杯中国研究生网络安全创新大赛实网对抗赛 EZ_ATEXEC 详解">2025 华为杯中国研究生网络安全创新大赛实网对抗赛 EZ_ATEXEC 详解</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/writeup/ class=post-category title="分类 - Writeup"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Writeup</a></span></div><div class=post-meta-line><span title="发布于 2026-01-10 21:53:27"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2026-01-10>2026-01-10</time></span>&nbsp;<span title="1791 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 1800 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 9 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#题目名称-smb>题目名称 SMB</a></li><li><a href=#题目名称-blue>题目名称 blue</a></li><li><a href=#题目名称-zipcracker>题目名称 ZipCracker</a></li><li><a href=#题目名称-whiteout>题目名称 whiteout</a></li><li><a href=#题目名称-hidden>题目名称 Hidden</a></li><li><a href=#题目名称-the_rogue_beacon>题目名称 The_Rogue_Beacon</a></li><li><a href=#题目名称-超越感官极致>题目名称 超越感官极致</a></li><li><a href=#题目名称-punkface>题目名称 PunkFace</a></li><li><a href=#题目名称-time>题目名称 time</a></li></ul></nav></div></div><div class=content id=content><p><strong>这个比赛来问的师傅比较多，于是打算写篇文章详细复现一下</strong></p><table><thead><tr><th style=text-align:center><img loading=lazy src=/posts/8bf5633/imgs/image-20260111164642203.png alt=/posts/8bf5633/imgs/image-20260111164642203.png height=501 width=999></th></tr></thead><tbody><tr><td style=text-align:center>本文中涉及的具体题目附件可以进我的 <a href=https://t.zsxq.com/an6p6 target=_blank rel="external nofollow noopener noreferrer">知识星球</a> 获取</td></tr></tbody></table><h2 class=heading-element id=题目名称-smb><span>题目名称 SMB</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-smb class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>Do you know SMB?</p></blockquote><p>附件给了一个pcapng流量包，打开翻看，发现是试用了NTLMv2认证的SMB2协议</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110220207954.png alt=/posts/8bf5633/imgs/image-20260110220207954.png height=1423 width=2099></p><p>拿脚本提取一下hash，然后拿hashcat爆破可以得到密码：<code>12megankirwin12</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110220259336.png alt=/posts/8bf5633/imgs/image-20260110220259336.png height=1094 width=1982></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rockyou::PC:5649f6b5969a9fbf:f8cb9296a5206484b1baf6bce47abe3b:0101000000000000f68d75c3fb59dc01ba30ab51dc5395c3000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800f68d75c3fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000
</span></span><span class=line><span class=cl>rockyou::PC:a230ee46968b6116:c3b172a7df39f6d1765de24170d5f387:0101000000000000ed3fabc7fb59dc01d9b1245c055f29b2000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000
</span></span><span class=line><span class=cl>rockyou::PC:12e83c96f85b09d7:14266416151fcfce3b420575ef030028:0101000000000000ed3fabc7fb59dc01ab5b9b0cfe9b35d0000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000
</span></span><span class=line><span class=cl>rockyou::PC:3822c6dbeba60ca2:4b35d5e49a18a4bf1ce0e68f591799d0:0101000000000000ed3fabc7fb59dc01c0f5befb4ddd6648000000000200160046004c00410047002d005300450052005600450052000100160046004c00410047002d005300450052005600450052000400160046004c00410047002d005300450052005600450052000300160046004c00410047002d0053004500520056004500520007000800ed3fabc7fb59dc0106000400020000000800300030000000000000000100000000200000c06bb8a56b86b084ba3cfc2b7e5a0eaef96088346e865b0c93bdd8b4de440ff70a001000000000000000000000000000000000000900200063006900660073002f0046004c00410047002d005300450052005600450052000000000000000000</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110221404842.png alt=/posts/8bf5633/imgs/image-20260110221404842.png height=926 width=1732></p><p>用wireshark导入密码后即可解密传输的文件</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110221514753.png alt=/posts/8bf5633/imgs/image-20260110221514753.png height=1423 width=2099></p><p>发现zip里只有一个exe文件，并且还是 zipcrypto+store，很明显提示了要明文攻击</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110221608590.png alt=/posts/8bf5633/imgs/image-20260110221608590.png height=293 width=1620></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110222053603.png alt=/posts/8bf5633/imgs/image-20260110222053603.png height=521 width=1814></p><p>然后IDA打开解压后得到的letter.exe，发现是rust写的，一坨shit</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110223317734.png alt=/posts/8bf5633/imgs/image-20260110223317734.png height=1775 width=3075></p><p>下个断点，直接启动动调后搜索flag即可：<code>flag{N0w_U-V1ctory}</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110224108190.png alt=/posts/8bf5633/imgs/image-20260110224108190.png height=1775 width=3075></p><h2 class=heading-element id=题目名称-blue><span>题目名称 blue</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-blue class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>蓝色的世界。</p></blockquote><p>附件给了一张png，stegsolve打开发现蓝色通道隐写了一个zip的hex数据</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110224835956.png alt=/posts/8bf5633/imgs/image-20260110224835956.png height=819 width=910></p><p>只不过这里的hex数据中插入了一些干扰的0，我们写个脚本提取一下即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;out.bin&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>b</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;zip_hex.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>提取出来的hex数据后面有干扰数据，因此我们可以手动转换一下</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110225835427.png alt=/posts/8bf5633/imgs/image-20260110225835427.png height=1749 width=3068></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110225823819.png alt=/posts/8bf5633/imgs/image-20260110225823819.png height=1389 width=1823></p><p>提取得到的压缩包中只有一张png，zipcrypto+store 很明显提示了明文攻击</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260110225936584.png alt=/posts/8bf5633/imgs/image-20260110225936584.png height=315 width=1620></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111130538826.png alt=/posts/8bf5633/imgs/image-20260111130538826.png height=926 width=1732></p><p>解压后得到xor.png</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111130624364.png alt=/posts/8bf5633/imgs/image-20260111130624364.png height=965 width=1615></p><p>010打开，发现末尾还有一张png</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111130713291.png alt=/posts/8bf5633/imgs/image-20260111130713291.png height=1387 width=1823></p><p>手动提取出来可以得到下图，放大后仔细看可以看到很多蓝色的横向分布的像素</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111130959003.png alt=/posts/8bf5633/imgs/image-20260111130959003.png height=999 width=1420></p><p>结合之前的图片名称xor，很容易联想到双图盲水印的一个考点：<code>原图和盲水印后的图像异或会得到下图这种横向蓝色虚线</code></p><p>因此，我们拿stegsolve异或一下这两张图片，然后再解个双图盲水印即可</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111131844294.png alt=/posts/8bf5633/imgs/image-20260111131844294.png height=878 width=1169></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111131955012.png alt=/posts/8bf5633/imgs/image-20260111131955012.png height=995 width=1512></p><p><code>flag{a5e2ffeb-133e-4eb0-9855-d4d0073326ee}</code></p><h2 class=heading-element id=题目名称-zipcracker><span>题目名称 ZipCracker</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-zipcracker class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>do u know zip and fm？</p></blockquote><p>附件给了个zip，经过尝试后发现是伪加密</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111132143243.png alt=/posts/8bf5633/imgs/image-20260111132143243.png height=402 width=1620></p><p>用010手动去除伪加密后解压，010打开其中的jpg，发现末尾有个zip</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111132406238.png alt=/posts/8bf5633/imgs/image-20260111132406238.png height=1387 width=1823></p><p>手动提取出来并解压可以得到两个txt</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111132510800.png alt=/posts/8bf5633/imgs/image-20260111132510800.png height=318 width=1620></p><p>然后再去看那个<code>do u know it</code>，发现是 GNU Radio 的 grc 文件</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111132544080.png alt=/posts/8bf5633/imgs/image-20260111132544080.png height=1424 width=2074></p><p>直接让AI快速搓个脚本还原一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scipy.io.wavfile</span> <span class=k>as</span> <span class=nn>wav</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_binary_float_file</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;读取二进制浮点数文件&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data_bytes</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 每个浮点数4字节</span>
</span></span><span class=line><span class=cl>    <span class=n>num_floats</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data_bytes</span><span class=p>)</span> <span class=o>//</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span> <span class=o>=</span> <span class=s1>&#39;f&#39;</span> <span class=o>*</span> <span class=n>num_floats</span>  <span class=c1># &#39;f&#39; 表示32位浮点数</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 解析二进制数据</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=n>fmt</span><span class=p>,</span> <span class=n>data_bytes</span><span class=p>[:</span><span class=n>num_floats</span><span class=o>*</span><span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 读取二进制数据</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;读取flag1.txt...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>real_part</span> <span class=o>=</span> <span class=n>read_binary_float_file</span><span class=p>(</span><span class=s1>&#39;flag1.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;读取flag2.txt...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imag_part</span> <span class=o>=</span> <span class=n>read_binary_float_file</span><span class=p>(</span><span class=s1>&#39;flag2.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;读取完成: real_part长度=</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>real_part</span><span class=p>)</span><span class=si>}</span><span class=s2>, imag_part长度=</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>imag_part</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 确保两个文件长度相同</span>
</span></span><span class=line><span class=cl><span class=n>min_len</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>real_part</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>imag_part</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>real_part</span> <span class=o>=</span> <span class=n>real_part</span><span class=p>[:</span><span class=n>min_len</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>imag_part</span> <span class=o>=</span> <span class=n>imag_part</span><span class=p>[:</span><span class=n>min_len</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 重构复数信号</span>
</span></span><span class=line><span class=cl><span class=n>signal_data</span> <span class=o>=</span> <span class=n>real_part</span> <span class=o>+</span> <span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=n>imag_part</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;复数信号长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>signal_data</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 参数（来自GRC流图）</span>
</span></span><span class=line><span class=cl><span class=n>if_rate</span> <span class=o>=</span> <span class=mi>192000</span>      <span class=c1># 576000 / 3</span>
</span></span><span class=line><span class=cl><span class=n>samp_rate</span> <span class=o>=</span> <span class=mi>48000</span>     <span class=c1># 音频采样率</span>
</span></span><span class=line><span class=cl><span class=n>max_dev</span> <span class=o>=</span> <span class=mi>5000</span>        <span class=c1># FM最大频偏</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. FM解调（相位差分法）</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;进行FM解调...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>phase</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>angle</span><span class=p>(</span><span class=n>signal_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>phase_diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>phase</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>phase_diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mod</span><span class=p>(</span><span class=n>phase_diff</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span>  <span class=c1># 处理相位跳变</span>
</span></span><span class=line><span class=cl><span class=n>audio_if</span> <span class=o>=</span> <span class=n>phase_diff</span> <span class=o>*</span> <span class=n>if_rate</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>max_dev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 下采样到音频采样率</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;下采样...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>factor</span> <span class=o>=</span> <span class=n>if_rate</span> <span class=o>//</span> <span class=n>samp_rate</span>  <span class=c1># 4倍下采样</span>
</span></span><span class=line><span class=cl><span class=c1># 使用平均下采样简化处理</span>
</span></span><span class=line><span class=cl><span class=n>audio_samp</span> <span class=o>=</span> <span class=n>audio_if</span><span class=p>[::</span><span class=n>factor</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 归一化</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;归一化...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>audio_samp</span> <span class=o>=</span> <span class=n>audio_samp</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>audio_samp</span><span class=p>))</span> <span class=o>*</span> <span class=mf>0.9</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. 保存音频</span>
</span></span><span class=line><span class=cl><span class=n>output_file</span> <span class=o>=</span> <span class=s1>&#39;recovered.wav&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;保存音频到 </span><span class=si>{</span><span class=n>output_file</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>wav</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=n>samp_rate</span><span class=p>,</span> <span class=n>audio_samp</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>完成！&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;音频已保存为: </span><span class=si>{</span><span class=n>output_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;采样率: </span><span class=si>{</span><span class=n>samp_rate</span><span class=si>}</span><span class=s2>Hz&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;时长: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>audio_samp</span><span class=p>)</span><span class=o>/</span><span class=n>samp_rate</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>秒&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;音频峰值: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>audio_samp</span><span class=p>))</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111133307556.png alt=/posts/8bf5633/imgs/image-20260111133307556.png height=1197 width=1768></p><p>发现是摩斯电码，对照着敲一下然后用Cyberchef转换一下即可得到 flag.zip 的解压密码：<code>114514350234114514</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111133434465.png alt=/posts/8bf5633/imgs/image-20260111133434465.png height=1131 width=3065></p><p>解压后可以得到一个flag.txt，内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{Y0u*****************!!!}</span></span></code></pre></td></tr></table></div></div><p>然后还有一个flag.zip，是 store+zipcrypto，很明显又是明文攻击</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111134330680.png alt=/posts/8bf5633/imgs/image-20260111134330680.png height=926 width=1732></p><p>解压后即可得到flag: <code>flag{Y0u_r_th3_Z1p_k1ng!!!!!}</code></p><h2 class=heading-element id=题目名称-whiteout><span>题目名称 whiteout</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-whiteout class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>一份离线备份的 Docker 镜像。</p></blockquote><p>题面提示了是导出的docker镜像，因此我们可以尝试直接用7z去解压</p><p><code>6ad10b1fede380e2db5571dfe343455d33dd1f07588368ff59ee2a9a826739a9\opt\app\</code>目录下有个<code>decode.py</code>，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># decode.py</span>
</span></span><span class=line><span class=cl><span class=n>KEY</span> <span class=o>=</span> <span class=mh>0x37</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>b</span> <span class=o>^</span> <span class=n>KEY</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;/opt/.data/.logs/syslog.bin&#34;</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>因此我们要去找这个文件，发现在<code>d53154d4f2499c5c31fdd61d359d2a9a0b9076ac639b102bb913c752f5769cfb\opt\.data\.logs\</code>目录下</p><p>直接提取出来然后改一下文件路径，用上面的脚本解密即可得到flag: <code>flag{docker_whiteout_forensics_is_fun}</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># decode.py</span>
</span></span><span class=line><span class=cl><span class=n>KEY</span> <span class=o>=</span> <span class=mh>0x37</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>b</span> <span class=o>^</span> <span class=n>KEY</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;syslog.bin&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;flag{docker_whiteout_forensics_is_fun}&#39;</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=题目名称-hidden><span>题目名称 Hidden</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-hidden class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>我们从一名嫌疑人的硬盘中恢复了这张图片。我们认为它不仅仅是一张普通的图片。对文件属性的初步分析没有结果，但我们怀疑需要一个密码才能解开秘密。请找出其中隐藏的数据。</p></blockquote><p>附件给了一张bmp图片，zsteg扫一下可以得到：<code>PixelWhisper</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111140513325.png alt=/posts/8bf5633/imgs/image-20260111140513325.png height=926 width=1732></p><p>然后把上面得到的内容作为密钥，解一下steghide即可得到flag: <code>flag{a9a3c2872e428b6d859a0e63458a43f8}</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111141219709.png alt=/posts/8bf5633/imgs/image-20260111141219709.png height=237 width=784></p><h2 class=heading-element id=题目名称-the_rogue_beacon><span>题目名称 The_Rogue_Beacon</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-the_rogue_beacon class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>某自动驾驶初创公司的测试车在进行极限速度测试时发生了数剧中断。竞争对手截获了测试期间的 CAN 总线广播数据。</p><p>我们需要评估这辆原型车的动力性能极限。附件是一个.pcap 文件，记录了底盘动力域（Chassis Domain）的所有通信。</p><p>请剥离出干扰数据，锁定车速信号，并向总部报告车辆达到的峰值速度发生的确切位置。</p></blockquote><p>根据车速一开始是不断增长的这个特点，筛选出车速信号的id是580</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111142736980.png alt=/posts/8bf5633/imgs/image-20260111142736980.png height=1423 width=2099></p><p>一直往下翻，发现包序号为12149的时候车速达到最大，sha256一下即可得到flag</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111143040004.png alt=/posts/8bf5633/imgs/image-20260111143040004.png height=1117 width=3036></p><p>因此最后的flag为：<code>9db878fd06dd7587a91c0fb600e0e9f7c3ea310e75f36253ef57ac2d92dd8c29</code></p><h2 class=heading-element id=题目名称-超越感官极致><span>题目名称 超越感官极致</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e8%b6%85%e8%b6%8a%e6%84%9f%e5%ae%98%e6%9e%81%e8%87%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>人間の感覚の極致を超えてみせる！おれは人間をやめるぞ！</p></blockquote><p>附件给了一张niko.png，010打开发现评论中有提示，并且文件末尾还有个zip</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111145731600.png alt=/posts/8bf5633/imgs/image-20260111145731600.png height=1387 width=1823></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111143420847.png alt=/posts/8bf5633/imgs/image-20260111143420847.png height=1387 width=1823></p><p>手动提取出来并解压，可以得到一张 ?.png</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111143521984.png alt=/posts/8bf5633/imgs/image-20260111143521984.png height=744 width=1162></p><p>经过尝试发现是IDAT块隐写</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111143815334.png alt=/posts/8bf5633/imgs/image-20260111143815334.png height=1387 width=1823></p><p>因此我们写个脚本，把上图中所有IDAT块的数据都提取出来并拼接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_idat_simple</span><span class=p>(</span><span class=n>png_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>png_file</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 读取并验证PNG文件头</span>
</span></span><span class=line><span class=cl>        <span class=n>header</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idat_data</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>chunk_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 读取块长度</span>
</span></span><span class=line><span class=cl>                <span class=n>len_bytes</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>length</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&gt;I&#39;</span><span class=p>,</span> <span class=n>len_bytes</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=c1># 读取块类型</span>
</span></span><span class=line><span class=cl>                <span class=n>chunk_type</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>chunk_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=c1># 读取块数据</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 跳过CRC</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 处理IDAT块</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>chunk_type</span> <span class=o>==</span> <span class=sa>b</span><span class=s1>&#39;IDAT&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>idat_data</span> <span class=o>+=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 正在处理IDAT块</span><span class=si>{</span><span class=n>chunk_count</span><span class=si>}</span><span class=s2>，长度: </span><span class=si>{</span><span class=n>length</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 如果是IEND块，结束</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>chunk_type</span> <span class=o>==</span> <span class=sa>b</span><span class=s1>&#39;IEND&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 到达IEND块，IDAT块提取完毕，共提取 </span><span class=si>{</span><span class=n>chunk_count</span><span class=si>}</span><span class=s2> 个块&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>struct</span><span class=o>.</span><span class=n>error</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>idat_data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>png_file</span> <span class=o>=</span> <span class=s1>&#39;？.png&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>extract_idat_simple</span><span class=p>(</span><span class=n>png_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(len(data))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(data.hex())</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;idat_hex.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span></span></span></code></pre></td></tr></table></div></div><p>提取出来后用CyberChef解压一下，暂时不知道是什么文件</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111145758744.png alt=/posts/8bf5633/imgs/image-20260111145758744.png height=1755 width=3071></p><p>结合之前图片评论中的 <code>key player</code> 以及现在得到的这个数据文件，猜测可能是VC加密容器，然后密钥文件就是那张Niko.png</p><p>挂载后发现可以得到一个<code>mystery_sound.wav</code>，Audacity打开，波形图中可以看到有余弦和正弦波</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111150204881.png alt=/posts/8bf5633/imgs/image-20260111150204881.png height=1341 width=2051></p><p>然后频谱图中可以看到，音频在时间上存在明显的周期，下图中每一小段都是在0.4秒左右</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111151251145.png alt=/posts/8bf5633/imgs/image-20260111151251145.png height=1341 width=2051></p><p>并且我们尝试播放，会发现这里的每一小段，有的是有声音，但是有的又是没有声音的</p><p>结合题目名称<code>超越感官极致</code>，猜测这些听不到的地方才是题目考察的重点</p><p>然后谷歌一下很容易找到人耳能听到的声音频率范围是 20 Hz 到 20,000 Hz（20 kHz）</p><p>结合上面的频谱图，我们应该考虑的就只有2种情况的，一种是小于20hz的，另一种就是大于20000hz的</p><p>我们写个脚本提取一下，并把这2种情况分别对应到二进制的0和1上</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.io</span> <span class=kn>import</span> <span class=n>wavfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_frequency_every_04s</span><span class=p>(</span><span class=n>wav_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sample_rate</span><span class=p>,</span> <span class=n>audio_data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>wav_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>window_size</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=mf>0.4</span> <span class=o>*</span> <span class=n>sample_rate</span><span class=p>)</span>  <span class=c1># 0.4秒窗口</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>audio_data</span><span class=p>),</span> <span class=n>window_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=n>window_size</span> <span class=o>&gt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>audio_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=c1># 获取窗口数据</span>
</span></span><span class=line><span class=cl>        <span class=n>window</span> <span class=o>=</span> <span class=n>audio_data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=n>window_size</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># 应用窗函数</span>
</span></span><span class=line><span class=cl>        <span class=n>window</span> <span class=o>=</span> <span class=n>window</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>hanning</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>window</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># FFT分析</span>
</span></span><span class=line><span class=cl>        <span class=n>fft_result</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fft</span><span class=p>(</span><span class=n>window</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>frequencies</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fftfreq</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>window</span><span class=p>),</span> <span class=mi>1</span><span class=o>/</span><span class=n>sample_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 取正频率部分</span>
</span></span><span class=line><span class=cl>        <span class=n>positive_freq_mask</span> <span class=o>=</span> <span class=n>frequencies</span> <span class=o>&gt;=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>positive_freqs</span> <span class=o>=</span> <span class=n>frequencies</span><span class=p>[</span><span class=n>positive_freq_mask</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>positive_magnitude</span> <span class=o>=</span> <span class=n>fft_result</span><span class=p>[</span><span class=n>positive_freq_mask</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># 找到主频（跳过直流分量）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>positive_magnitude</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 找幅度最大的频率</span>
</span></span><span class=line><span class=cl>            <span class=n>dominant_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>positive_magnitude</span><span class=p>[</span><span class=mi>5</span><span class=p>:])</span> <span class=o>+</span> <span class=mi>5</span>  <span class=c1># 跳过前几个低频分量</span>
</span></span><span class=line><span class=cl>            <span class=n>dominant_freq</span> <span class=o>=</span> <span class=n>positive_freqs</span><span class=p>[</span><span class=n>dominant_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>time_mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=n>window_size</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=n>sample_rate</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>time_mid</span><span class=p>,</span> <span class=n>dominant_freq</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>wav_file</span> <span class=o>=</span> <span class=s2>&#34;mystery_sound.wav&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>frequencies</span> <span class=o>=</span> <span class=n>get_frequency_every_04s</span><span class=p>(</span><span class=n>wav_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;分析文件: </span><span class=si>{</span><span class=n>wav_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;时间(秒) | 频率(Hz)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-&#34;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span><span class=p>,</span> <span class=n>freq</span> <span class=ow>in</span> <span class=n>frequencies</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>time</span><span class=si>:</span><span class=s2>7.2f</span><span class=si>}</span><span class=s2> | </span><span class=si>{</span><span class=n>freq</span><span class=si>:</span><span class=s2>8.1f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>freq</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>+=</span> <span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>freq</span> <span class=o>&gt;</span> <span class=mi>20000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>+=</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># 分析文件: mystery_sound.wav</span>
</span></span><span class=line><span class=cl><span class=c1># 时间(秒) | 频率(Hz)</span>
</span></span><span class=line><span class=cl><span class=c1># ------------------------------</span>
</span></span><span class=line><span class=cl><span class=c1>#    0.20 |  21420.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    0.60 |  15610.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    1.00 |  21705.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    1.40 |   7885.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    1.80 |     17.5</span>
</span></span><span class=line><span class=cl><span class=c1>#    2.20 |  18272.5</span>
</span></span><span class=line><span class=cl><span class=c1>#    2.60 |     12.5</span>
</span></span><span class=line><span class=cl><span class=c1>#    3.00 |  10612.5</span>
</span></span><span class=line><span class=cl><span class=c1>#    3.40 |  21430.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    3.80 |   8610.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    4.20 |  20230.0</span>
</span></span><span class=line><span class=cl><span class=c1>#    4.60 |   7212.5</span>
</span></span><span class=line><span class=cl><span class=c1>#    5.00 |     12.5</span>
</span></span><span class=line><span class=cl><span class=c1>#        ...</span>
</span></span><span class=line><span class=cl><span class=c1>#  331.80 |   1587.5</span>
</span></span><span class=line><span class=cl><span class=c1>#  332.20 |  20680.0</span>
</span></span><span class=line><span class=cl><span class=c1>#  332.60 |  17495.0</span>
</span></span><span class=line><span class=cl><span class=c1>#  333.00 |  20915.0</span>
</span></span><span class=line><span class=cl><span class=c1>#  333.40 |  14415.0</span>
</span></span><span class=line><span class=cl><span class=c1>#  333.80 |  20392.5</span>
</span></span><span class=line><span class=cl><span class=c1>#  334.20 |   7647.5</span>
</span></span><span class=line><span class=cl><span class=c1>#  334.60 |     12.5</span>
</span></span><span class=line><span class=cl><span class=c1>#  335.00 |    787.5</span>
</span></span><span class=line><span class=cl><span class=c1>#  335.40 |  21215.0</span>
</span></span><span class=line><span class=cl><span class=c1>#  335.80 |  17547.5</span>
</span></span><span class=line><span class=cl><span class=c1># 110011011011001100001110011111110111001111110111001100011111001101111111000101111001101111111100001101001011001111100101100011110100111011100111001101111101101111101000110010110111110110101111010111100101100110100000011000111100101101111110000110110100110111010111110110000110111011001011011111111010111011101100011011000011101100110011111001010111111110100110100001100111011111011011111100101110101111010011010001111101</span></span></span></code></pre></td></tr></table></div></div><p>最后7位二进制一组转为ASCII即可得到flag：<code>flag{On1y_by_pi3rcin9_7he_5urf@ce_C4n_0ne_unc0v3r_th3_7ruth}</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111152812608.png alt=/posts/8bf5633/imgs/image-20260111152812608.png height=1096 width=1502></p><h2 class=heading-element id=题目名称-punkface><span>题目名称 PunkFace</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-punkface class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>look。</p></blockquote><p>附件给了一个docx文件，文件有点大，将近90MB</p><p>因此我们改后缀为.zip后解压</p><p><code>PunkFace\word\media</code>路径下有两张png</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153409459.png alt=/posts/8bf5633/imgs/image-20260111153409459.png height=215 width=419></p><p>我们拿stegsolve打开image1.png，发现RGB的<code>plane 4</code>中有明显LSB的痕迹</p><table><thead><tr><th style=text-align:center><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153540399.png alt=/posts/8bf5633/imgs/image-20260111153540399.png height=590 width=780></th><th style=text-align:center><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153547760.png alt=/posts/8bf5633/imgs/image-20260111153547760.png height=590 width=780></th><th style=text-align:center><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153553952.png alt=/posts/8bf5633/imgs/image-20260111153553952.png height=590 width=780></th></tr></thead><tbody></tbody></table><p>发现LSB隐写了一张png图片</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153636697.png alt=/posts/8bf5633/imgs/image-20260111153636697.png height=598 width=764></p><p>提取出来后可以得到下图</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111153738731.png alt=/posts/8bf5633/imgs/image-20260111153738731.png height=1290 width=2049></p><p>发现图片中有字符，但不是很清晰，因此我们可以调整一下</p><p><img loading=lazy src=/posts/8bf5633/imgs/2.png alt=/posts/8bf5633/imgs/2.png height=662 width=1020></p><p>图中的内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>4e 65 74 77 6f 72 6b 20 73 65 63 75 72 69 74 79 20 69 73 20 61 6e 20 75 6d 62 72
</span></span><span class=line><span class=cl>65 6c 6c 61 20 74 65 72 6d 20 74 6f 20 64 65 73 63 72 69 62 65 20 73 65 63 75 72
</span></span><span class=line><span class=cl>69 74 79 20 63 6f 6e 74 72 6f 6c 73 2c 20 70 6f 6c 69 63 69 65 73 2c 20 70 72 6f 63
</span></span><span class=line><span class=cl>65 73 73 65 73 20 61 6e 64 20 70 72 61 63 74 69 63 65 73 20 61 64 6f 70 74 65 64
</span></span><span class=line><span class=cl>20 74 6f 20 70 72 65 76 65 6e 74 2c 20 64 65 74 65 63 74 20 61 6e 64 20 6d 6f 6e 69
</span></span><span class=line><span class=cl>74 6f 72 20 75 6e 61 75 74 68 6f 72 69 7a 65 64 20 61 63 63 65 73 73 2c 20 6d 69 73
</span></span><span class=line><span class=cl>75 73 65 2c 20 6d 6f 64 69 66 69 63 61 74 69 6f 6e 2c 20 6f 72 20 64 65 6e 69 61 6c
</span></span><span class=line><span class=cl>20 6f 66 20 61 20 63 6f 6d 70 75 74 65 72 20 6e 65 74 77 6f 72 6b 20 61 6e 64 20 6e
</span></span><span class=line><span class=cl>65 74 77 6f 72 6b 2d 61 63 63 65 73 73 69 62 6c 65 20 72 65 73 6f 75 72 63 65 73 2e
</span></span><span class=line><span class=cl>4e 65 74 77 6f 72 6b 20 73 65 63 75 72 69 74 79 20 69 6e 76 6f 6c 76 65 73 20 74 68
</span></span><span class=line><span class=cl>65 20 61 75 74 68 6f 72 69 7a 61 74 69 6f 6e 20 6f 66 20 61 63 63 65 73 73 20 74 6f
</span></span><span class=line><span class=cl>20 64 61 74 61 20 69 6e 20 61 20 6e 65 74 77 6f 72 6b 20 76 65 72 61 63 72 79 70
</span></span><span class=line><span class=cl>74 2c 20 77 68 69 63 68 20 69 73 20 63 6f 6e 74 72 6f 6c 6c 65 64 20 62 79 20 74 68
</span></span><span class=line><span class=cl>65 20 6e 65 74 77 6f 72 6b 20 61 20 69 73 20 36 3f 2c 20 62 20 69 73 20 3f 37 2c 20
</span></span><span class=line><span class=cl>73 20 69 73 20 3f 2c 20 61 64 6d 69 6e 69 73 74 72 61 74 6f 72 2e 20 55 73 65 72 73
</span></span><span class=line><span class=cl>20 63 68 6f 6f 73 65 20 6f 72 20 61 72 65 20 61 73 73 69 67 6e 65 64</span></span></code></pre></td></tr></table></div></div><p>拿CyberChef转一下可以得到如下内容</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111154151641.png alt=/posts/8bf5633/imgs/image-20260111154151641.png height=1194 width=3068></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Network security is an umbrella term to describe security controls, policies, processes and practices adopted to prevent, detect and monitor unauthorized access, misuse, modification, or denial of a computer network and network-accessible resources.Network security involves the authorization of access to data in a network veracrypt, which is controlled by the network a is 6?, b is ?7, s is ?, administrator. Users choose or are assigned</span></span></code></pre></td></tr></table></div></div><p>其中给了一个关键的提示：<code>a is 6?, b is ?7, s is ?</code>，猜测是Arnold变换的参数</p><p>最后爆破得到的参数为：<code>a = 68, b = 77, s = 8</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111154751274.png alt=/posts/8bf5633/imgs/image-20260111154751274.png height=793 width=1165></p><p><code>CCC35EF6EC2A7F5C67B2A3DA51C78DBB</code></p><p>然后再回头去看那个PunkFace\word\document.xml，这个docx很大的原因基本上就是出在这个文件上</p><p>这一个xml就有 84.2MB</p><p>这里的分析是参考：https://www.aristore.top/posts/PengChengBei2025/#PunkFace-%E6%9C%AA%E5%AE%8C%E6%88%90</p><p><code>&lt;w:r></code>标签中隐写了RGB像素值，可以用如下脚本提取出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_closest_dimensions</span><span class=p>(</span><span class=n>total</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>root</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>total</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>total</span> <span class=o>%</span> <span class=n>w</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>h</span> <span class=o>=</span> <span class=n>total</span> <span class=o>//</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span><span class=p>,</span> <span class=n>total</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;document.xml&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>FileNotFoundError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 提取被单独封装在一个 Run 里的彩色空格</span>
</span></span><span class=line><span class=cl>    <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;&lt;w:r&gt;&lt;w:rPr&gt;&lt;w:color w:val=&#34;([0-9A-Fa-f]</span><span class=si>{6}</span><span class=s1>)&#34;/&gt;&lt;/w:rPr&gt;&lt;w:t xml:space=&#34;preserve&#34;&gt; &lt;/w:t&gt;&lt;/w:r&gt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>colors</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>total_pixels</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>colors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>total_pixels</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 计算宽高</span>
</span></span><span class=line><span class=cl>    <span class=n>w_base</span><span class=p>,</span> <span class=n>h_base</span> <span class=o>=</span> <span class=n>get_closest_dimensions</span><span class=p>(</span><span class=n>total_pixels</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dimensions</span> <span class=o>=</span> <span class=p>[(</span><span class=n>w_base</span><span class=p>,</span> <span class=n>h_base</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>w_base</span> <span class=o>!=</span> <span class=n>h_base</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>dimensions</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>h_base</span><span class=p>,</span> <span class=n>w_base</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>dimensions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>total_pixels</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>hex_color</span> <span class=o>=</span> <span class=n>colors</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>hex_color</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>hex_color</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>4</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>hex_color</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>6</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>x</span> <span class=o>=</span> <span class=n>i</span> <span class=o>%</span> <span class=n>width</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=n>i</span> <span class=o>//</span> <span class=n>width</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;result.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本后可以得到下图</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111155738944.png alt=/posts/8bf5633/imgs/image-20260111155738944.png height=1350 width=2160></p><p>图片的宽高也很可疑，是1024x1024的，并且每个像素点都是RGB，因此总大小就是3MB</p><p>写个脚本提取一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;result.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl><span class=n>pixel_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># pixel_list.append((r,g,b))</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>r</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>g</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>b</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>hex_data</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>pixel_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>byte_data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>hex_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;output&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>byte_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># print(pixel_list[:100])</span></span></span></code></pre></td></tr></table></div></div><p>结合之前得到的那串字符串，以及这个文件大小，猜测是VC加密容器，挂载密钥就是 <code>CCC35EF6EC2A7F5C67B2A3DA51C78DBB</code></p><p>挂载后可以得到一张 punkworld.png</p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111161503439.png alt=/posts/8bf5633/imgs/image-20260111161503439.png height=795 width=1169></p><p>发现是打乱过的拼图，一共16x16=256块碎片，直接用工具拼一下图即可得到最后的flag</p><p><code>flag{0671b07f6b7908bd718dc969b056ab26}</code></p><p><img loading=lazy src=/posts/8bf5633/imgs/image-20260111162109683.png alt=/posts/8bf5633/imgs/image-20260111162109683.png height=913 width=1568></p><h2 class=heading-element id=题目名称-time><span>题目名称 time</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-time class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>What time is it?（flag 为全小写）</p></blockquote><p>题目附件给了个elf可执行文件</p><p>远程交互题，大概意思就是给你base64，解码出来是张带有时间的图片，需要在2秒内告诉远程，图片中显示的是几点</p><p>题目本身不难，就是根据题意写脚本+明文攻击</p><p>比赛已结束，我这里无法复现，感兴趣的师傅可以参考 <a href=https://bili33.top/posts/CTF-PCB2025-Preliminary-Round-Writeup/#time-Solved target=_blank rel="external nofollow noopener noreferrer">这篇文章</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2026-01-10 21:53:27">更新于 2026-01-10&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/8bf5633/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/8bf5633/ data-title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup" data-hashtags=CTF,Misc,Writeup><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/8bf5633/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/8bf5633/ data-title="2025 鹏城杯联邦网络靶场协同攻防演练 Misc Writeup"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/misc/ class=post-tag title="标签 - Misc">Misc</a><a href=/tags/writeup/ class=post-tag title="标签 - Writeup">Writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/6cc9a96/ class=post-nav-item rel=prev title="2025 年终总结"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>2025 年终总结</a><a href=/posts/911b6a0/ class=post-nav-item rel=next title="[持续更新] 记录各种app关闭广告和推荐的方法">[持续更新] 记录各种app关闭广告和推荐的方法<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2026</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/8bf5633/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>