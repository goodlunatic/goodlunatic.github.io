<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>2024 某金融系统内部赛 Misc Writeup - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="不知道具体是什么比赛，但是赛题还是有一定的强度的
"><meta name=keywords content='CTF,Misc,Writeup'><meta itemprop=name content="2024 某金融系统内部赛 Misc Writeup"><meta itemprop=description content="不知道具体是什么比赛，但是赛题还是有一定的强度的"><meta itemprop=datePublished content="2024-11-05T10:21:35+08:00"><meta itemprop=dateModified content="2024-11-05T10:21:35+08:00"><meta itemprop=wordCount content="3681"><meta itemprop=keywords content="CTF,Misc,Writeup"><meta property="og:url" content="https://goodlunatic.github.io/posts/69280be/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="2024 某金融系统内部赛 Misc Writeup"><meta property="og:description" content="不知道具体是什么比赛，但是赛题还是有一定的强度的"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-05T10:21:35+08:00"><meta property="article:modified_time" content="2024-11-05T10:21:35+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><meta property="article:tag" content="Writeup"><meta name=twitter:card content="summary"><meta name=twitter:title content="2024 某金融系统内部赛 Misc Writeup"><meta name=twitter:description content="不知道具体是什么比赛，但是赛题还是有一定的强度的"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/69280be/ title="2024 某金融系统内部赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/01ebd40/ title="CTF-ICS Learning Record"><link rel=next type=text/html href=https://goodlunatic.github.io/posts/e19da63/ title="Python Basic Knowledge"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/69280be/index.md title="2024 某金融系统内部赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"2024 某金融系统内部赛 Misc Writeup","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/69280be\/"},"genre":"posts","keywords":"CTF, Misc, Writeup","wordcount":3681,"url":"https:\/\/goodlunatic.github.io\/posts\/69280be\/","datePublished":"2024-11-05T10:21:35+08:00","dateModified":"2024-11-05T10:21:35+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/1eae35a/ title="2024 睿抗机器人开发者大赛（RAICOM）网络安全赛道初赛 Misc Writeup">2024 睿抗机器人开发者大赛（RAICOM）网络安全赛道初赛 Misc Writeup</a></li><li class=related-item><a href=/posts/4a27616/ title="2024 羊城杯网络安全大赛 Misc Writeup">2024 羊城杯网络安全大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/067cfbd/ title="2024 DASCTF 暑期挑战赛 Misc Writeup">2024 DASCTF 暑期挑战赛 Misc Writeup</a></li><li class=related-item><a href=/posts/5de0d7e/ title="2023 春秋杯冬季赛 Misc Writeup">2023 春秋杯冬季赛 Misc Writeup</a></li><li class=related-item><a href=/posts/2125dc5/ title="2024 WKCTF Misc Writeup">2024 WKCTF Misc Writeup</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>2024 某金融系统内部赛 Misc Writeup</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/writeup/ class=post-category title="分类 - Writeup"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Writeup</a></span></div><div class=post-meta-line><span title="发布于 2024-11-05 10:21:35"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2024-11-05>2024-11-05</time></span>&nbsp;<span title="3681 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 3700 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 18 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="2024 某金融系统内部赛 Misc Writeup"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#题目名称-x0r>题目名称 X0r</a></li><li><a href=#题目名称-add>题目名称 add</a></li><li><a href=#题目名称-finder>题目名称 Finder</a></li></ul></nav></div></div><div class=content id=content><p><strong>不知道具体是什么比赛，但是赛题还是有一定的强度的</strong></p><blockquote><p>本文中涉及的具体题目附件可以进我的交流群获取，进群详见 <a href=https://goodlunatic.github.io/about/ target=_blank rel="external nofollow noopener noreferrer">About</a></p></blockquote><h2 class=heading-element id=题目名称-x0r><span>题目名称 X0r</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-x0r class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>X0r is just a commonly used simple encryption</p></blockquote><p>题目附件给了一个 enc.txt，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ys~xdg/m@]mjkz@vl@z~lf&gt;b</span></span></code></pre></td></tr></table></div></div><p>直接拉进CyberChef用 XOR Brute Force 一把梭就行</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105102637102.png alt=/posts/69280be/imgs/image-20241105102637102.png height=984 width=1915></p><p><code>flag{x0r_Brute_is_easy!}</code></p><h2 class=heading-element id=题目名称-add><span>题目名称 add</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-add class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，得到以下两张图片</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105102829362.png alt=/posts/69280be/imgs/image-20241105102829362.png height=203 width=598></p><p>根据第二章图片的名字<code>noflag</code>提示了flag可能不在这张图片里，因此我们把注意力集中到第一张图片上</p><p>用stegsolve打开add.png，发现有好几个通道存在LSB隐写的痕迹，然后观察到不同的通道背景不同</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103011162.png alt=/posts/69280be/imgs/image-20241105103011162.png height=656 width=865></p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103016195.png alt=/posts/69280be/imgs/image-20241105103016195.png height=656 width=865></p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103021708.png alt=/posts/69280be/imgs/image-20241105103021708.png height=655 width=865></p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103026021.png alt=/posts/69280be/imgs/image-20241105103026021.png height=656 width=866></p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103031009.png alt=/posts/69280be/imgs/image-20241105103031009.png height=656 width=865></p><p>我们在stegsolve中使用 data extract 把黑色背景并且带有LSB隐写的通道勾选上即可得到flag</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103146312.png alt=/posts/69280be/imgs/image-20241105103146312.png height=668 width=865></p><p><code>flag{24aa07d8-8662-718a-9da8-a2628e779e40}</code></p><p>其实这里也算是非预期了吧，预期解应该是根据图片的文件名add想到使用 Image Conbiner 把两张图片和一起</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241106154638906.png alt=/posts/69280be/imgs/image-20241106154638906.png height=1529 width=2561></p><p>合成后导出为bmp，然后再用zsteg扫描得到flag</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241106154704872.png alt=/posts/69280be/imgs/image-20241106154704872.png height=628 width=1115></p><h2 class=heading-element id=题目名称-finder><span>题目名称 Finder</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-finder class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>解压附件压缩包，得到如下几个文件</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103254808.png alt=/posts/69280be/imgs/image-20241105103254808.png height=183 width=689></p><p><code>readme.txt</code>中的内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>某大型企业为了保护其内部数据安全，已经实施了严格的访问控制措施，并且在每位员工的电脑上安装了数字水印软件。这个软件会在员工处理的所有文档中嵌入一个独特的标识符，该标识符由员工的名字和手机号码后四位组成，用以追踪任何可能的数据泄露事件。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>最近，这家企业发现了一些包含敏感信息的文件被非法传播到了外部。基于此情况，怀疑是某些内部员工违反规定将这些文档外泄。为了解决这个问题并找出责任人，企业现在提供了一个用于生成这些数字水印的具体算法。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>接下来，请你协助该企业安全部门提取文档中嵌入的员工信息，任务如下：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 对泄漏的三个文档进行分析，提取出每个文档中嵌入的员工信息。
</span></span><span class=line><span class=cl>2. 找出所有泄漏文档中的员工信息，请将这些信息按首字母顺序依次排列，形如“Albert1234_Bili5678”的字符串。
</span></span><span class=line><span class=cl>3. 对改字符串进行MD5计算，并将生成的32位小写MD5值包裹上flag{}提交至平台即可。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>A large enterprise has implemented strict access control measures to protect its internal data security and has installed digital watermarking software on every employee&#39;s computer. This software embeds a unique identifier in all documents processed by employees, consisting of the employee&#39;s name and the last four digits of their mobile phone number, to track any potential data leakage incidents.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Recently, the enterprise discovered that some files containing sensitive information had been illegally disseminated externally. Based on this situation, there are suspicions that some internal employees violated regulations and leaked these documents. To address this issue and identify the responsible parties, the enterprise is now providing a specific algorithm to generate these digital watermarks.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Next, please assist the enterprise&#39;s security department in extracting the embedded employee information from the documents. The tasks are as follows:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Analyze the three leaked documents to extract the embedded employee information from each document.
</span></span><span class=line><span class=cl>2. Identify all employee information from the leaked documents and arrange this information in alphabetical order, formatted as strings like “Albert1234_Bili5678”
</span></span><span class=line><span class=cl>3. Perform an MD5 hash calculation on the resulting string and submit the generated 32-character lowercase MD5 value wrapped in flag{} to the platform.</span></span></code></pre></td></tr></table></div></div><p>所以题目的意思大概就是让我们提取嵌在三个<code>xlsx</code>文件中的水印</p><p><code>Excel_enc.py</code> 中的内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span> 
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MagicText</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span> <span class=p>(</span><span class=n>O0O00OO00O0OO0OOO</span> <span class=p>,</span><span class=n>OO0O00OOO00OOOO00</span> <span class=p>,</span><span class=n>chr_type</span> <span class=o>=</span><span class=p>(</span><span class=mi>4</span> <span class=p>,</span><span class=mi>5</span> <span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>O0O00OO00O0OO0OOO</span> <span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>=</span><span class=n>O0O00OO00O0OO0OOO</span> <span class=o>.</span><span class=n>_create_char_dict</span> <span class=p>(</span><span class=n>chr_type</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>O0O00OO00O0OO0OOO</span> <span class=o>.</span><span class=n>char2bit_dict</span> <span class=o>=</span><span class=p>{</span><span class=n>O0O0OO00000O0OOOO</span> <span class=p>:</span><span class=n>O0OOOO0O0O00OO00O</span> <span class=k>for</span> <span class=n>O0OOOO0O0O00OO00O</span> <span class=p>,</span><span class=n>O0O0OO00000O0OOOO</span> <span class=ow>in</span> <span class=n>O0O00OO00O0OO0OOO</span> <span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>.</span><span class=n>items</span> <span class=p>()}</span>
</span></span><span class=line><span class=cl>        <span class=n>O0O00OO00O0OO0OOO</span> <span class=o>.</span><span class=n>password</span> <span class=o>=</span><span class=n>OO0O00OOO00OOOO00</span> 
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_create_char_dict</span> <span class=p>(</span><span class=n>OO00OO00OO0OO0O00</span> <span class=p>,</span><span class=n>OOOOOO0O000O000O0</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>OOOOOO000O0O0OO00</span> <span class=o>=</span><span class=p>(</span><span class=s1>&#39;200D&#39;</span><span class=p>,</span><span class=s1>&#39;FEFF&#39;</span><span class=p>,</span><span class=s1>&#39;200B&#39;</span><span class=p>,</span><span class=s1>&#39;1d&#39;</span><span class=p>,</span><span class=s1>&#39;200C&#39;</span><span class=p>,</span><span class=s1>&#39;7F&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>OO00OO0O0O0O00O00</span> <span class=o>=</span><span class=p>[</span><span class=nb>chr</span> <span class=p>(</span><span class=nb>int</span> <span class=p>(</span><span class=n>OOOOOO000O0O0OO00</span> <span class=p>[</span><span class=n>O0O0000O0O0000O00</span> <span class=p>],</span><span class=mi>16</span> <span class=p>))</span><span class=k>for</span> <span class=n>O0O0000O0O0000O00</span> <span class=ow>in</span> <span class=n>OOOOOO0O000O000O0</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;0&#39;</span><span class=p>:</span><span class=n>OO00OO0O0O0O00O00</span> <span class=p>[</span><span class=mi>0</span> <span class=p>],</span><span class=s1>&#39;1&#39;</span><span class=p>:</span><span class=n>OO00OO0O0O0O00O00</span> <span class=p>[</span><span class=mi>1</span> <span class=p>]}</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_secret_bin</span> <span class=p>(</span><span class=n>O0OOO00OO0O0O0OOO</span> <span class=p>,</span><span class=n>OOOOOOO0000O00000</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>random</span> <span class=o>.</span><span class=n>seed</span> <span class=p>(</span><span class=n>O0OOO00OO0O0O0OOO</span> <span class=o>.</span><span class=n>password</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=nb>format</span> <span class=p>(</span><span class=n>O0OOOO0OOOOOOOO0O</span> <span class=o>^</span><span class=n>random</span> <span class=o>.</span><span class=n>randint</span> <span class=p>(</span><span class=mi>0</span> <span class=p>,</span><span class=mi>255</span> <span class=p>),</span><span class=s1>&#39;08b&#39;</span><span class=p>)</span><span class=k>for</span> <span class=n>O0OOOO0OOOOOOOO0O</span> <span class=ow>in</span> <span class=n>OOOOOOO0000O00000</span> <span class=o>.</span><span class=n>encode</span> <span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_secret</span> <span class=p>(</span><span class=n>OOOO000OO00OOO000</span> <span class=p>,</span><span class=n>O000O0OOO00OOOOOO</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>O0000OO0O00O0O00O</span> <span class=o>=</span><span class=n>OOOO000OO00OOO000</span> <span class=o>.</span><span class=n>_generate_secret_bin</span> <span class=p>(</span><span class=n>O000O0OOO00OOOOOO</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=n>OOOO000OO00OOO000</span> <span class=o>.</span><span class=n>bit2char_dict</span> <span class=p>[</span><span class=n>O0O00O00O00OO0O00</span> <span class=p>]</span><span class=k>for</span> <span class=n>O0O00O00O00OO0O00</span> <span class=ow>in</span> <span class=n>O0000OO0O00O0O00O</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_secret</span> <span class=p>(</span><span class=n>O000O00O0O0O00O0O</span> <span class=p>,</span><span class=n>OOOOOOOO000000O00</span> <span class=p>,</span><span class=n>O00OO0O0OO0OO0OO0</span> <span class=p>,</span><span class=n>idx</span> <span class=o>=</span><span class=kc>None</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>OOOOOOOO000000O00</span> <span class=o>=</span><span class=n>O000O00O0O0O00O0O</span> <span class=o>.</span><span class=n>remove_secret</span> <span class=p>(</span><span class=n>OOOOOOOO000000O00</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>O0000O00OO0OO0OO0</span> <span class=o>=</span><span class=n>O000O00O0O0O00O0O</span> <span class=o>.</span><span class=n>extract_secret</span> <span class=p>(</span><span class=n>O00OO0O0OO0OO0OO0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span><span class=n>idx</span> <span class=k>if</span> <span class=n>idx</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>random</span> <span class=o>.</span><span class=n>randint</span> <span class=p>(</span><span class=mi>0</span> <span class=p>,</span><span class=nb>len</span> <span class=p>(</span><span class=n>OOOOOOOO000000O00</span> <span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>OOOOOOOO000000O00</span> <span class=p>[:</span><span class=n>idx</span> <span class=p>]</span><span class=o>+</span><span class=n>O0000O00OO0OO0OO0</span> <span class=o>+</span><span class=n>OOOOOOOO000000O00</span> <span class=p>[</span><span class=n>idx</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>remove_secret</span> <span class=p>(</span><span class=n>O0OOO0OOOO000O0O0</span> <span class=p>,</span><span class=n>O0OOO000O0OOO0O00</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=n>O00O0O0OO000000O0</span> <span class=k>for</span> <span class=n>O00O0O0OO000000O0</span> <span class=ow>in</span> <span class=n>O0OOO000O0OOO0O00</span> <span class=k>if</span> <span class=n>O00O0O0OO000000O0</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>O0OOO0OOOO000O0O0</span> <span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>.</span><span class=n>values</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span><span class=s1>&#39;20241024&#39;</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>text_secret</span> <span class=o>=</span><span class=n>MagicText</span> <span class=p>(</span><span class=n>password</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>text_with_secret</span> <span class=o>=</span><span class=n>text_secret</span> <span class=o>.</span><span class=n>add_secret</span> <span class=p>(</span><span class=n>text</span> <span class=p>,</span><span class=n>secret</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=n>text_with_secret</span> <span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>发现对Python代码使用了<code>oxyxy</code>混淆，代码不是很长，因此可以尝试手动替换去混淆</p><p>我们尝试把xlsx文件的后缀改为zip并解压，然后在<code>sharedString.xml</code>文件中发现奇怪的字符</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103615361.png alt=/posts/69280be/imgs/image-20241105103615361.png height=247 width=1782></p><p>我们使用010打开这个文件</p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105103720888.png alt=/posts/69280be/imgs/image-20241105103720888.png height=929 width=1301></p><p>经过尝试，我们发现这一段由<code>\x7f</code>和<code>\xe2808c</code>组成的字符，刚刚好对应之前加密代码中的<code>\u200c</code>和<code>\x7f</code></p><p>因此可以确定，这一段数据就是出题人添加的水印，然后我们简单逆向一下上面的加密代码</p><p>将<code>sharedString.xml</code>文件里的水印数据的<code>Hex</code>数据复制出来，提取水印即可得到员工信息</p><p>然后将员工信息按照字母顺序用<code>_</code>连接起来，MD5加密一下即可得到flag：<code>flag{34a1660a5ae4aa7e423bcac3262ff16c}</code></p><p><img loading=lazy src=/posts/69280be/imgs/image-20241105104214877.png alt=/posts/69280be/imgs/image-20241105104214877.png height=1031 width=1917></p><p>完整解题代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span> 
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MagicText</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>chr_type</span> <span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>=</span><span class=bp>self</span> <span class=o>.</span><span class=n>_create_char_dict</span><span class=p>(</span><span class=n>chr_type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(self.bit2char_dict) # {&#39;0&#39;: &#39;\u200c&#39;, &#39;1&#39;: &#39;\x7f&#39;}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>char2bit_dict</span> <span class=o>=</span><span class=p>{</span><span class=n>char</span><span class=p>:</span><span class=n>bit</span> <span class=k>for</span> <span class=n>bit</span> <span class=p>,</span><span class=n>char</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>.</span><span class=n>items</span> <span class=p>()}</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(self.char2bit_dict) # {&#39;\u200c&#39;: &#39;0&#39;, &#39;\x7f&#39;: &#39;1&#39;}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>password</span> <span class=o>=</span><span class=n>password</span> 
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_create_char_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>chr_type</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>special_chars</span> <span class=o>=</span><span class=p>(</span><span class=s1>&#39;200D&#39;</span><span class=p>,</span><span class=s1>&#39;FEFF&#39;</span><span class=p>,</span><span class=s1>&#39;200B&#39;</span><span class=p>,</span><span class=s1>&#39;1d&#39;</span><span class=p>,</span><span class=s1>&#39;200C&#39;</span><span class=p>,</span><span class=s1>&#39;7F&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>characters</span> <span class=o>=</span><span class=p>[</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>special_chars</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=mi>16</span> <span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>chr_type</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># print({&#39;0&#39;:characters [0],&#39;1&#39;:characters [1]})</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;0&#39;</span><span class=p>:</span><span class=n>characters</span> <span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=s1>&#39;1&#39;</span><span class=p>:</span><span class=n>characters</span> <span class=p>[</span><span class=mi>1</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_secret_bin</span> <span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=nb>format</span><span class=p>(</span><span class=n>byte</span> <span class=o>^</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>),</span><span class=s1>&#39;08b&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>byte</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>encode</span> <span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_secret</span><span class=p>(</span><span class=bp>self</span> <span class=p>,</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(f&#34;data = {data}&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=n>secret_bin</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_secret_bin</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(f&#34;secret_bin = {secret_bin}&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=n>secret</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>bit2char_dict</span><span class=p>[</span><span class=n>bit</span><span class=p>]</span> <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>secret_bin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(f&#34;secret = {secret.encode()}&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>secret</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_secret</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>original_text</span><span class=p>,</span><span class=n>secret_text</span><span class=p>,</span><span class=n>idx</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>original_text</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>remove_secret</span><span class=p>(</span><span class=n>original_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>extracted_secret</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>extract_secret</span><span class=p>(</span><span class=n>secret_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=n>idx</span> <span class=k>if</span> <span class=n>idx</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>random</span> <span class=o>.</span><span class=n>randint</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span> <span class=p>(</span><span class=n>original_text</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>original_text</span> <span class=p>[:</span><span class=n>idx</span><span class=p>]</span><span class=o>+</span> <span class=n>extracted_secret</span> <span class=o>+</span> <span class=n>original_text</span> <span class=p>[</span><span class=n>idx</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>remove_secret</span> <span class=p>(</span><span class=bp>self</span> <span class=p>,</span><span class=n>text_with_secret</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=n>char</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>text_with_secret</span> <span class=k>if</span> <span class=n>char</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>.</span><span class=n>values</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_bin_secret</span><span class=p>(</span><span class=bp>self</span> <span class=p>,</span><span class=n>text_with_secret</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=n>char</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>text_with_secret</span> <span class=k>if</span> <span class=n>char</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>bit2char_dict</span> <span class=o>.</span><span class=n>values</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>trans2bin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>bin_data</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>char2bit_dict</span><span class=p>[</span><span class=n>bit</span><span class=p>]</span> <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bin_data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>bin2secret</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>bin_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>dec_bytes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>bin_data</span><span class=p>),</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>bin_byte</span> <span class=o>=</span> <span class=n>bin_data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>byte</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>bin_byte</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>dec_bytes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>byte</span> <span class=o>^</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>dec_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_watermark</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>enc_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>text_with_secret</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>enc_data</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>secret_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_bin_secret</span><span class=p>(</span><span class=n>text_with_secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>secret_bin</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>trans2bin</span><span class=p>(</span><span class=n>secret_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>watermark</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>bin2secret</span><span class=p>(</span><span class=n>secret_bin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>watermark</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># text = &#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=s1>&#39;20241024&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># secret = &#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>text_secret</span> <span class=o>=</span><span class=n>MagicText</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># text_with_secret = text_secret.add_secret(text, secret)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(text_with_secret.encode())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>enc1</span> <span class=o>=</span> <span class=s2>&#34;3c 74 3e 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c 49 44 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c 4e 61 6d 65 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 42 72 61 6e 64 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c 42 72 61 6e 64 3c 2f 74 3e&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>enc2</span> <span class=o>=</span> <span class=s2>&#34;3c 74 3e 49 44 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 4d 61 72 69 74 61 6c 20 53 74 61 74 75 73 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 47 65 6e 64 65 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 72 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 43 68 69 6c 64 72 65 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 6e 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 45 64 75 63 61 74 69 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 6f 6e 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 4f 63 63 75 70 61 74 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 69 6f 6e 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 48 6f 6d 65 20 4f 77 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 6e 65 72 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 43 61 72 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 73 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 43 6f 6d 6d 75 74 65 20 44 69 73 74 61 6e 63 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 65 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 52 65 67 69 6f 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 6e 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 41 67 65 7f 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c 7f e2 80 8c 7f 7f 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c 3c 2f 74 3e&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>enc3</span> <span class=o>=</span> <span class=s2>&#34;3c 74 3e 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 49 44 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 4d 61 72 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 69 74 69 61 6c 20 53 74 61 74 75 73 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 47 65 6e 64 65 72 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 49 6e 63 6f 6d 65 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 43 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 68 69 6c 64 72 65 6e 3c 2f 74 3e 3c 2f 73 69 3e 3c 73 69 3e 3c 74 3e 45 7f 7f e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 7f e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c 7f e2 80 8c e2 80 8c 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f e2 80 8c e2 80 8c e2 80 8c e2 80 8c 7f 7f 7f 7f e2 80 8c e2 80 8c 7f 7f 7f e2 80 8c 64 75 63 61 74 69 6f 6e 3c 2f 74 3e&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>text_secret</span><span class=o>.</span><span class=n>get_watermark</span><span class=p>(</span><span class=n>enc1</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;Peter5211\xfb\xfe \xd6\xb8\xaaSk\xa8\xa1\x8a\x1d\xc0\xc6\x93\xfd\x8f,&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>text_secret</span><span class=o>.</span><span class=n>get_watermark</span><span class=p>(</span><span class=n>enc2</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;Bob9527.\xe7b2\xdf\x95\xd2\xb1\xdc\xff\xb8\xd1Y\xcf\x9f&amp;\x03\xb4\xf2#\x1d\xd6\x1a\x10;r9?\x7f\x93\x04\x8e\xce_\x8fkY\xecX\x11p\xe0\xdb\x8d\xd9\xee\xb3z|\xaa\xff\xf5J\xba\xbe\xa6\xb7A\x0b\xfc\x1bD\xbcB\xcd\xe5\x11+\xb5\xd9&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>text_secret</span><span class=o>.</span><span class=n>get_watermark</span><span class=p>(</span><span class=n>enc3</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;Alice1145\xea\xf7=\xd0\xaf\xaePn\xac\xb0\x83\x00\xc6\xd1\x97\xfe\x8a(Q\x10_\xc2\n\x0fljhUI\r\xf5q\xdf&#34;\x86p&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;Alice1145_&#34;</span> <span class=o>+</span> <span class=s2>&#34;Bob9527_&#34;</span> <span class=o>+</span> <span class=s2>&#34;Peter5211&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(res) # Alice1145_Bob9527_Peter5211</span>
</span></span><span class=line><span class=cl>    <span class=n>md5_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>md5_hash</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>md5_hex</span> <span class=o>=</span> <span class=n>md5_hash</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;flag{&#34;</span><span class=o>+</span> <span class=n>md5_hex</span> <span class=o>+</span> <span class=s2>&#34;}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=c1># flag{34a1660a5ae4aa7e423bcac3262ff16c}</span></span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2024-11-05 10:21:35">更新于 2024-11-05&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/69280be/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/69280be/ data-title="2024 某金融系统内部赛 Misc Writeup" data-hashtags=CTF,Misc,Writeup><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/69280be/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/69280be/ data-title="2024 某金融系统内部赛 Misc Writeup"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a><a href=/tags/misc/ class=post-tag title="标签 - Misc">Misc</a><a href=/tags/writeup/ class=post-tag title="标签 - Writeup">Writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/01ebd40/ class=post-nav-item rel=prev title="CTF-ICS Learning Record"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>CTF-ICS Learning Record</a><a href=/posts/e19da63/ class=post-nav-item rel=next title="Python Basic Knowledge">Python Basic Knowledge<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/69280be/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>