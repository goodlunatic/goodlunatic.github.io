<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>2025 泰山杯线下决赛 Misc Writeup - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="群里有很多师傅在问这个比赛的Misc题，就打算专门写一篇博客记录一下
个人感觉这场比赛的Misc题出的还是可以的，出题人水平也在线，然后Misc附件还是动态的
"><meta name=keywords content='CTF,Misc,Writeup'><meta itemprop=name content="2025 泰山杯线下决赛 Misc Writeup"><meta itemprop=description content="群里有很多师傅在问这个比赛的Misc题，就打算专门写一篇博客记录一下
个人感觉这场比赛的Misc题出的还是可以的，出题人水平也在线，然后Misc附件还是动态的"><meta itemprop=datePublished content="2025-09-23T10:27:15+08:00"><meta itemprop=dateModified content="2025-09-23T10:27:15+08:00"><meta itemprop=wordCount content="454"><meta itemprop=keywords content="CTF,Misc,Writeup"><meta property="og:url" content="https://goodlunatic.github.io/posts/58b2135/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="2025 泰山杯线下决赛 Misc Writeup"><meta property="og:description" content="群里有很多师傅在问这个比赛的Misc题，就打算专门写一篇博客记录一下
个人感觉这场比赛的Misc题出的还是可以的，出题人水平也在线，然后Misc附件还是动态的"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-23T10:27:15+08:00"><meta property="article:modified_time" content="2025-09-23T10:27:15+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Misc"><meta property="article:tag" content="Writeup"><meta name=twitter:card content="summary"><meta name=twitter:title content="2025 泰山杯线下决赛 Misc Writeup"><meta name=twitter:description content="群里有很多师傅在问这个比赛的Misc题，就打算专门写一篇博客记录一下
个人感觉这场比赛的Misc题出的还是可以的，出题人水平也在线，然后Misc附件还是动态的"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/58b2135/ title="2025 泰山杯线下决赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/761da51/ title=Misc-Forensics><link rel=next type=text/html href=https://goodlunatic.github.io/posts/a8aa439/ title="利用 SCAT 实时捕获 4G-LTE 和 5G-NR 层三以上消息"><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/58b2135/index.md title="2025 泰山杯线下决赛 Misc Writeup - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"2025 泰山杯线下决赛 Misc Writeup","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/58b2135\/"},"genre":"posts","keywords":"CTF, Misc, Writeup","wordcount":454,"url":"https:\/\/goodlunatic.github.io\/posts\/58b2135\/","datePublished":"2025-09-23T10:27:15+08:00","dateModified":"2025-09-23T10:27:15+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> Friends</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> Friends</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=Collections></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>2025 泰山杯线下决赛 Misc Writeup</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=Author target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;included in <a href=/categories/writeup/ class=post-category title="Category - Writeup"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Writeup</a></span></div><div class=post-meta-line><span title="published on 2025-09-23 10:27:15"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-09-23>2025-09-23</time></span>&nbsp;<span title="454 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>About 500 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>3 minutes</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="2025 泰山杯线下决赛 Misc Writeup"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#题目名称-神秘的图片>题目名称 神秘的图片</a></li><li><a href=#题目名称-war>题目名称 war</a></li><li><a href=#题目名称-动听的音乐>题目名称 动听的音乐</a></li><li><a href=#题目名称-scrambled_base>题目名称 Scrambled_Base</a></li><li><a href=#题目名称-ezpdf>题目名称 ezpdf</a></li><li><a href=#题目名称-流量分析>题目名称 流量分析</a></li></ul></nav></div></div><div class=content id=content><p><strong>群里有很多师傅在问这个比赛的Misc题，就打算专门写一篇博客记录一下</strong></p><p><strong>个人感觉这场比赛的Misc题出的还是可以的，出题人水平也在线，然后Misc附件还是动态的</strong></p><blockquote><p>本文中涉及的具体题目附件可以进我的交流群获取，进群详见 <a href=https://goodlunatic.github.io/about/ target=_blank rel="external nofollow noopener noreferrer">About</a></p></blockquote><h2 class=heading-element id=题目名称-神秘的图片><span>题目名称 神秘的图片</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e7%a5%9e%e7%a7%98%e7%9a%84%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一张 ctf.png，010打开发现图片末尾有一个文件头被篡改了的ZIP压缩包</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920172409195.png alt=/posts/58b2135/imgs/image-20250920172409195.png height=1711 width=2512></p><p>补上文件头后打开，发现需要crc32爆破，猜测爆破出来的值就是压缩包的解压密码</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920172534372.png alt=/posts/58b2135/imgs/image-20250920172534372.png height=427 width=2087></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920173143629.png alt=/posts/58b2135/imgs/image-20250920173143629.png height=499 width=1104></p><p>用<code>hel1o_vigEneRe_here2</code>作为解压密码去解压可以得到那个data文件，010打开查看发现是一堆十六进制数据</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920173328746.png alt=/posts/58b2135/imgs/image-20250920173328746.png height=1711 width=2512></p><p>看前几个十六进制，发现是逆序的PNG的文件尾，因此我们拿CyberChef转一下</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920173500666.png alt=/posts/58b2135/imgs/image-20250920173500666.png height=1521 width=2544></p><p>发现PNG的文件头被篡改了，问题不大，我们下载下来用010手动修复一下</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920173659147.png alt=/posts/58b2135/imgs/image-20250920173659147.png height=1711 width=2512></p><p>修复文件头后发现图片还是没法正常显示，010的模板也有显示报错</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920173741612.png alt=/posts/58b2135/imgs/image-20250920173741612.png height=1711 width=2512></p><p>仔细观察发现部分IDAT块的长度被篡改了，并且结合U2Fs这几个字符，猜测还藏了加密后的密文</p><p>因此我们写个脚本提取一下IDAT长度，并解码一下十六进制</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># print(data[:100])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>find_list</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;(.</span><span class=si>{8}</span><span class=s2>)49444154&#34;</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>find_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>删除干扰的数据后得到的密文为：<code>U2FsdGVkX1+hrSabjmOfsFMTX/rQUZjwT6p6N+yHV4acgx+utA3D22I3s/Mg6BrgNOhR6s/7</code></p><p>然后我们参考010模板中正常的IDAT块长度，逐个修改一下错误的IDAT块</p><p>这里要注意开头和末尾的IDAT块的长度不一定是 65524</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920174354372.png alt=/posts/58b2135/imgs/image-20250920174354372.png height=1711 width=2512></p><p>修复完后即可得到下图，发现有密钥 <code>W87aETbAN</code>，并且图片的内容提示了rabbit加密</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920174004320.png alt=/posts/58b2135/imgs/image-20250920174004320.png height=1068 width=1690></p><p>rabbit解密后即可得到：<code>fheg{2b5je1145x3218j6b8y4i4dah9c655xi}</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920174821664.png alt=/posts/58b2135/imgs/image-20250920174821664.png height=740 width=1504></p><p>结合之前得到到内容，猜测还有一层维吉尼亚加密，可以结合我博客里的维吉尼亚对照表和flag开头的<code>flag{</code></p><p>逆推一下密钥即可得到最后的flag: <code>flag{2f5fe1145b3218f6b8c4e4ded9c655be}</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920175515097.png alt=/posts/58b2135/imgs/image-20250920175515097.png height=1458 width=2544></p><p>当然线下赛如果断网，CyberChef也能解</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920175436079.png alt=/posts/58b2135/imgs/image-20250920175436079.png height=1521 width=2544></p><h2 class=heading-element id=题目名称-war><span>题目名称 war</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-war class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一张war.png，010打开发现末尾有个被篡改了的ZIP压缩包</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920175915518.png alt=/posts/58b2135/imgs/image-20250920175915518.png height=1711 width=2512></p><p>提取出来手动修复一下文件头和文件尾，并修改一下目录区的长度</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920180042710.png alt=/posts/58b2135/imgs/image-20250920180042710.png height=1711 width=2512></p><p>修复好后010的模板就不报错了，但是发现压缩包是加密的，因此我们需要去寻找解压密码</p><p>stegsolve打开发现图片 <code>plane 7</code> 存在隐写</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920180206047.png alt=/posts/58b2135/imgs/image-20250920180206047.png height=889 width=1178></p><p>提取后可以得到：<code>autokey RPYJVMJQ</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920180255647.png alt=/posts/58b2135/imgs/image-20250920180255647.png height=838 width=1158></p><p>发现是autokey加密，我们拿到了密钥，但是没有密文，因此我们需要去寻找密文</p><p>用PS打开这张PNG，发现除了第一行的隐写以外，第二行的白色像素也很可疑</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920180640892.png alt=/posts/58b2135/imgs/image-20250920180640892.png height=1755 width=3002></p><p>后来和别的师傅交流了一下，知道了隐写的具体思路，我个人感觉挺难想到的，横坐标逐位做差，然后再逐位异或</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;war.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pixel</span> <span class=o>==</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tmp</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>tmp</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]),</span><span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># KWCYVEBMHYHXSOYCAWSCTBEFTOKVW</span></span></span></code></pre></td></tr></table></div></div><p>得到密文后用之前的密钥解个autokey即可得到压缩包的解压密码：<code>WGGMFPUBFYZHJVBV</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920181233378.png alt=/posts/58b2135/imgs/image-20250920181233378.png height=906 width=1247></p><p>用 <code>WGGMFPUBFYZHJVBV</code> 作为解压密码解压即可得到最后的flag: <code>flag{rPF5n4nRy7q43hf5RApe34UqWnq2hSAK}</code></p><h2 class=heading-element id=题目名称-动听的音乐><span>题目名称 动听的音乐</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e5%8a%a8%e5%90%ac%e7%9a%84%e9%9f%b3%e4%b9%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个<code>challenge.wav</code>还有一张<code>hint.bmp</code></p><p>先用zsteg扫一下bmp图片，可以看到隐写了一个ZIP压缩包的十六进制数据</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920181611962.png alt=/posts/58b2135/imgs/image-20250920181611962.png height=927 width=1734></p><p>用以下命令提取一下十六进制值，然后再转一下即可得到一个压缩包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>zsteg -e b1,rgb,lsb,xy hint.bmp &gt; out.bin</span></span></code></pre></td></tr></table></div></div><p>解压压缩包可以得到一个<code>hint.txt</code>，内容如下：</p><blockquote><p>既然你能注意到这里，那我就给你点提示吧。</p><p>1.音频LSB隐写</p><p>2.左右声道单独分析</p><p>3.AES-ECB解密</p></blockquote><p>因此我们先用<code>Audacity</code>分离一下两个声道到单个wav文件，然后再写个脚本提取一下隐写的数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wave</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_wav_lsb</span><span class=p>(</span><span class=n>wav_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>wav</span> <span class=o>=</span> <span class=n>wave</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>wav_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 读取前1000帧的音频数据并将其转换为十六进制字符串</span>
</span></span><span class=line><span class=cl>    <span class=c1># readframes()返回的是字节数据，.hex()将其转换为十六进制表示</span>
</span></span><span class=line><span class=cl>    <span class=n>frames_data</span> <span class=o>=</span> <span class=n>wav</span><span class=o>.</span><span class=n>readframes</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 遍历十六进制数据，每次处理4个字符(2字节)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 因为WAV文件通常使用16位(2字节)采样</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>frames_data</span><span class=p>),</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>frames_data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># 将数据从小端序转换为大端序，因为WAV文件使用小端序存储数据</span>
</span></span><span class=line><span class=cl>        <span class=n>data_rev</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span> <span class=o>+</span> <span class=n>data</span><span class=p>[:</span><span class=mi>2</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 使用位与运算(&amp;)获取最低有效位(LSB)</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>data_rev</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=n>res</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>extract_wav_lsb</span><span class=p>(</span><span class=s1>&#39;1.wav&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>extract_wav_lsb</span><span class=p>(</span><span class=s1>&#39;2.wav&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;MySuperSecretKey!\r]o^\x9e\xbd\x8a\x080\x83J\xcb\xcd.\xb0\xb9\x8fn\x87\xe3\x1f\xfb\xa5.\x0e\xfe\xd45\x1d\xf7\xe7}\xc2\x8cU\xa1O\xbeS,\xf6\xf1\x1a\x14!\x08C\x0e2\x1aR\x94\x86\x1a[R\xe7\xb9H!J\xd4\xe7\xf5\xff\r\xbc\xa1)\x84$7\x1a\x88\xc9\xbeFS\xac\x00\x89j\x84\xa5\x04\x15\x08\xde?\xf7h\x00\x862\xb8\xef\xfe\x00\x858\xd2G\xa8B\xa0\x84@%&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;q8TTfmlBwyT1QPLiZS9ixWKzS5h7aYgOUlaxNMJmE763AIoZ66FRHXFeYYWZBbLn\xces\x9a\xf6:P3\xdc\xea\xe28\xb8\x86\xe0Z\xc7\x19\x12\x93\x15K\x1c\xe2\x94=B\x1f\xa4\x13\x158j9Ot\xa0:_?\xbf\xad\xb3\\z\xb5\xac\xb7\x88[\x1a\xe7\xfd]\r\xf7\xad(\xd4\x95\x10J&#39;</span></span></span></code></pre></td></tr></table></div></div><p>得到密文：<code>q8TTfmlBwyT1QPLiZS9ixWKzS5h7aYgOUlaxNMJmE763AIoZ66FRHXFeYYWZBbLn</code> 和密钥：<code>MySuperSecretKey!</code></p><p>最后将密钥转为 hex，并在后面 Padding \x00 到 32 字节：<code>4d7953757065725365637265744b657921000000000000000000000000000000</code></p><p>最后解个 AES-ECB 即可得到最后的 flag：<code>flag{e394ed9b9c4b24e0fc0f1e6897bdf938}</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920220845770.png alt=/posts/58b2135/imgs/image-20250920220845770.png height=1744 width=2794></p><p>除此之外，用随波逐流把 AES 密钥的长度改为 256（32x8）位一样可以解出来</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250920221204002.png alt=/posts/58b2135/imgs/image-20250920221204002.png height=1350 width=1718></p><blockquote><p>其实之前也有遇到过这种在末尾 padding \x00 的情况，然后有在线网站和工具可以自动完成这个操作</p><p>但是为啥在线网站和工具遇到这题就解不出来了呢？</p><p>因为密钥长度是 17 字节，网站和工具可能默认 padding 到 24 字节(192 位)了，而不是 32 字节</p><p>所以我个人感觉出题人这里没出好，要么密钥长度就给刚刚好（16/24/32 字节），要么就让密钥长度超过 24 字节</p></blockquote><h2 class=heading-element id=题目名称-scrambled_base><span>题目名称 Scrambled_Base</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-scrambled_base class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个 txt 文件，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CLJZMY3TCLJVMEYDMM,MZWGCZ33GA3WENRSGI,RQGE3DONDFG56Q====,3TCLJVGMYDILJUMEZD</span></span></code></pre></td></tr></table></div></div><p>看到连续的四个=，猜测可能是 base32，直接写个脚本爆破一下排列顺序，然后解 Base32 即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>base_part</span> <span class=o>=</span> <span class=s2>&#34;CLJZMY3TCLJVMEYDMM,MZWGCZ33GA3WENRSGI,RQGE3DONDFG56Q====,3TCLJVGMYDILJUMEZD&#34;</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># print(base_part)</span>
</span></span><span class=line><span class=cl><span class=n>res_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>permutations</span><span class=p>(</span><span class=n>base_part</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>res_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b32decode</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>item</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;flag&#39;</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;flag{07b62271-5304-4a21-9f71-5a06201674e7}&#39;</span></span></span></code></pre></td></tr></table></div></div><p><code>flag{07b62271-5304-4a21-9f71-5a06201674e7}</code></p><h2 class=heading-element id=题目名称-ezpdf><span>题目名称 ezpdf</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-ezpdf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题目附件给了一个 pdf 文件，直接打开会提示文件已损坏</p><p>尝试用 foremost 分类一下，可以得到一个新的 pdf 文件，这个是可以正常打开的</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923095239620.png alt=/posts/58b2135/imgs/image-20250923095239620.png height=1836 width=2804></p><p>我们把上面的文字移开可以得到如下内容：</p><blockquote><p>A4k9icgydtiz3HvFSuNxr67fvWWHS6aGW</p></blockquote><p>解 base64 和 ROT13可以得到：<code>pass:Venus_G0oD_daY_????</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923095707151.png alt=/posts/58b2135/imgs/image-20250923095707151.png height=1072 width=2240></p><p>然后我们可以发现 foremost 分离出来的 PDF 明显比原 PDF 小，因此我们拿 010 diff 一下</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923100125802.png alt=/posts/58b2135/imgs/image-20250923100125802.png height=1836 width=2804></p><p>结合 PDF 文件尾部的数据，我们很容易可以想到末尾还有一个压缩包，只不过文件头被篡改了</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923100153100.png alt=/posts/58b2135/imgs/image-20250923100153100.png height=1836 width=2804></p><p>我们手动提取出来并修复文件头，发现是加密的</p><p>用我们之前得到的掩码爆破一下可以得到解压密码：<code>Venus_G0oD_daY_2895</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923100901393.png alt=/posts/58b2135/imgs/image-20250923100901393.png height=1530 width=2072></p><p>解压后得到一个 zero 文件，010 打开，猜测是文件头被篡改了的 GIF 文件</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101118688.png alt=/posts/58b2135/imgs/image-20250923101118688.png height=1836 width=2804></p><p>补上文件头后改后缀为.gif，发现可以正常打开</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101250135.png alt=/posts/58b2135/imgs/image-20250923101250135.png height=1836 width=2804></p><p>然后提取帧间隔，转二进制后再转 ASCII 即可得到 flag: <code>flag{5dca56a63c65beb79a2e6a86843b7a9}</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101405883.png alt=/posts/58b2135/imgs/image-20250923101405883.png height=718 width=1492></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101559972.png alt=/posts/58b2135/imgs/image-20250923101559972.png height=1662 width=2800></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101645977.png alt=/posts/58b2135/imgs/image-20250923101645977.png height=1180 width=2800></p><blockquote><p>Tips: 这里要注意到 259 / 7 = 37 ，因此我们要每 7 位二进制转 ASCII 才能得到正确的 flag</p></blockquote><h2 class=heading-element id=题目名称-流量分析><span>题目名称 流量分析</span>
<a href=#%e9%a2%98%e7%9b%ae%e5%90%8d%e7%a7%b0-%e6%b5%81%e9%87%8f%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>题面信息如下：</p><blockquote><p>在某次攻防演练行动中集团系统被攻破，系统里面被植入后门账号。应急人员在溯源的时候发现是因为系统运维人员安全意识不足，使用姓名+出生年月日设置密码（例如：zhangsan19900421），集团通讯录被泄露导致攻击者利用通讯录构造社工字典获取到了smb服务的密码，然后利用smb服务上传webshell，之后利用webshell植入后门账号。技术人员在安全设备上将流量下载下来了，请你分析，泄露的smb服务账号及密码以及植入的后门账号及密码。flag格式：flag{md5(泄露的smb服务账号_泄露的smb服务账号的密码_后门账号_后门账号的密码)}</p><p>例如：</p><p>泄露的smb服务账号：zhangsan</p><p>泄露的smb服务密码：zhangsan19900421</p><p>后门账号:hack</p><p>后门账号密码:hack@123</p><p>md5(zhangsan_zhangsan19900421_hack_hack@123)=1f91fcaedeee961c094aa6dd6a71a7ad</p><p>flag为：flag{1f91fcaedeee961c094aa6dd6a71a7ad}</p></blockquote><p>打开流量包查看，发现 FTP 传了一个 xlsx 文件</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923101957359.png alt=/posts/58b2135/imgs/image-20250923101957359.png height=1836 width=2810></p><p>提取出来，WPS 打开会提示报错，但是可以用 EXCEL 修复后打开</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923102117201.png alt=/posts/58b2135/imgs/image-20250923102117201.png height=1836 width=2830></p><p>打开后即可得到姓名拼音列表，直接复制出来删去空格做成一个字典</p><p>然后用 NTLMRawUnHide.py 提取 NTLMv2 的哈希</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 NTLMRawUnHide.py -i 流量分析.pcapng -o hash.txt</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923102423666.png alt=/posts/58b2135/imgs/image-20250923102423666.png height=1836 width=2832></p><p>然后用 hashcat 爆破即可得到 SMB 服务账号的密码：<code>guyongyan19901221</code></p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923102547394.png alt=/posts/58b2135/imgs/image-20250923102547394.png height=316 width=1822></p><p>用 wireshark 输入这个密码解密 ntlmssp 后导出解密后的流量包</p><p>最后直接用 CTF-NetA 一把梭解密哥斯拉流量即可</p><p><img loading=lazy src=/posts/58b2135/imgs/image-20250923232229237.png alt=/posts/58b2135/imgs/image-20250923232229237.png height=1538 width=2780></p><p>综上，我们总结如下：</p><blockquote><p>泄露的smb服务账号: administrator</p><p>泄露的smb服务密码: guyongyan19901221</p><p>后门账号: adm1n1strator</p><p>后门账号密码: Admin@123$</p></blockquote><p>最后的 flag 为：<code>flag{54b9afb4d6a16be08ef1e62aabcf739d}</code></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2025-09-23 10:27:15">Updated on 2025-09-23&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/58b2135/index.md title="Read Markdown" class=link-to-markdown>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/58b2135/ data-title="2025 泰山杯线下决赛 Misc Writeup" data-hashtags=CTF,Misc,Writeup><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/58b2135/ data-hashtag=CTF><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/58b2135/ data-title="2025 泰山杯线下决赛 Misc Writeup"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf/ class=post-tag title="Tags - CTF">CTF</a><a href=/tags/misc/ class=post-tag title="Tags - Misc">Misc</a><a href=/tags/writeup/ class=post-tag title="Tags - Writeup">Writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/761da51/ class=post-nav-item rel=prev title=Misc-Forensics><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Misc-Forensics</a><a href=/posts/a8aa439/ class=post-nav-item rel=next title="利用 SCAT 实时捕获 4G-LTE 和 5G-NR 层三以上消息">利用 SCAT 实时捕获 4G-LTE 和 5G-NR 层三以上消息<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=Contents><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> | Theme - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><div id=mask></div><noscript><div class=noscript-warning>This website works best with JavaScript enabled.</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/58b2135/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>