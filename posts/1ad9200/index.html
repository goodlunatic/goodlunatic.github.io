<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>[持续更新] CTF-Misc Guide - ⚡Lunatic BLOG⚡</title><meta name=author content="Lunatic"><meta name=description content="最开始接触CTF时，学的最多的就是Misc，各种编码与加密还有各种软件的使用等等
但Misc涉及的范围实在太广了，于是就想着一边学习一边记录，因而就有了这篇文章
"><meta name=keywords content='Misc,CTF'><meta itemprop=name content="[持续更新] CTF-Misc Guide"><meta itemprop=description content="最开始接触CTF时，学的最多的就是Misc，各种编码与加密还有各种软件的使用等等
但Misc涉及的范围实在太广了，于是就想着一边学习一边记录，因而就有了这篇文章"><meta itemprop=datePublished content="2025-11-22T12:10:17+08:00"><meta itemprop=dateModified content="2025-11-22T14:14:05+08:00"><meta itemprop=wordCount content="15252"><meta itemprop=keywords content="Misc,CTF"><meta property="og:url" content="https://goodlunatic.github.io/posts/1ad9200/"><meta property="og:site_name" content="⚡Lunatic BLOG⚡"><meta property="og:title" content="[持续更新] CTF-Misc Guide"><meta property="og:description" content="最开始接触CTF时，学的最多的就是Misc，各种编码与加密还有各种软件的使用等等
但Misc涉及的范围实在太广了，于是就想着一边学习一边记录，因而就有了这篇文章"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-22T12:10:17+08:00"><meta property="article:modified_time" content="2025-11-22T14:14:05+08:00"><meta property="article:tag" content="Misc"><meta property="article:tag" content="CTF"><meta name=twitter:card content="summary"><meta name=twitter:title content="[持续更新] CTF-Misc Guide"><meta name=twitter:description content="最开始接触CTF时，学的最多的就是Misc，各种编码与加密还有各种软件的使用等等
但Misc涉及的范围实在太广了，于是就想着一边学习一边记录，因而就有了这篇文章"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://goodlunatic.github.io/posts/1ad9200/ title="[持续更新] CTF-Misc Guide - ⚡Lunatic BLOG⚡"><link rel=prev type=text/html href=https://goodlunatic.github.io/posts/bb1da35/ title=星球朋友们问的一些来路不明的题><link rel=alternate type=text/markdown href=https://goodlunatic.github.io/posts/1ad9200/index.md title="[持续更新] CTF-Misc Guide - ⚡Lunatic BLOG⚡"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[持续更新] CTF-Misc Guide","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/goodlunatic.github.io\/posts\/1ad9200\/"},"image":["https:\/\/www.nssctf.cn\/files\/2025\/8\/21\/8ce6223a1a.png"],"genre":"posts","keywords":"Misc, CTF","wordcount":15252,"url":"https:\/\/goodlunatic.github.io\/posts\/1ad9200\/","datePublished":"2025-11-22T12:10:17+08:00","dateModified":"2025-11-22T14:14:05+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lunatic"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="⚡Lunatic BLOG⚡"><span class=header-title-text>⚡Lunatic BLOG⚡</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=合集>CTF-Misc入门指南</span>
<span class=collection-count>8</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><span class=active title="[持续更新] CTF-Misc Guide">[持续更新] CTF-Misc Guide</span></li><li class=collection-item><a href=/posts/c5bc8a2/ title=Misc-AI安全>Misc-AI安全</a></li><li class=collection-item><a href=/posts/761da51/ title=Misc-数字取证>Misc-数字取证</a></li><li class=collection-item><a href=/posts/5422d65/ title=Misc-流量分析>Misc-流量分析</a></li><li class=collection-item><a href=/posts/c49ae8a/ title=Misc-数据安全>Misc-数据安全</a></li><li class=collection-item><a href=/posts/01ebd40/ title=Misc-工控安全>Misc-工控安全</a></li><li class=collection-item><a href=/posts/442fd1d/ title=Misc-沙箱逃逸>Misc-沙箱逃逸</a></li><li class=collection-item><a href=/posts/3e9e231/ title=Misc-区块链安全>Misc-区块链安全</a></li></ul><div class=collection-nav-simple><i class="fa-solid fa-angle-left fa-fw collection-nav-item text-secondary" aria-hidden=true></i><span class=text-secondary>1/8</span><a href=/posts/c5bc8a2/ class=collection-nav-item rel=next title=Misc-AI安全><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>相关内容</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/8582ff7/ title="2025 浙江省大学生网络与信息安全竞赛 Misc Writeup">2025 浙江省大学生网络与信息安全竞赛 Misc Writeup</a></li><li class=related-item><a href=/posts/d0736a7/ title='CTF-Misc "雅"题共赏'>CTF-Misc "雅"题共赏</a></li><li class=related-item><a href=/posts/bfeb088/ title="2025 台州市网络安全大赛 Misc Writeup">2025 台州市网络安全大赛 Misc Writeup</a></li><li class=related-item><a href=/posts/02298dd/ title="2025 华为杯中国研究生网络安全创新大赛实网对抗赛 EZ_ATEXEC 详解">2025 华为杯中国研究生网络安全创新大赛实网对抗赛 EZ_ATEXEC 详解</a></li><li class=related-item><a href=/posts/bb1da35/ title=星球朋友们问的一些来路不明的题>星球朋友们问的一些来路不明的题</a></li></ul></div></div><div class=aside-custom><a href target=_blank rel=external><img src=/images/zsxq.webp alt="Lunatic Planet QR code" width=100%></a></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>[持续更新] CTF-Misc Guide</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://goodlunatic.github.io title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=https://www.nssctf.cn/files/2024/4/28/7f130a1387.png alt=Lunatic height=16 width=16>&nbsp;Lunatic</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/ctf/ class=post-category title="分类 - CTF"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CTF</a> 和 <a href=/collections/ctf-misc%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/ class=post-collection title="合集 - CTF-Misc入门指南"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> CTF-Misc入门指南</a></span></div><div class=post-meta-line><span title="发布于 2025-11-22 12:10:17"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-11-22>2025-11-22</time></span>&nbsp;<span title="更新于 2025-11-22 14:14:05"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2025-11-22>2025-11-22</time></span>&nbsp;<span title="15252 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 15300 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 72 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="[持续更新] CTF-Misc Guide"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#一些奇奇怪怪的经历>一些奇奇怪怪的经历</a></li><li><a href=#ctf中的常用关键词>CTF中的常用关键词</a></li><li><a href=#各种文件头尾>各种文件头/尾</a></li><li><a href=#各种加密编码>各种加密/编码</a><ul><li><a href=#进制转换>进制转换</a><ul><li><a href=#二进制>二进制</a></li><li><a href=#三进制>三进制</a></li><li><a href=#四进制>四进制</a></li><li><a href=#八进制>八进制</a></li></ul></li><li><a href=#base家族>base家族</a></li><li><a href=#base64隐写>base64隐写</a></li><li><a href=#md5加密>MD5加密</a></li><li><a href=#rc4加密算法>RC4加密算法</a></li><li><a href=#des加密算法>DES加密算法</a></li><li><a href=#aes加密算法>AES加密算法</a><ul><li><a href=#aes-ecb不需要iv>AES-ECB(不需要IV)</a></li><li><a href=#aes-cbc需要iv>AES-CBC(需要IV)</a></li></ul></li><li><a href=#国密sm系列加密算法>国密(SM)系列加密算法</a></li><li><a href=#emoji-aes加密>emoji-aes加密</a></li><li><a href=#字频爆破>字频爆破</a></li><li><a href=#字频统计>字频统计</a></li><li><a href=#摩斯电码>摩斯电码</a></li><li><a href=#栅栏密码fence>栅栏密码(fence)</a></li><li><a href=#维吉尼亚密码vigenere>维吉尼亚密码(vigenere)</a></li><li><a href=#希尔密码hill>希尔密码(Hill)</a></li><li><a href=#rabbit加密>Rabbit加密</a></li><li><a href=#云影密码>云影密码</a></li><li><a href=#曼彻斯特与差分曼彻斯特编码>曼彻斯特与差分曼彻斯特编码</a></li><li><a href=#社会主义核心价值观密码>社会主义核心价值观密码</a></li><li><a href=#音乐符号加密>音乐符号加密</a></li><li><a href=#敲击码>敲击码</a></li><li><a href=#博多码>博多码</a></li><li><a href=#格雷码>格雷码</a></li><li><a href=#波利比奥斯方阵密码polybius>波利比奥斯方阵密码(Polybius)</a></li><li><a href=#埃特巴什码atbash>埃特巴什码(Atbash)</a></li><li><a href=#dna编码>DNA编码</a></li><li><a href=#金笛短信pdu编码>金笛短信PDU编码</a></li><li><a href=#text-encoding-brute-force>Text Encoding Brute Force</a></li><li><a href=#decabit编码>Decabit编码</a></li><li><a href=#仿射密码>仿射密码</a></li><li><a href=#brainfuck和ook编码>Brainfuck和Ook!编码</a><ul><li><a href=#brainfuck>Brainfuck</a></li><li><a href=#ook>Ook!</a></li><li><a href=#short-ook>short Ook!</a></li></ul></li><li><a href=#gronsfeld密码>Gronsfeld密码</a></li><li><a href=#uuencode编码>UUencode编码</a></li><li><a href=#aaencode编码>AAencode编码</a></li><li><a href=#xxencode编码>XXencode编码</a></li><li><a href=#whitespace隐写>whitespace隐写</a></li><li><a href=#snow隐写>SNOW隐写</a></li><li><a href=#零宽字符隐写>零宽字符隐写</a></li><li><a href=#中文电报中文电码>中文电报（中文电码）</a></li><li><a href=#quote-printable编码>Quote-Printable编码</a></li><li><a href=#unicode编码>Unicode编码</a></li><li><a href=#中文ascii码>中文ascii码</a></li><li><a href=#培根密码>培根密码</a></li><li><a href=#锟斤拷>锟斤拷</a></li><li><a href=#电脑键盘密码>电脑键盘密码</a><ul><li><a href=#电脑键盘坐标密码>电脑键盘坐标密码</a></li><li><a href=#电脑键盘qwe加密>电脑键盘QWE加密</a></li><li><a href=#电脑键盘位移加密>电脑键盘位移加密</a></li></ul></li><li><a href=#手机键盘密码>手机键盘密码</a><ul><li><a href=#26键键盘密码>26键键盘密码</a></li><li><a href=#九宫格键盘密码>九宫格键盘密码</a><ul><li><a href=#第一种>第一种</a></li><li><a href=#第二种>第二种</a></li></ul></li></ul></li><li><a href=#不同键盘布局的编码>不同键盘布局的编码</a><ul><li><a href=#qwerty>Qwerty</a></li><li><a href=#qwertz>Qwertz</a></li><li><a href=#azerty>Azerty</a></li><li><a href=#dvorak德沃夏克键盘>Dvorak(德沃夏克键盘)</a></li><li><a href=#colemak>Colemak</a></li></ul></li><li><a href=#棋盘密码adfgvxadfgxpolybius>棋盘密码(ADFGVX,ADFGX,Polybius)</a></li><li><a href=#利用编程代码画图>利用编程代码画图</a></li><li><a href=#通过拼音和声调进行编码>通过拼音和声调进行编码</a></li><li><a href=#当铺密码>当铺密码</a></li><li><a href=#简繁体汉字笔画编码>简/繁体汉字笔画编码</a></li><li><a href=#pgp词汇表加密>PGP词汇表加密</a></li><li><a href=#vbs加密>VBS加密</a></li><li><a href=#日历密码>日历密码</a></li><li><a href=#twitter-secret-messages>Twitter Secret Messages</a></li><li><a href=#垃圾邮件隐写spammimic>垃圾邮件隐写(Spammimic)</a></li><li><a href=#tupper自指公式>Tupper自指公式</a></li><li><a href=#盲文>盲文</a></li><li><a href=#旗语>旗语</a></li><li><a href=#各种各样的异形文字>各种各样的异形文字</a><ul><li><a href=#原神提瓦特通用文字>原神提瓦特通用文字</a></li><li><a href=#瓦坎达文字>瓦坎达文字</a></li><li><a href=#喜羊羊与灰太狼-羊文>喜羊羊与灰太狼-羊文</a></li></ul></li></ul></li><li><a href=#misc流量分析题思路>Misc——流量分析题思路</a></li><li><a href=#misc工控题思路>Misc——工控题思路</a></li><li><a href=#misc数据安全题思路>Misc——数据安全题思路</a></li><li><a href=#misc图片题思路>MIsc——图片题思路</a><ul><li><a href=#通用思路>通用思路</a><ul><li><a href=#1查看图片属性的详细信息可能关键信息就在里面>1、查看图片属性的详细信息(可能关键信息就在里面)</a></li><li><a href=#2拉入010查看文件头尾>2、拉入010，查看文件头尾</a></li><li><a href=#3foremost-或者-binwalk>3、foremost 或者 binwalk</a></li><li><a href=#4盲水印隐写可能是一张图片或者两张图片>4、盲水印隐写(可能是一张图片或者两张图片)</a></li><li><a href=#5图片的分离和拼接>5、图片的分离和拼接</a></li><li><a href=#6image-conbiner两张图片>6、Image conbiner(两张图片)</a></li><li><a href=#7oursecret隐写可以无密码>7、OurSecret隐写(可以无密码)</a></li><li><a href=#8拼图题>8、拼图题</a></li><li><a href=#9提取图中等距像素点近邻法缩放图片>9、提取图中等距像素点/近邻法缩放图片</a></li><li><a href=#10pixeljihad有密码>10、pixeljihad（有密码）</a></li><li><a href=#11隐写文本可能藏在原图片和隐写文件的中间>11、隐写文本可能藏在原图片和隐写文件的中间</a></li><li><a href=#12deegger-embedder隐写>12、DeEgger Embedder隐写</a></li><li><a href=#13flag可能藏在-exif-中>13、flag可能藏在 exif 中</a></li><li><a href=#14给了两张图片flag藏在每行不同像素的个数中>14、给了两张图片，flag藏在每行不同像素的个数中</a></li><li><a href=#15两张图片用stegsolve中的image-conbiner合成为一张bmp>15、两张图片，用StegSolve中的Image Conbiner合成为一张bmp</a></li><li><a href=#16图片多个通道存在lsb隐写stegsolve中把背景颜色相同的勾选上>16、图片多个通道存在LSB隐写，StegSolve中把背景颜色相同的勾选上</a></li><li><a href=#17把小说藏进图片>17、把小说藏进图片</a></li><li><a href=#18arnold猫脸变换>18、Arnold猫脸变换</a></li><li><a href=#19二进制数据转图片>19、二进制数据转图片</a></li><li><a href=#20-脚本提取lsb数据并分析>20、 脚本提取LSB数据并分析</a></li><li><a href=#21像素点rgb值转图片>21、像素点RGB值转图片</a></li><li><a href=#22图片套娃>22、图片套娃</a></li><li><a href=#23java-blindwatermark>23、Java-BlindWatermark</a></li><li><a href=#24在线网站一把梭>24、在线网站一把梭</a></li><li><a href=#25立体图>25、立体图</a></li></ul></li><li><a href=#png思路>PNG思路</a><ul><li><a href=#1png图片宽高被篡改>1、PNG图片宽高被篡改</a></li><li><a href=#2lsb隐写>2、LSB隐写:</a></li><li><a href=#3idat块隐写>3、IDAT块隐写</a></li><li><a href=#4png末尾隐藏内容>4、PNG末尾隐藏内容</a></li><li><a href=#5apng格式>5、APNG格式</a></li><li><a href=#6cve-2023-28303-截图工具漏洞>6、CVE-2023-28303 截图工具漏洞</a></li><li><a href=#7stegpy隐写>7、stegpy隐写</a></li><li><a href=#8npiet编程语言>8、npiet编程语言</a></li><li><a href=#9image-steganography隐写>9、Image Steganography隐写</a></li><li><a href=#10关键信息藏在图片被篡改的宽高中>10、关键信息藏在图片被篡改的宽高中</a></li><li><a href=#11关键信息藏在图片每个被篡改的idat块长度中>11、关键信息藏在图片每个被篡改的IDAT块长度中</a></li></ul></li><li><a href=#jpg思路>JPG思路</a><ul><li><a href=#1lsb隐写>1、LSB隐写</a></li><li><a href=#2可以试试用stegdectet看看是什么加密>2、可以试试用stegdectet看看是什么加密：</a></li><li><a href=#2jphs隐写可以无密码>2、JPHS隐写(可以无密码)</a></li><li><a href=#3steghide隐写可以无密码>3、steghide隐写(可以无密码)</a></li><li><a href=#4silenteye隐写>4、Silenteye隐写</a></li><li><a href=#5outguess隐写>5、outguess隐写</a></li><li><a href=#6f5-steganography-master>6、F5-steganography-master</a></li><li><a href=#7jpg宽高隐写>7、JPG宽高隐写</a></li><li><a href=#8jsteg>8、jsteg</a></li><li><a href=#9关键信息混在-jpg-的十六进制数据中>9、关键信息混在 jpg 的十六进制数据中</a></li></ul></li><li><a href=#bmp思路>BMP思路</a><ul><li><a href=#1bmp宽高爆破>1、bmp宽高爆破：</a></li><li><a href=#2wbstego4open隐写可以无密钥>2、wbStego4open隐写(可以无密钥)</a></li><li><a href=#3silenteye隐写>3、Silenteye隐写</a></li></ul></li><li><a href=#gif思路>GIF思路</a><ul><li><a href=#1gif分帧在线网站或者工具>1、GIF分帧(在线网站或者工具)</a></li><li><a href=#2帧间隔隐写>2、帧间隔隐写</a></li><li><a href=#gif图像每帧的xy偏移量隐写>GIF图像每帧的XY偏移量隐写</a></li><li><a href=#gif图像每帧的实际尺寸隐写>GIF图像每帧的实际尺寸隐写</a></li></ul></li><li><a href=#webp思路>Webp思路</a></li><li><a href=#bpg图像文件>BPG图像文件</a></li><li><a href=#rawarw文件思路>RAW、ARW文件思路</a><ul><li><a href=#1raw的lsb隐写>1、RAW的LSB隐写</a></li><li><a href=#2直接改后缀为data然后拖入gimp调整即可>2、直接改后缀为.data，然后拖入Gimp调整即可</a></li></ul></li><li><a href=#二维码思路>二维码思路</a><ul><li><a href=#1bmp转二维码>1、bmp转二维码</a></li><li><a href=#216进制转pyc>2、16进制转pyc</a></li><li><a href=#3字符串制作二维码>3、字符串制作二维码</a></li><li><a href=#4四个ttl值转换一个字节的二进制数>4、四个TTL值转换一个字节的二进制数</a></li><li><a href=#5aztec-codedatamatrixgridmatrix汉信码pdf417code等>5、Aztec code、DataMatrix、GridMatrix、汉信码、PDF417code等</a></li><li><a href=#qrcode-二维码标准的一些考点>QRcode 二维码标准的一些考点</a></li></ul></li><li><a href=#信号和图像处理中的一些变换方法>信号和图像处理中的一些变换方法</a><ul><li><a href=#快速傅里叶变换fft>快速傅里叶变换（FFT）</a></li><li><a href=#离散傅里叶变换dft>离散傅里叶变换（DFT）</a></li><li><a href=#离散余弦变换dct>离散余弦变换（DCT）</a></li><li><a href=#离散小波变换dwt>离散小波变换（DWT）</a></li></ul></li></ul></li><li><a href=#miscpdf题思路>Misc——PDF题思路</a><ul><li><a href=#1binwalkforemost或者010手动提取出隐藏文件>1、binwalk/foremost或者010手动提取出隐藏文件</a></li><li><a href=#2wbstego4open隐写>2、wbStego4open隐写</a></li><li><a href=#3pdf中携带了附件>3、PDF中携带了附件</a></li><li><a href=#4pdf中写了透明或者白色的文字>4、PDF中写了透明或者白色的文字</a></li><li><a href=#5使用deegger-embedder工具extract-files>5、使用DeEgger Embedder工具extract files</a></li><li><a href=#6pdf存在多个图层的情况>6、PDF存在多个图层的情况</a></li><li><a href=#7弱密码加密的pdf>7、弱密码加密的PDF</a></li></ul></li><li><a href=#miscms-office题思路>Misc——MS-Office题思路</a><ul><li><a href=#新版-ms-office-2007>新版 MS-Office 2007</a><ul><li><a href=#docx文件>docx文件</a><ul><li><a href=#0可能有透明或者白色的文字全选复制出来或者直接清除样式>0、可能有透明或者白色的文字，全选复制出来，或者直接清除样式</a></li><li><a href=#1wps或者word打开显示隐藏文字的功能可能会有隐藏文字>1、WPS或者Word打开显示隐藏文字的功能，可能会有隐藏文字</a></li><li><a href=#2直接改后缀为zip解压然后查看有无关键信息>2、直接改后缀为.zip解压，然后查看有无关键信息</a></li><li><a href=#3与宏有关系的各种攻击与隐写>3、与宏有关系的各种攻击与隐写</a></li><li><a href=#4利用行距来隐写例iscc2023-汤姆历险记>4、利用行距来隐写（例：ISCC2023-汤姆历险记）</a></li><li><a href=#5docx中有emf和oleobject>5、docx中有emf和oleobject</a></li><li><a href=#6把关键内容隐写在自定义字体中>6、把关键内容隐写在自定义字体中</a><ul><li><a href=#直接给了otf文件的情况>直接给了otf文件的情况：</a></li><li><a href=#给了odttf文件的情况>给了odttf文件的情况</a></li></ul></li></ul></li><li><a href=#pptx>pptx</a></li><li><a href=#xlsx文件>xlsx文件</a></li></ul></li><li><a href=#旧版-ms-office-97-2003>旧版 MS-Office 97-2003</a><ul><li><a href=#oleheader修复>OLEHeader修复</a></li></ul></li></ul></li><li><a href=#misctxt题思路>Misc——TXT题思路</a><ul><li><a href=#1-有可能是ntfs直接用ntfsstreamseditor2扫描所在文件夹然后导出可疑文件如果是压缩包一定要用winrar解压>1、 有可能是ntfs，直接用NtfsStreamsEditor2扫描所在文件夹，然后导出可疑文件【如果是压缩包，一定要用winrar解压】</a></li><li><a href=#2可能是wbstego4open隐写用wbstego4open直接decode可能有密钥>2、可能是wbStego4open隐写，用wbStego4open直接decode(可能有密钥)</a></li><li><a href=#3如果是那种文件夹套文件夹的题目可以直接把路径粘贴到everything中让everything一把梭>3、如果是那种文件夹套文件夹的题目，可以直接把路径粘贴到everything中，让everything一把梭</a></li><li><a href=#4whitespace隐写>4、whitespace隐写</a></li><li><a href=#5snow隐写>5、SNOW隐写</a></li><li><a href=#零宽字符隐写-1>零宽字符隐写</a></li><li><a href=#5垃圾邮件隐写spammimic>5、垃圾邮件隐写(spammimic)</a></li><li><a href=#6cloakify隐写>6、Cloakify隐写</a></li></ul></li><li><a href=#mischtml题思路>Misc——HTML题思路</a></li><li><a href=#misc压缩包思路>Misc——压缩包思路</a><ul><li><a href=#zip文件结构>zip文件结构</a><ul><li><a href=#常见报错及对应解决方法借助010的模板功能>常见报错及对应解决方法（借助010的模板功能）</a></li></ul></li><li><a href=#rar文件结构>rar文件结构</a></li><li><a href=#1压缩包伪加密>1、压缩包伪加密</a><ul><li><a href=#zip文件>zip文件：</a></li><li><a href=#rar文件>rar文件：</a></li></ul></li><li><a href=#2crc爆破>2、CRC爆破</a></li><li><a href=#3暴力破解压缩包密码>3、暴力破解压缩包密码</a></li><li><a href=#4压缩包套娃解套>4、压缩包套娃解套</a></li><li><a href=#5分卷压缩包合并>5、分卷压缩包合并</a></li><li><a href=#6压缩包炸弹>6、压缩包炸弹</a></li><li><a href=#7根据010中的模板修改了某些参数>7、根据010中的模板修改了某些参数</a></li><li><a href=#8压缩包密码是不可见字符>8、压缩包密码是不可见字符</a><ul><li><a href=#字节数很短的情况>字节数很短的情况</a></li><li><a href=#字节数较长的情况>字节数较长的情况</a></li></ul></li><li><a href=#9明文攻击>9、明文攻击</a><ul><li><a href=#已知所有的明文或三段密钥>已知所有的明文或三段密钥</a></li><li><a href=#已知部分明文>已知部分明文</a><ul><li><a href=#1利用明文文本破解>1)利用明文文本破解</a></li><li><a href=#2利用png图片文件头破解>2)利用PNG图片文件头破解</a></li><li><a href=#3利用zip格式破解>3)利用ZIP格式破解</a></li><li><a href=#4利用exe文件格式破解>4)利用EXE文件格式破解</a></li><li><a href=#5利用pcapng格式破解>5)利用pcapng格式破解</a></li><li><a href=#6利用xml文件格式破解>6)利用XML文件格式破解</a></li><li><a href=#7利用svg文件格式破解>7)利用SVG文件格式破解</a></li><li><a href=#8利用vmdk文件格式破解>8)利用VMDK文件格式破解</a></li></ul></li><li><a href=#得到密钥后使用bkcrack修改压缩包密码>得到密钥后使用bkcrack修改压缩包密码</a></li><li><a href=#得到密钥后反向爆破压缩包密码>得到密钥后反向爆破压缩包密码</a></li><li><a href=#在比赛中的使用记录>在比赛中的使用记录</a></li></ul></li><li><a href=#10直接补上zlib头解压>10、直接补上Zlib头解压</a></li><li><a href=#11把加密的压缩包篡改成未加密的情况>11、把加密的压缩包篡改成未加密的情况</a></li><li><a href=#12压缩包文件时间戳隐写>12、压缩包文件时间戳隐写</a></li><li><a href=#13rar压缩包ntfs数据流隐写>13、rar压缩包NTFS数据流隐写</a></li></ul></li><li><a href=#misc视频题思路>Misc——视频题思路</a></li><li><a href=#misc音频题思路>Misc——音频题思路</a><ul><li><a href=#通用思路-1>通用思路</a><ul><li><a href=#1波形图分析摩斯电码>1、波形图分析：摩斯电码</a></li><li><a href=#2频谱图分析有时要调高最高频率>2、频谱图分析(有时要调高最高频率)：</a></li><li><a href=#3sstv慢扫描电视>3、SSTV慢扫描电视：</a><ul><li><a href=#windows中使用rx-sstv>Windows中使用RX-SSTV</a></li><li><a href=#拉入kali用qsstv有时候要用到反向和反相>拉入kali用qsstv（有时候要用到反向和反相）</a></li></ul></li><li><a href=#4电话音分析dtmf>4、电话音分析(DTMF)</a></li></ul></li><li><a href=#mp3思路>MP3思路</a><ul><li><a href=#1mp3stego隐写可以无密码>1、mp3stego隐写(可以无密码)</a></li></ul></li><li><a href=#wav思路>WAV思路</a><ul><li><a href=#1silenteye隐写>1、Silenteye隐写</a></li><li><a href=#2deepsound隐写可以无密码>2、Deepsound隐写（可以无密码）</a></li><li><a href=#3业余无线电数据>3、业余无线电数据：</a></li><li><a href=#4steghide隐写可以无密码>4、steghide隐写(可以无密码)</a></li><li><a href=#5openpuff隐写有密码>5、OpenPuff隐写（有密码）</a></li><li><a href=#6stegpy隐写>6、stegpy隐写</a></li><li><a href=#7deegger-embedder隐写>7、DeEgger Embedder隐写</a></li><li><a href=#8写脚本提取音频数据并分析>8、写脚本提取音频数据并分析</a><ul><li><a href=#提取wav中lsb隐写的数据>提取WAV中LSB隐写的数据</a></li><li><a href=#提取并分析wav左右声道的差值>提取并分析WAV左右声道的差值</a></li><li><a href=#使用脚本提取wav数据进行分析>使用脚本提取WAV数据进行分析</a></li><li><a href=#提取两个wav音频中的浮点集并分析>提取两个WAV音频中的浮点集并分析</a></li><li><a href=#提取音频数据并转为图片>提取音频数据并转为图片</a></li><li><a href=#音频频率映射到字符>音频频率映射到字符</a></li></ul></li></ul></li><li><a href=#midi-思路>MIDI 思路</a><ul><li><a href=#直接用audacity打开可以看到字符>直接用audacity打开可以看到字符</a></li><li><a href=#velato编程语言>velato编程语言</a></li><li><a href=#从流量中提取midi文件>从流量中提取MIDI文件</a></li><li><a href=#lsb隐写>LSB隐写</a></li></ul></li><li><a href=#ogg思路>OGG思路</a></li></ul></li><li><a href=#misc取证题思路>Misc——取证题思路</a></li><li><a href=#miscosint社工题思路>Misc——OSINT社工题思路</a><ul><li><a href=#1用谷歌必应yandex识图>1、用谷歌/必应/yandex识图</a></li><li><a href=#2使用百度地图查看实景地图>2、使用百度地图查看实景地图</a></li><li><a href=#3有时候会给你个图片哈希让选手去找原图>3、有时候会给你个图片哈希，让选手去找原图</a></li><li><a href=#4给个-git-提交的哈希让选手去-github-找提交的具体内容>4、给个 Git 提交的哈希，让选手去 Github 找提交的具体内容</a></li></ul></li><li><a href=#others>Others</a><ul><li><a href=#hashcat的使用>Hashcat的使用</a><ul><li><a href=#哈希对照表>哈希对照表</a></li><li><a href=#爆破参数>爆破参数</a></li><li><a href=#比赛中使用的一些例子>比赛中使用的一些例子</a></li><li><a href=#结合-john-生成哈希并爆破>结合 john 生成哈希并爆破</a><ul><li><a href=#zip2john>zip2john</a></li><li><a href=#rar2john>rar2john</a></li><li><a href=#office2john>office2john</a></li><li><a href=#deepsound2john>deepsound2john</a></li></ul></li></ul></li><li><a href=#字节序>字节序</a><ul><li><a href=#字节序的转换>字节序的转换</a></li></ul></li><li><a href=#linux-tar命令>Linux tar命令</a><ul><li><a href=#打包压缩>打包压缩</a></li><li><a href=#解压提取>解压提取</a></li></ul></li><li><a href=#pyc隐写>pyc隐写</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>最开始接触CTF时，学的最多的就是Misc，各种编码与加密还有各种软件的使用等等</strong></p><p><strong>但Misc涉及的范围实在太广了，于是就想着一边学习一边记录，因而就有了这篇文章</strong></p><div class="details admonition success open"><div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-check" aria-hidden=true></i>阅前须知<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p><strong>文章更新周期较长，如有疏漏，欢迎指正</strong></p><p><strong>若你也对Misc感兴趣或者对本文中的内容有疑问，欢迎加入我的<a href=https://t.zsxq.com/an6p6 target=_blank rel="external nofollow noopener noreferrer">知识星球</a></strong></p><p><strong>进星球后可第一时间获取文章后续更新</strong></p><p><strong>文章创作不易，感谢你能看到这里，转载还请标明出处</strong></p></div></div></div><h2 class=heading-element id=一些奇奇怪怪的经历><span>一些奇奇怪怪的经历</span>
<a href=#%e4%b8%80%e4%ba%9b%e5%a5%87%e5%a5%87%e6%80%aa%e6%80%aa%e7%9a%84%e7%bb%8f%e5%8e%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>1、rockstar 编程语言，在github上面可以找到，然后在本地用pip安装库，把rock文件转换为py文件，运行即可得到flag</p><p>2、给你一个.exe安装包文件，flag藏在安装之前的一大串协议中</p><p>3、实在做不出来的时候，可以把flag的格式转其他的编码和题目中的信息比对找规律</p><p>4、给你一个gpx文件，在线网站https://www.gpsvisualizer.com/map_input解密，然后地名的首字母连起来就是flag</p><h2 class=heading-element id=ctf中的常用关键词><span>CTF中的常用关键词</span>
<a href=#ctf%e4%b8%ad%e7%9a%84%e5%b8%b8%e7%94%a8%e5%85%b3%e9%94%ae%e8%af%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 要搜索的字符列表</span>
</span></span><span class=line><span class=cl><span class=n>search_items</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;key&#34;</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=p>,</span> <span class=s2>&#34;dasctf&#34;</span><span class=p>,</span> <span class=s2>&#34;k3y&#34;</span><span class=p>,</span> <span class=s2>&#34;p@ssword&#34;</span><span class=p>,</span> <span class=s2>&#34;passw0rd&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;p@ssw0rd&#34;</span><span class=p>,</span> <span class=s2>&#34;secret&#34;</span><span class=p>,</span> <span class=s2>&#34;s3cret&#34;</span><span class=p>,</span> <span class=s2>&#34;s3cr3t&#34;</span><span class=p>,</span> <span class=s2>&#34;s3cre4&#34;</span><span class=p>,</span><span class=s2>&#34;F14ggg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Ic4unq1U&#34;</span><span class=p>,</span> <span class=s2>&#34;ISCC&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 遇到⼀个加⼀个，CTFer的好习惯</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>查找的Python代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 要搜索的字符列表</span>
</span></span><span class=line><span class=cl><span class=n>search_items</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;key&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;password&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;dasctf&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;k3y&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;p@ssword&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;passw0rd&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;p@ssw0rd&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;secret&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;s3cret&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;s3cr3t&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;s3cre4&#34;</span><span class=p>,</span><span class=sa>b</span><span class=s2>&#34;F14ggg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 遇到⼀个加⼀个，CTFer的好习惯</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>file_path</span> <span class=o>=</span> <span class=s2>&#34;test.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>search_items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># re.escape(item) 用于转义 item 中的特殊字符, 确保它们被当作普通字符处理</span>
</span></span><span class=line><span class=cl>    <span class=c1># re.IGNORECASE 标志使得匹配不区分大小写。</span>
</span></span><span class=line><span class=cl>    <span class=n>regex</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>escape</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;.*&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>IGNORECASE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=k>match</span> <span class=ow>in</span> <span class=n>regex</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>data</span><span class=p>):</span> <span class=c1># finditer 返回一个迭代器，每次迭代返回一个匹配对象</span>
</span></span><span class=line><span class=cl>        <span class=n>matched_text</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>()</span> <span class=c1># 返回匹配到的完整文本</span>
</span></span><span class=line><span class=cl>        <span class=c1># 若匹配到，则显示前50个字节</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Found </span><span class=si>{</span><span class=n>item</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2> match: </span><span class=si>{</span><span class=n>matched_text</span><span class=p>[:</span><span class=mi>50</span><span class=p>]</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 各种常用关键字的bash64编码</span>
</span></span><span class=line><span class=cl><span class=n>flag</span>                          <span class=n>Zmxh</span>
</span></span><span class=line><span class=cl><span class=n>F14g</span>                          <span class=n>RjE0</span>
</span></span><span class=line><span class=cl><span class=n>DASCTF</span>                        <span class=n>REFTQ1RGe</span>
</span></span><span class=line><span class=cl><span class=n>s3cr3t</span>                        <span class=n>czNjcjN0</span>
</span></span><span class=line><span class=cl><span class=n>secret</span>                        <span class=n>c2VjcmV0</span>
</span></span><span class=line><span class=cl><span class=n>password</span>                      <span class=n>cGFzc3dvc</span>
</span></span><span class=line><span class=cl><span class=n>PNG文件头</span>                      <span class=n>iVBORw0KGgo</span>
</span></span><span class=line><span class=cl><span class=n>ZIP文件头</span>                      <span class=n>UEsDBA</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=各种文件头尾><span>各种文件头/尾</span>
<a href=#%e5%90%84%e7%a7%8d%e6%96%87%e4%bb%b6%e5%a4%b4%e5%b0%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>这里要注意，出题人可能会把文件头的小写字母偷偷改成大写，例如：Rar -> RAR</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>zip</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>50</span> <span class=mi>4</span><span class=n>B</span> <span class=mi>03</span> <span class=mi>04</span> <span class=mi>14</span> <span class=mi>00</span> <span class=mi>08</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl><span class=n>rar</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>52</span> <span class=mi>61</span> <span class=mi>72</span> <span class=mi>21</span> <span class=p>(</span><span class=n>Rar</span><span class=err>!</span><span class=p>)</span>               <span class=n>文件尾</span><span class=err>：</span><span class=n>C4</span> <span class=mi>3</span><span class=n>D</span> <span class=mi>7</span><span class=n>B</span> <span class=mi>00</span> <span class=mi>40</span> <span class=mi>07</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl><span class=mi>7</span><span class=n>z</span>  <span class=n>文件头</span><span class=err>：</span><span class=mi>37</span> <span class=mi>7</span><span class=n>A</span> <span class=n>BC</span> <span class=n>AF</span> <span class=mi>27</span> <span class=mi>1</span><span class=n>C</span>
</span></span><span class=line><span class=cl><span class=n>gz</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>1</span><span class=n>F</span> <span class=mi>8</span><span class=n>B</span> <span class=mi>08</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>png</span> <span class=n>文件头</span><span class=err>：</span><span class=mf>89504E47</span> <span class=mi>0</span><span class=n>D0A1A0A</span> <span class=mi>0000000</span><span class=n>D</span> <span class=mi>49484452</span>   <span class=n>文件尾</span><span class=err>：</span><span class=mi>00000000</span> <span class=mf>49454E44</span> <span class=n>AE426082</span>
</span></span><span class=line><span class=cl><span class=n>jpg</span> <span class=n>文件头</span><span class=err>：</span><span class=n>FF</span> <span class=n>D8</span> <span class=n>FF</span> <span class=n>E0</span> <span class=mi>00</span> <span class=mi>10</span> <span class=mi>4</span><span class=n>A</span> <span class=mi>46</span> <span class=mi>49</span> <span class=mi>46</span> <span class=mi>00</span> <span class=mi>01</span>
</span></span><span class=line><span class=cl><span class=n>gif</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>47</span> <span class=mi>49</span> <span class=mi>46</span> <span class=mi>38</span> <span class=mi>39</span> <span class=mi>61</span><span class=err>（</span><span class=n>GIF89A</span><span class=err>）</span><span class=n>或</span> <span class=mi>47</span> <span class=mi>49</span> <span class=mi>46</span> <span class=mi>38</span> <span class=mi>37</span> <span class=mi>61</span><span class=err>（</span><span class=n>GIF87A</span><span class=err>）</span>    <span class=n>文件尾</span><span class=err>：</span><span class=mi>00</span> <span class=mi>3</span><span class=n>B</span>
</span></span><span class=line><span class=cl><span class=n>bmp</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>42</span> <span class=mi>4</span><span class=n>D</span>
</span></span><span class=line><span class=cl><span class=n>psd</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>38</span> <span class=mi>42</span> <span class=mi>50</span> <span class=mi>53</span>
</span></span><span class=line><span class=cl><span class=n>TIFF</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>49</span> <span class=mi>49</span> <span class=mi>2</span><span class=n>A</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mp3</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>49</span> <span class=mi>44</span> <span class=mi>33</span> <span class=mi>03</span> <span class=mi>00</span> <span class=mi>00</span> <span class=mi>00</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl><span class=n>wav</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>57</span> <span class=mi>41</span> <span class=mi>56</span> <span class=mi>45</span> <span class=n>或</span> <span class=mi>52</span> <span class=mi>49</span> <span class=mi>46</span> <span class=mi>46</span>
</span></span><span class=line><span class=cl><span class=n>mid</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>4</span><span class=n>D</span> <span class=mi>54</span> <span class=mi>68</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=n>avi</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>41</span> <span class=mi>56</span> <span class=mi>49</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=n>mov</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>00</span> <span class=mi>00</span> <span class=mi>00</span> <span class=mi>20</span> <span class=mi>66</span> <span class=mi>74</span> <span class=mi>79</span> <span class=mi>70</span> <span class=mi>71</span> <span class=mi>74</span> <span class=mi>20</span> <span class=mi>20</span> <span class=mi>20</span> <span class=mi>05</span> <span class=mi>03</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl><span class=n>swf</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>46</span> <span class=mi>57</span> <span class=mi>53</span> <span class=mi>08</span> <span class=n>AC</span> <span class=mi>43</span> <span class=mi>00</span> <span class=mi>00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pyc</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>03</span> <span class=n>F3</span> <span class=mi>0</span><span class=n>D</span> <span class=mi>0</span><span class=n>A</span>
</span></span><span class=line><span class=cl><span class=n>MS</span><span class=o>-</span><span class=n>Office2003</span> <span class=n>文件头</span><span class=err>：</span><span class=n>D0</span> <span class=n>CF</span> <span class=mi>11</span> <span class=n>E0</span>
</span></span><span class=line><span class=cl><span class=n>xml</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>3</span><span class=n>C</span> <span class=mi>3</span><span class=n>F</span> <span class=mi>78</span> <span class=mi>6</span><span class=n>D</span> <span class=mi>6</span><span class=n>C</span>
</span></span><span class=line><span class=cl><span class=n>html</span> <span class=n>文件头</span><span class=err>：</span><span class=mi>68</span> <span class=mi>74</span> <span class=mi>6</span><span class=n>D</span> <span class=mi>6</span><span class=n>C</span> <span class=mi>3</span><span class=n>E</span>
</span></span><span class=line><span class=cl><span class=n>CAD</span> <span class=p>(</span><span class=n>dwg</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>41433130</span>
</span></span><span class=line><span class=cl><span class=n>Rich</span> <span class=n>Text</span> <span class=n>Format</span> <span class=p>(</span><span class=n>rtf</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>7</span><span class=n>B5C727466</span>
</span></span><span class=line><span class=cl><span class=n>Email</span> <span class=p>[</span><span class=n>thorough</span> <span class=n>only</span><span class=p>]</span> <span class=p>(</span><span class=n>eml</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>44656</span><span class=n>C69766572792D646174653A</span>
</span></span><span class=line><span class=cl><span class=n>Outlook</span> <span class=n>Express</span> <span class=p>(</span><span class=n>dbx</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=n>CFAD12FEC5FD746F</span>
</span></span><span class=line><span class=cl><span class=n>Outlook</span> <span class=p>(</span><span class=n>pst</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>2142444</span><span class=n>E</span>
</span></span><span class=line><span class=cl><span class=n>MS</span> <span class=n>Access</span> <span class=p>(</span><span class=n>mdb</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mf>5374616E64617264204</span><span class=n>A</span>
</span></span><span class=line><span class=cl><span class=n>WordPerfect</span> <span class=p>(</span><span class=n>wpd</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=n>FF575043</span>
</span></span><span class=line><span class=cl><span class=n>Postscript</span> <span class=p>(</span><span class=n>eps</span><span class=o>.</span><span class=ow>or</span><span class=o>.</span><span class=n>ps</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>252150532</span><span class=n>D41646F6265</span>
</span></span><span class=line><span class=cl><span class=n>Adobe</span> <span class=n>Acrobat</span> <span class=p>(</span><span class=n>pdf</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>255044462</span><span class=n>D312E</span>
</span></span><span class=line><span class=cl><span class=n>Quicken</span> <span class=p>(</span><span class=n>qdf</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=n>AC9EBD8F</span>
</span></span><span class=line><span class=cl><span class=n>Windows</span> <span class=n>Password</span> <span class=p>(</span><span class=n>pwl</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=n>E3828596</span>
</span></span><span class=line><span class=cl><span class=n>Real</span> <span class=n>Audio</span> <span class=p>(</span><span class=n>ram</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mf>2E7261</span><span class=n>FD</span>
</span></span><span class=line><span class=cl><span class=n>Real</span> <span class=n>Media</span> <span class=p>(</span><span class=n>rm</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mf>2E524</span><span class=n>D46</span>
</span></span><span class=line><span class=cl><span class=n>MPEG</span> <span class=p>(</span><span class=n>mpg</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>000001</span><span class=n>BA</span> <span class=n>或</span> <span class=mi>000001</span><span class=n>B3</span>
</span></span><span class=line><span class=cl><span class=n>Quicktime</span> <span class=p>(</span><span class=n>mov</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>6</span><span class=n>D6F6F76</span>
</span></span><span class=line><span class=cl><span class=n>Windows</span> <span class=n>Media</span> <span class=p>(</span><span class=n>asf</span><span class=p>)</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>3026</span><span class=n>B2758E66CF11</span>
</span></span><span class=line><span class=cl><span class=n>M4a</span><span class=err>，</span><span class=n>文件头</span><span class=err>：</span><span class=mi>00000018667479704</span><span class=n>D3441</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=各种加密编码><span>各种加密/编码</span>
<a href=#%e5%90%84%e7%a7%8d%e5%8a%a0%e5%af%86%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=进制转换><span>进制转换</span>
<a href=#%e8%bf%9b%e5%88%b6%e8%bd%ac%e6%8d%a2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=二进制><span>二进制</span>
<a href=#%e4%ba%8c%e8%bf%9b%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>首先我们要知道可打印字符(包括空格)的Ascii码的范围在 <code>32-126</code></p><p>因此在二进制的情况下，应该在 <code>00100000 - 01111110</code> 这个范围</p><p>所以当我们拿到一串经过变换的二进制字符串，可以根据这个范围来猜测变换</p><p>举个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;1100001 000011 0111011 1110011 0100111 001011 0010111 1010111 100011 1000011 0010111 1001011 1111011 0111011 100001 100001 1001101 000011 1010111 1111101 0001011 1000011 0110111 110011 1111101 0000111 1000011 1100111 1100111 1010011 0010011 1111101 0010111 0001011 110011 1111101 0110011 1001011 0100111 1100111 0010111 1111101 0011011 110011 0110111 1010011 100011 100001 100001&#34;</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=mi>2</span><span class=p>)),</span> <span class=n>end</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2023 CISCN初赛 Tough_DNS</p><h4 class=heading-element id=三进制><span>三进制</span>
<a href=#%e4%b8%89%e8%bf%9b%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>这里放一道比较有意思的例题</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251105200005373.png alt=/posts/1ad9200/imgs/image-20251105200005373.png height=1056 width=1680></p><blockquote><p>注意到每隔五个手必然是点赞，猜测点赞是分隔符，剩下只有三个符号，可以联想到三进制</p><p>flag四个字母的三进制分别是10210 11000 10121 10211，所以 布对应1 剪刀对应2 石头对应0，按规律依次转换即可</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;10210 11000 10121 10211 11120 11002 1211 10200 1220 10112 10001 2222 10002 10112 11021 10222 1211 11000 11000 11112 11122&#34;</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>,</span><span class=mi>3</span><span class=p>)),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># flag{n1c3_RPS_sk1llz}</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=四进制><span>四进制</span>
<a href=#%e5%9b%9b%e8%bf%9b%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;121212301201121313230311120103100320030212011210121102310301030012111210023103100321030003110231120103200320031202310303031203210320031003121210030203131201030003201331&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=mi>4</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;flag{5a482ade-10ed-4905-a886-369846d27a08}&#39;</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2025 能源网络安全大赛 Bluetooth</p><p>例题2-2024 蓝桥杯全国总决赛 nothing</p><h4 class=heading-element id=八进制><span>八进制</span>
<a href=#%e5%85%ab%e8%bf%9b%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=mi>8</span><span class=p>)))</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2025 上海市赛 两个数</p><h3 class=heading-element id=base家族><span>base家族</span>
<a href=#base%e5%ae%b6%e6%97%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>详细请看：https://www.cnblogs.com/0yst3r-2046/p/11962942.html</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1、base16                       flag         666C6167
</span></span><span class=line><span class=cl>2、base32[A-Z2-7]               flag         MZWGCZY=
</span></span><span class=line><span class=cl>3、base36                       flag         727432
</span></span><span class=line><span class=cl>4、base58                       flag         3cr9Ae
</span></span><span class=line><span class=cl>5、base64                       flag         Zmxh
</span></span><span class=line><span class=cl>6、base85                       flag         Ao(mg
</span></span><span class=line><span class=cl>7、base91                       flag         @iH&lt;Z
</span></span><span class=line><span class=cl>8、base92                       flag         F#S&lt;I
</span></span><span class=line><span class=cl>9、base100(emoji)               flag         👝👣👘👞
</span></span><span class=line><span class=cl>10、base1024                    flag
</span></span><span class=line><span class=cl>11、base2048                    flag         ڥڊװ
</span></span><span class=line><span class=cl>12、base65535                   flag         ꍦ鱡</span></span></code></pre></td></tr></table></div></div><p>base64还可以换表(表中的字符要求不重复)编码，例如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sQ+3ja02RchXLUFmNSZoYPlr8e/HVqxwfWtd7pnTADK15Evi9kGOMgbuIzyB64CJ
</span></span><span class=line><span class=cl>SjaoNgS0xgagUTpwe3QwHn4MrbkD/OUwqOQG/bpveg6Mqa4WH0k46
</span></span><span class=line><span class=cl>第一行是表，第二行是编码后的密文
</span></span><span class=line><span class=cl>cyberchef解密即可得到flag</span></span></code></pre></td></tr></table></div></div><p>Tips：base64可以与其他文件格式互相转换（比如图片[会有很多行的base64]），使用在线网站或者随波逐流转换即可
如果出现了很多层乱七八糟的base编码，连CyberChef都识别不出来的话，可以试试用BaseCrack这个开源工具
输入 python basecrack.py -m 运行即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/basecrack.png alt=basecrack height=1600 width=2560></p><h3 class=heading-element id=base64隐写><span>base64隐写</span>
<a href=#base64%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以使用以下脚本解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># base64隐写解密脚本1</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=n>b64chars</span> <span class=o>=</span> <span class=s1>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;stego.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>bin_str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>stegb64</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>line</span><span class=p>,</span> <span class=s2>&#34;utf-8&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>rowb64</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>stegb64</span><span class=p>)),</span> <span class=s2>&#34;utf-8&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>offset</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>b64chars</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>stegb64</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>-</span> <span class=n>b64chars</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>rowb64</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>equalnum</span> <span class=o>=</span> <span class=n>stegb64</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>  <span class=c1># no equalnum no offset</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>equalnum</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bin_str</span> <span class=o>+=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>offset</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=n>equalnum</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_str</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>bin_str</span><span class=p>),</span> <span class=mi>8</span><span class=p>)]))</span>  <span class=c1># 8 位一组</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># base64隐写解密脚本2</span>
</span></span><span class=line><span class=cl><span class=n>file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./base64.txt&#39;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=s2>&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>aaa</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>  <span class=c1># 只读取一行内容</span>
</span></span><span class=line><span class=cl>    <span class=c1># 判断是否读取到内容</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>text</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>aaa</span> <span class=o>=</span> <span class=n>aaa</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{:02b}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>((</span><span class=n>a</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=o>-</span><span class=mi>2</span><span class=p>]))</span> <span class=o>%</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>text</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>aaa</span> <span class=o>=</span> <span class=n>aaa</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{:04b}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>((</span><span class=n>a</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=o>-</span><span class=mi>3</span><span class=p>]))</span> <span class=o>%</span> <span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ttt</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>aaa</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ttt</span> <span class=o>=</span> <span class=n>ttt</span><span class=o>//</span><span class=mi>8</span><span class=o>*</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>ttt</span><span class=p>,</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>t</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span> <span class=n>aaa</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>],</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>t</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>或者直接使用PuzzleSolver解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241120164908626.png alt=/posts/1ad9200/imgs/image-20241120164908626.png height=752 width=752></p><blockquote><p>这里要注意多行base64编码可能会出现需要我们自己补全=的情况（例题-攻防世界 MISC - tunnel）</p><p>可以使用下面的脚本补全，也可以直接用上面那个工具补全</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./result.txt&#39;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>content</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;(.*?).evil.im&#39;</span><span class=p>,</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=mi>4</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>%</span><span class=mi>4</span><span class=p>)</span> <span class=o>*</span> <span class=s1>&#39;=&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./base64.txt&#39;</span><span class=p>,</span><span class=s1>&#39;a+&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>f1</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>result</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=md5加密><span>MD5加密</span>
<a href=#md5%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>明文：admin
</span></span><span class=line><span class=cl>32位小写21232f297a57a5a743894a0e4a801fc3 
</span></span><span class=line><span class=cl>32位大写21232F297A57A5A743894A0E4A801FC3 
</span></span><span class=line><span class=cl>16位小写7a57a5a743894a0e 
</span></span><span class=line><span class=cl>16位大写7A57A5A743894A0E 
</span></span><span class=line><span class=cl>Tips：十六位其实就是取32位的8-24位</span></span></code></pre></td></tr></table></div></div><p>MD5 加密后的密文都是十六进制字符</p><p>可以尝试在<a href=https://www.somd5.com/ target=_blank rel="external nofollow noopener noreferrer">somd5</a>或者<a href=https://cmd5.com/ target=_blank rel="external nofollow noopener noreferrer">CMD5</a>上反查MD5</p><h3 class=heading-element id=rc4加密算法><span>RC4加密算法</span>
<a href=#rc4%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>举个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>密文：VWap58FvOtV1VNlmdcyKiaNVhPsWQRFYqt/duezhcddcVXmz5zhQyoc7
</span></span><span class=line><span class=cl>密钥：20250606
</span></span><span class=line><span class=cl>明文：flag{edb99a94-f84d-e175-8a7d-e7f658789447}</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=des加密算法><span>DES加密算法</span>
<a href=#des%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>DES加密算法的密钥是8字节，举个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>密文：AK5O3BaZi+p1ci0JxythDZWToTXkFj4dexQ3cOAmYfUwtUVyJahFOcNroC8nAsHyCnmiuOOpJYyOWBV5npW3pg==
</span></span><span class=line><span class=cl>密钥：hristina</span></span></code></pre></td></tr></table></div></div><p>直接用在线网站解密即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241105212634286.png alt=/posts/1ad9200/imgs/image-20241105212634286.png height=978 width=1912></p><p>DES由于安全性上的问题，后来逐渐被AES所替代，详细可以参考<a href=https://crypto.stackexchange.com/questions/7938/may-the-problem-with-des-using-ofb-mode-be-generalized-for-all-feistel-ciphers target=_blank rel="external nofollow noopener noreferrer">这篇文章</a></p><p>因此DES存在以下四个弱密钥，当题目没给密钥的时候可以用下面几个试试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>b&#39;\x00\x00\x00\x00\x00\x00\x00\x00&#39;
</span></span><span class=line><span class=cl>b&#39;\x1E\x1E\x1E\x1E\x0F\x0F\x0F\x0F&#39;
</span></span><span class=line><span class=cl>b&#34;\xE1\xE1\xE1\xE1\xF0\xF0\xF0\xF0&#34;
</span></span><span class=line><span class=cl>b&#34;\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF&#34;</span></span></code></pre></td></tr></table></div></div><p>当然这里也可以延伸出去，用下面这个脚本去爆破密钥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>DES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>itertools</span> <span class=kn>import</span> <span class=n>product</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64decode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BYTES</span> <span class=o>=</span> <span class=p>[</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x1E</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xE1</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xF0</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x0F</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xFF</span><span class=s1>&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>byte_combinations</span> <span class=o>=</span> <span class=n>product</span><span class=p>(</span><span class=n>BYTES</span><span class=p>,</span> <span class=n>repeat</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>combo</span> <span class=ow>in</span> <span class=n>byte_combinations</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>combo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>brute_force_decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>generate_keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>DES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>DES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>decrypted</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>decrypted</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;FLAG&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found valid key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Decrypted data: </span><span class=si>{</span><span class=n>decrypted</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>encrypted_data</span> <span class=o>=</span> <span class=n>b64decode</span><span class=p>(</span><span class=s2>&#34;ftNbIBh+yU8rzOhvbAplhB1hoQkblsKa+uGaNnTudD2LGw0+5fOHXycXZDujJFWwHZjIg5bfDpKFsqI18Ts7ZGG8dpqWAzar&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>found_key</span> <span class=o>=</span> <span class=n>brute_force_decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>found_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No valid key found.&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=aes加密算法><span>AES加密算法</span>
<a href=#aes%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以尝试用<code>CyberChef</code>或者在线网站解密：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=k>tool</span><span class=o>.</span><span class=n>lmeee</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>jiami</span><span class=o>/</span><span class=n>aes</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>sojson</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>encrypt_aes</span><span class=o>.</span><span class=n>html</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>the</span><span class=o>-</span><span class=n>x</span><span class=o>.</span><span class=n>cn</span><span class=o>/</span><span class=n>cryptography</span><span class=o>/</span><span class=n>aes</span><span class=o>.</span><span class=n>aspx</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>因为 AES 的密钥长度可以是 16/24/32 字节，即 128/192/256位</p><p>因此解不出来的时候可以试试 Padding \x00 到更长的位数</p><p>例如下面这道题：</p><p>AES-ECB 密文：q8TTfmlBwyT1QPLiZS9ixWKzS5h7aYgOUlaxNMJmE763AIoZ66FRHXFeYYWZBbLn</p><p>AES-ECB 密钥：MySuperSecretKey!</p><p>需要把密钥用 \x00 Padding 到 32 字节才能正确解密</p></blockquote><h4 class=heading-element id=aes-ecb不需要iv><span>AES-ECB(不需要IV)</span>
<a href=#aes-ecb%e4%b8%8d%e9%9c%80%e8%a6%81iv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>如果 <code>key</code> 不足16字节可以尝试在后面补0</p><h4 class=heading-element id=aes-cbc需要iv><span>AES-CBC(需要IV)</span>
<a href=#aes-cbc%e9%9c%80%e8%a6%81iv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>Tips: CBC模式下key的长度必须是16bytes的整数倍，但是IV不一定</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241116212331838.png alt=/posts/1ad9200/imgs/image-20241116212331838.png height=1668 width=2940></p><p>密钥不足16字节时需要padding补齐16字节</p><p>可以使用能自动补齐的在线网站解密 <a href=https://www.sojson.com/encrypt_aes.html target=_blank rel="external nofollow noopener noreferrer">https://www.sojson.com/encrypt_aes.html</a></p><p><img loading=lazy src=/posts/1ad9200/imgs/aes1.png alt=/posts/1ad9200/imgs/aes1.png height=776 width=2061></p><p>也可以用<code>CaptfEncoder-win-x64-1.3.0</code>解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/aes2.png alt=/posts/1ad9200/imgs/aes2.png height=1600 width=2560></p><p>如何使用openssl进行加解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ==================== 加密命令 ====================</span>
</span></span><span class=line><span class=cl>tar -czvf - flag <span class=p>|</span> openssl des3 -salt -k th1sisKey -out ./flag.tar.gz
</span></span><span class=line><span class=cl><span class=c1># 功能：打包压缩文件并用3DES加密</span>
</span></span><span class=line><span class=cl><span class=c1># 参数说明：</span>
</span></span><span class=line><span class=cl><span class=c1>#   tar: </span>
</span></span><span class=line><span class=cl><span class=c1>#     -c 创建归档</span>
</span></span><span class=line><span class=cl><span class=c1>#     -z 使用gzip压缩 </span>
</span></span><span class=line><span class=cl><span class=c1>#     -v 显示过程</span>
</span></span><span class=line><span class=cl><span class=c1>#     -f - 输出到stdout</span>
</span></span><span class=line><span class=cl><span class=c1>#   openssl:</span>
</span></span><span class=line><span class=cl><span class=c1>#     des3 使用3DES算法</span>
</span></span><span class=line><span class=cl><span class=c1>#     -salt 添加随机盐值</span>
</span></span><span class=line><span class=cl><span class=c1>#     -k 密码(此处为th1sisKey)</span>
</span></span><span class=line><span class=cl><span class=c1>#     -out 输出文件</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== 解密命令 ==================== </span>
</span></span><span class=line><span class=cl>openssl des3 -d -salt -k th1sisKey -in ./flag.tar.gz -out decrypted_file
</span></span><span class=line><span class=cl><span class=c1># 功能：解密3DES加密的文件</span>
</span></span><span class=line><span class=cl><span class=c1># 参数说明：</span>
</span></span><span class=line><span class=cl><span class=c1>#   openssl:</span>
</span></span><span class=line><span class=cl><span class=c1>#     -d 解密模式</span>
</span></span><span class=line><span class=cl><span class=c1>#     -in 输入文件</span>
</span></span><span class=line><span class=cl><span class=c1>#     -out 输出文件</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=国密sm系列加密算法><span>国密(SM)系列加密算法</span>
<a href=#%e5%9b%bd%e5%af%86sm%e7%b3%bb%e5%88%97%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th style=text-align:center>算法</th><th style=text-align:center>算法类型</th><th style=text-align:center>密钥类型</th><th style=text-align:center>长度（位）</th><th style=text-align:center>长度（字节）</th><th style=text-align:center>备注</th></tr></thead><tbody><tr><td style=text-align:center><strong>SM4</strong></td><td style=text-align:center>对称加密</td><td style=text-align:center>密钥</td><td style=text-align:center>128 bits</td><td style=text-align:center><strong>16 字节</strong></td><td style=text-align:center>固定长度</td></tr><tr><td style=text-align:center><strong>SM2</strong></td><td style=text-align:center>非对称加密</td><td style=text-align:center>私钥</td><td style=text-align:center>256 bits</td><td style=text-align:center><strong>32 字节</strong></td><td style=text-align:center>固定长度（一个大整数）</td></tr><tr><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>公钥（原始值）</td><td style=text-align:center>512 bits</td><td style=text-align:center><strong>64 字节</strong></td><td style=text-align:center>两个32字节的整数（x，y）</td></tr><tr><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>公钥（编码后）</td><td style=text-align:center>-</td><td style=text-align:center>65 或 33 字节</td><td style=text-align:center>常见带<code>0x04</code>前缀的为65字节</td></tr><tr><td style=text-align:center><strong>SM9</strong></td><td style=text-align:center>非对称加密</td><td style=text-align:center>主密钥/用户密钥</td><td style=text-align:center>可变</td><td style=text-align:center><strong>可变</strong></td><td style=text-align:center>取决于安全参数，通常远长于SM2密钥</td></tr></tbody></table><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250819214101200.png alt=/posts/1ad9200/imgs/image-20250819214101200.png height=1026 width=2796></p><h3 class=heading-element id=emoji-aes加密><span>emoji-aes加密</span>
<a href=#emoji-aes%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>密文由一大串emoji表情组成，解密需要密钥</p><p>例如已知key：<code>th1sisKey</code>，直接使用<a href=https://aghorler.github.io/emoji-aes/ target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密即可，也可以下载源码然后本地解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>🙃💵🌿🎤🚪🌏🐎🥋🚫😆😍🔬👣🖐🌏😇🥋😇😊🍎🏹👌🌊☃🦓🌏🐅🥋🚨📮🐍🎈📮📂✅🐍⏩⌨🎈😍🌊😇🐍☺💧🥋🍌🎤🍍😇👁🦓😇🍍📮📂🎅😡🍵✖✉🏹⌨🍵🎤😆🍵🚹🏹🍎🚨ℹ☃👑🎤🚪💵😎😀😎🔬💵🦓🏹👉🦓✖😀🐘🔪⌨🎈🥋👌🍌🚹😂✉🍎🍌🏎👌🏹💵👌👁🎃🗒</span></span></code></pre></td></tr></table></div></div><blockquote><p>如果题目给了emoji但是没给密钥，可能就是base100编码</p></blockquote><h3 class=heading-element id=字频爆破><span>字频爆破</span>
<a href=#%e5%ad%97%e9%a2%91%e7%88%86%e7%a0%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>给一段字符串，看着什么编码都不像然后也没啥规律的，可能是字频爆破</p><p>可以尝试用在线网站<a href=https://quipqiup.com/ target=_blank rel="external nofollow noopener noreferrer">quipquip</a>进行词频爆破</p><blockquote><p>这个的爆破原理就是，我们平常可读的字符串中，某些字母出现的频率是差不多的</p><p>当我们在解某段密文时不知道具体单表替换的表，也可以尝试直接词频爆破</p></blockquote><p>例题1-2025SUCTF-SU_forensics</p><h3 class=heading-element id=字频统计><span>字频统计</span>
<a href=#%e5%ad%97%e9%a2%91%e7%bb%9f%e8%ae%a1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接用<code>随波逐流CTF编码工具</code>统计每个字母出现的次数就行</p><h3 class=heading-element id=摩斯电码><span>摩斯电码</span>
<a href=#%e6%91%a9%e6%96%af%e7%94%b5%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>从原理上来说，只要是三种字符构成的编码都有可能是摩斯电码</p></blockquote><p>用 <code>空格</code> 或者 <code>/</code> 做分隔符，然后字符可以用 <code>0和1</code> 或者 <code>.和-</code></p><p>下面举几个典型例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>..-. .-.. .- --.  - .... .. ... ..--.- .. ... ..--.- - . ... - ..--.- ..-. .-.. .- --. </span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.--/./.-../-.-./---/--/./-/---/-./-.-/-.-./-/..-./--..--/-/...././.--./.-/.../.../.--/---/.-./-../../.../.----/-..../-.../-.--/-/./.../.-./.-/-./-../---/--/.-../-.--/--././-././.-./.-/-/./-../--..-</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># C替换为-, P替换为., D替换为空格即可
</span></span><span class=line><span class=cl>CCPPDPCCCDCPDPPCDCPCPDCDPPCPDDCPCPDPCCPDCPPDCPPDPPCCPCDPCCCCDPPPDPPCCPCDCCDCCCCCDPPPCCDPPPDPD</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=栅栏密码fence><span>栅栏密码(fence)</span>
<a href=#%e6%a0%85%e6%a0%8f%e5%af%86%e7%a0%81fence class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>所谓栅栏密码，就是把要加密的明文分成N个一组，然后把每组的第1个字连起来，形成一段无规律的话。栅栏密码可以分为标准型和W型</p><p>可以直接用随波逐流或者<a href=https://ctf.bugku.com/tool/railfence target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密</p><p>有时候题目提示了栅栏密码，不一定是栅栏密码解密，也有可能是要用栅栏密码加密</p><p>举个例子：</p><blockquote><p>密文: eXV5d2V4eDV0OHc2ejEwNXt5dTgwNXUzMzl5MjcxNDAydn00OHQ=</p><p>base64_deocde: yuywexx5t8w6z105{yu805u339y271402v}48t</p><p>W型栅栏加密(偏移量为3): yetz{03728uwx58615y8539210v4tyxw0uuy4}</p><p>凯撒密码: flag{03728bde58615f8539210c4afed0bbf4}</p></blockquote><h3 class=heading-element id=维吉尼亚密码vigenere><span>维吉尼亚密码(vigenere)</span>
<a href=#%e7%bb%b4%e5%90%89%e5%b0%bc%e4%ba%9a%e5%af%86%e7%a0%81vigenere class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、给了密文和密钥：</p><p>可以用<code>cyberchef</code>或者<a href=https://ctf.bugku.com/tool/vigenere target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密</p><p>2、给了密文，没给密钥：</p><p>可以尝试用<a href=https://www.guballa.de/vigenere-solver target=_blank rel="external nofollow noopener noreferrer">在线网站</a>爆破</p><p>3、给了密文，没给密钥，但是知道明文的前几位：</p><p>可以根据对照表，手搓密钥的前几位，说不定就找到规律直接解出来了</p><p><img loading=lazy src=/posts/1ad9200/imgs/vigenere.png alt=vigenere height=2024 width=3827>
4、给了密钥字典，直接写脚本爆破</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pycipher</span> <span class=kn>import</span> <span class=n>Vigenere</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s2>&#34;rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;keys.txt&#34;</span><span class=p>,</span><span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>Vigenere</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=o>.</span><span class=n>decipher</span><span class=p>(</span><span class=n>cipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;PASSWORD&#34;</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] res: </span><span class=si>{</span><span class=n>res</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=希尔密码hill><span>希尔密码(Hill)</span>
<a href=#%e5%b8%8c%e5%b0%94%e5%af%86%e7%a0%81hill class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>解密网站:http://www.metools.info/code/hillcipher243.html</p><p>已知密文和密钥，并且密钥(key)是一个网址，如http://www.verymuch.net</p><p>已知密文和密钥，并且密钥是四个数字</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>密文：ymyvzjtxswwktetpyvpfmvcdgywktetpyvpfuedfnzdjsiujvpwktetpyvnzdjpfkjssvacdgywktetpyvnzdjqtincduedfpfkjssne
</span></span><span class=line><span class=cl>密钥：3 4 19 11</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=rabbit加密><span>Rabbit加密</span>
<a href=#rabbit%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>通常题目会提示是用<code>Rabbit加密</code>，然后密文通常以<code>U2FsdGVkX1</code>开头，解 base64 可以得到<code>Salted</code>，这是调用了 <code>js-crypt</code> 库加密的特征</p><p>可以使用<a href=https://www.sojson.com/encrypt_rabbit.html target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密，可以用<code>PuzzleSolver</code>中的 PBE 解密</p><h3 class=heading-element id=云影密码><span>云影密码</span>
<a href=#%e4%ba%91%e5%bd%b1%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>特征是：密文只由01248组成</p><p>用<code>随波逐流CTF编码工具</code>解密或者用下面的脚本解密</p><blockquote><p>云影密码的原理就是：以0作为分隔符分组，然后把每组数字相加得到一个数字，这个数字对应的就是26字母中的下标</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 云影密码</span>
</span></span><span class=line><span class=cl><span class=n>ciphey</span><span class=o>=</span><span class=s2>&#34;8842101220480224404014224202480122&#34;</span>
</span></span><span class=line><span class=cl><span class=n>enc_list</span><span class=o>=</span><span class=n>ciphey</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>enc_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>enc_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>sum</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>num</span> <span class=ow>in</span> <span class=n>item</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>sum</span> <span class=o>+=</span> <span class=nb>int</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>sum</span><span class=o>+</span><span class=mi>64</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>res</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=曼彻斯特与差分曼彻斯特编码><span>曼彻斯特与差分曼彻斯特编码</span>
<a href=#%e6%9b%bc%e5%bd%bb%e6%96%af%e7%89%b9%e4%b8%8e%e5%b7%ae%e5%88%86%e6%9b%bc%e5%bd%bb%e6%96%af%e7%89%b9%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240529203318823.png alt=/posts/1ad9200/imgs/image-20240529203318823.png height=473 width=889></p><blockquote><ol><li>曼彻斯特码：从高到低表示 1，从低到高表示 0</li><li>差分曼彻斯特码：在每个时钟周期的起始处（虚线处）有跳变表示 0；无跳变则表示1。</li></ol></blockquote><p>可以直接使用 曼彻斯特编码 转换工具转换</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240529203746999.png alt=/posts/1ad9200/imgs/image-20240529203746999.png height=465 width=673></p><p>例题1 2016CISCN-传感器1</p><blockquote><p>5555555595555A65556AA696AA6666666955</p><p>这是某压力传感器无线数据包解调后但未解码的报文(hex)</p><p>已知其ID为0xFED31F，请继续将报文完整解码，提交hex。</p><p>提示1：曼联</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=s2>&#34;5555555595555A65556AA696AA6666666955&#34;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag_final</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># tmp = bin(int(item, 16))[2:].rjust(4, &#39;0&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(tmp, end=&#39; &#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=mi>16</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># print(res)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>),</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;01&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;10&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># print(flag)</span>
</span></span><span class=line><span class=cl><span class=c1># 这里需要每8位进行一次反转，要不然无法得到校验ID:0xFED31F</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>flag</span><span class=p>),</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>flag_final</span> <span class=o>+=</span> <span class=nb>hex</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag_final</span><span class=o>.</span><span class=n>upper</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># FFFFFED31F645055F9</span></span></span></code></pre></td></tr></table></div></div><p>例题2 2016CISCN-传感器2</p><blockquote><p>现有某ID为0xFED31F的压力传感器，已知测得</p><p>压力为45psi时的未解码报文为：5555555595555A65556A5A96AA666666A955</p><p>压力为30psi时的未解码报文为：5555555595555A65556A9AA6AA6666665665</p><p>请给出ID为0xFEB757的传感器在压力为25psi时的解码后报文</p></blockquote><p>和上面那题的思路一样，就是最后多了一步压力位算法和校验位算法猜测</p><p>压力位算法：压力每增加5psi压力值增加11</p><p>校验位算法：校验值为从ID开始每字节相加的和模256的十六进制值即为校验值</p><p>例题3 2017CISCN-传感器1</p><blockquote><p>已知ID为0x8893CA58的温度传感器的未解码报文为：3EAAAAA56A69AA55A95995A569AA95565556</p><p>此时有另一个相同型号的传感器，其未解码报文为：3EAAAAA56A69AA556A965A5999596AA95656</p><p>请解出其ID，提交flag{不含0x的hex值}</p></blockquote><p>开头的3E提示了差分曼彻斯特编码，就是根据上图中的跳变位置解码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># enc = &#34;3EAAAAA56A69AA55A95995A569AA95565556&#34;</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=s2>&#34;3EAAAAA56A69AA556A965A5999596AA95656&#34;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag_final</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># tmp = bin(int(item, 16))[2:].rjust(4, &#39;0&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(tmp, end=&#39; &#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=mi>16</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>),</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>!=</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span> <span class=mi>2</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>upper</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1># 24D8845ABF34119</span>
</span></span><span class=line><span class=cl><span class=c1># 8845ABF3</span></span></span></code></pre></td></tr></table></div></div><p>例题4 2017CISCN-传感器2</p><blockquote><p>已知ID为0x8893CA58的温度传感器未解码报文为：3EAAAAA56A69AA55A95995A569AA95565556</p><p>为伪造该类型传感器的报文ID（其他报文内容不变），请给出ID为0xDEADBEEF的传感器1的报文校验位（解码后hex）</p><p>以及ID为0xBAADA555的传感器2的报文校验位（解码后hex），并组合作为flag提交。</p><p>例如，若传感器1的校验位为0x123456，传感器2的校验位为0xABCDEF，则flag为flag{123456ABCDEF}。</p></blockquote><p>解码步骤和上题一样，就是多考察了一个校验位算法（CRC8）</p><p>在最后的结果前面补一个0，然后再计算 CRC8 即可</p><h3 class=heading-element id=社会主义核心价值观密码><span>社会主义核心价值观密码</span>
<a href=#%e7%a4%be%e4%bc%9a%e4%b8%bb%e4%b9%89%e6%a0%b8%e5%bf%83%e4%bb%b7%e5%80%bc%e8%a7%82%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>密文由社会主义核心价值观中的词语构成：<code>富强民主文明和谐自由平等公正法治爱国敬业诚信友善</code></p><p>直接用<a href=https://ctf.bugku.com/tool/cvecode target=_blank rel="external nofollow noopener noreferrer">在线网站</a>或者<code>随波逐流CTF编码工具</code>解密即可</p><p>当然也可以写Python脚本调用第三方模块解密</p><h3 class=heading-element id=音乐符号加密><span>音乐符号加密</span>
<a href=#%e9%9f%b3%e4%b9%90%e7%ac%a6%e5%8f%b7%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>Tips：这里要注意，加密的密文一定是以 = 结尾的，有时候需要自己把=加上</p></blockquote><p>eg：♭♯♪‖¶♬♭♭♪♭‖‖♭♭♬‖♫♪‖♩♬‖♬♬♭♭♫‖♩♫‖♬♪♭♭♭‖¶∮‖‖‖‖♩♬‖♬♪‖♩♫♭♭♭♭♭§‖♩♩♭♭♫♭♭♭‖♬♭‖¶§♭♭♯‖♫∮‖♬¶‖¶∮‖♬♫‖♫♬‖♫♫§=</p><p>直接用在线网站解密即可：https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue</p><h3 class=heading-element id=敲击码><span>敲击码</span>
<a href=#%e6%95%b2%e5%87%bb%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/%E6%95%B2%E5%87%BB%E7%A0%81.jpeg alt=敲击码 height=330 width=907></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>5,2   3,1  3,1  3,2 
</span></span><span class=line><span class=cl> W     L    L    M</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=博多码><span>博多码</span>
<a href=#%e5%8d%9a%e5%a4%9a%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>最明显的特征就是五位二进制一组</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>11011 10101 10101 10101 11111 01110 11011 10101 10111 10101 00111 00111 11111 11001 11011 10000 00111 00001 10110 00111 00111 00111 00111 00111 00111 10000 11111 01101 11011 01010 11111 01001 11011 00001 10111 00111 00001 10101 00001 10000 11111 01101 11011 01010 11111 01001 11011 01010 10110 00111 00001 00111 01010 00001 00001 00111 10011 00001 00001 00001 00001 00001 00001 10011 10111 10011 10111 10011 10111 00111 11111 01001</span></span></code></pre></td></tr></table></div></div><p>直接用<code>随波逐流CTF编码工具</code>解密即可</p><p>例题1-2025宁波市赛-吾的字节</p><h3 class=heading-element id=格雷码><span>格雷码</span>
<a href=#%e6%a0%bc%e9%9b%b7%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>binary_to_gray</span><span class=p>(</span><span class=n>binary_str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;将两位二进制转换为两位格雷码&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary_str</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;输入必须是两位二进制&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 格雷码转换：第一位不变，第二位是第一位和第二位的异或</span>
</span></span><span class=line><span class=cl>    <span class=n>gray</span> <span class=o>=</span> <span class=n>binary_str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>binary_str</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>^</span> <span class=nb>int</span><span class=p>(</span><span class=n>binary_str</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gray</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2025上海市赛 两个数</p><h3 class=heading-element id=波利比奥斯方阵密码polybius><span>波利比奥斯方阵密码(Polybius)</span>
<a href=#%e6%b3%a2%e5%88%a9%e6%af%94%e5%a5%a5%e6%96%af%e6%96%b9%e9%98%b5%e5%af%86%e7%a0%81polybius class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>类似于<code>11，22，11，24</code>这样的</p><p>逗号改成空格，拉入随波逐流CTF编码工具直接解密即可</p><h3 class=heading-element id=埃特巴什码atbash><span>埃特巴什码(Atbash)</span>
<a href=#%e5%9f%83%e7%89%b9%e5%b7%b4%e4%bb%80%e7%a0%81atbash class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例如下面这段密文</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>WZHXGU{5v0u98z95u79829y7z484z54066xy08u}
</span></span><span class=line><span class=cl>DASCTF{5e0f98a95f79829b7a484a54066cb08f}</span></span></code></pre></td></tr></table></div></div><p>直接用<code>CyberChef</code>或者<code>随波逐流CTF编码工具</code>解密即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{ ==&gt; Atbash加密 ==&gt; UOZT{</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=dna编码><span>DNA编码</span>
<a href=#dna%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>AATTCAACAACATGCTGC</span></span></code></pre></td></tr></table></div></div><p>1、使用CTFD中的DNAcode脚本解密</p><p><a href=https://github.com/omemishra/DNA-Genetic-Python-Scripts-CTF target=_blank rel="external nofollow noopener noreferrer">https://github.com/omemishra/DNA-Genetic-Python-Scripts-CTF</a></p><p>2、网上找的脚本（红明谷杯2023——hacker）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=s1>&#39;ACGT&#39;</span>
</span></span><span class=line><span class=cl><span class=n>dic</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;AAA&#39;</span><span class=p>:</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;AAC&#39;</span><span class=p>:</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;AAG&#39;</span><span class=p>:</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=s1>&#39;AAT&#39;</span><span class=p>:</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;ACA&#39;</span><span class=p>:</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;ACC&#39;</span><span class=p>:</span> <span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;ACG&#39;</span><span class=p>:</span> <span class=s1>&#39;g&#39;</span><span class=p>,</span> <span class=s1>&#39;ACT&#39;</span><span class=p>:</span> <span class=s1>&#39;h&#39;</span><span class=p>,</span> <span class=s1>&#39;AGA&#39;</span><span class=p>:</span> <span class=s1>&#39;i&#39;</span><span class=p>,</span> <span class=s1>&#39;AGC&#39;</span><span class=p>:</span> <span class=s1>&#39;j&#39;</span><span class=p>,</span> <span class=s1>&#39;AGG&#39;</span><span class=p>:</span> <span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=s1>&#39;AGT&#39;</span><span class=p>:</span> <span class=s1>&#39;l&#39;</span><span class=p>,</span> <span class=s1>&#39;ATA&#39;</span><span class=p>:</span> <span class=s1>&#39;m&#39;</span><span class=p>,</span> <span class=s1>&#39;ATC&#39;</span><span class=p>:</span> <span class=s1>&#39;n&#39;</span><span class=p>,</span> <span class=s1>&#39;ATG&#39;</span><span class=p>:</span> <span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=s1>&#39;ATT&#39;</span><span class=p>:</span> <span class=s1>&#39;p&#39;</span><span class=p>,</span> <span class=s1>&#39;CAA&#39;</span><span class=p>:</span> <span class=s1>&#39;q&#39;</span><span class=p>,</span> <span class=s1>&#39;CAC&#39;</span><span class=p>:</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;CAG&#39;</span><span class=p>:</span> <span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=s1>&#39;CAT&#39;</span><span class=p>:</span> <span class=s1>&#39;t&#39;</span><span class=p>,</span> <span class=s1>&#39;CCA&#39;</span><span class=p>:</span> <span class=s1>&#39;u&#39;</span><span class=p>,</span> <span class=s1>&#39;CCC&#39;</span><span class=p>:</span> <span class=s1>&#39;v&#39;</span><span class=p>,</span> <span class=s1>&#39;CCG&#39;</span><span class=p>:</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=s1>&#39;CCT&#39;</span><span class=p>:</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;CGA&#39;</span><span class=p>:</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;CGC&#39;</span><span class=p>:</span> <span class=s1>&#39;z&#39;</span><span class=p>,</span> <span class=s1>&#39;CGG&#39;</span><span class=p>:</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;CGT&#39;</span><span class=p>:</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;CTA&#39;</span><span class=p>:</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;CTC&#39;</span><span class=p>:</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;CTG&#39;</span><span class=p>:</span> <span class=s1>&#39;E&#39;</span><span class=p>,</span> <span class=s1>&#39;CTT&#39;</span><span class=p>:</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;GAA&#39;</span><span class=p>:</span> <span class=s1>&#39;G&#39;</span><span class=p>,</span> <span class=s1>&#39;GAC&#39;</span><span class=p>:</span> <span class=s1>&#39;H&#39;</span><span class=p>,</span> <span class=s1>&#39;GAG&#39;</span><span class=p>:</span> <span class=s1>&#39;I&#39;</span><span class=p>,</span> <span class=s1>&#39;GAT&#39;</span><span class=p>:</span> <span class=s1>&#39;J&#39;</span><span class=p>,</span> <span class=s1>&#39;GCA&#39;</span><span class=p>:</span> <span class=s1>&#39;K&#39;</span><span class=p>,</span> <span class=s1>&#39;GCC&#39;</span><span class=p>:</span> <span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=s1>&#39;GCG&#39;</span><span class=p>:</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;GCT&#39;</span><span class=p>:</span> <span class=s1>&#39;N&#39;</span><span class=p>,</span> <span class=s1>&#39;GGA&#39;</span><span class=p>:</span> <span class=s1>&#39;O&#39;</span><span class=p>,</span> <span class=s1>&#39;GGC&#39;</span><span class=p>:</span> <span class=s1>&#39;P&#39;</span><span class=p>,</span> <span class=s1>&#39;GGG&#39;</span><span class=p>:</span> <span class=s1>&#39;Q&#39;</span><span class=p>,</span> <span class=s1>&#39;GGT&#39;</span><span class=p>:</span> <span class=s1>&#39;R&#39;</span><span class=p>,</span> <span class=s1>&#39;GTA&#39;</span><span class=p>:</span> <span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;GTC&#39;</span><span class=p>:</span> <span class=s1>&#39;T&#39;</span><span class=p>,</span> <span class=s1>&#39;GTG&#39;</span><span class=p>:</span> <span class=s1>&#39;U&#39;</span><span class=p>,</span> <span class=s1>&#39;GTT&#39;</span><span class=p>:</span> <span class=s1>&#39;V&#39;</span><span class=p>,</span> <span class=s1>&#39;TAA&#39;</span><span class=p>:</span> <span class=s1>&#39;W&#39;</span><span class=p>,</span> <span class=s1>&#39;TAC&#39;</span><span class=p>:</span> <span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;TAG&#39;</span><span class=p>:</span> <span class=s1>&#39;Y&#39;</span><span class=p>,</span> <span class=s1>&#39;TAT&#39;</span><span class=p>:</span> <span class=s1>&#39;Z&#39;</span><span class=p>,</span> <span class=s1>&#39;TCA&#39;</span><span class=p>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;TCC&#39;</span><span class=p>:</span> <span class=s1>&#39;2&#39;</span><span class=p>,</span> <span class=s1>&#39;TCG&#39;</span><span class=p>:</span> <span class=s1>&#39;3&#39;</span><span class=p>,</span> <span class=s1>&#39;TCT&#39;</span><span class=p>:</span> <span class=s1>&#39;4&#39;</span><span class=p>,</span> <span class=s1>&#39;TGA&#39;</span><span class=p>:</span> <span class=s1>&#39;5&#39;</span><span class=p>,</span> <span class=s1>&#39;TGC&#39;</span><span class=p>:</span> <span class=s1>&#39;6&#39;</span><span class=p>,</span> <span class=s1>&#39;TGG&#39;</span><span class=p>:</span> <span class=s1>&#39;7&#39;</span><span class=p>,</span> <span class=s1>&#39;TGT&#39;</span><span class=p>:</span> <span class=s1>&#39;8&#39;</span><span class=p>,</span> <span class=s1>&#39;TTA&#39;</span><span class=p>:</span> <span class=s1>&#39;9&#39;</span><span class=p>,</span> <span class=s1>&#39;TTC&#39;</span><span class=p>:</span> <span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=s1>&#39;TTG&#39;</span><span class=p>:</span> <span class=s1>&#39; &#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s1>&#39;TCATCAACAAAT&#39;</span>
</span></span><span class=line><span class=cl><span class=n>plain</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>cipher</span><span class=p>),</span> <span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plain</span> <span class=o>+=</span> <span class=n>dic</span><span class=p>[</span><span class=n>cipher</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>3、使用在线网站解密（例题-BUGKU-粉色的猫）</p><p>DNA编码在线解密：https://earthsciweb.org/js/bio/dna-writer/</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241121212750865.png alt=/posts/1ad9200/imgs/image-20241121212750865.png height=989 width=1916></p><h3 class=heading-element id=金笛短信pdu编码><span>金笛短信PDU编码</span>
<a href=#%e9%87%91%e7%ac%9b%e7%9f%ad%e4%bf%a1pdu%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接使用在线网站解码：http://www.sendsms.cn/pdu/ （特别注意：需要一行一行地解码）</p><p>形如下面这串数字</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0001000D91683106019196F4000872003800390035003000340045003400370030004400300041003100410030004100300030003000300030003000300044003400390034003800340034003500320030003000300030003000300034003700300030003000300030003000300038003000380030003200300030003000300030
</span></span><span class=line><span class=cl>0001000D91683106019196F4000872003000320034004400430037003500460031003000300030003000300030004200430034003900340034003400310035003400370038003500450044004400390032003400310031003200380035003300300030003800340033004200390031003900460037003300460031003500390046
</span></span><span class=line><span class=cl>0001000D91683106019196F400087000380034004600410038003700310032003100370036004500370034003500310032003600450033004400340041003600320044003700390035003500420033003800380032003100310037003900390042004200320045004100420039003500410036004200330042004200450037
</span></span><span class=line><span class=cl>0001000D91683106019196F400086E0042003600300039003900330045004500360033004600320036004600440044003100420043004400410042003300300033003300310046004500350045003600440039003300370035004200300036003500360036004100320031003000410033004100420037003100440038
</span></span><span class=line><span class=cl>0001000D91683106019196F400087000450033004400370032003100300031004400420034003900310036003900360038003000310033003200340046003800450046003200380034004500420033003500430030004600420036003400450046003100300030004100310042004100300043003200300044004400450042
</span></span><span class=line><span class=cl>0001000D91683106019196F400086E0038003400410032004200440038004200350038004200330039004500410043003600450030004100420031003000380044003600440036004600340034004300460044003800310044003000330042003600390034004200430039003400430032003300310033004400340046
</span></span><span class=line><span class=cl>0001000D91683106019196F400087000360038003900390031003600440036003200360041003700390035003800460035004300440039003500390042004500320038004300340034003300410045003700360043003100300035003800380030003200380035003900320039003600310042004600430044003400300044
</span></span><span class=line><span class=cl>0001000D91683106019196F4000872003100350037004600310033003400310033003800390043004600410042003600410045003500460032003300300038003700370035004500380031004500420032003000330030004300300035003000340037003500310044003900460041003400450045004600320032004600440030
</span></span><span class=line><span class=cl>0001000D91683106019196F400085200300037004400450044003500420036003800410033003100350046004400310031003000300030003000300030003000300034003900340035003400450034003400410045003400320036003000380032</span></span></code></pre></td></tr></table></div></div><p>一行一行解码后可以得到</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241121214741210.png alt=/posts/1ad9200/imgs/image-20241121214741210.png height=516 width=1031></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>89504E470D0A1A0A0000000D494844520000004700000008080200000024DC75F1000000BC49444154785EDD92411285300843B919F73F159F84FA8712176E745126E3D4A62D7955B388211799BB2EAB95A6B3BBE7B60993EE63F26FDD1BCDAB30331FE5E6D9375B06566A210A3AB71D8E3D72101DB491696801324F8EF284EB35C0FB64EF100A1BA0C20DDEB84A2BD8B58B39EAC6E0AB108D6D6F44CFD81D03B694BC94C2313D4F689916D626A7958F5CD959BE28C443AE76C10588028592961BFCD40D157F1341389CFAB6AE5F2308775E81EB2030C0504751D9FA4EEF22FD007DED5B68A315FD110000000049454E44AE426082</span></span></code></pre></td></tr></table></div></div><p>例题-BUGKU-粉色的猫</p><h3 class=heading-element id=text-encoding-brute-force><span>Text Encoding Brute Force</span>
<a href=#text-encoding-brute-force class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>如果赛博厨子转完两次Hex后依然是乱码，可以用<code>Text Encoding Brute Force</code>爆破试试看</p><p>例子：红明谷杯2023——阿尼亚</p><h3 class=heading-element id=decabit编码><span>Decabit编码</span>
<a href=#decabit%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>正常的 Decabit编码 是十个字符一组的，如果不是十个一组，就很可能不是 Decabit编码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+-+-++--+- ++---+-++- -+--++-++- +--++-++-- --+++++--- ++-++---+- +++-+-+--- +-+-+---++ ---+++-++- -+--++-++- -+--+++-+- -+--++-++- -+--++-++- ++-+-+-+-- -+--+++-+- ++-++---+- -++++---+- -+--++-++- ++-+-+-+-- +-+++---+- +++-++---- ---+++-++- +-+-+---++ ++-+-+-+-- +-+-+--++- ++--+--++- -++++---+- +---+++-+- ++-+-+-+-- -++++---+- -+--+++-+- +--+-+-++- +++-+-+--- +-+++---+- -+--+-+++- -+--++-++- ---+++-++- ++++----+- -++++---+- -+--+++-+- -+--++-++- ----+++++-</span></span></code></pre></td></tr></table></div></div><p>直接使用 <a href=https://www.dcode.fr/decabit-code target=_blank rel="external nofollow noopener noreferrer">在线网站</a> 解密即可</p><p>如果不是Decabit编码，可以试试看把+-分别用01替换 (例题1-2023楚慧杯-Easy_zip）</p><h3 class=heading-element id=仿射密码><span>仿射密码</span>
<a href=#%e4%bb%bf%e5%b0%84%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>密钥有两个参数a和b，a为必须是<code>1,3,5,7,9,11,15,17,19,21,23,25</code>中的一个(与26互质)</p><p>b可以是0到25之间的任意整数</p><p>可以使用<a href=http://www.hiencode.com/affine.html target=_blank rel="external nofollow noopener noreferrer">在线网站</a>或者<code>随波逐流CTF编码工具</code>解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>gezx{j13p5oznp_1t_z_900y_k3z771h_k001}
</span></span><span class=line><span class=cl>密钥：a=17 b=77
</span></span><span class=line><span class=cl>flag{w13e5hake_1s_a_900d_t3a771c_t001}</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=brainfuck和ook编码><span>Brainfuck和Ook!编码</span>
<a href=#brainfuck%e5%92%8cook%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以直接用以下几个在线网站解密：</p><p><a href=https://www.splitbrain.org/services/ook target=_blank rel="external nofollow noopener noreferrer">https://www.splitbrain.org/services/ook</a></p><p><a href="https://www.geocachingtoolbox.com/index.php?lang=en&amp;page=brainfuckOok" target=_blank rel="external nofollow noopener noreferrer">https://www.geocachingtoolbox.com/index.php?lang=en&page=brainfuckOok</a></p><p><a href=https://www.cachesleuth.com/bfook.html target=_blank rel="external nofollow noopener noreferrer">https://www.cachesleuth.com/bfook.html</a></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421200218788.png alt=/posts/1ad9200/imgs/image-20250421200218788.png height=1468 width=2560></p><h4 class=heading-element id=brainfuck><span>Brainfuck</span>
<a href=#brainfuck class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt;
</span></span><span class=line><span class=cl>++++[ -&gt;+++ +&lt;]&gt;+ +++.- ----- -.&lt;++ +[-&gt;- --&lt;]&gt; ---.+ .&lt;+++ [-&gt;++ +&lt;]&gt;+
</span></span><span class=line><span class=cl>.&lt;+++ +[-&gt;- ---&lt;] &gt;---- .&lt;+++ [-&gt;++ +&lt;]&gt;+ .&lt;+++ [-&gt;++ +&lt;]&gt;+ .&lt;+++ +[-&gt;-
</span></span><span class=line><span class=cl>---&lt;] &gt;---- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++++ +.&lt;++ +[-&gt;- --&lt;]&gt; ----- -.&lt;++ +[-&gt;+
</span></span><span class=line><span class=cl>++&lt;]&gt; +++++ .+.&lt;+ +++[- &gt;---- &lt;]&gt;-- ---.+ +++++ +.+++ +++.&lt; +++[- &gt;---&lt;
</span></span><span class=line><span class=cl>]&gt;--. +++++ +.&lt;++ ++[-&gt; ++++&lt; ]&gt;+++ +++.&lt; </span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=ook><span>Ook!</span>
<a href=#ook class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook?
</span></span><span class=line><span class=cl>Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook.
</span></span><span class=line><span class=cl>Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!
</span></span><span class=line><span class=cl>Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook!
</span></span><span class=line><span class=cl>Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!
</span></span><span class=line><span class=cl>Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook?
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!
</span></span><span class=line><span class=cl>Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.
</span></span><span class=line><span class=cl>Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.
</span></span><span class=line><span class=cl>Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. </span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=short-ook><span>short Ook!</span>
<a href=#short-ook class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>..... ..... ..... ..... !?!!. ?.... ..... ..... ..... .?.?! .?... .!...
</span></span><span class=line><span class=cl>..... ..... !.?.. ..... !?!!. ?!!!! !!?.? !.?!! !!!.. ..... ..... .!.?.
</span></span><span class=line><span class=cl>..... ...!? !!.?. ..... ..?.? !.?.. ..... .!.!! !!!!! !!!!! !!!.? .....
</span></span><span class=line><span class=cl>..!?! !.?!! !!!!? .?!.? !!!!! !!... !.?.. ..... !?!!. ?.... ..?.? !.?..
</span></span><span class=line><span class=cl>!.?.. ..... ..!?! !.?!! !!!!! !?.?! .?!!! !!!!! !.?.. ..... !?!!. ?....
</span></span><span class=line><span class=cl>..?.? !.?.. !.?.. ..... !?!!. ?.... ..?.? !.?.. !.?.. ..... ..!?! !.?!!
</span></span><span class=line><span class=cl>!!!!! !?.?! .?!!! !!!!! !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .....
</span></span><span class=line><span class=cl>..!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!!!! !!!.? ..... ..!?! !.?..
</span></span><span class=line><span class=cl>....? .?!.? ..... ..... !...! .?... ..... .!?!! .?!!! !!!!! ?.?!. ?!!!!
</span></span><span class=line><span class=cl>!!!!! !!... ..... ..... ..!.. ..... ..... .!.?. ..... .!?!! .?!!! !!!?.
</span></span><span class=line><span class=cl>?!.?! !!!!. ..... ..... ..!.? ..... ....! ?!!.? ..... ...?. ?!.?. .....
</span></span><span class=line><span class=cl>..... .!.?. </span></span></code></pre></td></tr></table></div></div><p>有时候flag可能会被删去，导致直接在线网站解密看不到flag，需要我们到内存中查看被删除的内容</p><p>因此可以用下面这个代码输出之前放在内存中的内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#define  _CRT_SECURE_NO_WARNINGS
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>30000</span><span class=p>]</span><span class=o>=</span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>char</span> <span class=n>code</span><span class=p>[</span><span class=mi>2000</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>stack</span><span class=p>[</span><span class=mi>10000</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>stack_len</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span><span class=n>j</span><span class=p>,</span><span class=n>k</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span><span class=o>*</span> <span class=n>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span><span class=o>*</span> <span class=n>p</span><span class=o>=</span><span class=n>s</span><span class=o>+</span><span class=mi>10000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>=</span><span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;./bf.txt&#34;</span><span class=p>,</span><span class=s>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=nf>fread</span><span class=p>(</span><span class=o>&amp;</span><span class=n>code</span><span class=p>[</span><span class=n>len</span><span class=p>],</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>f</span><span class=p>)</span><span class=o>==</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>len</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>setbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span><span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>i</span><span class=o>&lt;</span><span class=n>len</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=n>code</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;+&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=o>*</span><span class=n>p</span><span class=p>)</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;-&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=o>*</span><span class=n>p</span><span class=p>)</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;&gt;&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;&lt;&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;.&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=nf>putchar</span><span class=p>((</span><span class=kt>int</span><span class=p>)(</span><span class=o>*</span><span class=n>p</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;,&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=o>*</span><span class=n>p</span><span class=o>=</span><span class=nf>getchar</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;[&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=o>*</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>stack</span><span class=p>[</span><span class=n>stack_len</span><span class=o>++</span><span class=p>]</span><span class=o>=</span><span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span><span class=p>(</span><span class=n>k</span><span class=o>=</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>k</span><span class=o>&lt;</span><span class=n>len</span><span class=p>;</span><span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>code</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>==</span><span class=sc>&#39;[&#39;</span><span class=o>&amp;&amp;</span><span class=n>j</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>code</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>==</span><span class=sc>&#39;]&#39;</span><span class=o>&amp;&amp;</span><span class=n>j</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>==</span><span class=mi>0</span><span class=p>)</span><span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>==</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>i</span><span class=o>=</span><span class=n>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=s>&#34;%s:%dn&#34;</span><span class=p>,</span><span class=n>__FILE__</span><span class=p>,</span><span class=n>__LINE__</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;]&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span><span class=o>=</span><span class=n>stack</span><span class=p>[</span><span class=n>stack_len</span><span class=o>--</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>stack_len</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=n>stack</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>30000</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%c&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=gronsfeld密码><span>Gronsfeld密码</span>
<a href=#gronsfeld%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、可以直接使用这个<a href=https://www.boxentriq.com/code-breaking/gronsfeld-cipher target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密或爆破</p><p>2、也可以写Python脚本解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 解密脚本</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pycipher</span> <span class=kn>import</span> <span class=n>Gronsfeld</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s1>&#39;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&#39;</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>61</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>63</span><span class=p>,</span><span class=mi>41</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>Gronsfeld</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=o>.</span><span class=n>decipher</span><span class=p>(</span><span class=n>cipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=uuencode编码><span>UUencode编码</span>
<a href=#uuencode%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>看起来有点像base85编码，可以直接使用<a href=https://ctf.bugku.com/tool/uuencode target=_blank rel="external nofollow noopener noreferrer">在线网站</a>或者<code>随波逐流CTF编码工具</code>解密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=o>=</span><span class=mi>8</span><span class=n>S4U</span><span class=p>,</span><span class=mi>3</span><span class=n>DR8SDY</span><span class=p>,</span><span class=n>C</span><span class=o>`</span><span class=n>S</span><span class=o>-</span><span class=n>F5F</span><span class=o>-</span><span class=nf>C</span><span class=p>(</span><span class=n>S</span><span class=p>,</span><span class=n>S</span><span class=o>&lt;</span><span class=n>R</span><span class=o>-</span><span class=n>C</span><span class=o>`</span><span class=n>Q9F8S87T</span><span class=o>`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># c55192c992036ef623372601ff3a}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=aaencode编码><span>AAencode编码</span>
<a href=#aaencode%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以直接使用<a href=https://ctf.bugku.com/tool/uuencode target=_blank rel="external nofollow noopener noreferrer">在线网站</a>或者<code>随波逐流CTF编码工具</code>解密</p><h3 class=heading-element id=xxencode编码><span>XXencode编码</span>
<a href=#xxencode%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以直接使用<a href=https://ctf.bugku.com/tool/uuencode target=_blank rel="external nofollow noopener noreferrer">在线网站</a>或者<code>随波逐流CTF编码工具</code>解密</p><p>例题1-2023浙江省赛决赛-签到</p><h3 class=heading-element id=whitespace隐写><span>whitespace隐写</span>
<a href=#whitespace%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>一个文件打开都是空白字符</p><p>可以使用在线网站解密：https://vii5ard.github.io/whitespace/</p><p>全选复制进去，然后直接run即可</p><h3 class=heading-element id=snow隐写><span>SNOW隐写</span>
<a href=#snow%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>SNOW 隐写工具下载：https://darkside.com.au/snow/</p><p>到<code>snowdos32</code>工具目录下运行<code>SNOW.EXE -C -p password flag.txt</code> 命令即可</p><p>SNOW隐写有时候可以不全是空白字符，然后也可以无密码，如果懒得敲命令行可以直接用下面这个工具</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421200534255.png alt=/posts/1ad9200/imgs/image-20250421200534255.png height=508 width=748></p><blockquote><p>Tips: 这里要特别注意的一点就是 -C 这个参数，选了这个参数后加密和解密的时候会默认压缩或者解压，就有可能会解密乱码</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251031124513229.png alt=/posts/1ad9200/imgs/image-20251031124513229.png height=238 width=1484></p><h3 class=heading-element id=零宽字符隐写><span>零宽字符隐写</span>
<a href=#%e9%9b%b6%e5%ae%bd%e5%ad%97%e7%ac%a6%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以用在线网站解密，也可以用<code>PuzzleSolver</code>解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421200734831.png alt=/posts/1ad9200/imgs/image-20250421200734831.png height=402 width=1504></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># 几个解零宽比较好用的在线网站，也可以下载源码到本地</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>wetools</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>text</span><span class=o>-</span><span class=n>cloaking</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=mi>330</span><span class=n>k</span><span class=o>.</span><span class=n>github</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>misc_tools</span><span class=o>/</span><span class=n>unicode_steganography</span><span class=o>.</span><span class=n>html</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>mzy0</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>ctftools</span><span class=o>/</span><span class=n>zerowidth1</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>yuanfux</span><span class=o>.</span><span class=n>github</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>zero</span><span class=o>-</span><span class=n>width</span><span class=o>-</span><span class=n>web</span><span class=o>/</span></span></span></code></pre></td></tr></table></div></div><p>如果网站默认的字符集解不出来，可以尝试先在vim里查看，看看都有哪些字符</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250828223508020.png alt=/posts/1ad9200/imgs/image-20250828223508020.png height=1176 width=2070></p><p>然后再到解码网址上勾选对应字符</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250828223608794.png alt=/posts/1ad9200/imgs/image-20250828223608794.png height=708 width=1440></p><h3 class=heading-element id=中文电报中文电码><span>中文电报（中文电码）</span>
<a href=#%e4%b8%ad%e6%96%87%e7%94%b5%e6%8a%a5%e4%b8%ad%e6%96%87%e7%94%b5%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>类似于下面这种四位数一组的编码，直接在线网站或<code>随波逐流CTF编码工具</code>解码即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>5337 5337 2448 2448 0001 2448 0001 2161 1721 1869 6671 0008 3296 4430 0001 3945 0260 3945 1869 4574 5337 0344 2448 0037 5337 5337 0260 0668 5337 6671 0008 3296 1869 6671 0008 3296 1869 2161 1721 </span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>艾艾斯斯一斯一括弧恩达不溜科一由偶由恩第艾克斯之艾艾偶可艾达不溜恩达不溜恩括弧
</span></span><span class=line><span class=cl>ISCC{NWQOUNDXJLKWNWN}</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=quote-printable编码><span>Quote-Printable编码</span>
<a href=#quote-printable%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>类似于下面这样的编码，直接使用 <a href=https://try8.cn/tool/code/qp target=_blank rel="external nofollow noopener noreferrer">在线网站</a> 或<code>随波逐流CTF编码工具</code>解密即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{ichunqiu_=E6=8A=80=E6=9C=AF=E6=9C=89=E6=B8=A9=E5=BA=A6}
</span></span><span class=line><span class=cl>flag{ichunqiu_技术有温度}</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=unicode编码><span>Unicode编码</span>
<a href=#unicode%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>这个编码有很多种格式，比如<code>+U、\u、\x、&amp;#</code>啥的</p><p>可以使用这个在线网站解码：https://r12a.github.io/app-conversion/</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241101155218913.png alt=/posts/1ad9200/imgs/image-20241101155218913.png height=984 width=1915></p><h3 class=heading-element id=中文ascii码><span>中文ascii码</span>
<a href=#%e4%b8%ad%e6%96%87ascii%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>27880 30693 25915 21892 38450 23454 39564 23460 21457 36865 112 108 98 99 116 102 33719 21462 21069 27573 102 108 97 103 20851 27880 79 110 101 45 70 111 120 23433 20840 22242 38431 22238 22797 112 108 98 99 116 102 33719 21462 21518 27573 102 108 97 103</span></span></code></pre></td></tr></table></div></div><p>加上&amp;#和分号，直接<code>CyberChef</code>或者 <a href=https://www.xuhuhu.com/beautify/ascii/ target=_blank rel="external nofollow noopener noreferrer">在线网站</a> 解密即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&amp;#27880;&amp;#30693;&amp;#25915;&amp;#21892;&amp;#38450;&amp;#23454;&amp;#39564;&amp;#23460;&amp;#21457;&amp;#36865;&amp;#112;&amp;#108;&amp;#98;&amp;#99;&amp;#116;&amp;#102;&amp;#33719;&amp;#21462;&amp;#21069;&amp;#27573;&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#20851;&amp;#27880;&amp;#79;&amp;#110;&amp;#101;&amp;#45;&amp;#70;&amp;#111;&amp;#120;&amp;#23433;&amp;#20840;&amp;#22242;&amp;#38431;&amp;#22238;&amp;#22797;&amp;#112;&amp;#108;&amp;#98;&amp;#99;&amp;#116;&amp;#102;&amp;#33719;&amp;#21462;&amp;#21518;&amp;#27573;&amp;#102;&amp;#108;&amp;#97;&amp;#103;</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=培根密码><span>培根密码</span>
<a href=#%e5%9f%b9%e6%a0%b9%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>密文由<code>ab</code>或者<code>AB</code>或者<code>01</code>组成，密文中只有两种字符，可以直接使用<code>随波逐流CTF编码工具</code>解密</p><blockquote><p>Tips：CyberChef 的培根密码解密可能会有点问题，这里建议用随波逐流解密</p></blockquote><h3 class=heading-element id=锟斤拷><span>锟斤拷</span>
<a href=#%e9%94%9f%e6%96%a4%e6%8b%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>这个东西的成因是<code>Unicode</code>的替换字符与<code>UTF-8</code>编码下的结果<code>EF BF BD</code>重复</p><p>然后这几个字符在<code>GBK</code>编码中被解码为汉字 “锟斤拷”（EF BF BD EF BF BD）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;请选择你的功能（1、加密 2、解密）：&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=s2>&#34;1&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;请输入你要加密的话：&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>utf</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gbk</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;gbk&#39;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=o>%</span><span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>gbk</span> <span class=o>=</span> <span class=n>gbk</span> <span class=o>+</span> <span class=s2>&#34;�&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>gbk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;pause&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=s2>&#34;2&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;请输入你要解密的话：&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gbk</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;gbk&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>utf</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;gbk&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>utf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;pause&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=电脑键盘密码><span>电脑键盘密码</span>
<a href=#%e7%94%b5%e8%84%91%e9%94%ae%e7%9b%98%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=电脑键盘坐标密码><span>电脑键盘坐标密码</span>
<a href=#%e7%94%b5%e8%84%91%e9%94%ae%e7%9b%98%e5%9d%90%e6%a0%87%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  1 2 3 4 5 6 7 8 9 0
</span></span><span class=line><span class=cl>1 Q W E R T Y U I O P
</span></span><span class=line><span class=cl>2 A S D F G H J K L
</span></span><span class=line><span class=cl>3 Z X C V B N M</span></span></code></pre></td></tr></table></div></div><p>例题-i春秋-misc3</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag{11 21 31 18 27 33 34}
</span></span><span class=line><span class=cl>flag{QAZIJCV}</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=电脑键盘qwe加密><span>电脑键盘QWE加密</span>
<a href=#%e7%94%b5%e8%84%91%e9%94%ae%e7%9b%98qwe%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250331164724999.jpeg alt=/posts/1ad9200/imgs/image-20250331164724999.jpeg height=277 width=461></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>密文：tewatnolzsarffuykjydyayd
</span></span><span class=line><span class=cl>明文：ecbkeyistlkdnngfrqfmfkfm</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=电脑键盘位移加密><span>电脑键盘位移加密</span>
<a href=#%e7%94%b5%e8%84%91%e9%94%ae%e7%9b%98%e4%bd%8d%e7%a7%bb%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&amp;&amp;&amp;* &amp;&amp;&amp;!! %%%!! @@^^* %%# ^^!!( ##* $$!!^^^%%
</span></span><span class=line><span class=cl>思路：符号代表了位置，重复的次数代表了键盘上，向下移动的格数。&amp;&amp;&amp;就代表了字母M，而*则代表字母I
</span></span><span class=line><span class=cl>mi ma ba shi ge hao di fang</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=手机键盘密码><span>手机键盘密码</span>
<a href=#%e6%89%8b%e6%9c%ba%e9%94%ae%e7%9b%98%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=26键键盘密码><span>26键键盘密码</span>
<a href=#26%e9%94%ae%e9%94%ae%e7%9b%98%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>字母对应上档的数字</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ooo yyy ii w uuu ee iii ee uuu ooo r yyy yyy e
</span></span><span class=line><span class=cl>999 666 88 2 777 33 888 33 777 999 4 666 666 3</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421202022903.jpeg alt=/posts/1ad9200/imgs/image-20250421202022903.jpeg height=176 width=286></p><p>然后数字对应九键上的按键，出现次数对应第几个字母</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>999 666 88 2 777 33 888 33 777 999 4 666 666 3
</span></span><span class=line><span class=cl> y   o  u  a  r  e   v   e  r  y   g  o   o  d</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421202056717.jpeg alt=/posts/1ad9200/imgs/image-20250421202056717.jpeg height=392 width=512></p><h4 class=heading-element id=九宫格键盘密码><span>九宫格键盘密码</span>
<a href=#%e4%b9%9d%e5%ae%ab%e6%a0%bc%e9%94%ae%e7%9b%98%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=第一种><span>第一种</span>
<a href=#%e7%ac%ac%e4%b8%80%e7%a7%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>参考链接：<a href=https://blog.csdn.net/qq_55011640/article/details/123626280 target=_blank rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_55011640/article/details/123626280</a></p><p>对照表如下：</p><table><thead><tr><th style=text-align:center>密码</th><th style=text-align:center>明文</th><th style=text-align:center>密码</th><th style=text-align:center>明文</th></tr></thead><tbody><tr><td style=text-align:center>11</td><td style=text-align:center>:</td><td style=text-align:center>61</td><td style=text-align:center>m</td></tr><tr><td style=text-align:center>12</td><td style=text-align:center>_</td><td style=text-align:center>62</td><td style=text-align:center>n</td></tr><tr><td style=text-align:center>13</td><td style=text-align:center>-</td><td style=text-align:center>63</td><td style=text-align:center>o</td></tr><tr><td style=text-align:center>21</td><td style=text-align:center>a</td><td style=text-align:center>71</td><td style=text-align:center>p</td></tr><tr><td style=text-align:center>22</td><td style=text-align:center>b</td><td style=text-align:center>72</td><td style=text-align:center>q</td></tr><tr><td style=text-align:center>23</td><td style=text-align:center>c</td><td style=text-align:center>73</td><td style=text-align:center>r</td></tr><tr><td style=text-align:center>31</td><td style=text-align:center>d</td><td style=text-align:center>74</td><td style=text-align:center>s</td></tr><tr><td style=text-align:center>32</td><td style=text-align:center>e</td><td style=text-align:center>81</td><td style=text-align:center>t</td></tr><tr><td style=text-align:center>33</td><td style=text-align:center>f</td><td style=text-align:center>82</td><td style=text-align:center>u</td></tr><tr><td style=text-align:center>41</td><td style=text-align:center>g</td><td style=text-align:center>83</td><td style=text-align:center>v</td></tr><tr><td style=text-align:center>42</td><td style=text-align:center>h</td><td style=text-align:center>91</td><td style=text-align:center>w</td></tr><tr><td style=text-align:center>43</td><td style=text-align:center>i</td><td style=text-align:center>92</td><td style=text-align:center>x</td></tr><tr><td style=text-align:center>51</td><td style=text-align:center>j</td><td style=text-align:center>93</td><td style=text-align:center>y</td></tr><tr><td style=text-align:center>52</td><td style=text-align:center>k</td><td style=text-align:center>94</td><td style=text-align:center>z</td></tr><tr><td style=text-align:center>53</td><td style=text-align:center>l</td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><p>举个栗子就理解了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>82  73  42  31  22  31  33  41  32
</span></span><span class=line><span class=cl> U   R   H   D   B   D   F   G   E</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=第二种><span>第二种</span>
<a href=#%e7%ac%ac%e4%ba%8c%e7%a7%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>仔细看看就会发现其实和上面那种是一样的，就是这种情况下是用数字出现的次数表示方格中的位置</p><table><thead><tr><th style=text-align:center>密码</th><th style=text-align:center>明文</th><th style=text-align:center>密码</th><th style=text-align:center>明文</th></tr></thead><tbody><tr><td style=text-align:center>111</td><td style=text-align:center>:</td><td style=text-align:center>666</td><td style=text-align:center>m</td></tr><tr><td style=text-align:center>11</td><td style=text-align:center>_</td><td style=text-align:center>66</td><td style=text-align:center>n</td></tr><tr><td style=text-align:center>1</td><td style=text-align:center>-</td><td style=text-align:center>6</td><td style=text-align:center>o</td></tr><tr><td style=text-align:center>222</td><td style=text-align:center>a</td><td style=text-align:center>7777</td><td style=text-align:center>p</td></tr><tr><td style=text-align:center>22</td><td style=text-align:center>b</td><td style=text-align:center>777</td><td style=text-align:center>q</td></tr><tr><td style=text-align:center>2</td><td style=text-align:center>c</td><td style=text-align:center>77</td><td style=text-align:center>r</td></tr><tr><td style=text-align:center>333</td><td style=text-align:center>d</td><td style=text-align:center>7</td><td style=text-align:center>s</td></tr><tr><td style=text-align:center>33</td><td style=text-align:center>e</td><td style=text-align:center>888</td><td style=text-align:center>t</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>f</td><td style=text-align:center>88</td><td style=text-align:center>u</td></tr><tr><td style=text-align:center>444</td><td style=text-align:center>g</td><td style=text-align:center>8</td><td style=text-align:center>v</td></tr><tr><td style=text-align:center>44</td><td style=text-align:center>h</td><td style=text-align:center>9999</td><td style=text-align:center>w</td></tr><tr><td style=text-align:center>4</td><td style=text-align:center>i</td><td style=text-align:center>999</td><td style=text-align:center>x</td></tr><tr><td style=text-align:center>555</td><td style=text-align:center>j</td><td style=text-align:center>99</td><td style=text-align:center>y</td></tr><tr><td style=text-align:center>55</td><td style=text-align:center>k</td><td style=text-align:center>9</td><td style=text-align:center>z</td></tr><tr><td style=text-align:center>5</td><td style=text-align:center>l</td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><h3 class=heading-element id=不同键盘布局的编码><span>不同键盘布局的编码</span>
<a href=#%e4%b8%8d%e5%90%8c%e9%94%ae%e7%9b%98%e5%b8%83%e5%b1%80%e7%9a%84%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=qwerty><span>Qwerty</span>
<a href=#qwerty class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113151943395.png alt=/posts/1ad9200/imgs/image-20241113151943395.png height=380 width=822></p><h4 class=heading-element id=qwertz><span>Qwertz</span>
<a href=#qwertz class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113152029297.png alt=/posts/1ad9200/imgs/image-20241113152029297.png height=640 width=1920></p><h4 class=heading-element id=azerty><span>Azerty</span>
<a href=#azerty class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113152112365.png alt=/posts/1ad9200/imgs/image-20241113152112365.png height=250 width=800></p><h4 class=heading-element id=dvorak德沃夏克键盘><span>Dvorak(德沃夏克键盘)</span>
<a href=#dvorak%e5%be%b7%e6%b2%83%e5%a4%8f%e5%85%8b%e9%94%ae%e7%9b%98 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113151817733.png alt=/posts/1ad9200/imgs/image-20241113151817733.png height=640 width=1920></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113151927957.png alt=/posts/1ad9200/imgs/image-20241113151927957.png height=379 width=818></p><h4 class=heading-element id=colemak><span>Colemak</span>
<a href=#colemak class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113151902536.png alt=/posts/1ad9200/imgs/image-20241113151902536.png height=382 width=816></p><p>附：转换脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>qwerty_lower</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;qwertyuiop[]</span><span class=si>{}</span><span class=s2>-=_+\asdfghjkl;&#39;zxcvbnm,./&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>dvorak_lower</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;&#39;,.pyfgcrl/=?+[]</span><span class=si>{}</span><span class=s2>|aoeuidhtns-;qjkxbmwvz&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>qwerty_upper</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;QWERTYUIOP[]</span><span class=si>{}</span><span class=s2>-=_+\ASDFGHJKL;&#39;ZXCVBNM,./&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>dvorak_upper</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;&#34;&lt;&gt;PYFGCRL/=?+[]</span><span class=si>{}</span><span class=s2>|AOEUIDHTNS_:QJKXBMWVZ&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 构建映射字典</span>
</span></span><span class=line><span class=cl><span class=n>d2q</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=n>dvorak_lower</span> <span class=o>+</span> <span class=n>dvorak_upper</span><span class=p>,</span><span class=n>qwerty_lower</span> <span class=o>+</span> <span class=n>qwerty_upper</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q2d</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=n>qwerty_lower</span> <span class=o>+</span> <span class=n>qwerty_upper</span><span class=p>,</span><span class=n>dvorak_lower</span> <span class=o>+</span> <span class=n>dvorak_upper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dvorak_to_qwerty</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>d2q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>qwerty_to_dvorak</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>q2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;EAOJYU?TRX&gt;{XPFABY{8{24+&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>dvorak_to_qwerty</span><span class=p>(</span><span class=n>text</span><span class=p>))</span> <span class=c1># DASCTF{KOBE_BRYANT_8_24}</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>qwerty_to_dvorak</span><span class=p>(</span><span class=n>text</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>当然，也可以用随波逐流解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251108135158677.png alt=/posts/1ad9200/imgs/image-20251108135158677.png height=1630 width=1638></p><p>例题-2023台州市赛初赛-Black Mamba</p><h3 class=heading-element id=棋盘密码adfgvxadfgxpolybius><span>棋盘密码(ADFGVX,ADFGX,Polybius)</span>
<a href=#%e6%a3%8b%e7%9b%98%e5%af%86%e7%a0%81adfgvxadfgxpolybius class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251105212819794.png alt=/posts/1ad9200/imgs/image-20251105212819794.png height=860 width=1416></p><p>直接使用CaptfEncoder或者随波逐流等工具输入密文和密钥解密即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241018145101804.png alt=/posts/1ad9200/imgs/image-20241018145101804.png height=657 width=1186></p><p>ADFGVX密码 默认棋盘：<code>ph0qg64mea1yl2nofdxkr3cvs5zw7bj9uti8</code> 默认密钥：<code>german</code></p><p>ADFGX密码 默认棋盘：<code>phqgmeaynofdxkrcvszwbutil</code> 默认密钥：<code>german</code></p><p>波利比奥斯方阵密码 密钥：随机 默认密文字符：<code>ABCDE</code></p><h3 class=heading-element id=利用编程代码画图><span>利用编程代码画图</span>
<a href=#%e5%88%a9%e7%94%a8%e7%bc%96%e7%a8%8b%e4%bb%a3%e7%a0%81%e7%94%bb%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>1、LOGO编程语言【例题-RCTF2019-draw】</p><p>在线编译器：https://www.calormen.com/jslogo/</p><p>2、CFRS编程语言【例题-2024宁波市赛初赛-Misc2】</p><p>在线画图网站：https://susam.net/cfrs.html</p><h3 class=heading-element id=通过拼音和声调进行编码><span>通过拼音和声调进行编码</span>
<a href=#%e9%80%9a%e8%bf%87%e6%8b%bc%e9%9f%b3%e5%92%8c%e5%a3%b0%e8%b0%83%e8%bf%9b%e8%a1%8c%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例题-惠州学院红帽协会CTF招新赛-Crypto-xuanxue</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>哷哸哹哻哼哽咤娻屇庎忈咤煈炼呶呵呷呸</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pypinyin</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypinyin</span> <span class=kn>import</span> <span class=n>pinyin</span><span class=p>,</span> <span class=n>lazy_pinyin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 利用拼音库将每个汉字的拼音的字母转成ascii码相加,然后再与音调相加,最后取余128得到最后的字母</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>pin</span> <span class=o>=</span> <span class=n>lazy_pinyin</span><span class=p>(</span><span class=n>s</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=n>pinyin</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>style</span><span class=o>=</span><span class=n>pypinyin</span><span class=o>.</span><span class=n>Style</span><span class=o>.</span><span class=n>TONE3</span><span class=p>,</span> <span class=n>heteronym</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>pin</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>+=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>+=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>k</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>k</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=n>result</span> <span class=o>%</span> <span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=s2>&#34;哷哸哹哻哼哽咤娻屇庎忈咤煈炼呶呵呷呸&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>+=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=当铺密码><span>当铺密码</span>
<a href=#%e5%bd%93%e9%93%ba%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>当铺密码就是一种将中文和数字进行转化的密码：</p><p>当前汉字有多少笔画出头，就是转化成数字几</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>王夫 井工 夫口 由中人 井中 夫夫 由中大
</span></span><span class=line><span class=cl> 67  84  70   123   82  77   125</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=简繁体汉字笔画编码><span>简/繁体汉字笔画编码</span>
<a href=#%e7%ae%80%e7%b9%81%e4%bd%93%e6%b1%89%e5%ad%97%e7%ac%94%e7%94%bb%e7%bc%96%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;许&#34;</span><span class=p>:</span><span class=mi>11</span><span class=p>,</span><span class=s2>&#34;史&#34;</span><span class=p>:</span><span class=mi>5</span><span class=p>,</span><span class=s2>&#34;李&#34;</span><span class=p>:</span><span class=mi>7</span><span class=p>,</span><span class=s2>&#34;赵&#34;</span><span class=p>:</span><span class=mi>9</span><span class=p>,</span><span class=s2>&#34;周&#34;</span><span class=p>:</span><span class=mi>8</span><span class=p>,</span><span class=s2>&#34;秦&#34;</span><span class=p>:</span><span class=mi>10</span><span class=p>,</span><span class=s2>&#34;吕&#34;</span><span class=p>:</span><span class=mi>6</span><span class=p>,</span><span class=s2>&#34;乙&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;王&#34;</span><span class=p>:</span><span class=mi>4</span><span class=p>,</span><span class=s2>&#34;丁&#34;</span><span class=p>:</span><span class=mi>2</span><span class=p>,</span><span class=s2>&#34;温&#34;</span><span class=p>:</span><span class=mi>12</span><span class=p>,</span><span class=s2>&#34;万&#34;</span><span class=p>:</span><span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;李李 王周 史乙 吕李 史丁 周王 温万 吕李 秦王 秦史 李周 秦乙 许史 秦乙 赵史 赵赵 许李 秦周 许吕 许李 许王 秦乙 赵史 秦史 许史 赵史 许周 赵李 许史 许吕 赵史 赵李 李周 吕周 赵史 许丁 许王 许乙 秦丁 许乙 许李 李周 吕周 温史&#34;</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tmp</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>item</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>table</span><span class=p>[</span><span class=n>char</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>+=</span> <span class=s1>&#39; &#39;</span>
</span></span><span class=line><span class=cl><span class=n>tmp</span> <span class=o>=</span> <span class=n>tmp</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>tmp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>item</span><span class=p>)),</span><span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># M03C4T{ChiNese_culture_is_vast_aND_profouND}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=pgp词汇表加密><span>PGP词汇表加密</span>
<a href=#pgp%e8%af%8d%e6%b1%87%e8%a1%a8%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>密文格式大致如下:</p><p>例题1</p><blockquote><p>endow gremlin indulge bison flatfoot fallout goldfish bison hockey fracture fracture bison goggles jawbone bison flatfoot gremlin glucose glucose fracture flatfoot indoors gazelle gremlin goldfish bison guidance indulge keyboard keyboard glucose fracture hockey bison gazelle goldfish bison cement frighten gazelle goldfish indoors buzzard highchair fallout highchair bison fallout goldfish flytrap bison fallout goldfish gremlin indoors frighten fracture highchair bison cement fracture goldfish flatfoot gremlin flytrap fracture buzzard guidance goldfish freedom buzzard allow crowfoot jawbone bison indoors frighten fracture bison involve fallout jawbone Burbank indoors frighten fracture bison guidance gazelle flatfoot indoors indulge highchair fracture bison hockey frighten gremlin indulge flytrap bison flagpole fracture bison indulge hockey fracture flytrap bison allow blockade endow indulge hockey fallout blockade bison gazelle hockey bison inverse fracture highchair jawbone bison gazelle goggles guidance gremlin highchair indoors fallout goldfish indoors bison gazelle goldfish bison indoors frighten gazelle hockey bison flatfoot frighten fallout glucose glucose fracture goldfish freedom fracture blackjack blackjack</p></blockquote><p>例题2-2024国城杯-Tr4ffIc_w1th_Ste90</p><blockquote><p>I randomly found a word list to encrypt the flag. I only remember that Wikipedia said this word list is similar to the NATO phonetic alphabet.</p><p>crumpled chairlift freedom chisel island dashboard crucial kickoff crucial chairlift drifter classroom highchair cranky clamshell edict drainage fallout clamshell chatter chairlift goldfish chopper eyetooth endow chairlift edict eyetooth deadbolt fallout egghead chisel eyetooth cranky crucial deadbolt chatter chisel egghead chisel crumpled eyetooth clamshell deadbolt chatter chopper eyetooth classroom chairlift fallout drainage klaxon</p></blockquote><p>解密脚本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>aaa</span> <span class=o>=</span> <span class=p>[[</span><span class=s1>&#39;00&#39;</span><span class=p>,</span> <span class=s1>&#39;aardvark&#39;</span><span class=p>,</span> <span class=s1>&#39;adroitness&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;01&#39;</span><span class=p>,</span> <span class=s1>&#39;absurd&#39;</span><span class=p>,</span> <span class=s1>&#39;adviser&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;02&#39;</span><span class=p>,</span> <span class=s1>&#39;accrue&#39;</span><span class=p>,</span> <span class=s1>&#39;aftermath&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;03&#39;</span><span class=p>,</span> <span class=s1>&#39;acme&#39;</span><span class=p>,</span> <span class=s1>&#39;aggregate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;04&#39;</span><span class=p>,</span> <span class=s1>&#39;adrift&#39;</span><span class=p>,</span> <span class=s1>&#39;alkali&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;05&#39;</span><span class=p>,</span> <span class=s1>&#39;adult&#39;</span><span class=p>,</span> <span class=s1>&#39;almighty&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;06&#39;</span><span class=p>,</span> <span class=s1>&#39;afflict&#39;</span><span class=p>,</span> <span class=s1>&#39;amulet&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;07&#39;</span><span class=p>,</span> <span class=s1>&#39;ahead&#39;</span><span class=p>,</span> <span class=s1>&#39;amusement&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;08&#39;</span><span class=p>,</span> <span class=s1>&#39;aimless&#39;</span><span class=p>,</span> <span class=s1>&#39;antenna&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;09&#39;</span><span class=p>,</span> <span class=s1>&#39;Algol&#39;</span><span class=p>,</span> <span class=s1>&#39;applicant&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0A&#39;</span><span class=p>,</span> <span class=s1>&#39;allow&#39;</span><span class=p>,</span> <span class=s1>&#39;Apollo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0B&#39;</span><span class=p>,</span> <span class=s1>&#39;alone&#39;</span><span class=p>,</span> <span class=s1>&#39;armistice&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0C&#39;</span><span class=p>,</span> <span class=s1>&#39;ammo&#39;</span><span class=p>,</span> <span class=s1>&#39;article&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0D&#39;</span><span class=p>,</span> <span class=s1>&#39;ancient&#39;</span><span class=p>,</span> <span class=s1>&#39;asteroid&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0E&#39;</span><span class=p>,</span> <span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;Atlantic&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;0F&#39;</span><span class=p>,</span> <span class=s1>&#39;artist&#39;</span><span class=p>,</span> <span class=s1>&#39;atmosphere&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;10&#39;</span><span class=p>,</span> <span class=s1>&#39;assume&#39;</span><span class=p>,</span> <span class=s1>&#39;autopsy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;11&#39;</span><span class=p>,</span> <span class=s1>&#39;Athens&#39;</span><span class=p>,</span> <span class=s1>&#39;Babylon&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;12&#39;</span><span class=p>,</span> <span class=s1>&#39;atlas&#39;</span><span class=p>,</span> <span class=s1>&#39;backwater&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;13&#39;</span><span class=p>,</span> <span class=s1>&#39;Aztec&#39;</span><span class=p>,</span> <span class=s1>&#39;barbecue&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;14&#39;</span><span class=p>,</span> <span class=s1>&#39;baboon&#39;</span><span class=p>,</span> <span class=s1>&#39;belowground&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;15&#39;</span><span class=p>,</span> <span class=s1>&#39;backfield&#39;</span><span class=p>,</span> <span class=s1>&#39;bifocals&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;16&#39;</span><span class=p>,</span> <span class=s1>&#39;backward&#39;</span><span class=p>,</span> <span class=s1>&#39;bodyguard&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;17&#39;</span><span class=p>,</span> <span class=s1>&#39;banjo&#39;</span><span class=p>,</span> <span class=s1>&#39;bookseller&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;18&#39;</span><span class=p>,</span> <span class=s1>&#39;beaming&#39;</span><span class=p>,</span> <span class=s1>&#39;borderline&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;19&#39;</span><span class=p>,</span> <span class=s1>&#39;bedlamp&#39;</span><span class=p>,</span> <span class=s1>&#39;bottomless&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1A&#39;</span><span class=p>,</span> <span class=s1>&#39;beehive&#39;</span><span class=p>,</span> <span class=s1>&#39;Bradbury&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1B&#39;</span><span class=p>,</span> <span class=s1>&#39;beeswax&#39;</span><span class=p>,</span> <span class=s1>&#39;bravado&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1C&#39;</span><span class=p>,</span> <span class=s1>&#39;befriend&#39;</span><span class=p>,</span> <span class=s1>&#39;Brazilian&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1D&#39;</span><span class=p>,</span> <span class=s1>&#39;Belfast&#39;</span><span class=p>,</span> <span class=s1>&#39;breakaway&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1E&#39;</span><span class=p>,</span> <span class=s1>&#39;berserk&#39;</span><span class=p>,</span> <span class=s1>&#39;Burlington&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;1F&#39;</span><span class=p>,</span> <span class=s1>&#39;billiard&#39;</span><span class=p>,</span> <span class=s1>&#39;businessman&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;20&#39;</span><span class=p>,</span> <span class=s1>&#39;bison&#39;</span><span class=p>,</span> <span class=s1>&#39;butterfat&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;21&#39;</span><span class=p>,</span> <span class=s1>&#39;blackjack&#39;</span><span class=p>,</span> <span class=s1>&#39;Camelot&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;22&#39;</span><span class=p>,</span> <span class=s1>&#39;blockade&#39;</span><span class=p>,</span> <span class=s1>&#39;candidate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;23&#39;</span><span class=p>,</span> <span class=s1>&#39;blowtorch&#39;</span><span class=p>,</span> <span class=s1>&#39;cannonball&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;24&#39;</span><span class=p>,</span> <span class=s1>&#39;bluebird&#39;</span><span class=p>,</span> <span class=s1>&#39;Capricorn&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;25&#39;</span><span class=p>,</span> <span class=s1>&#39;bombast&#39;</span><span class=p>,</span> <span class=s1>&#39;caravan&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;26&#39;</span><span class=p>,</span> <span class=s1>&#39;bookshelf&#39;</span><span class=p>,</span> <span class=s1>&#39;caretaker&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;27&#39;</span><span class=p>,</span> <span class=s1>&#39;brackish&#39;</span><span class=p>,</span> <span class=s1>&#39;celebrate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;28&#39;</span><span class=p>,</span> <span class=s1>&#39;breadline&#39;</span><span class=p>,</span> <span class=s1>&#39;cellulose&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;29&#39;</span><span class=p>,</span> <span class=s1>&#39;breakup&#39;</span><span class=p>,</span> <span class=s1>&#39;certify&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2A&#39;</span><span class=p>,</span> <span class=s1>&#39;brickyard&#39;</span><span class=p>,</span> <span class=s1>&#39;chambermaid&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2B&#39;</span><span class=p>,</span> <span class=s1>&#39;briefcase&#39;</span><span class=p>,</span> <span class=s1>&#39;Cherokee&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2C&#39;</span><span class=p>,</span> <span class=s1>&#39;Burbank&#39;</span><span class=p>,</span> <span class=s1>&#39;Chicago&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2D&#39;</span><span class=p>,</span> <span class=s1>&#39;button&#39;</span><span class=p>,</span> <span class=s1>&#39;clergyman&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2E&#39;</span><span class=p>,</span> <span class=s1>&#39;buzzard&#39;</span><span class=p>,</span> <span class=s1>&#39;coherence&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;2F&#39;</span><span class=p>,</span> <span class=s1>&#39;cement&#39;</span><span class=p>,</span> <span class=s1>&#39;combustion&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;30&#39;</span><span class=p>,</span> <span class=s1>&#39;chairlift&#39;</span><span class=p>,</span> <span class=s1>&#39;commando&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;31&#39;</span><span class=p>,</span> <span class=s1>&#39;chatter&#39;</span><span class=p>,</span> <span class=s1>&#39;company&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;32&#39;</span><span class=p>,</span> <span class=s1>&#39;checkup&#39;</span><span class=p>,</span> <span class=s1>&#39;component&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;33&#39;</span><span class=p>,</span> <span class=s1>&#39;chisel&#39;</span><span class=p>,</span> <span class=s1>&#39;concurrent&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;34&#39;</span><span class=p>,</span> <span class=s1>&#39;choking&#39;</span><span class=p>,</span> <span class=s1>&#39;confidence&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;35&#39;</span><span class=p>,</span> <span class=s1>&#39;chopper&#39;</span><span class=p>,</span> <span class=s1>&#39;conformist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;36&#39;</span><span class=p>,</span> <span class=s1>&#39;Christmas&#39;</span><span class=p>,</span> <span class=s1>&#39;congregate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;37&#39;</span><span class=p>,</span> <span class=s1>&#39;clamshell&#39;</span><span class=p>,</span> <span class=s1>&#39;consensus&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;38&#39;</span><span class=p>,</span> <span class=s1>&#39;classic&#39;</span><span class=p>,</span> <span class=s1>&#39;consulting&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;39&#39;</span><span class=p>,</span> <span class=s1>&#39;classroom&#39;</span><span class=p>,</span> <span class=s1>&#39;corporate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3A&#39;</span><span class=p>,</span> <span class=s1>&#39;cleanup&#39;</span><span class=p>,</span> <span class=s1>&#39;corrosion&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3B&#39;</span><span class=p>,</span> <span class=s1>&#39;clockwork&#39;</span><span class=p>,</span> <span class=s1>&#39;councilman&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3C&#39;</span><span class=p>,</span> <span class=s1>&#39;cobra&#39;</span><span class=p>,</span> <span class=s1>&#39;crossover&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3D&#39;</span><span class=p>,</span> <span class=s1>&#39;commence&#39;</span><span class=p>,</span> <span class=s1>&#39;crucifix&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3E&#39;</span><span class=p>,</span> <span class=s1>&#39;concert&#39;</span><span class=p>,</span> <span class=s1>&#39;cumbersome&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;3F&#39;</span><span class=p>,</span> <span class=s1>&#39;cowbell&#39;</span><span class=p>,</span> <span class=s1>&#39;customer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;40&#39;</span><span class=p>,</span> <span class=s1>&#39;crackdown&#39;</span><span class=p>,</span> <span class=s1>&#39;Dakota&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;41&#39;</span><span class=p>,</span> <span class=s1>&#39;cranky&#39;</span><span class=p>,</span> <span class=s1>&#39;decadence&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;42&#39;</span><span class=p>,</span> <span class=s1>&#39;crowfoot&#39;</span><span class=p>,</span> <span class=s1>&#39;December&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;43&#39;</span><span class=p>,</span> <span class=s1>&#39;crucial&#39;</span><span class=p>,</span> <span class=s1>&#39;decimal&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;44&#39;</span><span class=p>,</span> <span class=s1>&#39;crumpled&#39;</span><span class=p>,</span> <span class=s1>&#39;designing&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;45&#39;</span><span class=p>,</span> <span class=s1>&#39;crusade&#39;</span><span class=p>,</span> <span class=s1>&#39;detector&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;46&#39;</span><span class=p>,</span> <span class=s1>&#39;cubic&#39;</span><span class=p>,</span> <span class=s1>&#39;detergent&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;47&#39;</span><span class=p>,</span> <span class=s1>&#39;dashboard&#39;</span><span class=p>,</span> <span class=s1>&#39;determine&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;48&#39;</span><span class=p>,</span> <span class=s1>&#39;deadbolt&#39;</span><span class=p>,</span> <span class=s1>&#39;dictator&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;49&#39;</span><span class=p>,</span> <span class=s1>&#39;deckhand&#39;</span><span class=p>,</span> <span class=s1>&#39;dinosaur&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4A&#39;</span><span class=p>,</span> <span class=s1>&#39;dogsled&#39;</span><span class=p>,</span> <span class=s1>&#39;direction&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4B&#39;</span><span class=p>,</span> <span class=s1>&#39;dragnet&#39;</span><span class=p>,</span> <span class=s1>&#39;disable&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4C&#39;</span><span class=p>,</span> <span class=s1>&#39;drainage&#39;</span><span class=p>,</span> <span class=s1>&#39;disbelief&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4D&#39;</span><span class=p>,</span> <span class=s1>&#39;dreadful&#39;</span><span class=p>,</span> <span class=s1>&#39;disruptive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4E&#39;</span><span class=p>,</span> <span class=s1>&#39;drifter&#39;</span><span class=p>,</span> <span class=s1>&#39;distortion&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;4F&#39;</span><span class=p>,</span> <span class=s1>&#39;dropper&#39;</span><span class=p>,</span> <span class=s1>&#39;document&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;50&#39;</span><span class=p>,</span> <span class=s1>&#39;drumbeat&#39;</span><span class=p>,</span> <span class=s1>&#39;embezzle&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;51&#39;</span><span class=p>,</span> <span class=s1>&#39;drunken&#39;</span><span class=p>,</span> <span class=s1>&#39;enchanting&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;52&#39;</span><span class=p>,</span> <span class=s1>&#39;Dupont&#39;</span><span class=p>,</span> <span class=s1>&#39;enrollment&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;53&#39;</span><span class=p>,</span> <span class=s1>&#39;dwelling&#39;</span><span class=p>,</span> <span class=s1>&#39;enterprise&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;54&#39;</span><span class=p>,</span> <span class=s1>&#39;eating&#39;</span><span class=p>,</span> <span class=s1>&#39;equation&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;55&#39;</span><span class=p>,</span> <span class=s1>&#39;edict&#39;</span><span class=p>,</span> <span class=s1>&#39;equipment&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;56&#39;</span><span class=p>,</span> <span class=s1>&#39;egghead&#39;</span><span class=p>,</span> <span class=s1>&#39;escapade&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;57&#39;</span><span class=p>,</span> <span class=s1>&#39;eightball&#39;</span><span class=p>,</span> <span class=s1>&#39;Eskimo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;58&#39;</span><span class=p>,</span> <span class=s1>&#39;endorse&#39;</span><span class=p>,</span> <span class=s1>&#39;everyday&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;59&#39;</span><span class=p>,</span> <span class=s1>&#39;endow&#39;</span><span class=p>,</span> <span class=s1>&#39;examine&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5A&#39;</span><span class=p>,</span> <span class=s1>&#39;enlist&#39;</span><span class=p>,</span> <span class=s1>&#39;existence&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5B&#39;</span><span class=p>,</span> <span class=s1>&#39;erase&#39;</span><span class=p>,</span> <span class=s1>&#39;exodus&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5C&#39;</span><span class=p>,</span> <span class=s1>&#39;escape&#39;</span><span class=p>,</span> <span class=s1>&#39;fascinate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5D&#39;</span><span class=p>,</span> <span class=s1>&#39;exceed&#39;</span><span class=p>,</span> <span class=s1>&#39;filament&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5E&#39;</span><span class=p>,</span> <span class=s1>&#39;eyeglass&#39;</span><span class=p>,</span> <span class=s1>&#39;finicky&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;5F&#39;</span><span class=p>,</span> <span class=s1>&#39;eyetooth&#39;</span><span class=p>,</span> <span class=s1>&#39;forever&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;60&#39;</span><span class=p>,</span> <span class=s1>&#39;facial&#39;</span><span class=p>,</span> <span class=s1>&#39;fortitude&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;61&#39;</span><span class=p>,</span> <span class=s1>&#39;fallout&#39;</span><span class=p>,</span> <span class=s1>&#39;frequency&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;62&#39;</span><span class=p>,</span> <span class=s1>&#39;flagpole&#39;</span><span class=p>,</span> <span class=s1>&#39;gadgetry&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;63&#39;</span><span class=p>,</span> <span class=s1>&#39;flatfoot&#39;</span><span class=p>,</span> <span class=s1>&#39;Galveston&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;64&#39;</span><span class=p>,</span> <span class=s1>&#39;flytrap&#39;</span><span class=p>,</span> <span class=s1>&#39;getaway&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;65&#39;</span><span class=p>,</span> <span class=s1>&#39;fracture&#39;</span><span class=p>,</span> <span class=s1>&#39;glossary&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;66&#39;</span><span class=p>,</span> <span class=s1>&#39;framework&#39;</span><span class=p>,</span> <span class=s1>&#39;gossamer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;67&#39;</span><span class=p>,</span> <span class=s1>&#39;freedom&#39;</span><span class=p>,</span> <span class=s1>&#39;graduate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;68&#39;</span><span class=p>,</span> <span class=s1>&#39;frighten&#39;</span><span class=p>,</span> <span class=s1>&#39;gravity&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;69&#39;</span><span class=p>,</span> <span class=s1>&#39;gazelle&#39;</span><span class=p>,</span> <span class=s1>&#39;guitarist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6A&#39;</span><span class=p>,</span> <span class=s1>&#39;Geiger&#39;</span><span class=p>,</span> <span class=s1>&#39;hamburger&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6B&#39;</span><span class=p>,</span> <span class=s1>&#39;glitter&#39;</span><span class=p>,</span> <span class=s1>&#39;Hamilton&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6C&#39;</span><span class=p>,</span> <span class=s1>&#39;glucose&#39;</span><span class=p>,</span> <span class=s1>&#39;handiwork&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6D&#39;</span><span class=p>,</span> <span class=s1>&#39;goggles&#39;</span><span class=p>,</span> <span class=s1>&#39;hazardous&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6E&#39;</span><span class=p>,</span> <span class=s1>&#39;goldfish&#39;</span><span class=p>,</span> <span class=s1>&#39;headwaters&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;6F&#39;</span><span class=p>,</span> <span class=s1>&#39;gremlin&#39;</span><span class=p>,</span> <span class=s1>&#39;hemisphere&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;70&#39;</span><span class=p>,</span> <span class=s1>&#39;guidance&#39;</span><span class=p>,</span> <span class=s1>&#39;hesitate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;71&#39;</span><span class=p>,</span> <span class=s1>&#39;hamlet&#39;</span><span class=p>,</span> <span class=s1>&#39;hideaway&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;72&#39;</span><span class=p>,</span> <span class=s1>&#39;highchair&#39;</span><span class=p>,</span> <span class=s1>&#39;holiness&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;73&#39;</span><span class=p>,</span> <span class=s1>&#39;hockey&#39;</span><span class=p>,</span> <span class=s1>&#39;hurricane&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;74&#39;</span><span class=p>,</span> <span class=s1>&#39;indoors&#39;</span><span class=p>,</span> <span class=s1>&#39;hydraulic&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;75&#39;</span><span class=p>,</span> <span class=s1>&#39;indulge&#39;</span><span class=p>,</span> <span class=s1>&#39;impartial&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;76&#39;</span><span class=p>,</span> <span class=s1>&#39;inverse&#39;</span><span class=p>,</span> <span class=s1>&#39;impetus&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;77&#39;</span><span class=p>,</span> <span class=s1>&#39;involve&#39;</span><span class=p>,</span> <span class=s1>&#39;inception&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;78&#39;</span><span class=p>,</span> <span class=s1>&#39;island&#39;</span><span class=p>,</span> <span class=s1>&#39;indigo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;79&#39;</span><span class=p>,</span> <span class=s1>&#39;jawbone&#39;</span><span class=p>,</span> <span class=s1>&#39;inertia&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7A&#39;</span><span class=p>,</span> <span class=s1>&#39;keyboard&#39;</span><span class=p>,</span> <span class=s1>&#39;infancy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7B&#39;</span><span class=p>,</span> <span class=s1>&#39;kickoff&#39;</span><span class=p>,</span> <span class=s1>&#39;inferno&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7C&#39;</span><span class=p>,</span> <span class=s1>&#39;kiwi&#39;</span><span class=p>,</span> <span class=s1>&#39;informant&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7D&#39;</span><span class=p>,</span> <span class=s1>&#39;klaxon&#39;</span><span class=p>,</span> <span class=s1>&#39;insincere&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7E&#39;</span><span class=p>,</span> <span class=s1>&#39;locale&#39;</span><span class=p>,</span> <span class=s1>&#39;insurgent&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;7F&#39;</span><span class=p>,</span> <span class=s1>&#39;lockup&#39;</span><span class=p>,</span> <span class=s1>&#39;integrate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;80&#39;</span><span class=p>,</span> <span class=s1>&#39;merit&#39;</span><span class=p>,</span> <span class=s1>&#39;intention&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;81&#39;</span><span class=p>,</span> <span class=s1>&#39;minnow&#39;</span><span class=p>,</span> <span class=s1>&#39;inventive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;82&#39;</span><span class=p>,</span> <span class=s1>&#39;miser&#39;</span><span class=p>,</span> <span class=s1>&#39;Istanbul&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;83&#39;</span><span class=p>,</span> <span class=s1>&#39;Mohawk&#39;</span><span class=p>,</span> <span class=s1>&#39;Jamaica&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;84&#39;</span><span class=p>,</span> <span class=s1>&#39;mural&#39;</span><span class=p>,</span> <span class=s1>&#39;Jupiter&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;85&#39;</span><span class=p>,</span> <span class=s1>&#39;music&#39;</span><span class=p>,</span> <span class=s1>&#39;leprosy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;86&#39;</span><span class=p>,</span> <span class=s1>&#39;necklace&#39;</span><span class=p>,</span> <span class=s1>&#39;letterhead&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;87&#39;</span><span class=p>,</span> <span class=s1>&#39;Neptune&#39;</span><span class=p>,</span> <span class=s1>&#39;liberty&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;88&#39;</span><span class=p>,</span> <span class=s1>&#39;newborn&#39;</span><span class=p>,</span> <span class=s1>&#39;maritime&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;89&#39;</span><span class=p>,</span> <span class=s1>&#39;nightbird&#39;</span><span class=p>,</span> <span class=s1>&#39;matchmaker&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8A&#39;</span><span class=p>,</span> <span class=s1>&#39;Oakland&#39;</span><span class=p>,</span> <span class=s1>&#39;maverick&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8B&#39;</span><span class=p>,</span> <span class=s1>&#39;obtuse&#39;</span><span class=p>,</span> <span class=s1>&#39;Medusa&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8C&#39;</span><span class=p>,</span> <span class=s1>&#39;offload&#39;</span><span class=p>,</span> <span class=s1>&#39;megaton&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8D&#39;</span><span class=p>,</span> <span class=s1>&#39;optic&#39;</span><span class=p>,</span> <span class=s1>&#39;microscope&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8E&#39;</span><span class=p>,</span> <span class=s1>&#39;orca&#39;</span><span class=p>,</span> <span class=s1>&#39;microwave&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;8F&#39;</span><span class=p>,</span> <span class=s1>&#39;payday&#39;</span><span class=p>,</span> <span class=s1>&#39;midsummer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;90&#39;</span><span class=p>,</span> <span class=s1>&#39;peachy&#39;</span><span class=p>,</span> <span class=s1>&#39;millionaire&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;91&#39;</span><span class=p>,</span> <span class=s1>&#39;pheasant&#39;</span><span class=p>,</span> <span class=s1>&#39;miracle&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;92&#39;</span><span class=p>,</span> <span class=s1>&#39;physique&#39;</span><span class=p>,</span> <span class=s1>&#39;misnomer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;93&#39;</span><span class=p>,</span> <span class=s1>&#39;playhouse&#39;</span><span class=p>,</span> <span class=s1>&#39;molasses&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;94&#39;</span><span class=p>,</span> <span class=s1>&#39;Pluto&#39;</span><span class=p>,</span> <span class=s1>&#39;molecule&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;95&#39;</span><span class=p>,</span> <span class=s1>&#39;preclude&#39;</span><span class=p>,</span> <span class=s1>&#39;Montana&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;96&#39;</span><span class=p>,</span> <span class=s1>&#39;prefer&#39;</span><span class=p>,</span> <span class=s1>&#39;monument&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;97&#39;</span><span class=p>,</span> <span class=s1>&#39;preshrunk&#39;</span><span class=p>,</span> <span class=s1>&#39;mosquito&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;98&#39;</span><span class=p>,</span> <span class=s1>&#39;printer&#39;</span><span class=p>,</span> <span class=s1>&#39;narrative&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;99&#39;</span><span class=p>,</span> <span class=s1>&#39;prowler&#39;</span><span class=p>,</span> <span class=s1>&#39;nebula&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9A&#39;</span><span class=p>,</span> <span class=s1>&#39;pupil&#39;</span><span class=p>,</span> <span class=s1>&#39;newsletter&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9B&#39;</span><span class=p>,</span> <span class=s1>&#39;puppy&#39;</span><span class=p>,</span> <span class=s1>&#39;Norwegian&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9C&#39;</span><span class=p>,</span> <span class=s1>&#39;python&#39;</span><span class=p>,</span> <span class=s1>&#39;October&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9D&#39;</span><span class=p>,</span> <span class=s1>&#39;quadrant&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9E&#39;</span><span class=p>,</span> <span class=s1>&#39;quiver&#39;</span><span class=p>,</span> <span class=s1>&#39;onlooker&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;9F&#39;</span><span class=p>,</span> <span class=s1>&#39;quota&#39;</span><span class=p>,</span> <span class=s1>&#39;opulent&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A0&#39;</span><span class=p>,</span> <span class=s1>&#39;ragtime&#39;</span><span class=p>,</span> <span class=s1>&#39;Orlando&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A1&#39;</span><span class=p>,</span> <span class=s1>&#39;ratchet&#39;</span><span class=p>,</span> <span class=s1>&#39;outfielder&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A2&#39;</span><span class=p>,</span> <span class=s1>&#39;rebirth&#39;</span><span class=p>,</span> <span class=s1>&#39;Pacific&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A3&#39;</span><span class=p>,</span> <span class=s1>&#39;reform&#39;</span><span class=p>,</span> <span class=s1>&#39;pandemic&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A4&#39;</span><span class=p>,</span> <span class=s1>&#39;regain&#39;</span><span class=p>,</span> <span class=s1>&#39;Pandora&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A5&#39;</span><span class=p>,</span> <span class=s1>&#39;reindeer&#39;</span><span class=p>,</span> <span class=s1>&#39;paperweight&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A6&#39;</span><span class=p>,</span> <span class=s1>&#39;rematch&#39;</span><span class=p>,</span> <span class=s1>&#39;paragon&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A7&#39;</span><span class=p>,</span> <span class=s1>&#39;repay&#39;</span><span class=p>,</span> <span class=s1>&#39;paragraph&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A8&#39;</span><span class=p>,</span> <span class=s1>&#39;retouch&#39;</span><span class=p>,</span> <span class=s1>&#39;paramount&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;A9&#39;</span><span class=p>,</span> <span class=s1>&#39;revenge&#39;</span><span class=p>,</span> <span class=s1>&#39;passenger&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AA&#39;</span><span class=p>,</span> <span class=s1>&#39;reward&#39;</span><span class=p>,</span> <span class=s1>&#39;pedigree&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AB&#39;</span><span class=p>,</span> <span class=s1>&#39;rhythm&#39;</span><span class=p>,</span> <span class=s1>&#39;Pegasus&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AC&#39;</span><span class=p>,</span> <span class=s1>&#39;ribcage&#39;</span><span class=p>,</span> <span class=s1>&#39;penetrate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AD&#39;</span><span class=p>,</span> <span class=s1>&#39;ringbolt&#39;</span><span class=p>,</span> <span class=s1>&#39;perceptive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AE&#39;</span><span class=p>,</span> <span class=s1>&#39;robust&#39;</span><span class=p>,</span> <span class=s1>&#39;performance&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;AF&#39;</span><span class=p>,</span> <span class=s1>&#39;rocker&#39;</span><span class=p>,</span> <span class=s1>&#39;pharmacy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B0&#39;</span><span class=p>,</span> <span class=s1>&#39;ruffled&#39;</span><span class=p>,</span> <span class=s1>&#39;phonetic&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B1&#39;</span><span class=p>,</span> <span class=s1>&#39;sailboat&#39;</span><span class=p>,</span> <span class=s1>&#39;photograph&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B2&#39;</span><span class=p>,</span> <span class=s1>&#39;sawdust&#39;</span><span class=p>,</span> <span class=s1>&#39;pioneer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B3&#39;</span><span class=p>,</span> <span class=s1>&#39;scallion&#39;</span><span class=p>,</span> <span class=s1>&#39;pocketful&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B4&#39;</span><span class=p>,</span> <span class=s1>&#39;scenic&#39;</span><span class=p>,</span> <span class=s1>&#39;politeness&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B5&#39;</span><span class=p>,</span> <span class=s1>&#39;scorecard&#39;</span><span class=p>,</span> <span class=s1>&#39;positive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B6&#39;</span><span class=p>,</span> <span class=s1>&#39;Scotland&#39;</span><span class=p>,</span> <span class=s1>&#39;potato&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B7&#39;</span><span class=p>,</span> <span class=s1>&#39;seabird&#39;</span><span class=p>,</span> <span class=s1>&#39;processor&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B8&#39;</span><span class=p>,</span> <span class=s1>&#39;select&#39;</span><span class=p>,</span> <span class=s1>&#39;provincial&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;B9&#39;</span><span class=p>,</span> <span class=s1>&#39;sentence&#39;</span><span class=p>,</span> <span class=s1>&#39;proximate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BA&#39;</span><span class=p>,</span> <span class=s1>&#39;shadow&#39;</span><span class=p>,</span> <span class=s1>&#39;puberty&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BB&#39;</span><span class=p>,</span> <span class=s1>&#39;shamrock&#39;</span><span class=p>,</span> <span class=s1>&#39;publisher&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BC&#39;</span><span class=p>,</span> <span class=s1>&#39;showgirl&#39;</span><span class=p>,</span> <span class=s1>&#39;pyramid&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BD&#39;</span><span class=p>,</span> <span class=s1>&#39;skullcap&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BE&#39;</span><span class=p>,</span> <span class=s1>&#39;skydive&#39;</span><span class=p>,</span> <span class=s1>&#39;racketeer&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;BF&#39;</span><span class=p>,</span> <span class=s1>&#39;slingshot&#39;</span><span class=p>,</span> <span class=s1>&#39;rebellion&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C0&#39;</span><span class=p>,</span> <span class=s1>&#39;slowdown&#39;</span><span class=p>,</span> <span class=s1>&#39;recipe&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C1&#39;</span><span class=p>,</span> <span class=s1>&#39;snapline&#39;</span><span class=p>,</span> <span class=s1>&#39;recover&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C2&#39;</span><span class=p>,</span> <span class=s1>&#39;snapshot&#39;</span><span class=p>,</span> <span class=s1>&#39;repellent&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C3&#39;</span><span class=p>,</span> <span class=s1>&#39;snowcap&#39;</span><span class=p>,</span> <span class=s1>&#39;replica&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C4&#39;</span><span class=p>,</span> <span class=s1>&#39;snowslide&#39;</span><span class=p>,</span> <span class=s1>&#39;reproduce&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C5&#39;</span><span class=p>,</span> <span class=s1>&#39;solo&#39;</span><span class=p>,</span> <span class=s1>&#39;resistor&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C6&#39;</span><span class=p>,</span> <span class=s1>&#39;southward&#39;</span><span class=p>,</span> <span class=s1>&#39;responsive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C7&#39;</span><span class=p>,</span> <span class=s1>&#39;soybean&#39;</span><span class=p>,</span> <span class=s1>&#39;retraction&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C8&#39;</span><span class=p>,</span> <span class=s1>&#39;spaniel&#39;</span><span class=p>,</span> <span class=s1>&#39;retrieval&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;C9&#39;</span><span class=p>,</span> <span class=s1>&#39;spearhead&#39;</span><span class=p>,</span> <span class=s1>&#39;retrospect&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CA&#39;</span><span class=p>,</span> <span class=s1>&#39;spellbind&#39;</span><span class=p>,</span> <span class=s1>&#39;revenue&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CB&#39;</span><span class=p>,</span> <span class=s1>&#39;spheroid&#39;</span><span class=p>,</span> <span class=s1>&#39;revival&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CC&#39;</span><span class=p>,</span> <span class=s1>&#39;spigot&#39;</span><span class=p>,</span> <span class=s1>&#39;revolver&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CD&#39;</span><span class=p>,</span> <span class=s1>&#39;spindle&#39;</span><span class=p>,</span> <span class=s1>&#39;sandalwood&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CE&#39;</span><span class=p>,</span> <span class=s1>&#39;spyglass&#39;</span><span class=p>,</span> <span class=s1>&#39;sardonic&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;CF&#39;</span><span class=p>,</span> <span class=s1>&#39;stagehand&#39;</span><span class=p>,</span> <span class=s1>&#39;Saturday&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D0&#39;</span><span class=p>,</span> <span class=s1>&#39;stagnate&#39;</span><span class=p>,</span> <span class=s1>&#39;savagery&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D1&#39;</span><span class=p>,</span> <span class=s1>&#39;stairway&#39;</span><span class=p>,</span> <span class=s1>&#39;scavenger&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D2&#39;</span><span class=p>,</span> <span class=s1>&#39;standard&#39;</span><span class=p>,</span> <span class=s1>&#39;sensation&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D3&#39;</span><span class=p>,</span> <span class=s1>&#39;stapler&#39;</span><span class=p>,</span> <span class=s1>&#39;sociable&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D4&#39;</span><span class=p>,</span> <span class=s1>&#39;steamship&#39;</span><span class=p>,</span> <span class=s1>&#39;souvenir&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D5&#39;</span><span class=p>,</span> <span class=s1>&#39;sterling&#39;</span><span class=p>,</span> <span class=s1>&#39;specialist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D6&#39;</span><span class=p>,</span> <span class=s1>&#39;stockman&#39;</span><span class=p>,</span> <span class=s1>&#39;speculate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D7&#39;</span><span class=p>,</span> <span class=s1>&#39;stopwatch&#39;</span><span class=p>,</span> <span class=s1>&#39;stethoscope&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D8&#39;</span><span class=p>,</span> <span class=s1>&#39;stormy&#39;</span><span class=p>,</span> <span class=s1>&#39;stupendous&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;D9&#39;</span><span class=p>,</span> <span class=s1>&#39;sugar&#39;</span><span class=p>,</span> <span class=s1>&#39;supportive&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DA&#39;</span><span class=p>,</span> <span class=s1>&#39;surmount&#39;</span><span class=p>,</span> <span class=s1>&#39;surrender&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DB&#39;</span><span class=p>,</span> <span class=s1>&#39;suspense&#39;</span><span class=p>,</span> <span class=s1>&#39;suspicious&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DC&#39;</span><span class=p>,</span> <span class=s1>&#39;sweatband&#39;</span><span class=p>,</span> <span class=s1>&#39;sympathy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DD&#39;</span><span class=p>,</span> <span class=s1>&#39;swelter&#39;</span><span class=p>,</span> <span class=s1>&#39;tambourine&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DE&#39;</span><span class=p>,</span> <span class=s1>&#39;tactics&#39;</span><span class=p>,</span> <span class=s1>&#39;telephone&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;DF&#39;</span><span class=p>,</span> <span class=s1>&#39;talon&#39;</span><span class=p>,</span> <span class=s1>&#39;therapist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E0&#39;</span><span class=p>,</span> <span class=s1>&#39;tapeworm&#39;</span><span class=p>,</span> <span class=s1>&#39;tobacco&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E1&#39;</span><span class=p>,</span> <span class=s1>&#39;tempest&#39;</span><span class=p>,</span> <span class=s1>&#39;tolerance&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E2&#39;</span><span class=p>,</span> <span class=s1>&#39;tiger&#39;</span><span class=p>,</span> <span class=s1>&#39;tomorrow&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E3&#39;</span><span class=p>,</span> <span class=s1>&#39;tissue&#39;</span><span class=p>,</span> <span class=s1>&#39;torpedo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E4&#39;</span><span class=p>,</span> <span class=s1>&#39;tonic&#39;</span><span class=p>,</span> <span class=s1>&#39;tradition&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E5&#39;</span><span class=p>,</span> <span class=s1>&#39;topmost&#39;</span><span class=p>,</span> <span class=s1>&#39;travesty&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E6&#39;</span><span class=p>,</span> <span class=s1>&#39;tracker&#39;</span><span class=p>,</span> <span class=s1>&#39;trombonist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E7&#39;</span><span class=p>,</span> <span class=s1>&#39;transit&#39;</span><span class=p>,</span> <span class=s1>&#39;truncated&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E8&#39;</span><span class=p>,</span> <span class=s1>&#39;trauma&#39;</span><span class=p>,</span> <span class=s1>&#39;typewriter&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;E9&#39;</span><span class=p>,</span> <span class=s1>&#39;treadmill&#39;</span><span class=p>,</span> <span class=s1>&#39;ultimate&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;EA&#39;</span><span class=p>,</span> <span class=s1>&#39;Trojan&#39;</span><span class=p>,</span> <span class=s1>&#39;undaunted&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;EB&#39;</span><span class=p>,</span> <span class=s1>&#39;trouble&#39;</span><span class=p>,</span> <span class=s1>&#39;underfoot&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;EC&#39;</span><span class=p>,</span> <span class=s1>&#39;tumor&#39;</span><span class=p>,</span> <span class=s1>&#39;unicorn&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;ED&#39;</span><span class=p>,</span> <span class=s1>&#39;tunnel&#39;</span><span class=p>,</span> <span class=s1>&#39;unify&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;EE&#39;</span><span class=p>,</span> <span class=s1>&#39;tycoon&#39;</span><span class=p>,</span> <span class=s1>&#39;universe&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;EF&#39;</span><span class=p>,</span> <span class=s1>&#39;uncut&#39;</span><span class=p>,</span> <span class=s1>&#39;unravel&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F0&#39;</span><span class=p>,</span> <span class=s1>&#39;unearth&#39;</span><span class=p>,</span> <span class=s1>&#39;upcoming&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F1&#39;</span><span class=p>,</span> <span class=s1>&#39;unwind&#39;</span><span class=p>,</span> <span class=s1>&#39;vacancy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F2&#39;</span><span class=p>,</span> <span class=s1>&#39;uproot&#39;</span><span class=p>,</span> <span class=s1>&#39;vagabond&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F3&#39;</span><span class=p>,</span> <span class=s1>&#39;upset&#39;</span><span class=p>,</span> <span class=s1>&#39;vertigo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F4&#39;</span><span class=p>,</span> <span class=s1>&#39;upshot&#39;</span><span class=p>,</span> <span class=s1>&#39;Virginia&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F5&#39;</span><span class=p>,</span> <span class=s1>&#39;vapor&#39;</span><span class=p>,</span> <span class=s1>&#39;visitor&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F6&#39;</span><span class=p>,</span> <span class=s1>&#39;village&#39;</span><span class=p>,</span> <span class=s1>&#39;vocalist&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F7&#39;</span><span class=p>,</span> <span class=s1>&#39;virus&#39;</span><span class=p>,</span> <span class=s1>&#39;voyager&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F8&#39;</span><span class=p>,</span> <span class=s1>&#39;Vulcan&#39;</span><span class=p>,</span> <span class=s1>&#39;warranty&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;F9&#39;</span><span class=p>,</span> <span class=s1>&#39;waffle&#39;</span><span class=p>,</span> <span class=s1>&#39;Waterloo&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FA&#39;</span><span class=p>,</span> <span class=s1>&#39;wallet&#39;</span><span class=p>,</span> <span class=s1>&#39;whimsical&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FB&#39;</span><span class=p>,</span> <span class=s1>&#39;watchword&#39;</span><span class=p>,</span> <span class=s1>&#39;Wichita&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FC&#39;</span><span class=p>,</span> <span class=s1>&#39;wayside&#39;</span><span class=p>,</span> <span class=s1>&#39;Wilmington&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FD&#39;</span><span class=p>,</span> <span class=s1>&#39;willow&#39;</span><span class=p>,</span> <span class=s1>&#39;Wyoming&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FE&#39;</span><span class=p>,</span> <span class=s1>&#39;woodlark&#39;</span><span class=p>,</span> <span class=s1>&#39;yesteryear&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;FF&#39;</span><span class=p>,</span> <span class=s1>&#39;Zulu&#39;</span><span class=p>,</span> <span class=s1>&#39;Yucatan&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>_string</span> <span class=o>=</span> <span class=s2>&#34;crumpled chairlift freedom chisel island dashboard crucial kickoff crucial chairlift drifter classroom highchair cranky clamshell edict drainage fallout clamshell chatter chairlift goldfish chopper eyetooth endow chairlift edict eyetooth deadbolt fallout egghead chisel eyetooth cranky crucial deadbolt chatter chisel egghead chisel crumpled eyetooth clamshell deadbolt chatter chopper eyetooth classroom chairlift fallout drainage klaxon&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tihuan</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>aaa</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bbb</span> <span class=o>=</span> <span class=n>tihuan</span><span class=p>(</span><span class=n>_string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>bbb</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ccc</span> <span class=o>=</span> <span class=n>bbb</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ddd</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>ccc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ddd</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ddd</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=vbs加密><span>VBS加密</span>
<a href=#vbs%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例题1-2024国城杯-Just_F0r3n51Cs</p><p><code>enc.vbe</code>内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#@~^HAAAAA==W^lLyPb/P@#@&amp;4*.2{W!!x[mFC&amp;|0AcAAA==^#~@</span></span></code></pre></td></tr></table></div></div><p>直接使用<a href=https://master.ayra.ch/vbs/vbs.aspx target=_blank rel="external nofollow noopener noreferrer">在线网站</a>解密为vbs即可</p><h3 class=heading-element id=日历密码><span>日历密码</span>
<a href=#%e6%97%a5%e5%8e%86%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例题1-QHCTF For Year 2025</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250307145358642.png alt=/posts/1ad9200/imgs/image-20250307145358642.png height=458 width=1230></p><h3 class=heading-element id=twitter-secret-messages><span>Twitter Secret Messages</span>
<a href=#twitter-secret-messages class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>特点就是密文中有很多<code>Unicode</code>字符，直接用在线网站解密即可：https://holloway.nz/steg/</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250307145735098.png alt=/posts/1ad9200/imgs/image-20250307145735098.png height=981 width=1917></p><h3 class=heading-element id=垃圾邮件隐写spammimic><span>垃圾邮件隐写(Spammimic)</span>
<a href=#%e5%9e%83%e5%9c%be%e9%82%ae%e4%bb%b6%e9%9a%90%e5%86%99spammimic class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>特征就是给了一长串垃圾电子邮件，直接用在线网站解密即可：https://www.spammimic.com/</p><h3 class=heading-element id=tupper自指公式><span>Tupper自指公式</span>
<a href=#tupper%e8%87%aa%e6%8c%87%e5%85%ac%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>题目通常会给一个0-9组成的十进制长整数</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>64302039943980618121484184873128503074609076299244422107146064367058121738007282650851520841656649070683123403821937513267391370346165645908933956953599129037238861474390287394253991334205788122863003605507035424785292830536282067025856204240859500900770386319047433635878298987553848841486636769829855797015618861382395619672208366605793866695702843978585628878996390708495917362310741277717465790690657480858197797078816624813513712771929056001109014477328987890335180242509040895793315048815591172058129474723554263040</span></span></code></pre></td></tr></table></div></div><p>可以直接用在线网站画图：https://tuppers-formula.ovh/</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250817140518358.png alt=/posts/1ad9200/imgs/image-20250817140518358.png height=1744 width=2810></p><p>也可以写一个脚本画图：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>Tupper_self_referential_formula</span><span class=p>(</span><span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>aa</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>17</span><span class=p>,</span> <span class=mi>106</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>+=</span> <span class=n>k</span>
</span></span><span class=line><span class=cl>        <span class=n>a1</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>**</span> <span class=o>-</span><span class=p>(</span><span class=o>-</span><span class=mi>17</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span> <span class=o>%</span> <span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>a2</span> <span class=o>=</span> <span class=p>(</span><span class=n>y</span> <span class=o>//</span> <span class=mi>17</span><span class=p>)</span> <span class=o>//</span> <span class=n>a1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>a2</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>&gt;</span> <span class=mf>0.5</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>17</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>106</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>aa</span><span class=p>[</span><span class=n>y</span><span class=p>,</span> <span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>aa</span><span class=p>[:,</span> <span class=p>::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>k</span> <span class=o>=</span> <span class=mi>1594199391770250354455183081054802631580554590456781276981302978243348088576774816981145460077422136047780972200375212293357383685099969525103172039042888918139627966684645793042724447954308373948403404873262837470923601139156304668538304057819343713500158029312192443296076902692735780417298059011568971988619463802818660736654049870484193411780158317168232187100668526865378478661078082009408188033574841574337151898932291631715135266804518790328831268881702387643369637508117317249879868707531954723945940226278368605203277838681081840279552</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>aa</span> <span class=o>=</span> <span class=n>Tupper_self_referential_formula</span><span class=p>(</span><span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>aa</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 绘制图像</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>&#34;tupper.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;tupper.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out1</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>FLIP_TOP_BOTTOM</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out2</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>FLIP_LEFT_RIGHT</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out2</span><span class=o>.</span><span class=n>show</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=盲文><span>盲文</span>
<a href=#%e7%9b%b2%e6%96%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250925131554313.png alt=/posts/1ad9200/imgs/image-20250925131554313.png height=1060 width=1588></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250925131524373.png alt=/posts/1ad9200/imgs/image-20250925131524373.png height=1170 width=1686></p><h3 class=heading-element id=旗语><span>旗语</span>
<a href=#%e6%97%97%e8%af%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421203306482.png alt=/posts/1ad9200/imgs/image-20250421203306482.png height=787 width=1368></p><h3 class=heading-element id=各种各样的异形文字><span>各种各样的异形文字</span>
<a href=#%e5%90%84%e7%a7%8d%e5%90%84%e6%a0%b7%e7%9a%84%e5%bc%82%e5%bd%a2%e6%96%87%e5%ad%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>这一栏目主要搜集了比赛中遇到的一些异形文字，当然如果实在找不到对照表，也可以直接映射到字母上，然后拿quipquip爆破，详细可以参考 2025-SUCTF 的 SU_forensics</p></blockquote><h4 class=heading-element id=原神提瓦特通用文字><span>原神提瓦特通用文字</span>
<a href=#%e5%8e%9f%e7%a5%9e%e6%8f%90%e7%93%a6%e7%89%b9%e9%80%9a%e7%94%a8%e6%96%87%e5%ad%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250823182424652.png alt=/posts/1ad9200/imgs/image-20250823182424652.png height=1130 width=1692></p><h4 class=heading-element id=瓦坎达文字><span>瓦坎达文字</span>
<a href=#%e7%93%a6%e5%9d%8e%e8%be%be%e6%96%87%e5%ad%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250315123245293.png alt=/posts/1ad9200/imgs/image-20250315123245293.png height=550 width=550></p><h4 class=heading-element id=喜羊羊与灰太狼-羊文><span>喜羊羊与灰太狼-羊文</span>
<a href=#%e5%96%9c%e7%be%8a%e7%be%8a%e4%b8%8e%e7%81%b0%e5%a4%aa%e7%8b%bc-%e7%be%8a%e6%96%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421190228589.png alt=/posts/1ad9200/imgs/image-20250421190228589.png height=406 width=479></p><h2 class=heading-element id=misc流量分析题思路><span>Misc——流量分析题思路</span>
<a href=#misc%e6%b5%81%e9%87%8f%e5%88%86%e6%9e%90%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>详见作者博客中的 <strong><a href=https://goodlunatic.github.io/posts/5422d65/ target=_blank rel="external nofollow noopener noreferrer">Network Traffic Analysis</a></strong> 这篇文章</p><h2 class=heading-element id=misc工控题思路><span>Misc——工控题思路</span>
<a href=#misc%e5%b7%a5%e6%8e%a7%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>详见作者博客中的 <strong><a href=https://goodlunatic.github.io/posts/01ebd40/ target=_blank rel="external nofollow noopener noreferrer">CTF-ICS Learning Record</a></strong> 这篇文章</p><h2 class=heading-element id=misc数据安全题思路><span>Misc——数据安全题思路</span>
<a href=#misc%e6%95%b0%e6%8d%ae%e5%ae%89%e5%85%a8%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>详见作者博客中的 <strong><a href=https://goodlunatic.github.io/posts/c49ae8a/ target=_blank rel="external nofollow noopener noreferrer">CTF-数据安全</a></strong> 这篇文章</p><h2 class=heading-element id=misc图片题思路><span>MIsc——图片题思路</span>
<a href=#misc%e5%9b%be%e7%89%87%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><blockquote><p>Tips：</p><p>1.各种隐写可以先拉入一键梭哈网站解析一下:https://aperisolve.fr/</p><p>2.各种乱七八糟的隐写可以先看看这个UP主的视频：https://space.bilibili.com/39665558</p></blockquote><h3 class=heading-element id=通用思路><span>通用思路</span>
<a href=#%e9%80%9a%e7%94%a8%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1查看图片属性的详细信息可能关键信息就在里面><span>1、查看图片属性的详细信息(可能关键信息就在里面)</span>
<a href=#1%e6%9f%a5%e7%9c%8b%e5%9b%be%e7%89%87%e5%b1%9e%e6%80%a7%e7%9a%84%e8%af%a6%e7%bb%86%e4%bf%a1%e6%81%af%e5%8f%af%e8%83%bd%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af%e5%b0%b1%e5%9c%a8%e9%87%8c%e9%9d%a2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=2拉入010查看文件头尾><span>2、拉入010，查看文件头尾</span>
<a href=#2%e6%8b%89%e5%85%a5010%e6%9f%a5%e7%9c%8b%e6%96%87%e4%bb%b6%e5%a4%b4%e5%b0%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=3foremost-或者-binwalk><span>3、foremost 或者 binwalk</span>
<a href=#3foremost-%e6%88%96%e8%80%85-binwalk class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>如果<code>foremost</code>没有提取出东西，可以用<code>binwalk</code>试一下，可能<code>binwalk</code>可以提取出东西</p><p>例题-i春秋CTF-Misc-class10</p><h4 class=heading-element id=4盲水印隐写可能是一张图片或者两张图片><span>4、盲水印隐写(可能是一张图片或者两张图片)</span>
<a href=#4%e7%9b%b2%e6%b0%b4%e5%8d%b0%e9%9a%90%e5%86%99%e5%8f%af%e8%83%bd%e6%98%af%e4%b8%80%e5%bc%a0%e5%9b%be%e7%89%87%e6%88%96%e8%80%85%e4%b8%a4%e5%bc%a0%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>单图盲水印</strong></p><p>可以使用<code>隐形水印工具V1.2</code>或者<code>WaterMark</code>工具来提取水印</p><p><img loading=lazy src=/posts/1ad9200/imgs/bw1.png alt=/posts/1ad9200/imgs/bw1.png height=814 width=1149></p><p><strong>双图盲水印</strong></p><blockquote><p>双图盲水印这里有两个项目：</p><p>chishaxie/BlindWaterMark：https://github.com/chishaxie/BlindWaterMark</p><p>linyacool/blind-watermark（频域盲水印）：https://github.com/linyacool/blind-watermark</p><p>具体用哪个项目根据题目提示，如果不确定的话可以两个都试试看</p><p>当然，出题人可能会直接用项目中的一模一样示例图像出题，熟悉图像可以帮助我们定位是哪种盲水印</p></blockquote><p>当然这两种都已经被 byxs 集成到 <code>PuzzleSolver</code> 里了，可以尝试直接用<code>PuzzleSolver</code>处理</p><p>如果没有 PuzzlerSolver 的话，也可以下载原始项目提取</p><p>普通盲水印：</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251102142531985.png alt=/posts/1ad9200/imgs/image-20251102142531985.png height=1758 width=1968></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 先把要处理的图片拉入BlindWaterMark-master文件夹，然后使用如下命令</span>
</span></span><span class=line><span class=cl>python bwmforpy3.py decode hui.png hui_wm_py3.png wm_out_py3.png
</span></span><span class=line><span class=cl>python bwmforpy3.py decode day1.png day2.png flag.png --oldseed
</span></span><span class=line><span class=cl><span class=c1># 这里的 --oldseed 参数的意思是在 Python3 中用 Python2 的随机数生成算法</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips：这里构成盲水印的两张图片不一定要都是 PNG 或者都是 JPG，有时候一张 JPG 一张 PNG，或者一张 PNG 一张 BMP，都可以出盲水印</p></blockquote><p>然后第一个项目还有一个特征就是：原图和盲水印后的图像异或会得到下图这种横向蓝色虚线（例题1-2025交通运输行业网络安全大赛 XORkitt）</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251102142829703.png alt=/posts/1ad9200/imgs/image-20251102142829703.png height=1222 width=1634></p><p>频域盲水印：</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251102142715074.png alt=/posts/1ad9200/imgs/image-20251102142715074.png height=1746 width=2202></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python decode.py --original ori.png --image res.png --result extract.png</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=5图片的分离和拼接><span>5、图片的分离和拼接</span>
<a href=#5%e5%9b%be%e7%89%87%e7%9a%84%e5%88%86%e7%a6%bb%e5%92%8c%e6%8b%bc%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>(1)可以用kali的convert分离和montage拼接命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>分解GIF的命令：convert glance.gif flag.png
</span></span><span class=line><span class=cl>水平镜像翻转图片：convert -flop reverse.jpg reversed.jpg
</span></span><span class=line><span class=cl>垂直镜像翻转图片：convert -flip reverse.jpg reversed.jpg
</span></span><span class=line><span class=cl>合成图片的命令：montage flag*.png -tile x1 -geometry +0+0 flag.png
</span></span><span class=line><span class=cl>-tile是拼接时每行和每列的图片数，这里用x1，就是只一行
</span></span><span class=line><span class=cl>-geometry是首选每个图和边框尺寸，我们边框为0，图照原始尺寸即可</span></span></code></pre></td></tr></table></div></div><p>(2)使用在线网站分解：https://tu.sioe.cn/gj/fenjie/</p><p>(3)用Python脚本跑</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=n>im</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=mi>201</span><span class=p>,</span> <span class=mi>600</span><span class=p>))</span>  <span class=c1># new(mode,size) size is long and width</span>
</span></span><span class=line><span class=cl><span class=n>PATH</span> <span class=o>=</span> <span class=s1>&#39;E:/ctf/glance.gif&#39;</span>
</span></span><span class=line><span class=cl><span class=n>FILE_NAME</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>PATH</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>width</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>FILE_NAME</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>im</span><span class=o>.</span><span class=n>paste</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>PATH</span><span class=o>+</span><span class=n>i</span><span class=p>),</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>width</span><span class=o>+</span><span class=mi>2</span><span class=p>,</span> <span class=mi>600</span><span class=p>))</span>  <span class=c1># box is 左，上，右,下</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>im</span><span class=o>.</span><span class=n>show</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=6image-conbiner两张图片><span>6、Image conbiner(两张图片)</span>
<a href=#6image-conbiner%e4%b8%a4%e5%bc%a0%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>两张图片可能有部分残缺（可以互补）</p><p>给了两张图片时，用<code>Stegsolve</code>打开其中一张，</p><p>然后再<code>Analyze</code>-<code>Image conbiner</code>打开另一张图片</p><p>还有可能是给了两张二维码，需要两个二维码每个像素亦或</p><h4 class=heading-element id=7oursecret隐写可以无密码><span>7、OurSecret隐写(可以无密码)</span>
<a href=#7oursecret%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>拉入OurSecret，输入密码(也可以无密码)解密，得到隐藏文件</p><blockquote><p>OurSecret隐写的特征非常明显，如下图中标蓝的那40字节</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>9E 97 BA 2A 00 80 88 C9 A3 70 97 5B A2 E4 99 B8
</span></span><span class=line><span class=cl>C1 78 72 0F 88 DD DC 34 2B 4E 7D 31 7F B5 E8 70
</span></span><span class=line><span class=cl>39 A8 B8 42 75 68 71 91</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250312191643162.png alt=/posts/1ad9200/imgs/image-20250312191643162.png height=462 width=1041></p><h4 class=heading-element id=8拼图题><span>8、拼图题</span>
<a href=#8%e6%8b%bc%e5%9b%be%e9%a2%98 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>碎图片合成一张图片</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#在Windows中使用imagemagick处理</span>
</span></span><span class=line><span class=cl>magick.exe montage *.png -tile 18x10 -geometry 125x125+0+0 flag.jpg
</span></span><span class=line><span class=cl>magick montage *.png -tile 40x22 -geometry +0+0 flag-0.png</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#在kali中处理</span>
</span></span><span class=line><span class=cl>拉入kali里处理，如果是碎的图片，
</span></span><span class=line><span class=cl>先使用 montage *.PNG -tile 12x12 -geometry +0+0 out.png合成一张图片
</span></span><span class=line><span class=cl>*.png表示匹配所有图片
</span></span><span class=line><span class=cl>-tile表示图片的张数
</span></span><span class=line><span class=cl>-geometry +0+0表示每张图片的间距为0
</span></span><span class=line><span class=cl>合成后要先查看图片的宽高（宽高要相等，不相等要用PS调整）</span></span></code></pre></td></tr></table></div></div><p><strong>然后把上面合成好的图片使用 Puzzle-Merak 工具进行智能拼图</strong></p><p><img loading=lazy src=/posts/1ad9200/imgs/puzzles1.png alt=/posts/1ad9200/imgs/puzzles1.png height=298 width=508></p><p><img loading=lazy src=/posts/1ad9200/imgs/puzzles2.png alt=/posts/1ad9200/imgs/puzzles2.png height=821 width=1237></p><p><strong>这里只需要输入 generation、population、size 并用分号分开即可开始自动拼图</strong></p><p><strong>也可以使用gaps智能拼图(在kali和wsl里使用都可以)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gaps --image<span class=o>=</span>out.png --generation<span class=o>=</span><span class=m>30</span> --population<span class=o>=</span><span class=m>144</span> --size<span class=o>=</span><span class=m>30</span> --save 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--image 指向拼图的路径
</span></span><span class=line><span class=cl>--size 拼图块的像素尺寸
</span></span><span class=line><span class=cl>--generations 遗传算法的代的数量
</span></span><span class=line><span class=cl>--population 个体数量
</span></span><span class=line><span class=cl>--verbose 每一代训练结束后展示最佳结果
</span></span><span class=line><span class=cl>--save 将拼图还原为图像</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gaps --image<span class=o>=</span>flag.jpg --generations<span class=o>=</span><span class=m>50</span> --population<span class=o>=</span><span class=m>180</span> --size<span class=o>=</span><span class=m>125</span> --verbose
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-generations 你要迭代多少次
</span></span><span class=line><span class=cl>-population 你有多少个小拼图
</span></span><span class=line><span class=cl>--size 每张小图，也就是拼图小块的大小
</span></span><span class=line><span class=cl>--verbose 实时显示</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=9提取图中等距像素点近邻法缩放图片><span>9、提取图中等距像素点/近邻法缩放图片</span>
<a href=#9%e6%8f%90%e5%8f%96%e5%9b%be%e4%b8%ad%e7%ad%89%e8%b7%9d%e5%83%8f%e7%b4%a0%e7%82%b9%e8%bf%91%e9%82%bb%e6%b3%95%e7%bc%a9%e6%94%be%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>参考链接：</p><p><a href="https://www.bilibili.com/video/BV1Lf4y1r7dZ/?spm_id_from=333.999.0.0" target=_blank rel="external nofollow noopener noreferrer">https://www.bilibili.com/video/BV1Lf4y1r7dZ/?spm_id_from=333.999.0.0</a></p><p><a href=https://github.com/Byxs20 target=_blank rel="external nofollow noopener noreferrer">https://github.com/Byxs20</a></p><p>例题-2024浙江省赛决赛-天命人</p><p>拿下面这张图片举个栗子</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241120171656554.png alt=/posts/1ad9200/imgs/image-20241120171656554.png height=1080 width=1920></p><p>方法一：直接在PS中将宽高都缩小为原来的十分之一，并选择邻近硬边缘即可直接得到隐藏的图片</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241120171835713.png alt=/posts/1ad9200/imgs/image-20241120171835713.png height=1031 width=1919></p><p>方法二：在windows的终端中运行CTFD中的Get_Pixels.py（注意所有路径中都不要出现中文）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>py main.py -f arcaea.png -p 0x0+3828x2148 -n 12x12
</span></span><span class=line><span class=cl>py main.py -f 要解密的图片 -p 第一个像素点的XY坐标+最后一个像素点的XY坐标 -n 两个等距像素点的XY距离的差值
</span></span><span class=line><span class=cl>如果是等距离提取整张图片中所有像素点，要注意右下角那个点的位置XY都要减去一倍的距离
</span></span><span class=line><span class=cl>Tips:在PS中按F8就可以看到每个像素点的具体坐标了</span></span></code></pre></td></tr></table></div></div><blockquote><p>这里有时候运行会报错，需要把main.py脚本拉到桌面上运行或者检查一下图片的CRC对不对</p></blockquote><p>一样可以得到隐藏的图片</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241120172043964.png alt=/posts/1ad9200/imgs/image-20241120172043964.png height=544 width=971></p><h4 class=heading-element id=10pixeljihad有密码><span>10、pixeljihad（有密码）</span>
<a href=#10pixeljihad%e6%9c%89%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接使用在线网站解密即可：<a href=https://sekao.net/pixeljihad/ target=_blank rel="external nofollow noopener noreferrer">PixelJihad (sekao.net)</a></p><h4 class=heading-element id=11隐写文本可能藏在原图片和隐写文件的中间><span>11、隐写文本可能藏在原图片和隐写文件的中间</span>
<a href=#11%e9%9a%90%e5%86%99%e6%96%87%e6%9c%ac%e5%8f%af%e8%83%bd%e8%97%8f%e5%9c%a8%e5%8e%9f%e5%9b%be%e7%89%87%e5%92%8c%e9%9a%90%e5%86%99%e6%96%87%e4%bb%b6%e7%9a%84%e4%b8%ad%e9%97%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接在010中运行对应文件类型的模板，依次查看文件头尾有无额外内容即可</p><h4 class=heading-element id=12deegger-embedder隐写><span>12、DeEgger Embedder隐写</span>
<a href=#12deegger-embedder%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>可以直接使用 DeEgger Embedder 工具 extract files</p><h4 class=heading-element id=13flag可能藏在-exif-中><span>13、flag可能藏在 exif 中</span>
<a href=#13flag%e5%8f%af%e8%83%bd%e8%97%8f%e5%9c%a8-exif-%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接在 WSL 中输入以下命令查看即可，如果偷懒也可以直接使用 破空 flag 查找工具 进行查找</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>exiftool</span> <span class=mf>3.j</span><span class=n>pg</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=14给了两张图片flag藏在每行不同像素的个数中><span>14、给了两张图片，flag藏在每行不同像素的个数中</span>
<a href=#14%e7%bb%99%e4%ba%86%e4%b8%a4%e5%bc%a0%e5%9b%be%e7%89%87flag%e8%97%8f%e5%9c%a8%e6%af%8f%e8%a1%8c%e4%b8%8d%e5%90%8c%e5%83%8f%e7%b4%a0%e7%9a%84%e4%b8%aa%e6%95%b0%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>例题1-2023羊城杯初赛-两支老虎</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span><span class=p>,</span> <span class=n>ImageChops</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img1</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;1.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>width1</span><span class=p>,</span><span class=n>heigth1</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>size</span> <span class=c1># 1134,720</span>
</span></span><span class=line><span class=cl><span class=n>img2</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;2.png&#34;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>width2</span><span class=p>,</span><span class=n>heigth2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>size</span> <span class=c1># 1144,720</span>
</span></span><span class=line><span class=cl><span class=n>img2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>crop</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1134</span><span class=p>,</span><span class=mi>720</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>width2</span><span class=p>,</span><span class=n>heigth2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl><span class=c1># img2.save(&#34;3.png&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>diff_dit</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=c1># 返回差异图像，表示 img1 和 img2 之间的像素差异。</span>
</span></span><span class=line><span class=cl><span class=n>diff</span> <span class=o>=</span> <span class=n>ImageChops</span><span class=o>.</span><span class=n>difference</span><span class=p>(</span><span class=n>img1</span><span class=p>,</span><span class=n>img2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>width3</span><span class=p>,</span><span class=n>heigth3</span> <span class=o>=</span> <span class=n>diff</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>heigth3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel3</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>diff</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=c1># 统计一下差异像素</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pixel3</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>diff_dit</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>            <span class=n>diff_dit</span><span class=p>[</span><span class=n>pixel3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>diff_dit</span><span class=p>[</span><span class=n>pixel3</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>diff_dit</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=c1># {&#39;(0, 0, 0)&#39;: 813891, &#39;(1, 1, 1)&#39;: 2533, &#39;(1, 1, 0)&#39;: 53}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>heigth1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel1</span> <span class=o>=</span> <span class=n>img1</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>pixel2</span> <span class=o>=</span> <span class=n>img2</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pixel1</span> <span class=o>!=</span> <span class=n>pixel2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cnt</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>cnt</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>cnt</span><span class=p>),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># DASCTF{tWo_t1gers_rUn_f@st}</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=15两张图片用stegsolve中的image-conbiner合成为一张bmp><span>15、两张图片，用StegSolve中的Image Conbiner合成为一张bmp</span>
<a href=#15%e4%b8%a4%e5%bc%a0%e5%9b%be%e7%89%87%e7%94%a8stegsolve%e4%b8%ad%e7%9a%84image-conbiner%e5%90%88%e6%88%90%e4%b8%ba%e4%b8%80%e5%bc%a0bmp class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241106154249826.png alt=/posts/1ad9200/imgs/image-20241106154249826.png height=1529 width=2561></p><p>合成一张bmp后，再使用zsteg扫描</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241106154358962.png alt=/posts/1ad9200/imgs/image-20241106154358962.png height=628 width=1115></p><h4 class=heading-element id=16图片多个通道存在lsb隐写stegsolve中把背景颜色相同的勾选上><span>16、图片多个通道存在LSB隐写，StegSolve中把背景颜色相同的勾选上</span>
<a href=#16%e5%9b%be%e7%89%87%e5%a4%9a%e4%b8%aa%e9%80%9a%e9%81%93%e5%ad%98%e5%9c%a8lsb%e9%9a%90%e5%86%99stegsolve%e4%b8%ad%e6%8a%8a%e8%83%8c%e6%99%af%e9%a2%9c%e8%89%b2%e7%9b%b8%e5%90%8c%e7%9a%84%e5%8b%be%e9%80%89%e4%b8%8a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=17把小说藏进图片><span>17、把小说藏进图片</span>
<a href=#17%e6%8a%8a%e5%b0%8f%e8%af%b4%e8%97%8f%e8%bf%9b%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>参考链接：https://www.bilibili.com/video/BV1Ai4y1V7rg/?spm_id_from=333.999.0.0&amp;vd_source=31399c09aa0c93655468bde7b13fcc03</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 脚本一</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;1.bmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>width</span><span class=p>,</span><span class=n>height</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span> <span class=c1># 1326 1326</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;decode.txt&#34;</span><span class=p>,</span><span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 脚本二</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>numpy</span> <span class=kn>import</span> <span class=n>array</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>array</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;1.bmp&#39;</span><span class=p>))[:,</span> <span class=p>:,</span> <span class=p>::</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\0</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-16-be&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=18arnold猫脸变换><span>18、Arnold猫脸变换</span>
<a href=#18arnold%e7%8c%ab%e8%84%b8%e5%8f%98%e6%8d%a2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>参考链接：https://1cepeak.cn/post/arnold/</p><p>如果已经得到了<code>shuffle_times</code>、<code>a</code>和<code>b</code>，然后直接使用下面这个脚本恢复即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_encode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>arnold_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>h</span>   <span class=c1># 或N=w</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=o>*</span><span class=n>ori_x</span> <span class=o>+</span> <span class=n>b</span><span class=o>*</span><span class=n>ori_y</span><span class=p>)</span><span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>b</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>arnold_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>arnold_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;flag_arnold_encode.png&#39;</span><span class=p>,</span> <span class=n>arnold_image</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>IMWRITE_PNG_COMPRESSION</span><span class=p>),</span> <span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>arnold_image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>h</span>  <span class=c1># 或N=w</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>((</span><span class=n>a</span> <span class=o>*</span> <span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=o>-</span><span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>((</span><span class=o>-</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>decode_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>,</span> <span class=n>decode_image</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>IMWRITE_PNG_COMPRESSION</span><span class=p>),</span> <span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decode_image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># arnold_encode(img, 1, 2, 3)</span>
</span></span><span class=line><span class=cl><span class=n>arnold_decode</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>29294</span><span class=p>,</span> <span class=mi>7302244</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>如果题目没有给我们上面的三个参数，我可以尝试爆破一下</p><p>例题-cat(技能兴鲁)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>h</span>  <span class=c1># 或N=w</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 按照公式坐标变换</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>((</span><span class=n>a</span> <span class=o>*</span> <span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=o>-</span><span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>((</span><span class=o>-</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>                <span class=n>decode_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>decode_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_brute</span><span class=p>(</span><span class=n>image</span><span class=p>,</span><span class=n>shuffle_times_range</span><span class=p>,</span><span class=n>a_range</span><span class=p>,</span><span class=n>b_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>shuffle_times_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>a_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>a_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>b_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Trying shuffle_times=</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2> a=</span><span class=si>{</span><span class=n>a</span><span class=si>}</span><span class=s2> b=</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>decoded_img</span> <span class=o>=</span> <span class=n>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>output_filename</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;flag_decodedc</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>_a</span><span class=si>{</span><span class=n>a</span><span class=si>}</span><span class=s2>_b</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=s2>.png&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=n>output_filename</span><span class=p>,</span> <span class=n>decoded_img</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>IMWRITE_PNG_COMPRESSION</span><span class=p>),</span> <span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;cat.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>arnold_brute</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p><strong>正常来说猫脸变换的图像长和宽都是相等的，如果遇到抽象的长宽不相等的图像，脚本中的N需要改一下</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>arnold_decode</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shuffle_times</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shuffle_times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>ori_x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>ori_y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>new_x</span> <span class=o>=</span> <span class=p>((</span><span class=n>a</span> <span class=o>*</span> <span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=p>(</span><span class=o>-</span><span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>                <span class=n>new_y</span> <span class=o>=</span> <span class=p>((</span><span class=o>-</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>ori_x</span> <span class=o>+</span> <span class=n>ori_y</span><span class=p>)</span> <span class=o>%</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>                <span class=n>decode_image</span><span class=p>[</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>image</span><span class=p>[</span><span class=n>ori_x</span><span class=p>,</span> <span class=n>ori_y</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>decode_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;fla@.bmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>decode_img</span> <span class=o>=</span> <span class=n>arnold_decode</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>,</span><span class=n>decode_img</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=19二进制数据转图片><span>19、二进制数据转图片</span>
<a href=#19%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%95%b0%e6%8d%ae%e8%bd%ac%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bin_data</span> <span class=o>=</span> <span class=s2>&#34;010000001010101101110001000010001110010110101100111010011101001010111011111101111111110110100100011001001100011001000001010111100001101000001010001011101111000100001010110110101101100111010000010000110101100001100110010100010011100011100011010100100000111101111111010010111101100010001100100010111111111001011101011101000000110111011000001001010011001001110101111111010110011011001000101010010110101011011111001010100011100001100001011010011&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>bin_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sqrt_len</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>data_len</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s2>&#34;pic_out&#34;</span><span class=p>,</span><span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>sqrt_len</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data_len</span> <span class=o>%</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>i</span><span class=p>,</span> <span class=n>data_len</span> <span class=o>//</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;尝试图像尺寸: </span><span class=si>{</span><span class=n>width</span><span class=si>}</span><span class=s2> x </span><span class=si>{</span><span class=n>height</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;L&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>),</span> <span class=mi>255</span><span class=p>)</span>          <span class=c1># 原始图像</span>
</span></span><span class=line><span class=cl>        <span class=n>inverted_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;L&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>),</span> <span class=mi>0</span><span class=p>)</span>   <span class=c1># 反色图像</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bin_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span><span class=p>,</span> <span class=n>x</span> <span class=o>=</span> <span class=n>idx</span> <span class=o>//</span> <span class=n>width</span><span class=p>,</span> <span class=n>idx</span> <span class=o>%</span> <span class=n>width</span>
</span></span><span class=line><span class=cl>            <span class=n>color</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>if</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=k>else</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>inverted_img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=mi>255</span> <span class=o>-</span> <span class=n>color</span><span class=p>)</span>  <span class=c1># 反色</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;pic_out/</span><span class=si>{</span><span class=n>width</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>height</span><span class=si>}</span><span class=s2>.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>inverted_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;pic_out/</span><span class=si>{</span><span class=n>width</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>height</span><span class=si>}</span><span class=s2>_inverted.png&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=20-脚本提取lsb数据并分析><span>20、 脚本提取LSB数据并分析</span>
<a href=#20-%e8%84%9a%e6%9c%ac%e6%8f%90%e5%8f%96lsb%e6%95%b0%e6%8d%ae%e5%b9%b6%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_lsb</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;flag.png&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>r_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># lsb_data = libnum.b2s(&#34;&#34;.join(r_lsb))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>lsb_data</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=21像素点rgb值转图片><span>21、像素点RGB值转图片</span>
<a href=#21%e5%83%8f%e7%b4%a0%e7%82%b9rgb%e5%80%bc%e8%bd%ac%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>题目提供了类似如下的数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>直接写一个Python脚本爆破宽高并还原图像即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;basic.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将每行数据转换为元组，并存储在列表中</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=nb>eval</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span> <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将列表转换为NumPy数组，形状为 (N, 3)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data_length</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sqrt_length</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>data_length</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>sqrt_length</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data_length</span> <span class=o>%</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># 如果长度可以整除</span>
</span></span><span class=line><span class=cl>        <span class=n>rows</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=n>cols</span> <span class=o>=</span> <span class=n>data_length</span> <span class=o>//</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;尝试重塑为 </span><span class=si>{</span><span class=n>rows</span><span class=si>}</span><span class=s2> 行, </span><span class=si>{</span><span class=n>cols</span><span class=si>}</span><span class=s2> 列&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>reshaped_data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>reshaped_data</span><span class=p>,</span> <span class=s1>&#39;RGB&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>image</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>rows</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>cols</span><span class=si>}</span><span class=s2>.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;无法重塑为 </span><span class=si>{</span><span class=n>rows</span><span class=si>}</span><span class=s2> 行, </span><span class=si>{</span><span class=n>cols</span><span class=si>}</span><span class=s2> 列: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=22图片套娃><span>22、图片套娃</span>
<a href=#22%e5%9b%be%e7%89%87%e5%a5%97%e5%a8%83 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>图片的每个像素的RGB值其实都是另一张图片的字节数据</p><p>例题1-2025软件系统安全赛</p><p>附件给了下面这张图片</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250324153749556.png alt=/posts/1ad9200/imgs/image-20250324153749556.png height=256 width=256></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.png&#34;</span><span class=p>,</span><span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>data</span><span class=p>)))</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[:</span><span class=mi>20</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>((</span><span class=n>i</span><span class=p>,</span><span class=nb>hex</span><span class=p>(</span><span class=n>i</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]),</span><span class=n>end</span><span class=o>=</span><span class=s2>&#34; &#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>用以上脚本把像素的每个RGB值都转为hex，就可以在图片头几个像素发现PNG文件头</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250324154302576.png alt=/posts/1ad9200/imgs/image-20250324154302576.png height=75 width=1592></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>io</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>cnt</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>img_file</span> <span class=o>=</span> <span class=s2>&#34;flag.png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>img_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span><span class=p>,</span><span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>out</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>out</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>out</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>outfile</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>cnt</span><span class=si>}</span><span class=s2>.png&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>outfile</span><span class=p>,</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>out</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>cnt</span><span class=si>}</span><span class=s2>.png 处理完毕&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>img_file</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>cnt</span><span class=si>}</span><span class=s2>.png&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cnt</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在利用io.BytesIO内存中处理文件数据：避免频繁读写磁盘，提高性能。</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func2</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.png&#34;</span><span class=p>,</span><span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cnt</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>data</span><span class=p>)))</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xff</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>data</span><span class=p>))</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>cnt</span><span class=si>}</span><span class=s2>.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>cnt</span><span class=si>}</span><span class=s2>.png 处理完毕&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>cnt</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># func1()</span>
</span></span><span class=line><span class=cl>    <span class=n>func2</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>运行以上脚本循环485次后即可得到flag</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250324153842745.png alt=/posts/1ad9200/imgs/image-20250324153842745.png height=256 width=256></p><h4 class=heading-element id=23java-blindwatermark><span>23、Java-BlindWatermark</span>
<a href=#23java-blindwatermark class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>1、直接用<code>Byxs20</code>写的<code>PuzzleSolver</code>一把梭</p><p>2、Github上的开源项目：https://github.com/ww23/BlindWatermark</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -jar .<span class=se>\B</span>lindWatermark-v0.0.3-windows-x86_64.jar decode -c .<span class=se>\p</span>assword.png output.png</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=24在线网站一把梭><span>24、在线网站一把梭</span>
<a href=#24%e5%9c%a8%e7%ba%bf%e7%bd%91%e7%ab%99%e4%b8%80%e6%8a%8a%e6%a2%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>这种情况常常发生在某些Misc出题人水平不够，图片隐写道行不够的情况</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在线网站：</span>
</span></span><span class=line><span class=cl>https://www.a.tools/Tool.php?Id<span class=o>=</span><span class=m>100</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=25立体图><span>25、立体图</span>
<a href=#25%e7%ab%8b%e4%bd%93%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>看到类似于下面这种图案，可能就是立体图，可以拉到 stegsolve 中遍历偏移量</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251031130725174.png alt=/posts/1ad9200/imgs/image-20251031130725174.png height=906 width=1510></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251031130125322.png alt=/posts/1ad9200/imgs/image-20251031130125322.png height=1508 width=2940></p><p>当然，在理解了原理后也可以自己写个脚本把偏移的像素还原回去</p><h3 class=heading-element id=png思路><span>PNG思路</span>
<a href=#png%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1png图片宽高被篡改><span>1、PNG图片宽高被篡改</span>
<a href=#1png%e5%9b%be%e7%89%87%e5%ae%bd%e9%ab%98%e8%a2%ab%e7%af%a1%e6%94%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>010打开图片改宽高即可，17-20字节是宽，21-24字节是高</p><p>当然也可以用PuzzleSolver或随波逐流工具直接爆破图片宽高</p><h4 class=heading-element id=2lsb隐写><span>2、LSB隐写:</span>
<a href=#2lsb%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>没有密钥的情况</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 用zsteg快速查看</span>
</span></span><span class=line><span class=cl>zsteg -a <span class=o>(</span>文件名<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=c1># 提取数据并导出</span>
</span></span><span class=line><span class=cl>zsteg -e b1,r,lsb,xy 3.png &gt; 123.jpg</span></span></code></pre></td></tr></table></div></div><p>有时候图片隐写的内容，zsteg识别不出来，因此最保险的还是用<code>stegsolve</code>肉眼过一遍</p><p>然后根据LSB隐写的痕迹尝试手动提取</p><blockquote><p>这里详细讲一下zsteg扫出来的参数的含义：</p><p>参考链接：https://www.anquanke.com/post/id/189154</p><p>-c：rgba的组合理解，r3g2b3则表示r通道的低3bit，g通道2bit，r通道3bit，如果设置为rbg不加数字的，则表示每个通道读取bit数相同，bit数由-b参数设置</p><p>-b：设置每个通道读取的bit数，从低位开始，如果不是顺序的低位开始，则可以使用掩码，比如取最低位和最高位，则可以-b 10000001或者-b 0x81</p><p>-o：设置行列的读取顺序，xy就是从上到下，从左到右，xy任意有大写的，表示倒序，其中当图片是BMP时，bY的顺序和xY是一样的，Yb和Yx的顺序是一样的</p><p>行列顺序：zsteg可以通过-o选项设置8种组合（xy,xY,Xy,XY,yx,yX,Yx,YX），Stegsolve只有Extract By Row or Column，对应到zsteg的-o选项上就是xy和yx</p><p>字节顺序：Stegsolve字节上的读取顺序与Bit Order选项有关，如果设置了MSBFirst，是从高位开始读取，LSBFirst是从低位开始读取。zsteg只能从高位开始读，比如-b 0x81，在读取不同通道数据时，都是先读取一个字节的高位，再读取该字节的低位。对应到Stegsolve就是MSBFirst的选项。</p><p>组合顺序：zsteg的&ndash;lsb和&ndash;msb决定了组合顺序：lsb-大端存放，msb-小端存放。stegsolve的MSBFirst表示从高位读取到低位，LSBFirst表示从低位读取到高位。只有当通道勾选的Bit个数大于1时，该选项才会影响返回的结果。</p></blockquote><p><strong>有密钥的情况（cloacked-pixel）</strong></p><p>直接下载开源项目到本地，根据<code>README</code>输入命令解密即可</p><p>如果懒得敲命令行，也可以用<code>PuzzleSolver</code>辅助解密</p><blockquote><p>原项目: <a href=https://github.com/livz/cloacked-pixel target=_blank rel="external nofollow noopener noreferrer">https://github.com/livz/cloacked-pixel</a></p><p>Python3重写的版本: <a href=https://github.com/Grazee/cloacked-pixel-python3 target=_blank rel="external nofollow noopener noreferrer">https://github.com/Grazee/cloacked-pixel-python3</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 cloacked-pixel-master/lsb.py extract 0.png out.data f78dcd383f1b574b
</span></span><span class=line><span class=cl><span class=c1># 0.png是隐写后的图片</span>
</span></span><span class=line><span class=cl><span class=c1># out.data是隐写内容保存的位置</span>
</span></span><span class=line><span class=cl><span class=c1># f78dcd383f1b574b是密钥</span></span></span></code></pre></td></tr></table></div></div><p>用Ai搓了一个爆破clocked-pixel密钥的脚本，将其放到clocked-pixel-python3目录下运行即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>crypt</span> <span class=kn>import</span> <span class=n>AESCipher</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span><span class=p>,</span> <span class=n>as_completed</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Assemble an array of bits into a binary file</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>assemble</span><span class=p>(</span><span class=n>v</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>bs</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>length</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>end_idx</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>idx</span> <span class=o>+</span> <span class=mi>8</span><span class=p>,</span> <span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=n>end_idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>b</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>bs</span> <span class=o>+=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload_size</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;i&#34;</span><span class=p>,</span> <span class=n>bs</span><span class=p>[:</span><span class=mi>4</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bs</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span> <span class=n>payload_size</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 批量解密函数</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt_batch</span><span class=p>(</span><span class=n>passwords</span><span class=p>,</span> <span class=n>data_out</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>passwd</span> <span class=ow>in</span> <span class=n>passwords</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cipher</span> <span class=o>=</span> <span class=n>AESCipher</span><span class=p>(</span><span class=n>passwd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>data_dec</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>data_out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data_dec</span> <span class=ow>and</span> <span class=p>(</span><span class=sa>b</span><span class=s1>&#39;ctf{&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;CTF{&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;flag{&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;FLAG{&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x50\x4b\x03\x04</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span> <span class=ow>or</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x89\x50\x4e\x47</span><span class=s1>&#39;</span> <span class=ow>in</span> <span class=n>data_dec</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Found password: </span><span class=si>{</span><span class=n>passwd</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>data_dec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span><span class=p>,</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extract data embedded into LSB of the input file</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>burp_func</span><span class=p>(</span><span class=n>png_path</span><span class=p>,</span><span class=n>dic_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>dic_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>passwd_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>p</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span> <span class=k>if</span> <span class=n>p</span><span class=o>.</span><span class=n>strip</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Loaded </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>passwd_list</span><span class=p>)</span><span class=si>}</span><span class=s1> passwords&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 使用numpy加速图像处理</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>png_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Image size: </span><span class=si>{</span><span class=n>width</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>height</span><span class=si>}</span><span class=s2> pixels.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 转换为numpy数组进行快速处理</span>
</span></span><span class=line><span class=cl>    <span class=n>img_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>img</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s2>&#34;RGBA&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 一次性提取所有LSB</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=c1># 使用numpy的位操作加速</span>
</span></span><span class=line><span class=cl>    <span class=n>red_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>img_array</span><span class=p>[:,</span> <span class=p>:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>green_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>img_array</span><span class=p>[:,</span> <span class=p>:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>blue_lsb</span> <span class=o>=</span> <span class=p>(</span><span class=n>img_array</span><span class=p>[:,</span> <span class=p>:,</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 交错排列RGB的LSB</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>red_lsb</span><span class=o>.</span><span class=n>size</span> <span class=o>+</span> <span class=n>green_lsb</span><span class=o>.</span><span class=n>size</span> <span class=o>+</span> <span class=n>blue_lsb</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>::</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>red_lsb</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>::</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>green_lsb</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span><span class=p>[</span><span class=mi>2</span><span class=p>::</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>blue_lsb</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>data_out</span> <span class=o>=</span> <span class=n>assemble</span><span class=p>(</span><span class=n>v</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data_out</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Failed to assemble data from LSBs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 多线程爆破密码</span>
</span></span><span class=line><span class=cl>    <span class=n>num_threads</span> <span class=o>=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_size</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>passwd_list</span><span class=p>)</span> <span class=o>//</span> <span class=n>num_threads</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[*] Starting multi-threaded decryption with </span><span class=si>{</span><span class=n>num_threads</span><span class=si>}</span><span class=s2> threads...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>num_threads</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>futures</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 分批处理密码</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>passwd_list</span><span class=p>),</span> <span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>batch</span> <span class=o>=</span> <span class=n>passwd_list</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=n>batch_size</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>futures</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>decrypt_batch</span><span class=p>,</span> <span class=n>batch</span><span class=p>,</span> <span class=n>data_out</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 等待结果</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span><span class=p>,</span> <span class=n>decrypted_data</span> <span class=o>=</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>password</span> <span class=ow>and</span> <span class=n>decrypted_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Found password: </span><span class=si>{</span><span class=n>password</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 立即关闭其他线程</span>
</span></span><span class=line><span class=cl>                <span class=n>executor</span><span class=o>.</span><span class=n>shutdown</span><span class=p>(</span><span class=n>wait</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>png_path</span> <span class=o>=</span> <span class=s1>&#39;steg.png&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>dic_path</span> <span class=o>=</span> <span class=s1>&#39;passwd_list.txt&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>burp_func</span><span class=p>(</span><span class=n>png_path</span><span class=p>,</span><span class=n>dic_path</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=3idat块隐写><span>3、IDAT块隐写</span>
<a href=#3idat%e5%9d%97%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>(1) 解压zlib获得原始数据</strong></p><p>用010提取数据扔进zlib脚本解压获得原始数据</p><p>将异常的IDAT数据块去头去尾之后使用以下脚本解压</p><blockquote><p>这里要注意的是 zlib 压缩数据流的文件头不一定是789C，还有可能是785E</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>IDAT</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;789C5D91011280400802BF04FFFF5C75294B5537738A21A27D1E49CFD17DB3937A92E7E603880A6D485100901FB0410153350DE83112EA2D51C54CE2E585B15A2FC78E8872F51C6FC1881882F93D372DEF78E665B0C36C529622A0A45588138833A170A2071DDCD18219DB8C0D465D8B6989719645ED9C11C36AE3ABDAEFCFC0ACF023E77C17C7897667&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>zlib</span><span class=o>.</span><span class=n>decompress</span><span class=p>(</span><span class=n>IDAT</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># print(data)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>decode</span><span class=p>()))</span></span></span></code></pre></td></tr></table></div></div><p>当然，这里也可以直接用 cyberchef 解码</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250809215320909.png alt=/posts/1ad9200/imgs/image-20250809215320909.png height=1422 width=2722></p><p><strong>(2) 加上文件头爆破宽高得到新的图片</strong></p><p>一般出问题的 IDAT Chunk 大小都是比正常的小的，很可能在图片末尾</p><p>如果不确定是哪一个有问题，可以尝试都提取出来，一个一个分析</p><p>可以使用 tweakpng 辅助分析，但是一般用 010 的模板提取分析就够了</p><p>我们可用 WSL 中的 pngcheck -v 0.png 检查 IDAT</p><p>如下图，最后一个和倒数第二个IDAT明显有问题，因此可以对这两部分进行尝试</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240724171411362.png alt=/posts/1ad9200/imgs/image-20240724171411362.png height=557 width=1835></p><p>借助 010 的模板功能把IDAT块提取出来，加上文件头尾并爆破宽高即可得到另一张图片</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 图片头(其中后面部分的数据可以不一样，但是数据长度要一样)
</span></span><span class=line><span class=cl>89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52
</span></span><span class=line><span class=cl>00 00 04 E0 00 00 03 0C 08 06 00 00 00 FA 9A D8
</span></span><span class=line><span class=cl>07
</span></span><span class=line><span class=cl>#图片尾
</span></span><span class=line><span class=cl>00 00 00 00 49 45 4E 44 AE 42 60 82</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240724171723828.png alt=/posts/1ad9200/imgs/image-20240724171723828.png height=2088 width=3840></p><p>Tips：这里有时候也可以不用补文件尾</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240724171731445.png alt=/posts/1ad9200/imgs/image-20240724171731445.png height=2088 width=3840></p><p>把文件头尾补完整后直接爆破一下宽高即可</p><p>例题1-2023安洵杯-dacongのsecret</p><p>例题2-DASCTF2024 暑期挑战赛-png_master</p><h4 class=heading-element id=4png末尾隐藏内容><span>4、PNG末尾隐藏内容</span>
<a href=#4png%e6%9c%ab%e5%b0%be%e9%9a%90%e8%97%8f%e5%86%85%e5%ae%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>010打开PNG，根据PNG模板定位到文件尾，看看后面有没有多余的数据</p><p>当然，也可以尝试直接<code>binwalk</code>或者<code>foremost</code>提取（但是如果隐藏文件的文件结构不完整可能识别不出来）</p><h4 class=heading-element id=5apng格式><span>5、APNG格式</span>
<a href=#5apng%e6%a0%bc%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>一张后缀为.png的图片，还可能是apng格式的</p><p>可以用exiftool看一下，apng格式是支持动图的，我们可以用<code>apngdis_gui</code>将每一帧分离出来</p><p>然后每一帧图片里可能藏了二维码或者有盲水印，或者每张图片的时间间隔转ASCII码就是flag</p><p>例题1-2021 GKCTF 你知道apng吗</p><p>例题2-2022 HGAME Week4摆烂</p><h4 class=heading-element id=6cve-2023-28303-截图工具漏洞><span>6、CVE-2023-28303 截图工具漏洞</span>
<a href=#6cve-2023-28303-%e6%88%aa%e5%9b%be%e5%b7%a5%e5%85%b7%e6%bc%8f%e6%b4%9e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>一张图片如果有两个<code>IEND</code>块：<code>AE 42 60 82</code></p><p>就很有可能考察的是这个漏洞</p><p>可以使用<a href=https://github.com/frankthetank-music/Acropalypse-Multi-Tool target=_blank rel="external nofollow noopener noreferrer">Github上大佬写好的工具</a>一把梭，恢复完整图片前需要知道原图的分辨率</p><h4 class=heading-element id=7stegpy隐写><span>7、stegpy隐写</span>
<a href=#7stegpy%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><a href=https://github.com/izcoser/stegpy target=_blank rel="external nofollow noopener noreferrer">stegpy 开源地址</a> 下载好后直接用WSL输入以下命令并输入密码解密即可</p><p>也可以直接用 pip 安装： pip3 install stegpy</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>stegpy 1.png -p</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=8npiet编程语言><span>8、npiet编程语言</span>
<a href=#8npiet%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>白底</strong>+很多彩色的小像素点组成的图片，形如下图</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241121215108269.png alt=/posts/1ad9200/imgs/image-20241121215108269.png height=8 width=71></p><p>方法一：直接使用在线网站：https://www.bertnase.de/npiet/npiet-execute.php 运行即可</p><p>方法二：下载源代码<code>npiet-1.3a-win32</code>到本地，然后使用以下命令运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.<span class=se>\n</span>piet.exe -tpic solved.png</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=9image-steganography隐写><span>9、Image Steganography隐写</span>
<a href=#9image-steganography%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接使用<code>Image Steganography</code>工具解密即可，如果需要密码，就勾选上<code>Decrypt</code>选项</p><blockquote><p>当然也可以直接用PuzzleSolver解密</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241229152552878.png alt=/posts/1ad9200/imgs/image-20241229152552878.png height=1077 width=834></p><h4 class=heading-element id=10关键信息藏在图片被篡改的宽高中><span>10、关键信息藏在图片被篡改的宽高中</span>
<a href=#10%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af%e8%97%8f%e5%9c%a8%e5%9b%be%e7%89%87%e8%a2%ab%e7%af%a1%e6%94%b9%e7%9a%84%e5%ae%bd%e9%ab%98%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=11关键信息藏在图片每个被篡改的idat块长度中><span>11、关键信息藏在图片每个被篡改的IDAT块长度中</span>
<a href=#11%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af%e8%97%8f%e5%9c%a8%e5%9b%be%e7%89%87%e6%af%8f%e4%b8%aa%e8%a2%ab%e7%af%a1%e6%94%b9%e7%9a%84idat%e5%9d%97%e9%95%bf%e5%ba%a6%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h3 class=heading-element id=jpg思路><span>JPG思路</span>
<a href=#jpg%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1lsb隐写><span>1、LSB隐写</span>
<a href=#1lsb%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>用<code>StegSolve</code>打开查看即可</p><h4 class=heading-element id=2可以试试用stegdectet看看是什么加密><span>2、可以试试用stegdectet看看是什么加密：</span>
<a href=#2%e5%8f%af%e4%bb%a5%e8%af%95%e8%af%95%e7%94%a8stegdectet%e7%9c%8b%e7%9c%8b%e6%98%af%e4%bb%80%e4%b9%88%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>.\stegdetect.exe -t jopi -s 10.0 .\0.jpg</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/stegdectet-171427285283031.gif alt=stegdectet height=84 width=907></p><p>出现三颗星不一定就代表一定是这种加密方式</p><h4 class=heading-element id=2jphs隐写可以无密码><span>2、JPHS隐写(可以无密码)</span>
<a href=#2jphs%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>导出步骤 Select File &ndash;> seek &ndash;> demo.txt &ndash;> Save the file</p><h4 class=heading-element id=3steghide隐写可以无密码><span>3、steghide隐写(可以无密码)</span>
<a href=#3steghide%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#如果密码已经知道了</span>
</span></span><span class=line><span class=cl>steghide extract -sf filename -p passwd</span></span></code></pre></td></tr></table></div></div><p>在WSL或者kali里用Stegseek跑（字典在wordlist里）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#如果密码未知</span>
</span></span><span class=line><span class=cl>可以用下面这个脚本爆破
</span></span><span class=line><span class=cl><span class=c1>#bruteStegHide.sh</span>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> line in <span class=sb>`</span>cat <span class=nv>$2</span><span class=sb>`</span><span class=p>;</span><span class=k>do</span>
</span></span><span class=line><span class=cl>    steghide extract -sf <span class=nv>$1</span> -p <span class=nv>$line</span> &gt; /dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s1>&#39;password is: &#39;</span><span class=nv>$line</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#或者在WSL或者kali里用Stegseek跑（字典在wordlist里）</span>
</span></span><span class=line><span class=cl>stegseek filename rockyou.txt</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=4silenteye隐写><span>4、Silenteye隐写</span>
<a href=#4silenteye%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接用<code>silenteye</code>打开输入密钥decode即可，默认密钥是<code>silenteye</code>，也可以填入自己的密钥</p><h4 class=heading-element id=5outguess隐写><span>5、outguess隐写</span>
<a href=#5outguess%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>outguess -k <span class=s2>&#34;abc&#34;</span> -r mmm.jpg flag.txt
</span></span><span class=line><span class=cl><span class=c1>#-k 后面跟的是解密的密钥</span>
</span></span><span class=line><span class=cl><span class=c1>#flag.txt是解密后数据保存的位置</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=6f5-steganography-master><span>6、F5-steganography-master</span>
<a href=#6f5-steganography-master class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>把要解密的图片拉到F5文件夹中</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#有密码的情况</span>
</span></span><span class=line><span class=cl>java Extract beautiful.jpg -p passwd
</span></span><span class=line><span class=cl><span class=c1>#无密码的情况</span>
</span></span><span class=line><span class=cl>java Extract beautiful.jpg
</span></span><span class=line><span class=cl><span class=c1>#解密出来的数据会放到F5文件夹下的output.txt中</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=7jpg宽高隐写><span>7、JPG宽高隐写</span>
<a href=#7jpg%e5%ae%bd%e9%ab%98%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>010打开JPG图片，找到 struct SOF 块数据，手动调整宽高即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240911103611924.png alt=/posts/1ad9200/imgs/image-20240911103611924.png height=825 width=1246></p><h4 class=heading-element id=8jsteg><span>8、jsteg</span>
<a href=#8jsteg class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>JPG图片的<code>jsteg隐写</code>可以直接用下面这个工具一把梭</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250524115606248.png alt=/posts/1ad9200/imgs/image-20250524115606248.png height=670 width=992></p><h4 class=heading-element id=9关键信息混在-jpg-的十六进制数据中><span>9、关键信息混在 jpg 的十六进制数据中</span>
<a href=#9%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af%e6%b7%b7%e5%9c%a8-jpg-%e7%9a%84%e5%8d%81%e5%85%ad%e8%bf%9b%e5%88%b6%e6%95%b0%e6%8d%ae%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>如果实在没有思路，可以尝试在010中打开并搜索<code>flag</code>等关键字词</p><p>假如关键数据放到 jpg 文件尾前面，010可能不会报错，这时候就需要我们肉眼丁真手动提取</p><h3 class=heading-element id=bmp思路><span>BMP思路</span>
<a href=#bmp%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>BMP图片通道排列顺序是BGR</p></blockquote><h4 class=heading-element id=1bmp宽高爆破><span>1、bmp宽高爆破：</span>
<a href=#1bmp%e5%ae%bd%e9%ab%98%e7%88%86%e7%a0%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>删除文件头，并保存为文件名.data，然后用GIMP打开修改宽高（这个比较方便）</p><p>或者直接用bmp爆破脚本跑 python script.py -f filename.bmp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#用这个脚本要注意对图片一个个使用</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;-f&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>help</span><span class=o>=</span><span class=s2>&#34;输入同级目录下图片的名称&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>SAVE_DIR</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save_img</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sqrt_num</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>SAVE_DIR</span><span class=p>,</span> <span class=s2>&#34;fix_width.bmp&#34;</span><span class=p>),</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>[:</span><span class=mh>0x12</span><span class=p>]</span> <span class=o>+</span> <span class=n>width</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=o>+</span> <span class=n>data</span><span class=p>[</span><span class=mh>0x16</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>SAVE_DIR</span><span class=p>,</span> <span class=s2>&#34;fix_height.bmp&#34;</span><span class=p>),</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>[:</span><span class=mh>0x16</span><span class=p>]</span> <span class=o>+</span> <span class=n>height</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=o>+</span> <span class=n>data</span><span class=p>[</span><span class=mh>0x1a</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>SAVE_DIR</span><span class=p>,</span> <span class=s2>&#34;fix_sqrt.bmp&#34;</span><span class=p>),</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>[:</span><span class=mh>0x12</span><span class=p>]</span> <span class=o>+</span> <span class=n>sqrt_num</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>data</span><span class=p>[</span><span class=mh>0x1a</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_pixels_size</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>bfSize</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mh>0x2</span><span class=p>:</span><span class=mh>0x2</span><span class=o>+</span><span class=mi>4</span><span class=p>],</span> <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bfOffBits</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=mh>0xa</span><span class=p>:</span><span class=mh>0xa</span><span class=o>+</span><span class=mi>4</span><span class=p>],</span> <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>biBitCount</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=mh>0x1c</span><span class=p>:</span><span class=mh>0x1c</span><span class=o>+</span><span class=mi>2</span><span class=p>],</span> <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span> <span class=o>=</span> <span class=n>biBitCount</span> <span class=o>//</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=c1># 由于宽高都会被修改，所以我计算出来的Padding_size也不是正确的，没有意义</span>
</span></span><span class=line><span class=cl>    <span class=c1># padding_size = (4 - col * channel % 4) * row if col * channel % 4 != 0 else 0</span>
</span></span><span class=line><span class=cl>    <span class=c1># pixels_size = (bfSize - bfOffBits - padding_size) // channel</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>bfSize</span> <span class=o>-</span> <span class=n>bfOffBits</span><span class=p>)</span> <span class=o>//</span> <span class=n>channel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>f</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=s2>&#34;.bmp&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;您的文件后缀名不为BMP!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>col</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mh>0x12</span><span class=p>:</span><span class=mh>0x12</span><span class=o>+</span><span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>row</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mh>0x16</span><span class=p>:</span><span class=mh>0x16</span><span class=o>+</span><span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=n>byteorder</span><span class=o>=</span><span class=s2>&#34;little&#34;</span><span class=p>,</span> <span class=n>signed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>pixels_size</span> <span class=o>=</span> <span class=n>get_pixels_size</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>pixels_size</span> <span class=o>//</span> <span class=n>row</span><span class=p>,</span> <span class=n>pixels_size</span> <span class=o>//</span> <span class=n>col</span>
</span></span><span class=line><span class=cl>    <span class=n>sqrt_num</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>((</span><span class=n>pixels_size</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>save_img</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=n>height</span><span class=p>,</span> <span class=n>sqrt_num</span><span class=o>=</span><span class=n>sqrt_num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;温馨提示：由于填充字节的问题，所以可能会偏差几个像素!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;1.修复宽度: </span><span class=si>{</span><span class=n>width</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;2.修复高度: </span><span class=si>{</span><span class=n>height</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;3.修复宽度高度为: </span><span class=si>{</span><span class=n>sqrt_num</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=2wbstego4open隐写可以无密钥><span>2、wbStego4open隐写(可以无密钥)</span>
<a href=#2wbstego4open%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e9%92%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>用<code>wbStego4open</code>输入密钥后decode即可</p><h4 class=heading-element id=3silenteye隐写><span>3、Silenteye隐写</span>
<a href=#3silenteye%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接用<code>silenteye</code>打开输入密钥decode即可，默认密钥是<code>silenteye</code>，可以填入自己的密钥</p><h3 class=heading-element id=gif思路><span>GIF思路</span>
<a href=#gif%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>做GIF图像的相关的隐写题之前，我们首先需要对GIF图像大概的参数又一定的了解</p><p>下图我用Linux下的<code>identify</code>工具提取了一张GIF图像的一些参数</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250309155001150.png alt=/posts/1ad9200/imgs/image-20250309155001150.png height=927 width=1734></p><p>这里简要介绍一下每一行中的参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> flag.gif[195]     GIF      465x294      481x305+8+11          8-bit            sRGB 
</span></span><span class=line><span class=cl>图像名称及对应帧数  图像格式  帧的实际尺寸  画布尺寸及xy的偏移量  图像使用 8 位色深  颜色空间为标准 RGB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      16c                   0.010u                         0:00.080
</span></span><span class=line><span class=cl>使用了 16 种颜色  处理该图像消耗的 CPU 用户时间，单位是秒  处理该图像所用的总时间，单位是秒</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=1gif分帧在线网站或者工具><span>1、GIF分帧(在线网站或者工具)</span>
<a href=#1gif%e5%88%86%e5%b8%a7%e5%9c%a8%e7%ba%bf%e7%bd%91%e7%ab%99%e6%88%96%e8%80%85%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>[推荐] Linux下使用<code>convert</code>提取</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>convert flag.gif flag.png</span></span></code></pre></td></tr></table></div></div><p>使用<code>ffmpeg</code>提取（如果帧间隔不同，提取出来会有问题）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在Windows或者WSL中执行以下命令进行分离</span>
</span></span><span class=line><span class=cl>ffmpeg -i filename.gif frame%04d.png</span></span></code></pre></td></tr></table></div></div><p>使用<code>PuzzleSolver</code>提取，是按照帧来进行提取</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241111093328214.png alt=/posts/1ad9200/imgs/image-20241111093328214.png height=284 width=1127></p><h4 class=heading-element id=2帧间隔隐写><span>2、帧间隔隐写</span>
<a href=#2%e5%b8%a7%e9%97%b4%e9%9a%94%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>[推荐] 方法一：直接使用<code>PuzzleSolver</code>提取帧间隔</strong></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241111093420194.png alt=/posts/1ad9200/imgs/image-20241111093420194.png height=1113 width=1504></p><p>方法二：使用<code>identify</code>提取</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>identify -format <span class=s2>&#34;%s %T \n&#34;</span> flag.gif  <span class=c1>#格式：帧序号 时间间隔（单位是1/100秒）</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250309155841569.png alt=/posts/1ad9200/imgs/image-20250309155841569.png height=927 width=1734></p><p>例题1-2024羊城杯初赛-checkin</p><p>例题2-2024浙江省赛决赛-非黑即白</p><h4 class=heading-element id=gif图像每帧的xy偏移量隐写><span>GIF图像每帧的XY偏移量隐写</span>
<a href=#gif%e5%9b%be%e5%83%8f%e6%af%8f%e5%b8%a7%e7%9a%84xy%e5%81%8f%e7%a7%bb%e9%87%8f%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>使用<code>identify</code>提取出偏移量然后再分析</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>identify flag.gif</span></span></code></pre></td></tr></table></div></div><p>例题1-Boxing Boxer</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>time_space</span> <span class=o>=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_pos</span><span class=p>(</span><span class=n>gif_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>offset_x</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>offset_y</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>pic_width</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>pic_height</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;identify </span><span class=si>{</span><span class=n>gif_file</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span><span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span><span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span><span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span><span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>stdout</span>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>output</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_lst</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>frame_size</span><span class=p>,</span><span class=n>tmp_x</span><span class=p>,</span><span class=n>tmp_y</span> <span class=o>=</span> <span class=n>tmp_lst</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;+&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>offset_x</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>tmp_x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>offset_y</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>tmp_y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_x</span><span class=p>,</span><span class=n>tmp_y</span> <span class=o>=</span> <span class=n>tmp_lst</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;x&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pic_width</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>tmp_x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>pic_height</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>tmp_y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>offset_x</span><span class=p>,</span><span class=n>offset_y</span><span class=p>,</span><span class=n>pic_width</span><span class=p>,</span><span class=n>pic_height</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw2pic</span><span class=p>(</span><span class=n>offset_x</span><span class=p>,</span><span class=n>offset_y</span><span class=p>,</span><span class=n>pic_width</span><span class=p>,</span><span class=n>pic_height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGB&#34;</span><span class=p>,(</span><span class=mi>500</span><span class=p>,</span><span class=mi>500</span><span class=p>),(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span> <span class=c1># 新建一张尺寸为500x500的RGB图像</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span><span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>time_space</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;70&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;50&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>offset_x</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span><span class=n>offset_y</span><span class=p>[</span><span class=n>idx</span><span class=p>]),(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>offset_x</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=o>+</span><span class=n>pic_width</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span><span class=n>offset_y</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=o>+</span><span class=n>pic_height</span><span class=p>[</span><span class=n>idx</span><span class=p>]),(</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;60&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>offset_x</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span><span class=n>offset_y</span><span class=p>[</span><span class=n>idx</span><span class=p>]),(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>offset_x</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=o>+</span><span class=n>pic_width</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span><span class=n>offset_y</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=o>+</span><span class=n>pic_height</span><span class=p>[</span><span class=n>idx</span><span class=p>]),(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y%m</span><span class=si>%d</span><span class=s2>%H%M%S&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>gif_file</span> <span class=o>=</span> <span class=s2>&#34;flag.gif&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>offset_x</span><span class=p>,</span><span class=n>offset_y</span><span class=p>,</span><span class=n>pic_width</span><span class=p>,</span><span class=n>pic_height</span> <span class=o>=</span> <span class=n>get_pos</span><span class=p>(</span><span class=n>gif_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>draw2pic</span><span class=p>(</span><span class=n>offset_x</span><span class=p>,</span><span class=n>offset_y</span><span class=p>,</span><span class=n>pic_width</span><span class=p>,</span><span class=n>pic_height</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=gif图像每帧的实际尺寸隐写><span>GIF图像每帧的实际尺寸隐写</span>
<a href=#gif%e5%9b%be%e5%83%8f%e6%af%8f%e5%b8%a7%e7%9a%84%e5%ae%9e%e9%99%85%e5%b0%ba%e5%af%b8%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>例题1-Boxing Boxer</p><h3 class=heading-element id=webp思路><span>Webp思路</span>
<a href=#webp%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>webp文件用电脑自带的图片看可能会有点问题，建议用浏览器打开这种文件</p><p>webp可能是动图，可以用下面这个脚本分离webp中的每帧图片</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;killer.webp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>n_frame</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>n_frames</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_frame</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;img/</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>.png&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=bpg图像文件><span>BPG图像文件</span>
<a href=#bpg%e5%9b%be%e5%83%8f%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>使用<code>bpg-0.9.8-win64</code>转换为PNG图片即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.<span class=se>\b</span>pgdec.exe .<span class=se>\f</span>lag.bpg</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=rawarw文件思路><span>RAW、ARW文件思路</span>
<a href=#rawarw%e6%96%87%e4%bb%b6%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1raw的lsb隐写><span>1、RAW的LSB隐写</span>
<a href=#1raw%e7%9a%84lsb%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>ARW文件是 Sony 相机的原始数据格式</p><p>可以使用 rawpy 模块读取图片的像素数据，查看是否存在LSB隐写(例题1-2024-L3HCTF-RAWatermark)</p><p>示例脚本如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>rawpy</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>rawpy</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;image.ARW&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>raw</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 从 raw 对象中获取可见的 Bayer 格式图像数据</span>
</span></span><span class=line><span class=cl>    <span class=n>bayer_visible</span> <span class=o>=</span> <span class=n>raw</span><span class=o>.</span><span class=n>raw_image_visible</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(bayer_visible)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 用 bitwise_and() 函数将 bayer_visible 中的每个像素值与 1 进行按位与操作，以提取每个像素的最低有效位（LSB）</span>
</span></span><span class=line><span class=cl>    <span class=n>lsb_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>bitwise_and</span><span class=p>(</span><span class=n>bayer_visible</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(lsb_array)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 使用 NumPy 数组的 flatten() 方法将 lsb_array 数组展平成一维数组</span>
</span></span><span class=line><span class=cl>    <span class=n>lsb_array_flat</span> <span class=o>=</span> <span class=n>lsb_array</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(lsb_array_flat)</span>
</span></span><span class=line><span class=cl>    <span class=n>hidden_message</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>lsb_array_flat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># 将隐写的数据转为十六进制，便于查看文件头</span>
</span></span><span class=line><span class=cl>    <span class=n>hex_data</span> <span class=o>=</span> <span class=nb>hex</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>hidden_message</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(hex_data[:10]) # 0x504b0304</span>
</span></span><span class=line><span class=cl>    <span class=c1># 将二进制数据转换为byte类型数据</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=n>hidden_message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=2直接改后缀为data然后拖入gimp调整即可><span>2、直接改后缀为.data，然后拖入Gimp调整即可</span>
<a href=#2%e7%9b%b4%e6%8e%a5%e6%94%b9%e5%90%8e%e7%bc%80%e4%b8%badata%e7%84%b6%e5%90%8e%e6%8b%96%e5%85%a5gimp%e8%b0%83%e6%95%b4%e5%8d%b3%e5%8f%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h3 class=heading-element id=二维码思路><span>二维码思路</span>
<a href=#%e4%ba%8c%e7%bb%b4%e7%a0%81%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1bmp转二维码><span>1、bmp转二维码</span>
<a href=#1bmp%e8%bd%ac%e4%ba%8c%e7%bb%b4%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=216进制转pyc><span>2、16进制转pyc</span>
<a href=#216%e8%bf%9b%e5%88%b6%e8%bd%acpyc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=3字符串制作二维码><span>3、字符串制作二维码</span>
<a href=#3%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%88%b6%e4%bd%9c%e4%ba%8c%e7%bb%b4%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>直接右键使用B神的脚本制作二维码，制作前注意要把字符串的长度手动修正为平方数
</span></span><span class=line><span class=cl>1.0 1制作二维码
</span></span><span class=line><span class=cl>2.00 11制作二维码</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=4四个ttl值转换一个字节的二进制数><span>4、四个TTL值转换一个字节的二进制数</span>
<a href=#4%e5%9b%9b%e4%b8%aattl%e5%80%bc%e8%bd%ac%e6%8d%a2%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%9a%84%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%95%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=5aztec-codedatamatrixgridmatrix汉信码pdf417code等><span>5、Aztec code、DataMatrix、GridMatrix、汉信码、PDF417code等</span>
<a href=#5aztec-codedatamatrixgridmatrix%e6%b1%89%e4%bf%a1%e7%a0%81pdf417code%e7%ad%89 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>我们平常见的最多的二维码就是QRcode，但是实际上还有很多不同类型的二维码，这里就简单举几个例子：</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421205934212.png alt=AztecCode height=1290 width=2137></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421210022191.png alt=DataMatrix height=1290 width=2137></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421210051456.png alt=GridMatrix height=1290 width=2137></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250912223855981.png alt=MaxiCode height=1034 width=1710></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250912224010642.png alt=DotCode height=882 width=1456></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421210117218.png alt=汉信码 height=1290 width=2137></p><blockquote><p>汉信码这里要注意，左下角的那块定位块的方向和另外几块是不一样的</p><p>有时候题目会把这块定位块反过来</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421210137589.png alt=PDF417code height=1290 width=2137></p><p>这里要注意的是，出题人可能会把图片反相导致无法直接扫描</p><p>因此我们可以先将二维码拉入<code>StegSolve</code>或者<code>PS</code>进行反相处理，再扫描</p><h4 class=heading-element id=qrcode-二维码标准的一些考点><span>QRcode 二维码标准的一些考点</span>
<a href=#qrcode-%e4%ba%8c%e7%bb%b4%e7%a0%81%e6%a0%87%e5%87%86%e7%9a%84%e4%b8%80%e4%ba%9b%e8%80%83%e7%82%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>关于 QRcode标准可以出的考点实在是太多了，有时间的话还是建议直接去读官方标准，我 Github 上存了一份</p><p><a href=https://github.com/goodlunatic/ISO-IEC-18004-Standard target=_blank rel="external nofollow noopener noreferrer">https://github.com/goodlunatic/ISO-IEC-18004-Standard</a></p><blockquote><p>参考链接：</p><p><a href=https://note.tonycrane.cc/ctf/misc/qrcode/ target=_blank rel="external nofollow noopener noreferrer">https://note.tonycrane.cc/ctf/misc/qrcode/</a></p><p><a href=https://www.cnblogs.com/luogi/p/15469106.html target=_blank rel="external nofollow noopener noreferrer">https://www.cnblogs.com/luogi/p/15469106.html</a></p><p><a href=https://cabelis.ink/2023/01/16/crash-qrcode-by-hand/ target=_blank rel="external nofollow noopener noreferrer">https://cabelis.ink/2023/01/16/crash-qrcode-by-hand/</a></p></blockquote><p>例题1-2022NCTF qrssssssss</p><p>例题2-2023羊城杯决赛-LmqHmAsk</p><p>例题3-GEEKCTF2024 QRcode2</p><p>例题4-SHCTF2024 week2 练假成真</p><h3 class=heading-element id=信号和图像处理中的一些变换方法><span>信号和图像处理中的一些变换方法</span>
<a href=#%e4%bf%a1%e5%8f%b7%e5%92%8c%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e4%b8%ad%e7%9a%84%e4%b8%80%e4%ba%9b%e5%8f%98%e6%8d%a2%e6%96%b9%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=快速傅里叶变换fft><span>快速傅里叶变换（FFT）</span>
<a href=#%e5%bf%ab%e9%80%9f%e5%82%85%e9%87%8c%e5%8f%b6%e5%8f%98%e6%8d%a2fft class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=离散傅里叶变换dft><span>离散傅里叶变换（DFT）</span>
<a href=#%e7%a6%bb%e6%95%a3%e5%82%85%e9%87%8c%e5%8f%b6%e5%8f%98%e6%8d%a2dft class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=离散余弦变换dct><span>离散余弦变换（DCT）</span>
<a href=#%e7%a6%bb%e6%95%a3%e4%bd%99%e5%bc%a6%e5%8f%98%e6%8d%a2dct class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=离散小波变换dwt><span>离散小波变换（DWT）</span>
<a href=#%e7%a6%bb%e6%95%a3%e5%b0%8f%e6%b3%a2%e5%8f%98%e6%8d%a2dwt class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h2 class=heading-element id=miscpdf题思路><span>Misc——PDF题思路</span>
<a href=#miscpdf%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=1binwalkforemost或者010手动提取出隐藏文件><span>1、binwalk/foremost或者010手动提取出隐藏文件</span>
<a href=#1binwalkforemost%e6%88%96%e8%80%85010%e6%89%8b%e5%8a%a8%e6%8f%90%e5%8f%96%e5%87%ba%e9%9a%90%e8%97%8f%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=2wbstego4open隐写><span>2、wbStego4open隐写</span>
<a href=#2wbstego4open%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接用<code>wbStego4open</code>打开然后输入密钥decode</p><h3 class=heading-element id=3pdf中携带了附件><span>3、PDF中携带了附件</span>
<a href=#3pdf%e4%b8%ad%e6%90%ba%e5%b8%a6%e4%ba%86%e9%99%84%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以在<code>firefox</code>或者别的PDF软件中打开并提取</p><h3 class=heading-element id=4pdf中写了透明或者白色的文字><span>4、PDF中写了透明或者白色的文字</span>
<a href=#4pdf%e4%b8%ad%e5%86%99%e4%ba%86%e9%80%8f%e6%98%8e%e6%88%96%e8%80%85%e7%99%bd%e8%89%b2%e7%9a%84%e6%96%87%e5%ad%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接打开全选复制，然后粘贴到记事本中查看即可</p><h3 class=heading-element id=5使用deegger-embedder工具extract-files><span>5、使用DeEgger Embedder工具extract files</span>
<a href=#5%e4%bd%bf%e7%94%a8deegger-embedder%e5%b7%a5%e5%85%b7extract-files class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=6pdf存在多个图层的情况><span>6、PDF存在多个图层的情况</span>
<a href=#6pdf%e5%ad%98%e5%9c%a8%e5%a4%9a%e4%b8%aa%e5%9b%be%e5%b1%82%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接用PS打开，然后查看隐藏的图层</p><p>例题1-2024古剑山-jpg</p><h3 class=heading-element id=7弱密码加密的pdf><span>7、弱密码加密的PDF</span>
<a href=#7%e5%bc%b1%e5%af%86%e7%a0%81%e5%8a%a0%e5%af%86%e7%9a%84pdf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以直接用 Forensic PasswareKit 爆破</p><p>也可以在Linux下安装 pdfcrack 爆破(sudo apt install pdfcrack)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pdfcrack -f enc.pdf -w rockyou.txt</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=miscms-office题思路><span>Misc——MS-Office题思路</span>
<a href=#miscms-office%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>有时候会遇到不知道是MS-Office中具体什么类型的情况，如下图</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250315203340810.png alt=/posts/1ad9200/imgs/image-20250315203340810.png height=911 width=1446></p><p>并且这个文件还是加密的，我们可以尝试把后缀改成<code>docx</code>或者<code>pptx</code>，然后用<code>PasswareKit</code>先爆破出密码</p><p>再用<code>msoffcrypto-tool</code>输入密码解密一下：https://github.com/nolze/msoffcrypto-tool</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install msoffcrypto-tool
</span></span><span class=line><span class=cl>msoffcrypto-tool encrypted.docx decrypted.docx -p Passw0rd</span></span></code></pre></td></tr></table></div></div><p>解密完成后010打开就能判断出准确的文件类型了</p><h3 class=heading-element id=新版-ms-office-2007><span>新版 MS-Office 2007</span>
<a href=#%e6%96%b0%e7%89%88-ms-office-2007 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=docx文件><span>docx文件</span>
<a href=#docx%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=0可能有透明或者白色的文字全选复制出来或者直接清除样式><span>0、可能有透明或者白色的文字，全选复制出来，或者直接清除样式</span>
<a href=#0%e5%8f%af%e8%83%bd%e6%9c%89%e9%80%8f%e6%98%8e%e6%88%96%e8%80%85%e7%99%bd%e8%89%b2%e7%9a%84%e6%96%87%e5%ad%97%e5%85%a8%e9%80%89%e5%a4%8d%e5%88%b6%e5%87%ba%e6%9d%a5%e6%88%96%e8%80%85%e7%9b%b4%e6%8e%a5%e6%b8%85%e9%99%a4%e6%a0%b7%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h5 class=heading-element id=1wps或者word打开显示隐藏文字的功能可能会有隐藏文字><span>1、WPS或者Word打开显示隐藏文字的功能，可能会有隐藏文字</span>
<a href=#1wps%e6%88%96%e8%80%85word%e6%89%93%e5%bc%80%e6%98%be%e7%a4%ba%e9%9a%90%e8%97%8f%e6%96%87%e5%ad%97%e7%9a%84%e5%8a%9f%e8%83%bd%e5%8f%af%e8%83%bd%e4%bc%9a%e6%9c%89%e9%9a%90%e8%97%8f%e6%96%87%e5%ad%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251122124407348.png alt=/posts/1ad9200/imgs/image-20251122124407348.png height=982 width=1261></p><h5 class=heading-element id=2直接改后缀为zip解压然后查看有无关键信息><span>2、直接改后缀为.zip解压，然后查看有无关键信息</span>
<a href=#2%e7%9b%b4%e6%8e%a5%e6%94%b9%e5%90%8e%e7%bc%80%e4%b8%bazip%e8%a7%a3%e5%8e%8b%e7%84%b6%e5%90%8e%e6%9f%a5%e7%9c%8b%e6%9c%89%e6%97%a0%e5%85%b3%e9%94%ae%e4%bf%a1%e6%81%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h5 class=heading-element id=3与宏有关系的各种攻击与隐写><span>3、与宏有关系的各种攻击与隐写</span>
<a href=#3%e4%b8%8e%e5%ae%8f%e6%9c%89%e5%85%b3%e7%b3%bb%e7%9a%84%e5%90%84%e7%a7%8d%e6%94%bb%e5%87%bb%e4%b8%8e%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>分析word中的宏需要用到这样一个工具：oletools
</span></span><span class=line><span class=cl>这个工具直接在pip中安装即可使用: pip3 install oletools
</span></span><span class=line><span class=cl>doc格式可以不需要文档密码直接提取其中的vba宏代码
</span></span><span class=line><span class=cl>安装好oletools后直接运行以下代码提取即可，可能加密文档的加密算法就在期中
</span></span><span class=line><span class=cl>olevba .<span class=se>\a</span>ttachment.doc &gt; test.txt</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=4利用行距来隐写例iscc2023-汤姆历险记><span>4、利用行距来隐写（例：ISCC2023-汤姆历险记）</span>
<a href=#4%e5%88%a9%e7%94%a8%e8%a1%8c%e8%b7%9d%e6%9d%a5%e9%9a%90%e5%86%99%e4%be%8biscc2023-%e6%b1%a4%e5%a7%86%e5%8e%86%e9%99%a9%e8%ae%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>word中可能有一段是1倍行距，可能又有一段是1.5倍行距，需要根据不同行距敲出摩斯电码（单倍转为.多倍转为-空行转为空格或者分隔符）</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=5docx中有emf和oleobject><span>5、docx中有emf和oleobject</span>
<a href=#5docx%e4%b8%ad%e6%9c%89emf%e5%92%8coleobject class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>可以打开后双击那个emf图标，激活相关内容(如音频文件)然后再进一步提取并分析</p><p>当然也可以直接从oleobject中提取文件并分析</p><h5 class=heading-element id=6把关键内容隐写在自定义字体中><span>6、把关键内容隐写在自定义字体中</span>
<a href=#6%e6%8a%8a%e5%85%b3%e9%94%ae%e5%86%85%e5%ae%b9%e9%9a%90%e5%86%99%e5%9c%a8%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ad%97%e4%bd%93%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h6 class=heading-element id=直接给了otf文件的情况><span>直接给了otf文件的情况：</span>
<a href=#%e7%9b%b4%e6%8e%a5%e7%bb%99%e4%ba%86otf%e6%96%87%e4%bb%b6%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>首先安装给的otf字体文件，注意要记下字体名称</p><p>如果不确定字体名称的话，可以尝试再次安装，会有弹窗告诉你具体的字体名</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251122130354235.png alt=/posts/1ad9200/imgs/image-20251122130354235.png height=963 width=1466></p><p>然后根据题目提示找到关键的字符</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251122130550194.png alt=/posts/1ad9200/imgs/image-20251122130550194.png height=1464 width=1985></p><blockquote><p>如果想要卸载某个字体文件，可以 Win+I 打开设置搜索字体选项，然后卸载对应的字体即可</p></blockquote><h6 class=heading-element id=给了odttf文件的情况><span>给了odttf文件的情况</span>
<a href=#%e7%bb%99%e4%ba%86odttf%e6%96%87%e4%bb%b6%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>首先把docx文件改后缀为.zip并解压，然后找到 <code>/word/fontTable.xml</code></p><p>获取里面的字体的 fontkey，并把odttf文件重命名为 <code>{fontkey}.ttf</code></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251122133148248.png alt=/posts/1ad9200/imgs/image-20251122133148248.png height=968 width=1913></p><p>然后用这个项目把odttf文件转为ttf文件：https://github.com/somanchiu/odttf2ttf</p><p>最后用这个在线网站预览ttf文件即可得到flag：https://fontdrop.info/#/?darkmode=true</p><p>当然也可以使用 fontforge 这个项目查看：https://github.com/fontforge/fontforge</p><p>例题1-2022HNCTF calligraphy</p><h4 class=heading-element id=pptx><span>pptx</span>
<a href=#pptx class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>1、可能有透明或者白色的文字，全选复制出来，或者直接清除样式</p><p>2、直接改后缀为.zip解压，然后查看有无关键信息</p><p>3、关键信息可能藏在的PPTX评论或者批注中</p><p>例题1-2024CISCN初赛 神秘文件</p><h4 class=heading-element id=xlsx文件><span>xlsx文件</span>
<a href=#xlsx%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>1、可能有透明或者白色的文字，全选复制出来，或者直接清除样式</p><p>2、直接改后缀为.zip解压，然后查看有无关键信息</p><p>3、可能会有隐藏的行和列，直接取消隐藏先前隐藏的行和列</p><p>4、条件格式里设置突出显示某些单元格(黑白后可能会有图案)</p><p>这个直接根据条件格式查找，然后找到后设置为黑色底色，可能就会有个二维码</p><p>5、要先将数据按照行列排序后再进行处理</p><h3 class=heading-element id=旧版-ms-office-97-2003><span>旧版 MS-Office 97-2003</span>
<a href=#%e6%97%a7%e7%89%88-ms-office-97-2003 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=oleheader修复><span>OLEHeader修复</span>
<a href=#oleheader%e4%bf%ae%e5%a4%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><table><thead><tr><th>字段名称</th><th>偏移量</th><th>字段描述</th></tr></thead><tbody><tr><td>文件签名</td><td>0x0-0-x7</td><td>固定值：D0CF11E0A1B11AE100</td></tr><tr><td>对象标识符</td><td>0x8-0x17</td><td>通常全为0</td></tr><tr><td>次要版本号</td><td>0x18-0x19</td><td>通常为固定值：3E00</td></tr><tr><td>DLL版本号</td><td>0x1A-0x1B</td><td>通常为固定值：0300</td></tr><tr><td>字节序</td><td>0x1C-0x1D</td><td>通常为小段序：FEFF</td></tr><tr><td>每个扇区的大小</td><td>0x1E-0x1F</td><td>通常为固定值0900（即2的9次方=512字节）</td></tr><tr><td>迷你扇区大小</td><td>0x20-0x21</td><td>通常为固定值0600（即2的6次方=64字节）</td></tr><tr><td>保留字段</td><td>0x22-0x23</td><td>通常为0000</td></tr><tr><td>保留字段</td><td>0x24-0x27</td><td>通常为00000000</td></tr><tr><td>目录扇区的数量</td><td>0x28-0x2B</td><td>通常为00000000</td></tr><tr><td>FAT表扇区的数量</td><td>0x2C-0x2F</td><td>存储文件分配表（FAT）占用的扇区数量（01000000）</td></tr><tr><td>根目录扇区索引</td><td>0x30-0x33</td><td>根目录所在扇区的索引号，找RootEntry所载的扇区，计算时需要把第一个扇区排除0x6800/0x200-1=0x33</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>6800  52 00 6F 00 6F 00 74 00 20 00 45 00 6E 00 74 00  R.o.o.t. .E.n.t. 
</span></span><span class=line><span class=cl>6810  72 00 79 00 00 00 00 00 00 00 00 00 00 00 00 00  r.y............. 
</span></span><span class=line><span class=cl>6820  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ 
</span></span><span class=line><span class=cl>6830  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ 
</span></span><span class=line><span class=cl>6840  16 00 05 01 FF FF FF FF FF FF FF FF 03 00 00 00  ....ÿÿÿÿÿÿÿÿ.... 
</span></span><span class=line><span class=cl>6850  06 09 02 00 00 00 00 00 C0 00 00 00 00 00 00 46  ........À......F</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>事务签名</th><th>0x34-0x37</th><th>通常为固定值：00000000</th></tr></thead><tbody><tr><td>迷你流最大大小</td><td>0x38-0x3B</td><td>通常为固定值：00010000</td></tr><tr><td>第一个迷你 FAT 扇区索引</td><td>0x3C-0x3F</td><td>短扇区分配表的扇区位置,一般紧接着RootEntry,得看RootEntry占用多少扇区,这里是占用两个扇区,因此这里的值应该填0x35</td></tr><tr><td>迷你 FAT 扇区数量</td><td>0x40-0x43</td><td>短扇区分配表占用的扇区数，这里长度为0x200，因此只占用了一个扇区</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>6C00  01 00 00 00 FE FF FF FF FF FF FF FF FF FF FF FF  ....þÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C10  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C20  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C30  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C40  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C50  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6C60  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>6DB0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6DC0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6DD0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6DE0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>6DF0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>第一个 DIFAT 扩展扇区索引</th><th>0x44-0x47</th><th>指向第一个 DIFAT（双 FAT）扇区的起始位置（FAT 索引）</th></tr></thead><tbody><tr><td>DIFAT 扇区数量</td><td>0x48-0x4B</td><td>存储 DIFAT（双 FAT）表占用的扇区数量</td></tr></tbody></table><p>0x44-0x4B：主扇区分配表的扩展部分的索引以及其数量，因为文件比较小没有用到扩展部分，第一个应该是-2即0xFEFFFFFF，然后数量为0</p><table><thead><tr><th>DIFAT 表</th><th>0x4C-0x1FF</th><th>主扇区分配表，因为文件不是很大,基本只有前面几个字节是有意义的,后面都是0xFF，取值和RootEntry的扇区号有关，一般就是root扇区倒着写，因为root为0x33,这里我们填一个0x32000000</th></tr></thead><tbody></tbody></table><p>最后修复完整后的OLEHeader如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0000  D0 CF 11 E0 A1 B1 1A E1 00 00 00 00 00 00 00 00  ÐÏ.à¡±.á........ 
</span></span><span class=line><span class=cl>0010  00 00 00 00 00 00 00 00 3E 00 03 00 FE FF 09 00  ........&gt;...þÿ.. 
</span></span><span class=line><span class=cl>0020  06 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00  ................ 
</span></span><span class=line><span class=cl>0030  33 00 00 00 00 00 00 00 00 10 00 00 35 00 00 00  3...........5... 
</span></span><span class=line><span class=cl>0040  01 00 00 00 FE FF FF FF 00 00 00 00 32 00 00 00  ....þÿÿÿ....2... 
</span></span><span class=line><span class=cl>0050  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>0060  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>0070  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>0080  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>0090  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>01C0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>01D0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>01E0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ 
</span></span><span class=line><span class=cl>01F0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=misctxt题思路><span>Misc——TXT题思路</span>
<a href=#misctxt%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=1-有可能是ntfs直接用ntfsstreamseditor2扫描所在文件夹然后导出可疑文件如果是压缩包一定要用winrar解压><span>1、 有可能是ntfs，直接用NtfsStreamsEditor2扫描所在文件夹，然后导出可疑文件【如果是压缩包，一定要用winrar解压】</span>
<a href=#1-%e6%9c%89%e5%8f%af%e8%83%bd%e6%98%afntfs%e7%9b%b4%e6%8e%a5%e7%94%a8ntfsstreamseditor2%e6%89%ab%e6%8f%8f%e6%89%80%e5%9c%a8%e6%96%87%e4%bb%b6%e5%a4%b9%e7%84%b6%e5%90%8e%e5%af%bc%e5%87%ba%e5%8f%af%e7%96%91%e6%96%87%e4%bb%b6%e5%a6%82%e6%9e%9c%e6%98%af%e5%8e%8b%e7%bc%a9%e5%8c%85%e4%b8%80%e5%ae%9a%e8%a6%81%e7%94%a8winrar%e8%a7%a3%e5%8e%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=2可能是wbstego4open隐写用wbstego4open直接decode可能有密钥><span>2、可能是wbStego4open隐写，用wbStego4open直接decode(可能有密钥)</span>
<a href=#2%e5%8f%af%e8%83%bd%e6%98%afwbstego4open%e9%9a%90%e5%86%99%e7%94%a8wbstego4open%e7%9b%b4%e6%8e%a5decode%e5%8f%af%e8%83%bd%e6%9c%89%e5%af%86%e9%92%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=3如果是那种文件夹套文件夹的题目可以直接把路径粘贴到everything中让everything一把梭><span>3、如果是那种文件夹套文件夹的题目，可以直接把路径粘贴到everything中，让everything一把梭</span>
<a href=#3%e5%a6%82%e6%9e%9c%e6%98%af%e9%82%a3%e7%a7%8d%e6%96%87%e4%bb%b6%e5%a4%b9%e5%a5%97%e6%96%87%e4%bb%b6%e5%a4%b9%e7%9a%84%e9%a2%98%e7%9b%ae%e5%8f%af%e4%bb%a5%e7%9b%b4%e6%8e%a5%e6%8a%8a%e8%b7%af%e5%be%84%e7%b2%98%e8%b4%b4%e5%88%b0everything%e4%b8%ad%e8%ae%a9everything%e4%b8%80%e6%8a%8a%e6%a2%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=4whitespace隐写><span>4、whitespace隐写</span>
<a href=#4whitespace%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>一个文件打开都是空白字符</p><p>可以使用在线网站解密：https://vii5ard.github.io/whitespace/</p><p>全选复制进去，然后直接run即可</p><h3 class=heading-element id=5snow隐写><span>5、SNOW隐写</span>
<a href=#5snow%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>SNOW 隐写工具下载：https://darkside.com.au/snow/</p><p>到<code>snowdos32</code>工具目录下运行<code>SNOW.EXE -C -p password flag.txt</code> 命令即可</p><p>SNOW隐写有时候可以不全是空白字符，然后也可以无密码，如果懒得敲命令行可以直接用下面这个工具</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421200534255.png alt=/posts/1ad9200/imgs/image-20250421200534255.png height=508 width=748></p><blockquote><p>Tips: 这里要特别注意的一点就是 -C 这个参数，选了这个参数后加密和解密的时候会默认压缩或者解压，就有可能会解密乱码</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251031124513229.png alt=/posts/1ad9200/imgs/image-20251031124513229.png height=238 width=1484></p><h3 class=heading-element id=零宽字符隐写-1><span>零宽字符隐写</span>
<a href=#%e9%9b%b6%e5%ae%bd%e5%ad%97%e7%ac%a6%e9%9a%90%e5%86%99-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以用在线网站解密，也可以用<code>PuzzleSolver</code>解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250421200734831.png alt=/posts/1ad9200/imgs/image-20250421200734831.png height=402 width=1504></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># 几个解零宽比较好用的在线网站，也可以下载源码到本地</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>wetools</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>text</span><span class=o>-</span><span class=n>cloaking</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=mi>330</span><span class=n>k</span><span class=o>.</span><span class=n>github</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>misc_tools</span><span class=o>/</span><span class=n>unicode_steganography</span><span class=o>.</span><span class=n>html</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>mzy0</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>ctftools</span><span class=o>/</span><span class=n>zerowidth1</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>yuanfux</span><span class=o>.</span><span class=n>github</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>zero</span><span class=o>-</span><span class=n>width</span><span class=o>-</span><span class=n>web</span><span class=o>/</span></span></span></code></pre></td></tr></table></div></div><p>如果网站默认的字符集解不出来，可以尝试先在vim里查看，看看都有哪些字符</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250828223508020.png alt=/posts/1ad9200/imgs/image-20250828223508020.png height=1176 width=2070></p><p>然后再到解码网址上勾选对应字符</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250828223608794.png alt=/posts/1ad9200/imgs/image-20250828223608794.png height=708 width=1440></p><h3 class=heading-element id=5垃圾邮件隐写spammimic><span>5、垃圾邮件隐写(spammimic)</span>
<a href=#5%e5%9e%83%e5%9c%be%e9%82%ae%e4%bb%b6%e9%9a%90%e5%86%99spammimic class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例题1-2024强网拟态初赛-PvZ</p><p>直接使用以下在线网站解密即可：</p><p><a href=https://www.spammimic.com/ target=_blank rel="external nofollow noopener noreferrer">https://www.spammimic.com/</a></p><h3 class=heading-element id=6cloakify隐写><span>6、Cloakify隐写</span>
<a href=#6cloakify%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>例题1-群友发的题</p><p>附件下载链接：https://pan.baidu.com/s/1EMAMOeot_aKXIs5pckTQfQ?pwd=93np 提取码：93np</p><p>解密需要用到<a href=https://github.com/TryCatchHCF/Cloakify target=_blank rel="external nofollow noopener noreferrer">Cloakify</a>这个项目</p><p>拿到密文和字典后，直接Python运行解密即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 decloakify.py cipher.txt passwd.txt</span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips：如果碰到解密失败的情况，可以试试看在windows下重新复制文本，并在末尾加一个换行符</p></blockquote><h2 class=heading-element id=mischtml题思路><span>Misc——HTML题思路</span>
<a href=#mischtml%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>1、可能是<code>wbStego4open</code>隐写，用<code>wbStego4open</code>直接输入密钥decode</p><h2 class=heading-element id=misc压缩包思路><span>Misc——压缩包思路</span>
<a href=#misc%e5%8e%8b%e7%bc%a9%e5%8c%85%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>Tips：压缩包的密码可以是可打印字符(中英文数字+特殊符号)，也可以是不可打印字符</p><p>没有思路时可以直接纯数字/字母暴力爆破一下</p><h3 class=heading-element id=zip文件结构><span>zip文件结构</span>
<a href=#zip%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>ZIP文件结构：<a href=https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT target=_blank rel="external nofollow noopener noreferrer">https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT</a></p><p>三部分：压缩文件源数据区 + 压缩源文件目录区 + 压缩源文件目录结束标志</p><p><strong>文件源数据区</strong></p><table><thead><tr><th style=text-align:center>字段名称</th><th style=text-align:center>字段描述</th></tr></thead><tbody><tr><td style=text-align:center>frSignature</td><td style=text-align:center>ZIP文件头，固定值504B0304</td></tr><tr><td style=text-align:center>frVersion</td><td style=text-align:center>解压所需的 pkware 版本</td></tr><tr><td style=text-align:center>frFLags</td><td style=text-align:center>全局方式位标记，最低位的1bit是1表示加密，是0表示未加密</td></tr><tr><td style=text-align:center>frCompression</td><td style=text-align:center>压缩方法（具体值如Store、Deflate等）</td></tr><tr><td style=text-align:center>frFileTime</td><td style=text-align:center>被压缩文件的最后修改时间</td></tr><tr><td style=text-align:center>frFileDate</td><td style=text-align:center>被压缩文件的最后修改日期</td></tr><tr><td style=text-align:center>frCrc</td><td style=text-align:center>文件压缩前 CRC-32 的值</td></tr><tr><td style=text-align:center>frCompressedSize</td><td style=text-align:center>被压缩文件压缩后的大小</td></tr><tr><td style=text-align:center>frUncompressedSize</td><td style=text-align:center>被压缩文件压缩前的大小</td></tr><tr><td style=text-align:center>frFileNameLength</td><td style=text-align:center>被压缩文件的文件名长度</td></tr><tr><td style=text-align:center>frExtraFieldLength</td><td style=text-align:center>扩展字段长度（具体值如0等）</td></tr><tr><td style=text-align:center>frFileName</td><td style=text-align:center>被压缩文件的文件名</td></tr><tr><td style=text-align:center>frData</td><td style=text-align:center>被压缩文件压缩后的数据</td></tr></tbody></table><p><strong>文件目录区</strong></p><table><thead><tr><th style=text-align:center>字段名称</th><th style=text-align:center>字段描述</th></tr></thead><tbody><tr><td style=text-align:center>deSignature</td><td style=text-align:center>签名，通常是504B0102</td></tr><tr><td style=text-align:center>deVersionMadeBy</td><td style=text-align:center>制作于哪个 pkware 版本</td></tr><tr><td style=text-align:center>deVersionToExtract</td><td style=text-align:center>解析该目录需要的版本号，与数据区frVersion的值一致</td></tr><tr><td style=text-align:center>deFLags</td><td style=text-align:center>一般标志位，与数据区frFlags的值一致</td></tr><tr><td style=text-align:center>deCompression</td><td style=text-align:center>压缩方法，与数据区frCompression的值一致</td></tr><tr><td style=text-align:center>deFileTime</td><td style=text-align:center>被压缩文件的最后修改时间，与数据区中对应字段的值一致</td></tr><tr><td style=text-align:center>deFileDate</td><td style=text-align:center>被压缩文件的最后修改日期，与数据区中对应字段的值一致</td></tr><tr><td style=text-align:center>deCrc</td><td style=text-align:center>文件压缩前 CRC-32 的值</td></tr><tr><td style=text-align:center>deCompressedSize</td><td style=text-align:center>被压缩文件压缩后的大小</td></tr><tr><td style=text-align:center>deUncompressedSize</td><td style=text-align:center>被压缩文件压缩前的大小</td></tr><tr><td style=text-align:center>deFileNameLength</td><td style=text-align:center>被压缩文件的文件名长度</td></tr><tr><td style=text-align:center>deExtraFieldLength</td><td style=text-align:center>扩展字段长度（与数据区的对应值可能不一致）</td></tr><tr><td style=text-align:center>deFileCommentLength</td><td style=text-align:center>文件备注长度</td></tr><tr><td style=text-align:center>deDiskNumberStart</td><td style=text-align:center>文件起始位置所在的磁盘编号（早期磁盘很小的情况下，压缩包可能跨磁盘）</td></tr><tr><td style=text-align:center>deInternalAttributes</td><td style=text-align:center>内部文件属性</td></tr><tr><td style=text-align:center>deExternalAttributes</td><td style=text-align:center>外部文件属性</td></tr><tr><td style=text-align:center>uint deHeaderOffset</td><td style=text-align:center>本目录指向的entry相对于第一个entry的起始位置，单位byte，这也就限制了ZIP文件最大也就是4G了，再大就无法定位了</td></tr><tr><td style=text-align:center>deFileName</td><td style=text-align:center>被压缩文件的文件名</td></tr><tr><td style=text-align:center>deExtraField</td><td style=text-align:center>扩展字段</td></tr></tbody></table><p><strong>文件目录结束</strong></p><table><thead><tr><th style=text-align:center>字段名称</th><th style=text-align:center>字段描述</th></tr></thead><tbody><tr><td style=text-align:center>elSignature</td><td style=text-align:center>签名，通常是504B0506</td></tr><tr><td style=text-align:center>elDiskNumber</td><td style=text-align:center>当前磁盘编号</td></tr><tr><td style=text-align:center>elStartDiskNumber</td><td style=text-align:center>中央目录起始磁盘编号</td></tr><tr><td style=text-align:center>elEntriesOnDisk</td><td style=text-align:center>当前磁盘上的中央目录记录数</td></tr><tr><td style=text-align:center>elEntriesInDirectory</td><td style=text-align:center>中央目录总条目数</td></tr><tr><td style=text-align:center>elDirectorySize</td><td style=text-align:center>中央目录的总大小</td></tr><tr><td style=text-align:center>elDirectoryOffset</td><td style=text-align:center>中央目录相对于第一个entry的起始位置</td></tr><tr><td style=text-align:center>elCommentLength</td><td style=text-align:center>注释长度</td></tr><tr><td style=text-align:center>char elComment</td><td style=text-align:center>压缩包注释</td></tr></tbody></table><h4 class=heading-element id=常见报错及对应解决方法借助010的模板功能><span>常见报错及对应解决方法（借助010的模板功能）</span>
<a href=#%e5%b8%b8%e8%a7%81%e6%8a%a5%e9%94%99%e5%8f%8a%e5%af%b9%e5%ba%94%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95%e5%80%9f%e5%8a%a9010%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%8a%9f%e8%83%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ol><li>该文件已损坏-源数据区和目录区的文件名长度被修改了</li></ol><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240724172656435.png alt=/posts/1ad9200/imgs/image-20240724172656435.png height=1528 width=2560></p><ol start=2><li>CRC校验错误-源数据区或目录区的压缩方法被修改了</li></ol><p><img loading=lazy src=/posts/1ad9200/imgs/image-20240724172708418.png alt=/posts/1ad9200/imgs/image-20240724172708418.png height=2088 width=3840></p><h3 class=heading-element id=rar文件结构><span>rar文件结构</span>
<a href=#rar%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>52 61 72 21 1A 07 00</td><td>rar 文件头标记，文本为 Rar!</td><td></td></tr></tbody></table><p><strong>Main block</strong></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>33 92 B5 E5</td><td>全部块的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>0A</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>01</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>05</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><blockquote><p>当 RAR 压缩包添加了注释时，会出现 CMT 这个参数</p></blockquote><p><strong>File Header</strong></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>43 06 35 17</td><td>单独块的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>55</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>02</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>03</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><p><strong>Terminator</strong></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>1D 77 56 51</td><td>固定的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>03</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>05</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>04 00</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><h3 class=heading-element id=1压缩包伪加密><span>1、压缩包伪加密</span>
<a href=#1%e5%8e%8b%e7%bc%a9%e5%8c%85%e4%bc%aa%e5%8a%a0%e5%af%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><blockquote><p>感觉网上很多讲压缩包伪加密的博客都是有问题的，因此打算这里详细总结一下</p><p>首先，frFlags 只是用于告诉压缩软件这个压缩包是否被加密，<strong>没有任何一个标志可以直接表示压缩包是否是伪加密</strong>。我们只能通过frFlags这个标志位判断出压缩包当前是否是加密状态，如果是加密状态，我们再进一步尝试判断是否是伪加密。</p></blockquote><h4 class=heading-element id=zip文件><span>zip文件：</span>
<a href=#zip%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>Bandizip判断压缩包是否加密的方式：record区的<code>frFlags</code></p><p>7zip判断压缩包是否加密的方式：dirEntry区<code>deFlags</code></p><p>因此，出题的时候需要把这两个位置都改了，要不然换个软件可能就直接非预期了</p><p>record区的<code>frFlags</code>和dirEntry区<code>deFlags</code>两个位置均为8个bit，其中只有最后一位代表是否加密</p><p><strong>去除伪加密的方法：直接用<code>010editor</code>打开，将压缩源文件数据区第8字节和压缩源文件目录区第10字节改为00即可</strong></p><h4 class=heading-element id=rar文件><span>rar文件：</span>
<a href=#rar%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>rar的伪加密有两种方式：</p><p>第一种是把第24字节尾数改成1：因此<code>010editor</code>打开，第24个字节尾数为4表示加密，0表示无加密，将尾数改为0即可去除伪加密</p><p>第二种是把第11字节的尾数改成1：因此<code>010editor</code>打开，把第11字节改为<code>\x00</code>即可</p><h3 class=heading-element id=2crc爆破><span>2、CRC爆破</span>
<a href=#2crc%e7%88%86%e7%a0%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>适用于压缩包中文件比较小，比如只有几字节的时候</p><p>可以直接用网上的脚本爆破，但是要注意有些脚本只能提取zip压缩包的CRC32：</p><p><a href=https://github.com/AabyssZG/CRC32-Tools target=_blank rel="external nofollow noopener noreferrer">https://github.com/AabyssZG/CRC32-Tools</a></p><p><a href=https://github.com/theonlypwner/crc32 target=_blank rel="external nofollow noopener noreferrer">https://github.com/theonlypwner/crc32</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 crc32.py reverse 0x7c2df918</span></span></code></pre></td></tr></table></div></div><p>发现网上大部分的脚本只能爆破可打印字符的结果，因此这里我自己写了一个包含不可打印字符的脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CRC32Reverse</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>crc32</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=n>tbl</span><span class=o>=</span><span class=nb>bytes</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>)),</span> <span class=n>poly</span><span class=o>=</span><span class=mh>0xEDB88320</span><span class=p>,</span> <span class=n>accum</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>char_set</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>tbl</span><span class=p>)</span>  <span class=c1># 支持所有字节</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>crc32</span> <span class=o>=</span> <span class=n>crc32</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>length</span> <span class=o>=</span> <span class=n>length</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>poly</span> <span class=o>=</span> <span class=n>poly</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>accum</span> <span class=o>=</span> <span class=n>accum</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>table</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>table_reverse</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>init_tables</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>poly</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;构建 CRC32 表及其反向查找表&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># CRC32 表构建</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>i</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=n>i</span> <span class=o>^=</span> <span class=n>poly</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>i</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=p>)</span> <span class=o>==</span> <span class=mi>256</span><span class=p>,</span> <span class=s2>&#34;CRC32 表的大小错误&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 构建反向查找表</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>reverse</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>found</span> <span class=o>=</span> <span class=p>[</span><span class=n>j</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span> <span class=o>==</span> <span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>table_reverse</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>tuple</span><span class=p>(</span><span class=n>found</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>table_reverse</span><span class=p>)</span> <span class=o>==</span> <span class=mi>256</span><span class=p>,</span> <span class=s2>&#34;反向查找表的大小错误&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calc</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>accum</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算 CRC32 校验值&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>accum</span> <span class=o>=</span> <span class=o>~</span><span class=n>accum</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>accum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=p>[(</span><span class=n>accum</span> <span class=o>^</span> <span class=n>b</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>]</span> <span class=o>^</span> <span class=p>((</span><span class=n>accum</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0x00FFFFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>accum</span> <span class=o>=</span> <span class=o>~</span><span class=n>accum</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>accum</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_reverse</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>desired</span><span class=p>,</span> <span class=n>accum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;查找反向字节序列&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>solutions</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>accum</span> <span class=o>=</span> <span class=o>~</span><span class=n>accum</span>
</span></span><span class=line><span class=cl>        <span class=n>stack</span> <span class=o>=</span> <span class=p>[(</span><span class=o>~</span><span class=n>desired</span><span class=p>,)]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>stack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span> <span class=o>=</span> <span class=n>stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>table_reverse</span><span class=p>[(</span><span class=n>node</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>node</span><span class=p>)</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>a</span> <span class=o>=</span> <span class=n>accum</span>
</span></span><span class=line><span class=cl>                    <span class=n>data</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>                    <span class=n>node</span> <span class=o>=</span> <span class=n>node</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                        <span class=n>data</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>a</span> <span class=o>^</span> <span class=n>node</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>a</span> <span class=o>&gt;&gt;=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>                        <span class=n>a</span> <span class=o>^=</span> <span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=p>[</span><span class=n>node</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>                    <span class=n>solutions</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>tuple</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>stack</span><span class=o>.</span><span class=n>append</span><span class=p>(((</span><span class=n>node</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>^</span> <span class=bp>self</span><span class=o>.</span><span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>,)</span> <span class=o>+</span> <span class=n>node</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>solutions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>dfs</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=n>outlist</span><span class=o>=</span><span class=p>[</span><span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;深度优先搜索生成字节序列&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>length</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>outlist</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>item</span> <span class=o>+</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>x</span><span class=p>])</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>outlist</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>char_set</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=n>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>tmp_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run_reverse</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;执行 CRC32 反向查找&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>init_tables</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>poly</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>desired</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>crc32</span>
</span></span><span class=line><span class=cl>        <span class=n>accum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>accum</span>
</span></span><span class=line><span class=cl>        <span class=n>result_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 处理至少为 4 字节的情况</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>length</span> <span class=o>&gt;=</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>patches</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>find_reverse</span><span class=p>(</span><span class=n>desired</span><span class=p>,</span> <span class=n>accum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>patch</span> <span class=ow>in</span> <span class=n>patches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>checksum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calc</span><span class=p>(</span><span class=n>patch</span><span class=p>,</span> <span class=n>accum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># print(f&#34;verification checksum: 0x{checksum:08x} ({&#39;OK&#39; if checksum == desired else &#39;ERROR&#39;})&#34;)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>length</span> <span class=o>-</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>patch</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>patches</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>find_reverse</span><span class=p>(</span><span class=n>desired</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>calc</span><span class=p>(</span><span class=n>patch</span><span class=p>,</span> <span class=n>accum</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>last_4_bytes</span> <span class=ow>in</span> <span class=n>patches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>patch</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>last_4_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>checksum</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calc</span><span class=p>(</span><span class=n>patch</span><span class=p>,</span> <span class=n>accum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>checksum</span> <span class=o>==</span> <span class=n>desired</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>result_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>patch</span><span class=p>))</span>  <span class=c1># 添加符合条件的字节序列</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>calc</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=o>==</span> <span class=n>desired</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>result_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>item</span><span class=p>))</span>  <span class=c1># 添加符合条件的字节序列</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result_list</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>crc32_reverse</span><span class=p>(</span><span class=n>crc32</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=n>char_set</span><span class=o>=</span><span class=nb>bytes</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>)),</span> <span class=n>poly</span><span class=o>=</span><span class=mh>0xEDB88320</span><span class=p>,</span> <span class=n>accum</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span> <span class=o>=</span> <span class=n>CRC32Reverse</span><span class=p>(</span><span class=n>crc32</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=n>char_set</span><span class=p>,</span> <span class=n>poly</span><span class=p>,</span> <span class=n>accum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>obj</span><span class=o>.</span><span class=n>run_reverse</span><span class=p>()</span>  <span class=c1># 返回所有结果</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>crc32</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>binascii</span><span class=o>.</span><span class=n>crc32</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>crc_values</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0xf72c104b</span><span class=p>,</span> <span class=mh>0x39004188</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>crc_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>crc32_reverse</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>例题1-BugKu MISC 就五层你能解开吗?</p><p>参考文章：https://blog.csdn.net/mochu7777777/article/details/110206427</p><h3 class=heading-element id=3暴力破解压缩包密码><span>3、暴力破解压缩包密码</span>
<a href=#3%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以使用的工具：<code>Advanced Archive Password Recovery(ARCHPR)</code>、<code>Passware Kit Forensic</code>、<code>Hashcat</code></p><p>爆破效率:<code>Advanced Archive Password Recovery(ARCHPR)</code> &lt; <code>Passware Kit Forensic</code>&lt; <code>Hashcat</code></p><p>爆破的类型主要可以分为<code>限制字符集及长度的爆破</code>、<code>掩码爆破</code>、<code>字典爆破</code>这三种</p><blockquote><p>Tips：</p><ol><li><p>掩码爆破这里，<code>ARCHPR</code>是用<code>?</code>表示占位符、而<code>Passware Kit Forensic</code>是用例如<code>?d</code>等正则表达式表示占位符</p></li><li><p>字典爆破推荐使用<code>rockyou.txt</code>这个字典，<code>kali</code>系统中自带了，在<code>/usr/share/wordlists</code>目录下</p></li></ol></blockquote><p><strong>Hashcat爆破压缩包密码的步骤</strong></p><ol><li>生成待爆破的Hash值</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>联网的情况下可以使用在线网站生成：https://hashes.com/en/johntheripper
</span></span><span class=line><span class=cl>断网的情况下可以使用johntheripper生成 .\zip2john.exe .\layer3.zip</span></span></code></pre></td></tr></table></div></div><p>2.找到对应的Hash类型：https://hashcat.net/wiki/doku.php?id=example_hashes</p><p>3.使用Hashcat进行爆破</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.<span class=se>\h</span>ashcat.exe -a <span class=m>3</span> -m <span class=m>17200</span> hash1.txt --increment --increment-min <span class=m>1</span> --increment-max <span class=m>8</span> ?d?d?d?d?d?d?d?d --force
</span></span><span class=line><span class=cl>.<span class=se>\h</span>ashcat.exe -a <span class=m>3</span> -m <span class=m>17200</span> -1 ?d hash2.txt Y3p_P@ssW0rd_1s_?1?1?1?1?1?1 --force
</span></span><span class=line><span class=cl>.<span class=se>\h</span>ashcat.exe -a <span class=m>0</span> -m <span class=m>17200</span> hash3.txt rockyou.txt --force
</span></span><span class=line><span class=cl>.<span class=se>\h</span>ashcat.exe -a <span class=m>3</span> -m <span class=m>11600</span> -1 ?d hash4.txt Y3p_Ke9_1s_?1?1?1?1?1 --force</span></span></code></pre></td></tr></table></div></div><blockquote><p>参数含义：</p><p>-a 后跟使用的攻击类型 3表示掩码攻击 0表示字典攻击</p><p>-m 后跟待爆破的Hash类型，具体类型参考上面的链接</p><p>&ndash;increment &ndash;increment-min 1 &ndash;increment-max 6 表示限制长度1-6位</p><p>-1 表示自定义字符集 ?d代表数字 ?l代表小写字母 ?u代表大写字母 ?s代表特殊符号</p><p>&ndash;force 代表忽略破解过程中的警告信息</p><p>&ndash;show 输出已爆破出的Hash值及对应明文，爆破成功的Hash会保存在hashcat.potfile文件中</p></blockquote><h3 class=heading-element id=4压缩包套娃解套><span>4、压缩包套娃解套</span>
<a href=#4%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%a5%97%e5%a8%83%e8%a7%a3%e5%a5%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>压缩包套娃可能会包含多种类型的压缩混合套娃，但是流程都差不多，这里就贴一下我写的脚本吧</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zipfile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>rarfile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>py7zr</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decompress_7z</span><span class=p>(</span><span class=n>archive_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>py7zr</span><span class=o>.</span><span class=n>SevenZipFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>archive</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>file_list</span> <span class=o>=</span> <span class=n>archive</span><span class=o>.</span><span class=n>list</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>new_archive_file</span> <span class=o>=</span> <span class=n>file_list</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>py7zr</span><span class=o>.</span><span class=n>SevenZipFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>archive</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>archive</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=s2>&#34;tmp/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>archive_file</span><span class=si>}</span><span class=s2> 解压成功 ==&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;mv tmp/* .&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>rmdir</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>new_archive_file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decompress_zip</span><span class=p>(</span><span class=n>archive_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>zip_ref</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>file_list</span> <span class=o>=</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>new_archive_file</span> <span class=o>=</span> <span class=n>file_list</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>zip_ref</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>zip_ref</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=s2>&#34;tmp/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>archive_file</span><span class=si>}</span><span class=s2> 解压成功 ==&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;mv tmp/* .&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>rmdir</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>new_archive_file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decompress_rar</span><span class=p>(</span><span class=n>archive_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>rarfile</span><span class=o>.</span><span class=n>RarFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span> <span class=k>as</span> <span class=n>rar_ref</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>file_list</span> <span class=o>=</span> <span class=n>rar_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>new_archive_file</span> <span class=o>=</span> <span class=n>file_list</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>rarfile</span><span class=o>.</span><span class=n>RarFile</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span> <span class=k>as</span> <span class=n>rar_ref</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>rar_ref</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=s2>&#34;tmp/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] </span><span class=si>{</span><span class=n>archive_file</span><span class=si>}</span><span class=s2> 解压成功 ==&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;mv tmp/* .&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>rmdir</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>new_archive_file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>archive_file</span> <span class=o>=</span> <span class=s2>&#34;flag.zip&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;7z&#34;</span> <span class=ow>in</span> <span class=n>archive_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>archive_file</span> <span class=o>=</span> <span class=n>decompress_7z</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=s2>&#34;rar&#34;</span> <span class=ow>in</span> <span class=n>archive_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>archive_file</span> <span class=o>=</span> <span class=n>decompress_rar</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=s2>&#34;zip&#34;</span> <span class=ow>in</span> <span class=n>archive_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>archive_file</span> <span class=o>=</span> <span class=n>decompress_zip</span><span class=p>(</span><span class=n>archive_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>py7zr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>input_file</span> <span class=o>=</span> <span class=s1>&#39;shell9999.tar.gz&#39;</span>  <span class=c1># 更改为你的文件路径</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_compressed_type</span><span class=p>(</span><span class=n>filepath</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>,</span> <span class=n>filepath</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>file_cmd_output</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;gzip compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;tar.gz&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;Zip archive data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;zip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;7-zip archive data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;7z&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;gzip compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;gzip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;XZ compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;xz&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;bzip2 compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;bzip2&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;LZMA compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;lzma&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;Zstandard compressed data&#39;</span> <span class=ow>in</span> <span class=n>file_cmd_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;zstd&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ctype</span> <span class=o>=</span> <span class=n>get_compressed_type</span><span class=p>(</span><span class=n>input_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;tar.gz&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;tar&#39;</span><span class=p>,</span> <span class=s1>&#39;-xzf&#39;</span><span class=p>,</span> <span class=n>input_file</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;zip&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;unzip&#39;</span><span class=p>,</span> <span class=n>input_file</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;7z&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>py7zr</span><span class=o>.</span><span class=n>SevenZipFile</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>z</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>z</span><span class=o>.</span><span class=n>extractall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;gzip&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_file</span> <span class=o>=</span> <span class=n>input_file</span> <span class=o>+</span> <span class=s2>&#34;.gz&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;mv </span><span class=si>{}</span><span class=s2> </span><span class=si>{}</span><span class=s2>; gunzip </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;xz&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_file</span> <span class=o>=</span> <span class=n>input_file</span> <span class=o>+</span> <span class=s2>&#34;.xz&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;mv </span><span class=si>{}</span><span class=s2> </span><span class=si>{}</span><span class=s2>; unxz </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;bzip2&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_file</span> <span class=o>=</span> <span class=n>input_file</span> <span class=o>+</span> <span class=s2>&#34;.bz2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;mv </span><span class=si>{}</span><span class=s2> </span><span class=si>{}</span><span class=s2>; bunzip2 </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;lzma&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_file</span> <span class=o>=</span> <span class=n>input_file</span> <span class=o>+</span> <span class=s2>&#34;.lzma&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;mv </span><span class=si>{}</span><span class=s2> </span><span class=si>{}</span><span class=s2>; unlzma </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>ctype</span> <span class=o>==</span> <span class=s2>&#34;zstd&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp_file</span> <span class=o>=</span> <span class=n>input_file</span> <span class=o>+</span> <span class=s2>&#34;.zst&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cmd</span> <span class=o>=</span> <span class=s2>&#34;mv </span><span class=si>{}</span><span class=s2> </span><span class=si>{}</span><span class=s2>; unzstd --force </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>,</span> <span class=n>tmp_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Unsupported file type or done extracting!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 删除已解压的文件并更新input_file为新解压的文件</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>input_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span> <span class=o>=</span> <span class=p>[</span><span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>()</span> <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=ow>and</span> <span class=n>f</span> <span class=o>!=</span> <span class=s2>&#34;test.py&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>files</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>input_file</span> <span class=o>=</span> <span class=n>files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Unexpected number of files in directory!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips：ZIP压缩包套娃建议用<code>pyzipper</code>模块写脚本解套，不要用<code>zipfile</code>了，这个模块有点过时了</p></blockquote><h3 class=heading-element id=5分卷压缩包合并><span>5、分卷压缩包合并</span>
<a href=#5%e5%88%86%e5%8d%b7%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%90%88%e5%b9%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>使用以下命令合并或者直接<code>Bandizip</code>打开</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>copy /B topic.zip.001 + topic.zip.002+topic.zip.003+topic.zip.004+topic.zip.005+topic.zip.006 topic.zip</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=6压缩包炸弹><span>6、压缩包炸弹</span>
<a href=#6%e5%8e%8b%e7%bc%a9%e5%8c%85%e7%82%b8%e5%bc%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>很小的压缩文件，解压出来会占据巨大的空间，甚至撑爆磁盘</p><p>处理方法：010中直接编辑压缩包文件，看看是否藏有另一个压缩包</p><h3 class=heading-element id=7根据010中的模板修改了某些参数><span>7、根据010中的模板修改了某些参数</span>
<a href=#7%e6%a0%b9%e6%8d%ae010%e4%b8%ad%e7%9a%84%e6%a8%a1%e6%9d%bf%e4%bf%ae%e6%94%b9%e4%ba%86%e6%9f%90%e4%ba%9b%e5%8f%82%e6%95%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>有些题目可能会修改源数据中压缩包文件中被压缩文件的文件名的长度</p><p>源数据中被压缩文件名字的长度对不上也会导致解压后文件无法打开</p><p>所以&mldr;010的模板功能真的非常非常的好用！</p><p><img loading=lazy src=/posts/1ad9200/imgs/010.png alt=/posts/1ad9200/imgs/010.png height=1600 width=2560></p><h3 class=heading-element id=8压缩包密码是不可见字符><span>8、压缩包密码是不可见字符</span>
<a href=#8%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%af%86%e7%a0%81%e6%98%af%e4%b8%8d%e5%8f%af%e8%a7%81%e5%ad%97%e7%ac%a6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=字节数很短的情况><span>字节数很短的情况</span>
<a href=#%e5%ad%97%e8%8a%82%e6%95%b0%e5%be%88%e7%9f%ad%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接写个Python脚本爆破即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zipfile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 在ASCII编码中，一个字符占用8位（1字节）</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>fz</span> <span class=o>=</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=s1>&#39;secret key.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span> <span class=o>=</span> <span class=n>libnum</span><span class=o>.</span><span class=n>n2s</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>+</span> <span class=n>libnum</span><span class=o>.</span><span class=n>n2s</span><span class=p>(</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+]正在尝试密码</span><span class=si>{</span><span class=n>password</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>fz</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>pwd</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>fz</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>fz</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>solve</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+]压缩包解压成功,密码是</span><span class=si>{</span><span class=n>password</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+]在该范围内找不到压缩包密码，压缩包解压失败&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=字节数较长的情况><span>字节数较长的情况</span>
<a href=#%e5%ad%97%e8%8a%82%e6%95%b0%e8%be%83%e9%95%bf%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>需要先把密码base64编码一下，然后再base64解码成byte类型作为密码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pyzipper</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target_zip</span> <span class=o>=</span> <span class=s1>&#39;1.zip&#39;</span>
</span></span><span class=line><span class=cl><span class=n>outfile</span> <span class=o>=</span> <span class=s1>&#39;./solved&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pwd</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;aEXigItjVOKAjEbigI8=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;hE\xe2\x80\x8bcT\xe2\x80\x8cF\xe2\x80\x8f&#39;</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>pyzipper</span><span class=o>.</span><span class=n>AESZipFile</span><span class=p>(</span><span class=n>target_zip</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>pwd</span> <span class=o>=</span> <span class=n>pwd</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>outfile</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=9明文攻击><span>9、明文攻击</span>
<a href=#9%e6%98%8e%e6%96%87%e6%94%bb%e5%87%bb class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>zip压缩包可被明文攻击的具体条件如下：</p><blockquote><ol><li><p>至少已知明文的12个字节及其偏移，其中至少8字节需要连续</p></li><li><p><strong>加密算法</strong>为：<code>ZipCrypto</code>，如果仅有部分明文，则压缩算法需为：<code>Store</code>；如果有至少一个完整明文，则压缩算法可为<code>Deflate</code></p></li></ol></blockquote><p>zip明文攻击的原始论文：<a href=https://link.springer.com/content/pdf/10.1007/3-540-60590-8_12.pdf target=_blank rel="external nofollow noopener noreferrer">https://link.springer.com/content/pdf/10.1007/3-540-60590-8_12.pdf</a></p><p>明文指的是：加密压缩包内数据区储存的已知内容</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251030102351671.png alt=/posts/1ad9200/imgs/image-20251030102351671.png height=1682 width=2486></p><p><strong>bkcrack常用参数</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-c 要解密的文件
</span></span><span class=line><span class=cl>-P 已知明文所在的压缩包
</span></span><span class=line><span class=cl>-p 已知的明文部分
</span></span><span class=line><span class=cl>-x 压缩包内目标文件的偏移地址  部分已知明文值
</span></span><span class=line><span class=cl>-C 加密压缩包
</span></span><span class=line><span class=cl>-o offset  -p参数指定的明文在压缩包内目标文件的偏移量
</span></span><span class=line><span class=cl>-k 后面加破解出的三段密钥
</span></span><span class=line><span class=cl>-d 后面加解密后数据的保存位置
</span></span><span class=line><span class=cl>-U 修改压缩包密码并导出	bkcrack -C flag.zip -c hint.jpg -k afb9fee3 f8795353 f6de1d4e -U out.zip <span class=m>114514</span></span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=已知所有的明文或三段密钥><span>已知所有的明文或三段密钥</span>
<a href=#%e5%b7%b2%e7%9f%a5%e6%89%80%e6%9c%89%e7%9a%84%e6%98%8e%e6%96%87%e6%88%96%e4%b8%89%e6%ae%b5%e5%af%86%e9%92%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>方法一、直接使用Advanced Archive Password Recovery破解</p><blockquote><p>已有完整明文的情况下，可手动构造包含已知明文的压缩包进行明文攻击,ARCHPR攻击的速度较慢；</p><p>已有完整的三段密钥也可以使用该工具破解密码</p><p>在手动构造包含已知明文的压缩包时使用的压缩工具需要与出题人所使用的一致</p></blockquote><p><strong>如何判断压缩工具</strong>（参考自Byxs20的博客）</p><table><thead><tr><th>压缩工具</th><th>VersionMadeBy(压缩所用版本)</th></tr></thead><tbody><tr><td>Bandzip 7.06</td><td>20</td></tr><tr><td>Windows自带</td><td>20</td></tr><tr><td>WinRAR</td><td>20</td></tr><tr><td>WinRAR 4.20</td><td>31</td></tr><tr><td>WinRAR 5.70</td><td>31</td></tr><tr><td>7-Zip</td><td>63</td></tr></tbody></table><blockquote><p>Tips: 可以手动删除题目给出压缩包内的加密文件，从而构造完美的包含已知明文的压缩包，这样可以绕过压缩工具不一致导致无法进行明文攻击的情况</p></blockquote><p>方法二、使用 bkcrack破解(推荐)</p><blockquote><p>参数含义：</p><p>-C 后跟待破解的压缩包，</p><p>-c 后跟压缩包中我们要攻击的明文文件</p><p>-P 后跟我们压缩好的压缩包</p><p>-p 后跟我们已得的明文文件</p><p>-U 参数用于修改压缩包密码并导出</p></blockquote><blockquote><p>把相同文件按照对应的压缩方法，压缩成压缩包，然后使用bkcrack破解即可</p></blockquote><p>例题1-2023古剑山-幸运饼干</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ bkcrack -C flag.zip -c hint.jpg -p hint.jpg -P hint.zip
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>14:37:27<span class=o>]</span> Z reduction using <span class=m>25761</span> bytes of known plaintext
</span></span><span class=line><span class=cl>100.0 % <span class=o>(</span><span class=m>25761</span> / 25761<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>14:37:29<span class=o>]</span> Attack on <span class=m>289</span> Z values at index <span class=m>21821</span>
</span></span><span class=line><span class=cl>Keys: afb9fee3 f8795353 f6de1d4e
</span></span><span class=line><span class=cl>100.0 % <span class=o>(</span><span class=m>289</span> / 289<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>14:37:29<span class=o>]</span> Keys
</span></span><span class=line><span class=cl>afb9fee3 f8795353 f6de1d4e</span></span></code></pre></td></tr></table></div></div><p>例题2-2023铁三决赛-baby_jpg</p><blockquote><p>先从部分伪加密的压缩包中分离出<code>serect.pdf</code>，然后从PDF中 foremost 出了加密压缩包中的<code>sha512.txt</code></p><p>将<code>sha512.txt</code>压缩成<code>sha512.zip</code>，然后使用下面的命令进行明文攻击即可：</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ bkcrack -C 00000218.zip -c <span class=s1>&#39;sha512.txt&#39;</span> -P sha512.zip -p sha512.txt
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>16:14:25<span class=o>]</span> Z reduction using <span class=m>78</span> bytes of known plaintext
</span></span><span class=line><span class=cl>100.0 % <span class=o>(</span><span class=m>78</span> / 78<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>16:14:25<span class=o>]</span> Attack on <span class=m>104916</span> Z values at index <span class=m>6</span>
</span></span><span class=line><span class=cl>Keys: ed3fb6a9 1c4a7211 c07461ed
</span></span><span class=line><span class=cl>59.9 % <span class=o>(</span><span class=m>62867</span> / 104916<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>16:14:52<span class=o>]</span> Keys
</span></span><span class=line><span class=cl>ed3fb6a9 1c4a7211 c07461ed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ bkcrack -C 00000218.zip -k ed3fb6a9 1c4a7211 c07461ed -U out.zip <span class=m>111</span>
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>16:15:44<span class=o>]</span> Writing unlocked archive out.zip with password <span class=s2>&#34;111&#34;</span>
</span></span><span class=line><span class=cl>100.0 % <span class=o>(</span><span class=m>3</span> / 3<span class=o>)</span>
</span></span><span class=line><span class=cl>Wrote unlocked archive.</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=已知部分明文><span>已知部分明文</span>
<a href=#%e5%b7%b2%e7%9f%a5%e9%83%a8%e5%88%86%e6%98%8e%e6%96%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=1利用明文文本破解><span>1)利用明文文本破解</span>
<a href=#1%e5%88%a9%e7%94%a8%e6%98%8e%e6%96%87%e6%96%87%e6%9c%ac%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>已知 flag{16e371fa-0555-47fc-b343-74f6754f6c01} 字符串中的flag{16e*********************74f6********</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;lag{16e3&#34;</span> &gt; plain1.txt   <span class=c1>#连续的8明文</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;74f6&#34;</span> <span class=p>|</span> xxd             <span class=c1>#额外明文的十六进制格式，37346636</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-2.zip -c flag.txt -p plain1.txt -o <span class=m>0</span> -x <span class=m>29</span> <span class=m>37346636</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-2.zip -c flag.txt -p plain1.txt -o <span class=m>0</span> -x <span class=m>29</span> <span class=m>37346636</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-2.zip -c flag.txt -k b21e5df4 ab9a9430 8c336475 -U out.zip <span class=m>123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -o 和 -x 后需要已知明文在文件中的偏移量</span>
</span></span><span class=line><span class=cl><span class=c1># -o 指定的明文不需要转为十六进制</span>
</span></span><span class=line><span class=cl><span class=c1># -x 指定的明文需要转成十六进制</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=2利用png图片文件头破解><span>2)利用PNG图片文件头破解</span>
<a href=#2%e5%88%a9%e7%94%a8png%e5%9b%be%e7%89%87%e6%96%87%e4%bb%b6%e5%a4%b4%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> 89504E470D0A1A0A0000000D49484452 <span class=p>|</span> xxd -r -ps &gt; png_header
</span></span><span class=line><span class=cl>bkcrack -C png4.zip -c 2.png -p png_header -o <span class=m>0</span>
</span></span><span class=line><span class=cl>bkcrack -C png4.zip -c flag.txt -k e0be8d5d 70bb3140 7e983fff -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=3利用zip格式破解><span>3)利用ZIP格式破解</span>
<a href=#3%e5%88%a9%e7%94%a8zip%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>将flag.txt压缩成flag.zip(无加密，压缩方法任意)，在外面再套一层zip(zipcrypto + store)时适用</p><blockquote><p>将一个名为flag.txt的文件打包成ZIP压缩包后，发现文件名称会出现在内层压缩包文件头中，且偏移固定为30</p><p>且默认情况下，flag.zip也会作为该压缩包的名称（但如果出题人修改了压缩包的名字，就不能这样攻击了）</p><p>然后再在外层套一个满足明文攻击条件的压缩包，这样的情况也可被明文攻击</p><p>已知的明文片段有：</p><p>“flag.txt” 8个字节，偏移30</p><p>ZIP本身文件头：50 4B 03 04 ，4字节</p><p>满足12字节的要求</p><p>然后这些都是内层压缩包的固定格式</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/2a2a99168773b0112f23f77f5a3067d8.png alt=/posts/1ad9200/imgs/2a2a99168773b0112f23f77f5a3067d8.png height=269 width=742></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;flag.txt&#34;</span> &gt; plain1.txt <span class=c1># -n参数避免换行，不然文件中会出现换行符，导致攻击失效</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-4.zip -c flag.zip -p plain1.txt -o 30  -x <span class=m>0</span> 504B0304
</span></span><span class=line><span class=cl>bkcrack -C 7-4.zip -c flag.zip -k b21e5df4 ab9a9430 8c336475  -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>Tips：如果这里用 <code>XXXXX.txt</code>作为明文无法破解成功，可以试试直接去掉后缀<code>.txt</code></p></blockquote><p>当然，这里还有另外一种攻击方式，因为 ZIP 压缩包的尾部 22 字节肯定是<code>504b050600000000</code>开头的</p><p>所以当 ZIP 压缩包内压缩的是一个压缩包或者一个目录的时候，偏移量就等于<code>被压缩文件的大小-22</code></p><p>因此我们可以用 010 把 <code>504b050600000000</code> 导入 Hex 到 plain.txt 中做一个已知明文</p><p>然后偏移量 -o 参数后跟上 <code>被压缩文件的大小-22</code></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250920222741333.png alt=/posts/1ad9200/imgs/image-20250920222741333.png height=260 width=1435></p><p>例题1-NKCTF2023——五年Misc，三年模拟</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#echo -n &#34;handsome.txt&#34; &gt; plain1.txt 破解失败</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;handsome&#34;</span> &gt; plain1.txt
</span></span><span class=line><span class=cl>bkcrack -C test5.zip -c handsome.zip -p plain1.txt -o <span class=m>30</span>  -x <span class=m>0</span> 504B0304</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=4利用exe文件格式破解><span>4)利用EXE文件格式破解</span>
<a href=#4%e5%88%a9%e7%94%a8exe%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>EXE文件默认加密情况下，不太会以store方式被加密，但它文件格式中的的明文及其明显，长度足够。</p><p>如果加密ZIP压缩包出现以store算法存储的EXE格式文件，很容易进行破解。</p><p>大部分exe中都有这相同一段，且偏移固定为64：</p></blockquote><p><img loading=lazy src=https://image.3001.net/images/20201117/1605593956_5fb36b64db62588f96dcc.png!small alt=img></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&#34;</span> <span class=p>|</span> xxd -r -ps &gt; mingwen <span class=c1># 需要在Linux下使用，Windows下可以用010或者CyberChef</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-5.zip -c nc64.exe -p mingwen -o <span class=m>64</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-5.zip -c nc64.exe -k b21e5df4 ab9a9430 8c336475  -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=5利用pcapng格式破解><span>5)利用pcapng格式破解</span>
<a href=#5%e5%88%a9%e7%94%a8pcapng%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;00004D3C2B1A01000000FFFFFFFFFFFFFFFF&#34;</span> <span class=p>|</span> xxd -r -ps &gt; pcap_plain <span class=c1># 需要在Linux下使用，Windows下可以用010或者CyberChef</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-6.zip -c capture.pcapng -p pcap_plain -o <span class=m>6</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-6.zip -c capture.pcapng  -k 2c795462 fe9163bf 53086712  -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=6利用xml文件格式破解><span>6)利用XML文件格式破解</span>
<a href=#6%e5%88%a9%e7%94%a8xml%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>robots.txt的文件开头内容通常是User-agent: * 
</span></span><span class=line><span class=cl>html文件开头通常是 &lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>xml文件开头通常是&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s1>&#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&#39;</span> &gt; xml_plain
</span></span><span class=line><span class=cl>bkcrack -C 7-7.zip -c 123/web.xml -p xml_plain -o 0 <span class=c1># 注意相对路径</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-7.zip -c 123/web.xml  -k e0be8d5d 70bb3140 7e983fff  -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=7利用svg文件格式破解><span>7)利用SVG文件格式破解</span>
<a href=#7%e5%88%a9%e7%94%a8svg%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#SVG是一种基于XML的图像文件格式</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s1>&#39;&lt;?xml version=&#34;1.0&#34; &#39;</span> &gt; plain.txt
</span></span><span class=line><span class=cl>bkcrack -C 7-8.zip -c spiral.svg -p plain.txt -o <span class=m>0</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-8.zip -c advice.jpg -k c4038591 d5ff449d d3b0c696 -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=8利用vmdk文件格式破解><span>8)利用VMDK文件格式破解</span>
<a href=#8%e5%88%a9%e7%94%a8vmdk%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f%e7%a0%b4%e8%a7%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;4B444D560100000003000000&#34;</span> <span class=p>|</span> xxd -r -ps &gt; plain
</span></span><span class=line><span class=cl>bkcrack -C 7-9.zip -c flag.vmdk -p plain -o <span class=m>0</span>
</span></span><span class=line><span class=cl>bkcrack -C 7-9.zip -c flag.vmdk -k e6a73d9f 21ccfdbc f3e0c61c -U out.zip <span class=m>123</span></span></span></code></pre></td></tr></table></div></div><p><strong>有时候直接给你部分明文的情况（2023 DASCTFxCBCTF）</strong></p><p>直接在bkcrack中使用以下命令即可，key是题目给的压缩包中被压缩文件的部分明文</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bkcrack -C purezip.zip -c <span class=s1>&#39;secret key.zip&#39;</span> -p key</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=得到密钥后使用bkcrack修改压缩包密码><span>得到密钥后使用bkcrack修改压缩包密码</span>
<a href=#%e5%be%97%e5%88%b0%e5%af%86%e9%92%a5%e5%90%8e%e4%bd%bf%e7%94%a8bkcrack%e4%bf%ae%e6%94%b9%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>破解出压缩包的三段密钥后，可以用 -U 参数修改压缩包密码并导出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ bkcrack -C 00000218.zip -k ed3fb6a9 1c4a7211 c07461ed -U out.zip <span class=m>111</span>
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>16:15:44<span class=o>]</span> Writing unlocked archive out.zip with password <span class=s2>&#34;111&#34;</span>
</span></span><span class=line><span class=cl>100.0 % <span class=o>(</span><span class=m>3</span> / 3<span class=o>)</span>
</span></span><span class=line><span class=cl>Wrote unlocked archive.</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=得到密钥后反向爆破压缩包密码><span>得到密钥后反向爆破压缩包密码</span>
<a href=#%e5%be%97%e5%88%b0%e5%af%86%e9%92%a5%e5%90%8e%e5%8f%8d%e5%90%91%e7%88%86%e7%a0%b4%e5%8e%8b%e7%bc%a9%e5%8c%85%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bkcrack -k e48d3828 5b7223cc 71851fb0 -r <span class=m>3</span> <span class=se>\?</span>b
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>17:47:50<span class=o>]</span> Recovering password
</span></span><span class=line><span class=cl>length 0-6...
</span></span><span class=line><span class=cl><span class=o>[</span>17:47:50<span class=o>]</span> Password
</span></span><span class=line><span class=cl>as bytes: 8b e7 dc
</span></span><span class=line><span class=cl>as text: ���</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=在比赛中的使用记录><span>在比赛中的使用记录</span>
<a href=#%e5%9c%a8%e6%af%94%e8%b5%9b%e4%b8%ad%e7%9a%84%e4%bd%bf%e7%94%a8%e8%ae%b0%e5%bd%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>2022 西湖论剑zipeasy</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bkcrack -C zipeasy.zip -c dasflow.zip -x 30 646173666c6f772e706361706e67 -x 0 504B0304</span></span></code></pre></td></tr></table></div></div><p><strong>2023 DASCTFxCBCTF</strong></p><p>利用bkcrack反向爆破密钥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bkcrack -k e48d3828 5b7223cc 71851fb0 -r <span class=m>3</span> <span class=se>\?</span>b
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bkcrack 1.5.0 - 2023-03-08
</span></span><span class=line><span class=cl><span class=o>[</span>17:47:50<span class=o>]</span> Recovering password
</span></span><span class=line><span class=cl>length 0-6...
</span></span><span class=line><span class=cl><span class=o>[</span>17:47:50<span class=o>]</span> Password
</span></span><span class=line><span class=cl>as bytes: 8b e7 dc
</span></span><span class=line><span class=cl>as text: ���</span></span></code></pre></td></tr></table></div></div><p>然后如果要对得到的密钥进行MD5加密，可以使用CyberChef（From Hex + MD5）</p><p><img loading=lazy src=/posts/1ad9200/imgs/MD5.png alt=/posts/1ad9200/imgs/MD5.png height=1278 width=2280></p><blockquote><p>Tips：</p><ol><li><p>明文攻击失败可以尝试多换几个压缩软件：Bandizip、Winrar、7zip、360压缩、2345压缩、kali自带的压缩软件等</p></li><li><p>这里<code>echo -n xxx > 1.txt</code>要注意在Windows下使用默认是<code>utf-16LE</code>编码，Linux下使用才是<code>utf-8</code>，这个原因也会导致攻击失败</p></li><li><p>这里密钥爆破成功后推荐使用-U改密码导出压缩包，不推荐使用-d直接解出对应文件，因为文件如果是<code>deflate</code>压缩的直接解出来会乱码</p></li></ol></blockquote><blockquote><p>参考资料:</p><p><a href=https://www.freebuf.com/articles/network/255145.html target=_blank rel="external nofollow noopener noreferrer">https://www.freebuf.com/articles/network/255145.html</a></p><p><a href=https://byxs20.github.io/posts/30731.html#%E6%80%BB%E7%BB%93 target=_blank rel="external nofollow noopener noreferrer">https://byxs20.github.io/posts/30731.html#%E6%80%BB%E7%BB%93</a></p></blockquote><h3 class=heading-element id=10直接补上zlib头解压><span>10、直接补上Zlib头解压</span>
<a href=#10%e7%9b%b4%e6%8e%a5%e8%a1%a5%e4%b8%8azlib%e5%a4%b4%e8%a7%a3%e5%8e%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250415103117200.png alt=/posts/1ad9200/imgs/image-20250415103117200.png height=711 width=1482></p><p>假如压缩包在压缩时选择的是无加密并且压缩方法是<code>Deflate</code></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250415103228713.png alt=/posts/1ad9200/imgs/image-20250415103228713.png height=1501 width=2828></p><p>我们可以直接在010中把<code>frData</code>的数据提取出来，前面加上<code>78 9C</code>然后<code>Zlib Inflate</code>解压即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250415103608664.png alt=/posts/1ad9200/imgs/image-20250415103608664.png height=899 width=2487></p><p>例题1-2025TGCTF-ez_zip</p><h3 class=heading-element id=11把加密的压缩包篡改成未加密的情况><span>11、把加密的压缩包篡改成未加密的情况</span>
<a href=#11%e6%8a%8a%e5%8a%a0%e5%af%86%e7%9a%84%e5%8e%8b%e7%bc%a9%e5%8c%85%e7%af%a1%e6%94%b9%e6%88%90%e6%9c%aa%e5%8a%a0%e5%af%86%e7%9a%84%e6%83%85%e5%86%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>解决方案：将加密位修改回来即可</p><blockquote><p>以下内容参考自八神：</p><p>frFlags和deFlags这两字节其实就叫Flags，010模板里写fr和de是为了区分数据存储区还是中央目录区</p><p>然后这两字节一共16bit,只有最低位是记录加密与否的，倒数第二三两个bit记录压缩选项，大部分情况下改了没事</p><p>但这两字节改成09的话就动了倒数第四个bt,记录数据描述符，这个bit是1的话，标头里的CRC32和文件大小是未知的</p><p>实际数据会以额外的12或16字节结构出现在压缩数据后面，把一个实际上没有数据描述符的压缩包的flags倒数第四bit改成1</p><p>会导致软件被指示去读取一个不存在的描述符片段，从而导致后续的数据读取全部错乱</p></blockquote><h3 class=heading-element id=12压缩包文件时间戳隐写><span>12、压缩包文件时间戳隐写</span>
<a href=#12%e5%8e%8b%e7%bc%a9%e5%8c%85%e6%96%87%e4%bb%b6%e6%97%b6%e9%97%b4%e6%88%b3%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>如果是加密的压缩包，可以用下面的脚本提取时间戳，然后尝试转Ascii码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pyzipper</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_zip_timestamps</span><span class=p>(</span><span class=n>zip_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamps</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>pyzipper</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>zip_path</span><span class=p>)</span> <span class=k>as</span> <span class=n>zip_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>file_info</span> <span class=ow>in</span> <span class=n>zip_file</span><span class=o>.</span><span class=n>infolist</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>filename</span> <span class=o>=</span> <span class=n>file_info</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>            <span class=n>modified_datetime</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=o>*</span><span class=n>file_info</span><span class=o>.</span><span class=n>date_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>modified_timestamp</span> <span class=o>=</span> <span class=n>modified_datetime</span><span class=o>.</span><span class=n>timestamp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>timestamps</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>filename</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;modified_timestamp&#39;</span><span class=p>:</span> <span class=n>modified_timestamp</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>timestamps</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>translate_data</span><span class=p>(</span><span class=n>timestamps</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>timestamps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(f&#34;{entry[&#39;filename&#39;]} {entry[&#39;modified_timestamp&#39;]}&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;.txt&#39;</span> <span class=ow>in</span> <span class=n>entry</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>entry</span><span class=p>[</span><span class=s1>&#39;modified_timestamp&#39;</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1737276000</span><span class=o>+</span><span class=mi>1</span><span class=p>),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># YUKWOU9sUYeWSU5qUUKOaA==</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>zip_file_path</span> <span class=o>=</span> <span class=s1>&#39;1.zip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamps</span> <span class=o>=</span> <span class=n>get_zip_timestamps</span><span class=p>(</span><span class=n>zip_file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>translate_data</span><span class=p>(</span><span class=n>timestamps</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>如果压缩包没有加密，并且用上面的脚本提不出来有用的信息</p><p>可以尝试先解压到一个目录中，然后写脚本读取目录中所有文件修改时间的时间戳</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_numeric_part</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>base_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>filename</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>base_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_file_timestamps</span><span class=p>(</span><span class=n>directory</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>file_timestamps</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>file_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>directory</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>filepath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>file_list</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>filename</span><span class=p>,</span> <span class=n>filepath</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>file_list</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>get_numeric_part</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>filename</span><span class=p>,</span> <span class=n>filepath</span> <span class=ow>in</span> <span class=n>file_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>stat_info</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 获取修改时间和创建时间</span>
</span></span><span class=line><span class=cl>            <span class=n>modified_time</span> <span class=o>=</span> <span class=n>stat_info</span><span class=o>.</span><span class=n>st_mtime</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s1>&#39;nt&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>created_time</span> <span class=o>=</span> <span class=n>stat_info</span><span class=o>.</span><span class=n>st_ctime</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>created_time</span> <span class=o>=</span> <span class=n>stat_info</span><span class=o>.</span><span class=n>st_ctime</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 转换为datetime对象</span>
</span></span><span class=line><span class=cl>            <span class=n>modified_dt</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromtimestamp</span><span class=p>(</span><span class=n>modified_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>created_dt</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromtimestamp</span><span class=p>(</span><span class=n>created_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>file_timestamps</span><span class=p>[</span><span class=n>filepath</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;created_unix&#39;</span><span class=p>:</span> <span class=n>created_time</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;modified_unix&#39;</span><span class=p>:</span> <span class=n>modified_time</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;created_datetime&#39;</span><span class=p>:</span> <span class=n>created_dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;modified_datetime&#39;</span><span class=p>:</span> <span class=n>modified_dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;无法获取文件 </span><span class=si>{</span><span class=n>filepath</span><span class=si>}</span><span class=s2> 的时间戳: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 按排序后的顺序打印</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>filename</span><span class=p>,</span> <span class=n>filepath</span> <span class=ow>in</span> <span class=n>file_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>filepath</span> <span class=ow>in</span> <span class=n>file_timestamps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>time_info</span> <span class=o>=</span> <span class=n>file_timestamps</span><span class=p>[</span><span class=n>filepath</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>filepath</span><span class=si>}</span><span class=s2> 创建时间: </span><span class=si>{</span><span class=n>time_info</span><span class=p>[</span><span class=s1>&#39;created_unix&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> 修改时间: </span><span class=si>{</span><span class=n>time_info</span><span class=p>[</span><span class=s1>&#39;modified_unix&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>file_timestamps</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_data</span><span class=p>(</span><span class=n>timestamps</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 按文件名中的数字排序，会把字典中的键值对转为元组列表</span>
</span></span><span class=line><span class=cl>    <span class=n>sorted_files</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>get_numeric_part</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(sorted_files)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>filepath</span><span class=p>,</span> <span class=n>time_info</span> <span class=ow>in</span> <span class=n>sorted_files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>time_info</span><span class=p>[</span><span class=s1>&#39;modified_unix&#39;</span><span class=p>]</span><span class=o>-</span><span class=mi>1737276000</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>target_directory</span> <span class=o>=</span> <span class=s2>&#34;out&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamps</span> <span class=o>=</span> <span class=n>get_file_timestamps</span><span class=p>(</span><span class=n>target_directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>extract_data</span><span class=p>(</span><span class=n>timestamps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># YTJWNU9sTXdVRU5qTTJNaA==</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2024ISCC-时间刺客</p><p>例题2-环环相扣</p><h3 class=heading-element id=13rar压缩包ntfs数据流隐写><span>13、rar压缩包NTFS数据流隐写</span>
<a href=#13rar%e5%8e%8b%e7%bc%a9%e5%8c%85ntfs%e6%95%b0%e6%8d%ae%e6%b5%81%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>看到rar压缩包，可以用010打开看看，可能会存在NTFS数据流隐写</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251117200339111.png alt=/posts/1ad9200/imgs/image-20251117200339111.png height=1696 width=2940></p><p>有两种方法去提取这种数据</p><p>第一种方法就是直接用新版的7zip去打开提取</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251117200040072.png alt=/posts/1ad9200/imgs/image-20251117200040072.png height=389 width=1107></p><p>第二种就是用winrar解压后，用NtfsStreansEdutior工具提取</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251117200017615.png alt=/posts/1ad9200/imgs/image-20251117200017615.png height=596 width=1770></p><p>例题1-2023四川省网络与信息安全技能大赛 密码在这</p><p>例题2-2025浙江省赛 easySteg0</p><h2 class=heading-element id=misc视频题思路><span>Misc——视频题思路</span>
<a href=#misc%e8%a7%86%e9%a2%91%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>1、视频中的音频存在隐写</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 用 mkvtool 分离出 mka 音频，拉入Au看频谱图</span>
</span></span><span class=line><span class=cl><span class=c1># 也可以用 ffmpeg 分离出 mp3 或者 wav 音频，然后拉入Au看频谱图</span>
</span></span><span class=line><span class=cl>ffmpeg -i lion.mp4
</span></span><span class=line><span class=cl>ffmpeg -i lion.mp4 -map 0:2 -q:a <span class=m>0</span> output.wav</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250429115745570.png alt=/posts/1ad9200/imgs/image-20250429115745570.png height=1032 width=1920></p><p>2、可能是视频中的每一帧图片都有LSB隐写（2023 WMCTF）</p><p>3、循环读取视频每一帧图像中指定列的指定像素（2023 极客大挑战）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 创建一个视频读取对象，读取名为&#39;kira.mp4&#39;的视频文件。</span>
</span></span><span class=line><span class=cl><span class=n>video</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=s1>&#39;kira.mp4&#39;</span><span class=p>)</span>  <span class=c1># type: ignore</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># # 设置要提取的帧数，如现在指定的是第100帧</span>
</span></span><span class=line><span class=cl><span class=c1># video.set(cv2.CAP_PROP_POS_FRAMES, 100)</span>
</span></span><span class=line><span class=cl><span class=c1># # 读取视频的指定帧</span>
</span></span><span class=line><span class=cl><span class=c1># ret, frame = video.read()</span>
</span></span><span class=line><span class=cl><span class=c1># # 保存提取的帧为图像文件</span>
</span></span><span class=line><span class=cl><span class=c1># cv2.imwrite(&#39;1.png&#39;, frame)</span>
</span></span><span class=line><span class=cl><span class=c1># # 释放视频对象</span>
</span></span><span class=line><span class=cl><span class=c1># video.release()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定义视频的尺寸为1920x1080</span>
</span></span><span class=line><span class=cl><span class=n>video_size</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1920</span><span class=p>,</span> <span class=mi>1080</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># 设置起始像素为5</span>
</span></span><span class=line><span class=cl><span class=n>start_pixel</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=c1># 设置每个像素块的大小为10</span>
</span></span><span class=line><span class=cl><span class=n>size</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=c1># 创建一个新的图像对象，大小为视频尺寸除以像素块大小，即原视频的帧的抽样结果</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>video_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>//</span> <span class=n>size</span><span class=p>,</span> <span class=n>video_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>//</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># 初始化帧率计数为0</span>
</span></span><span class=line><span class=cl><span class=n>fps_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=c1># 循环读取每一帧图像中指定列的指定像素</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 当前正在读取视频的第</span><span class=si>{</span><span class=n>fps_count</span><span class=si>}</span><span class=s2>帧&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 从视频文件中读取一帧，success为是否成功读取帧的结果，frame为读取的帧</span>
</span></span><span class=line><span class=cl>    <span class=n>success</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>video</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 如果读取失败，跳出循环</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[X] 视频的第</span><span class=si>{</span><span class=n>fps_count</span><span class=si>}</span><span class=s2>帧读取失败&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=c1># 对每一行像素进行遍历，从视频的高度减去起始像素并除以像素块大小，得到需要遍历的行数</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>((</span><span class=n>video_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>start_pixel</span><span class=p>)</span><span class=o>//</span><span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 从当前行中获取一个像素，使用getpixel方法获取指定坐标处的像素，并将其转换为PIL图像格式</span>
</span></span><span class=line><span class=cl>            <span class=n>pixel</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span><span class=o>.</span><span class=n>getpixel</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>start_pixel</span><span class=o>+</span><span class=n>fps_count</span><span class=o>*</span><span class=n>size</span><span class=p>,</span> <span class=n>start_pixel</span><span class=o>+</span><span class=n>y</span><span class=o>*</span><span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># 将获取的像素值设置为抽样图像的对应像素位置的值</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>fps_count</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>pixel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=c1># 帧率计数加1，准备下一帧的处理</span>
</span></span><span class=line><span class=cl>    <span class=n>fps_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将抽样图像保存为&#39;out.png&#39;文件</span>
</span></span><span class=line><span class=cl><span class=n>out</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;out.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out</span><span class=o>.</span><span class=n>show</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>4、DeEgger Embedder隐写</p><p>可以直接使用 DeEgger Embedder 工具 extract files</p><p>例题-攻防世界 PyHaHa</p><h2 class=heading-element id=misc音频题思路><span>Misc——音频题思路</span>
<a href=#misc%e9%9f%b3%e9%a2%91%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=通用思路-1><span>通用思路</span>
<a href=#%e9%80%9a%e7%94%a8%e6%80%9d%e8%b7%af-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1波形图分析摩斯电码><span>1、波形图分析：摩斯电码</span>
<a href=#1%e6%b3%a2%e5%bd%a2%e5%9b%be%e5%88%86%e6%9e%90%e6%91%a9%e6%96%af%e7%94%b5%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=2频谱图分析有时要调高最高频率><span>2、频谱图分析(有时要调高最高频率)：</span>
<a href=#2%e9%a2%91%e8%b0%b1%e5%9b%be%e5%88%86%e6%9e%90%e6%9c%89%e6%97%b6%e8%a6%81%e8%b0%83%e9%ab%98%e6%9c%80%e9%ab%98%e9%a2%91%e7%8e%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h4 class=heading-element id=3sstv慢扫描电视><span>3、SSTV慢扫描电视：</span>
<a href=#3sstv%e6%85%a2%e6%89%ab%e6%8f%8f%e7%94%b5%e8%a7%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><strong>SSTV识别可以直接用这个项目里的脚本：https://github.com/colaclanth/sstv</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 安装步骤：</span>
</span></span><span class=line><span class=cl>sudo python3 setup.py install 
</span></span><span class=line><span class=cl><span class=c1># 注意python版本如果低于python3.9，需要将setup.py中的numpy那一行注释</span>
</span></span><span class=line><span class=cl><span class=c1># 使用命令如下，图片会自动命名为result.png</span>
</span></span><span class=line><span class=cl>sstv -d flag.wav</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241108232143418.png alt=/posts/1ad9200/imgs/image-20241108232143418.png height=318 width=1734></p><h5 class=heading-element id=windows中使用rx-sstv><span>Windows中使用RX-SSTV</span>
<a href=#windows%e4%b8%ad%e4%bd%bf%e7%94%a8rx-sstv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>使用前还要安装虚拟声卡 Virtual Audio Cable</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#使用步骤:</span>
</span></span><span class=line><span class=cl>1.点击Setup-Sound Control and Devices将默认输入设备和输出设备都设置为虚拟声卡line1
</span></span><span class=line><span class=cl>2.用VLC播放音频（最好不要用Au播放）
</span></span><span class=line><span class=cl>3.如果扫描出来的图片有错位，可以点击slant手动修改
</span></span><span class=line><span class=cl>4.退出RX-SSTV前要注意把默认的输入/输出设备改回原来的参数</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=拉入kali用qsstv有时候要用到反向和反相><span>拉入kali用qsstv（有时候要用到反向和反相）</span>
<a href=#%e6%8b%89%e5%85%a5kali%e7%94%a8qsstv%e6%9c%89%e6%97%b6%e5%80%99%e8%a6%81%e7%94%a8%e5%88%b0%e5%8f%8d%e5%90%91%e5%92%8c%e5%8f%8d%e7%9b%b8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h4 class=heading-element id=4电话音分析dtmf><span>4、电话音分析(DTMF)</span>
<a href=#4%e7%94%b5%e8%af%9d%e9%9f%b3%e5%88%86%e6%9e%90dtmf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>用在线网站解码:http://www.dialabc.com/sound/detect/</p><p>或者在Windows下使用<a href=https://github.com/ribt/dtmf-decoder target=_blank rel="external nofollow noopener noreferrer">ribt/dtmf-decoder</a>这个开源项目解密</p><p>上面工具的识别可能有误差，如果想要更加精确，可以尝试按照下面这个对照表用肉眼去看</p><blockquote><p>参考链接：https://blog.csdn.net/qawsedrf123lala/article/details/132084646</p></blockquote><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241229101546924.png alt=/posts/1ad9200/imgs/image-20241229101546924.png height=204 width=374></p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241229102346611.png alt=/posts/1ad9200/imgs/image-20241229102346611.png height=1529 width=2561></p><blockquote><p>Tips：如果音频中看不出来可以尝试在Au中把音频增幅，要求能看到两条白线</p></blockquote><h3 class=heading-element id=mp3思路><span>MP3思路</span>
<a href=#mp3%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1mp3stego隐写可以无密码><span>1、mp3stego隐写(可以无密码)</span>
<a href=#1mp3stego%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>使用前需要先把要处理的文件放到 mp3stego 目录下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Encode</span>
</span></span><span class=line><span class=cl>encode -E data.txt -P pass sound.wav sound.mp3    
</span></span><span class=line><span class=cl>data.txt里面放要隐写的txt信息 pass是解密时需要的密码
</span></span><span class=line><span class=cl><span class=c1># Decode</span>
</span></span><span class=line><span class=cl>decode -X -P pass sound.mp3   
</span></span><span class=line><span class=cl>-X 是提取出隐写的文件
</span></span><span class=line><span class=cl>pass是解密时需要的密码 
</span></span><span class=line><span class=cl>sound.mp3是待处理的MP3文件
</span></span><span class=line><span class=cl><span class=c1># mp3stego可以使用无密码进行隐写</span>
</span></span><span class=line><span class=cl><span class=c1># 如果需要密码解密，但是没有密码，可以试试看音频中歌曲的名字（比如Canon）</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=wav思路><span>WAV思路</span>
<a href=#wav%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=1silenteye隐写><span>1、Silenteye隐写</span>
<a href=#1silenteye%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>wav音频文件可能是<code>silenteye</code>隐写，可以拿<code>silenteye</code>用默认密码解密试试看</p><p>当然如果已知密钥的话就用密钥去解密</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20250429203026980.png alt=/posts/1ad9200/imgs/image-20250429203026980.png height=338 width=664></p><h4 class=heading-element id=2deepsound隐写可以无密码><span>2、Deepsound隐写（可以无密码）</span>
<a href=#2deepsound%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>可以先把 wav 音频文件拉入 deepsound 打开，如果下面有显示隐写的文件就是 deepsound 隐写</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251031123014232.png alt=/posts/1ad9200/imgs/image-20251031123014232.png height=1186 width=1598></p><p>隐写可以无密钥，但是如果提示需要密钥就直接填入密钥解密即可</p><p>如果是 deepsound 隐写并且密钥未知，可以先用 <a href=https://github.com/willstruggle/john/blob/master/deepsound2john.py target=_blank rel="external nofollow noopener noreferrer">deepsound2john</a> 脚本获取wav文件的哈希值(注释里有使用方法)</p><p>然后拉入kali用john爆破hash（如果编码有误，可以先用notepad另存为一下）</p><p>得到 hash后执行：john hash.txt</p><h4 class=heading-element id=3业余无线电数据><span>3、业余无线电数据：</span>
<a href=#3%e4%b8%9a%e4%bd%99%e6%97%a0%e7%ba%bf%e7%94%b5%e6%95%b0%e6%8d%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>先用sox把wav转为raw：</p><p>sox -t wav latlong.wav -esigned-integer -b16 -r 22050 -t raw latlong.raw</p><p>再用multimon-ng分析:</p><p>multimon-ng -t raw -a AFSK1200 latlong.raw</p><h4 class=heading-element id=4steghide隐写可以无密码><span>4、steghide隐写(可以无密码)</span>
<a href=#4steghide%e9%9a%90%e5%86%99%e5%8f%af%e4%bb%a5%e6%97%a0%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#如果密码已经知道了</span>
</span></span><span class=line><span class=cl>steghide extract -sf filename -p passwd</span></span></code></pre></td></tr></table></div></div><p>在WSL或者kali里用Stegseek跑（字典在wordlist里）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#如果密码未知</span>
</span></span><span class=line><span class=cl>可以用下面这个脚本爆破
</span></span><span class=line><span class=cl><span class=c1>#bruteStegHide.sh</span>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> line in <span class=sb>`</span>cat <span class=nv>$2</span><span class=sb>`</span><span class=p>;</span><span class=k>do</span>
</span></span><span class=line><span class=cl>    steghide extract -sf <span class=nv>$1</span> -p <span class=nv>$line</span> &gt; /dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s1>&#39;password is: &#39;</span><span class=nv>$line</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#或者在WSL或者kali里用Stegseek跑（字典在wordlist里）</span>
</span></span><span class=line><span class=cl>stegseek filename rockyou.txt</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=5openpuff隐写有密码><span>5、OpenPuff隐写（有密码）</span>
<a href=#5openpuff%e9%9a%90%e5%86%99%e6%9c%89%e5%af%86%e7%a0%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>直接用OpenPuff.exe解密即可</p><h4 class=heading-element id=6stegpy隐写><span>6、stegpy隐写</span>
<a href=#6stegpy%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><a href=https://github.com/izcoser/stegpy target=_blank rel="external nofollow noopener noreferrer">stegpy 开源地址</a> 下载好后直接用WSL输入以下命令并输入密码解密即可</p><p>也可以直接用 pip 安装： pip3 install stegpy</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>stegpy 1.wav -p</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=7deegger-embedder隐写><span>7、DeEgger Embedder隐写</span>
<a href=#7deegger-embedder%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>可以直接使用 DeEgger Embedder 工具 extract files</p><h4 class=heading-element id=8写脚本提取音频数据并分析><span>8、写脚本提取音频数据并分析</span>
<a href=#8%e5%86%99%e8%84%9a%e6%9c%ac%e6%8f%90%e5%8f%96%e9%9f%b3%e9%a2%91%e6%95%b0%e6%8d%ae%e5%b9%b6%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p>这种情况下就要求选手对音频数据有更深一步的理解</p><p>需要自己手动写脚本去提取音频的原始数据并进行分析</p><p>然后这里通常会用到下面这几个模块</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wave</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wavio</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scipy.io.wavfile</span> <span class=k>as</span> <span class=nn>wavfile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>soundfile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>librosa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. scipy.io.wavfile</span>
</span></span><span class=line><span class=cl><span class=n>samplerate</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;audio.wav&#39;</span><span class=p>)</span>  <span class=c1># 返回np.int16整数数据</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. soundfile  </span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>,</span> <span class=n>samplerate</span> <span class=o>=</span> <span class=n>soundfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;audio.wav&#39;</span><span class=p>)</span>  <span class=c1># 可以指定数据类型</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. librosa</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>,</span> <span class=n>samplerate</span> <span class=o>=</span> <span class=n>librosa</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;audio.wav&#39;</span><span class=p>,</span> <span class=n>sr</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>  <span class=c1># 返回浮点数，可重采样</span></span></span></code></pre></td></tr></table></div></div><p>在进行处理前可以先用下面这个脚本看看基础参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wave</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_info</span><span class=p>(</span><span class=n>wav_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>wave</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>wav_file</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>wf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>n_channels</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getnchannels</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>samplewidth_bytes</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getsampwidth</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>bits_per_sample</span> <span class=o>=</span> <span class=n>samplewidth_bytes</span> <span class=o>*</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>        <span class=n>framerate</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getframerate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>n_frames</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getnframes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>duration</span> <span class=o>=</span> <span class=n>n_frames</span> <span class=o>/</span> <span class=n>framerate</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;通道数: </span><span class=si>{</span><span class=n>n_channels</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;每个采样的字节数: </span><span class=si>{</span><span class=n>samplewidth_bytes</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;每个采样的位数: </span><span class=si>{</span><span class=n>bits_per_sample</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;采样率: </span><span class=si>{</span><span class=n>framerate</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;总帧数: </span><span class=si>{</span><span class=n>n_frames</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;时长(秒): </span><span class=si>{</span><span class=n>duration</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 通道数: 2</span>
</span></span><span class=line><span class=cl>    <span class=c1># 每个采样的字节数: 2</span>
</span></span><span class=line><span class=cl>    <span class=c1># 每个采样的位数: 16</span>
</span></span><span class=line><span class=cl>    <span class=c1># 采样率: 44100</span>
</span></span><span class=line><span class=cl>    <span class=c1># 总帧数: 6804591</span>
</span></span><span class=line><span class=cl>    <span class=c1># 时长(秒): 154.2991156462585</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=提取wav中lsb隐写的数据><span>提取WAV中LSB隐写的数据</span>
<a href=#%e6%8f%90%e5%8f%96wav%e4%b8%adlsb%e9%9a%90%e5%86%99%e7%9a%84%e6%95%b0%e6%8d%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wave</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_lsb</span><span class=p>(</span><span class=n>wav_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>wave</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>wav_file</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>wf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sample_width</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getsampwidth</span><span class=p>()</span> <span class=c1># # 获取每个采样的字节数</span>
</span></span><span class=line><span class=cl>        <span class=n>n_frames</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>getnframes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>frame_data</span> <span class=o>=</span> <span class=n>wf</span><span class=o>.</span><span class=n>readframes</span><span class=p>(</span><span class=n>n_frames</span><span class=p>)</span>  <span class=c1># 读取2000个采样点需要的字节</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(type(frame_data)) # &lt;class &#39;bytes&#39;&gt;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>sample_width</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># 16位采样，每2个字节组成一个采样点</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>n_frames</span><span class=p>,</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 将数据从小端序转换为大端序，因为WAV文件使用小端序存储数据</span>
</span></span><span class=line><span class=cl>                <span class=n>sample</span> <span class=o>=</span> <span class=n>frame_data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>|</span> <span class=p>(</span><span class=n>frame_data</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>sample</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>  <span class=c1># 8位采样</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>frame_data</span><span class=p>),</span> <span class=mi>1000</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>frame_data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] 二进制字符串长度:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] 提取出的 LSB 信息:&#34;</span><span class=p>,</span> <span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=n>res</span><span class=p>)[:</span><span class=mi>100</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  7avpassword:NO996!</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2022 CISCN 华南分区赛 Ste9ano9raphy 6inary</p><h5 class=heading-element id=提取并分析wav左右声道的差值><span>提取并分析WAV左右声道的差值</span>
<a href=#%e6%8f%90%e5%8f%96%e5%b9%b6%e5%88%86%e6%9e%90wav%e5%b7%a6%e5%8f%b3%e5%a3%b0%e9%81%93%e7%9a%84%e5%b7%ae%e5%80%bc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scipy.io.wavfile</span> <span class=k>as</span> <span class=nn>wavfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sample_rate</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s2>&#34;1.wav&#34;</span><span class=p>)</span> <span class=c1># 读取音频文件的采样率和数据</span>
</span></span><span class=line><span class=cl><span class=c1># print(sample_rate, data)</span>
</span></span><span class=line><span class=cl><span class=c1># 创建两个列表来存储左右两声道的数据</span>
</span></span><span class=line><span class=cl><span class=n>left</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>right</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 第一列的数据是左声道，第二列是右声道</span>
</span></span><span class=line><span class=cl>    <span class=n>left</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>right</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>diff</span> <span class=o>=</span> <span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>left</span><span class=o>-</span><span class=n>right</span><span class=p>)</span> <span class=k>for</span> <span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>diff</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;2&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>item</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;res.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>res</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=使用脚本提取wav数据进行分析><span>使用脚本提取WAV数据进行分析</span>
<a href=#%e4%bd%bf%e7%94%a8%e8%84%9a%e6%9c%ac%e6%8f%90%e5%8f%96wav%e6%95%b0%e6%8d%ae%e8%bf%9b%e8%a1%8c%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 2023 DASCTFxCBCTF</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>wave</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scipy.fftpack</span> <span class=k>as</span> <span class=nn>fftpack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>SAMPLE_RATE</span> <span class=o>=</span> <span class=mi>44100</span> <span class=c1># 表示采样率，即每秒钟有多少采样点</span>
</span></span><span class=line><span class=cl><span class=n>SAMPLE_TIME</span> <span class=o>=</span> <span class=mf>0.1</span> <span class=c1># 表示一个样本的时间，即0.1秒</span>
</span></span><span class=line><span class=cl><span class=n>SAMPLE_NUM</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>SAMPLE_RATE</span> <span class=o>*</span> <span class=n>SAMPLE_TIME</span><span class=p>)</span> <span class=c1># 计算在SAMPLE_TIME时间内的采样点数</span>
</span></span><span class=line><span class=cl><span class=n>LIST</span> <span class=o>=</span> <span class=p>[</span><span class=mi>800</span><span class=p>,</span> <span class=mi>900</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>1100</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1300</span><span class=p>,</span> <span class=mi>1400</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>1600</span><span class=p>,</span> <span class=mi>1700</span><span class=p>]</span>   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_len</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>wave</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;1.wav&#39;</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 使用numpy从音频文件中读取所有的帧并将其转换为int16数据类型的数组</span>
</span></span><span class=line><span class=cl>        <span class=n>wav_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>frombuffer</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>readframes</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span><span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>wav_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#这实际上计算了wav文件的总时长（以0.1秒为单位）</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>N</span><span class=o>/</span><span class=p>(</span><span class=mi>44100</span><span class=o>*</span><span class=mf>0.1</span><span class=p>))</span> <span class=o>/</span> <span class=mi>189</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 傅立叶变换函数。给定时域数据，该函数返回其频域形式的前半部分</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fft</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>                                   <span class=c1>#获取数据长度</span>
</span></span><span class=line><span class=cl>    <span class=n>fft_data</span> <span class=o>=</span> <span class=n>fftpack</span><span class=o>.</span><span class=n>fft</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>                    <span class=c1>#得到频域信号                      </span>
</span></span><span class=line><span class=cl>    <span class=n>abs_fft</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>fft_data</span><span class=p>)</span>                      <span class=c1>#计算幅值    </span>
</span></span><span class=line><span class=cl>    <span class=n>abs_fft</span> <span class=o>=</span> <span class=n>abs_fft</span><span class=o>/</span><span class=p>(</span><span class=n>N</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>                             
</span></span><span class=line><span class=cl>    <span class=n>half_fft</span> <span class=o>=</span> <span class=n>abs_fft</span><span class=p>[</span><span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=o>//</span><span class=mi>2</span><span class=p>)]</span>                 <span class=c1>#取频域信号的前半部分</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>half_fft</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 此函数旨在解码100ms的音频数据。它首先对音频数据进行FFT变换，然后检查LIST中的每个频率，以确定哪些频率具有明显的活动（幅值大于0.8）  </span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dec_100ms</span><span class=p>(</span><span class=n>wave_data_100_ms</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>fft_ret</span> <span class=o>=</span> <span class=n>fft</span><span class=p>(</span><span class=n>wave_data_100_ms</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>freq</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>LIST</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>fft_ret</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>freq</span><span class=o>*</span><span class=n>SAMPLE_TIME</span><span class=p>)</span> <span class=o>-</span> <span class=mi>2</span> <span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>freq</span><span class=o>*</span><span class=n>SAMPLE_TIME</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>freq</span><span class=p>,</span> <span class=s1>&#39;Hz有值&#39;</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>index</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 解码整个音频文件中的句子。它首先确定音频中有多少个100ms的段，然后每次解码两个段来生成一个两位数的索引，该索引用于查找与之对应的字符</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dec_sentence</span><span class=p>(</span><span class=n>wav_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_100ms_count</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>wav_data</span><span class=p>)</span> <span class=o>//</span> <span class=n>SAMPLE_NUM</span>    
</span></span><span class=line><span class=cl>    <span class=c1># print(_100ms_count) </span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;待解码音频包含&#39;</span><span class=p>,</span> <span class=n>_100ms_count</span> <span class=o>//</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;个字&#39;</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>_100ms_count</span><span class=p>,</span> <span class=mi>2</span><span class=p>):</span>              
</span></span><span class=line><span class=cl>        <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>index</span> <span class=o>=</span> <span class=n>index</span><span class=o>*</span><span class=mi>10</span> <span class=o>+</span> <span class=n>dec_100ms</span><span class=p>(</span><span class=n>wav_data</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=n>SAMPLE_NUM</span> <span class=o>+</span> <span class=n>k</span><span class=o>*</span><span class=n>SAMPLE_NUM</span> <span class=p>:</span> <span class=n>i</span><span class=o>*</span><span class=n>SAMPLE_NUM</span> <span class=o>+</span> <span class=p>(</span><span class=n>k</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=n>SAMPLE_NUM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;序号:&#39;</span><span class=p>,</span> <span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=o>+=</span> <span class=n>string</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># get_len()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 题目给了一个字符串序列，所以就是从音频中提取出index，然后根据index找到对应的字符</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span> <span class=o>=</span><span class=s2>&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_}{-?!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>wave</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;1.wav&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>          <span class=c1>#读取为数组</span>
</span></span><span class=line><span class=cl>        <span class=n>wav_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>frombuffer</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>readframes</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>dec_sentence</span><span class=p>(</span><span class=n>wav_data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># DASCTF{Wh1stling_t0_Convey_informat1on!!!}</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=提取两个wav音频中的浮点集并分析><span>提取两个WAV音频中的浮点集并分析</span>
<a href=#%e6%8f%90%e5%8f%96%e4%b8%a4%e4%b8%aawav%e9%9f%b3%e9%a2%91%e4%b8%ad%e7%9a%84%e6%b5%ae%e7%82%b9%e9%9b%86%e5%b9%b6%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>例题1-2024极客大挑战-音乐大师</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>librosa</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>libnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;19&#39;</span><span class=p>:</span><span class=s2>&#34;01&#34;</span><span class=p>,</span><span class=s2>&#34;9&#34;</span><span class=p>:</span><span class=s2>&#34;00&#34;</span><span class=p>,</span><span class=s2>&#34;39&#34;</span><span class=p>:</span><span class=s2>&#34;11&#34;</span><span class=p>,</span><span class=s2>&#34;29&#34;</span><span class=p>:</span><span class=s2>&#34;10&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1># 使用文件原始采样率获取音频数据和采样率</span>
</span></span><span class=line><span class=cl><span class=n>data1</span><span class=p>,</span><span class=n>sr1</span> <span class=o>=</span> <span class=n>librosa</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&#34;secret.wav&#34;</span><span class=p>,</span><span class=n>sr</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span><span class=n>dtype</span><span class=o>=</span><span class=s2>&#34;float32&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data2</span><span class=p>,</span><span class=n>sr2</span> <span class=o>=</span> <span class=n>librosa</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&#34;1.wav&#34;</span><span class=p>,</span><span class=n>sr</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span><span class=n>dtype</span><span class=o>=</span><span class=s2>&#34;float32&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>148</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>((</span><span class=n>data1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>data2</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>*</span><span class=mf>1e7</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=n>table</span><span class=p>[</span><span class=n>item</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>libnum</span><span class=o>.</span><span class=n>b2s</span><span class=p>(</span><span class=n>flag</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># b&#39;SYC{wav_LSB_but_You_can_get_M3_Coll!}&#39;</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=提取音频数据并转为图片><span>提取音频数据并转为图片</span>
<a href=#%e6%8f%90%e5%8f%96%e9%9f%b3%e9%a2%91%e6%95%b0%e6%8d%ae%e5%b9%b6%e8%bd%ac%e4%b8%ba%e5%9b%be%e7%89%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.io</span> <span class=kn>import</span> <span class=n>wavfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func1</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>sample_rate</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s2>&#34;flag.wav&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,[</span><span class=n>l</span><span class=p>,</span><span class=n>r</span><span class=p>]</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>[:</span><span class=mi>100</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>idx</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>,</span> <span class=n>g</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>l</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>r</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>l</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>g</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>l</span><span class=p>,</span><span class=n>r</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>sample_rate</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s2>&#34;flag.wav&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;RGBA&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>1021</span><span class=p>,</span> <span class=mi>761</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>761</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1021</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>y</span> <span class=o>*</span> <span class=mi>1021</span><span class=p>)</span> <span class=o>*</span> <span class=mi>5</span> <span class=c1># 5个采样点一组</span>
</span></span><span class=line><span class=cl>            <span class=n>left_val</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># 左声道的数据</span>
</span></span><span class=line><span class=cl>            <span class=n>right_val</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=c1># 右声道的数据</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span> <span class=o>=</span> <span class=p>(</span><span class=n>left_val</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>left_val</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>    <span class=c1># 高 8 位 -&gt; R，低 8 位 -&gt; G</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>right_val</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>right_val</span> <span class=o>&amp;</span> <span class=mh>0xFF</span>  <span class=c1># 高 8 位 -&gt; B，低 8 位 -&gt; A</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>g</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=c1># np.int16 转为 int 类型</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;flag.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func1</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2025 浙江省赛-Really Good Binaural Audio</p><h5 class=heading-element id=音频频率映射到字符><span>音频频率映射到字符</span>
<a href=#%e9%9f%b3%e9%a2%91%e9%a2%91%e7%8e%87%e6%98%a0%e5%b0%84%e5%88%b0%e5%ad%97%e7%ac%a6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.io</span> <span class=kn>import</span> <span class=n>wavfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 常量定义</span>
</span></span><span class=line><span class=cl><span class=n>DEFAULT_CHUNK_DURATION_MS</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># 默认分析块时长（毫秒）</span>
</span></span><span class=line><span class=cl><span class=n>FREQ_DIFF_THRESHOLD</span> <span class=o>=</span> <span class=mi>30</span>         <span class=c1># 频率差异阈值</span>
</span></span><span class=line><span class=cl><span class=n>LOW_FREQ_THRESHOLD</span> <span class=o>=</span> <span class=mi>100</span>         <span class=c1># 低频噪声阈值</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 频率与字符的对照表</span>
</span></span><span class=line><span class=cl><span class=n>FREQ_MAP</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 小写字母</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=mi>440</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=mi>466</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=mi>494</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>:</span> <span class=mi>523</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>:</span> <span class=mi>554</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;f&#39;</span><span class=p>:</span> <span class=mi>587</span><span class=p>,</span> <span class=s1>&#39;g&#39;</span><span class=p>:</span> <span class=mi>622</span><span class=p>,</span> <span class=s1>&#39;h&#39;</span><span class=p>:</span> <span class=mi>659</span><span class=p>,</span> <span class=s1>&#39;i&#39;</span><span class=p>:</span> <span class=mi>698</span><span class=p>,</span> <span class=s1>&#39;j&#39;</span><span class=p>:</span> <span class=mi>740</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;k&#39;</span><span class=p>:</span> <span class=mi>784</span><span class=p>,</span> <span class=s1>&#39;l&#39;</span><span class=p>:</span> <span class=mi>830</span><span class=p>,</span> <span class=s1>&#39;m&#39;</span><span class=p>:</span> <span class=mi>880</span><span class=p>,</span> <span class=s1>&#39;n&#39;</span><span class=p>:</span> <span class=mi>932</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>:</span> <span class=mi>988</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;p&#39;</span><span class=p>:</span> <span class=mi>1047</span><span class=p>,</span> <span class=s1>&#39;q&#39;</span><span class=p>:</span> <span class=mi>1109</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>:</span> <span class=mi>1175</span><span class=p>,</span> <span class=s1>&#39;s&#39;</span><span class=p>:</span> <span class=mi>1245</span><span class=p>,</span> <span class=s1>&#39;t&#39;</span><span class=p>:</span> <span class=mi>1319</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;u&#39;</span><span class=p>:</span> <span class=mi>1397</span><span class=p>,</span> <span class=s1>&#39;v&#39;</span><span class=p>:</span> <span class=mi>1480</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>:</span> <span class=mi>1568</span><span class=p>,</span> <span class=s1>&#39;x&#39;</span><span class=p>:</span> <span class=mi>1661</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>:</span> <span class=mi>1760</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>:</span> <span class=mi>1865</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 数字</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;1&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>:</span> <span class=mi>2000</span><span class=p>,</span> <span class=s1>&#39;3&#39;</span><span class=p>:</span> <span class=mi>3000</span><span class=p>,</span> <span class=s1>&#39;4&#39;</span><span class=p>:</span> <span class=mi>4000</span><span class=p>,</span> <span class=s1>&#39;5&#39;</span><span class=p>:</span> <span class=mi>5000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;6&#39;</span><span class=p>:</span> <span class=mi>6000</span><span class=p>,</span> <span class=s1>&#39;7&#39;</span><span class=p>:</span> <span class=mi>7000</span><span class=p>,</span> <span class=s1>&#39;8&#39;</span><span class=p>:</span> <span class=mi>8000</span><span class=p>,</span> <span class=s1>&#39;9&#39;</span><span class=p>:</span> <span class=mi>9000</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>:</span> <span class=mi>10000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 大写字母（比对应小写字母稍高频率）</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=mi>445</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=mi>471</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=mi>499</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>:</span> <span class=mi>528</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>:</span> <span class=mi>559</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;F&#39;</span><span class=p>:</span> <span class=mi>592</span><span class=p>,</span> <span class=s1>&#39;G&#39;</span><span class=p>:</span> <span class=mi>627</span><span class=p>,</span> <span class=s1>&#39;H&#39;</span><span class=p>:</span> <span class=mi>664</span><span class=p>,</span> <span class=s1>&#39;I&#39;</span><span class=p>:</span> <span class=mi>703</span><span class=p>,</span> <span class=s1>&#39;J&#39;</span><span class=p>:</span> <span class=mi>745</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;K&#39;</span><span class=p>:</span> <span class=mi>789</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>:</span> <span class=mi>835</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>:</span> <span class=mi>885</span><span class=p>,</span> <span class=s1>&#39;N&#39;</span><span class=p>:</span> <span class=mi>937</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>:</span> <span class=mi>993</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;P&#39;</span><span class=p>:</span> <span class=mi>1052</span><span class=p>,</span> <span class=s1>&#39;Q&#39;</span><span class=p>:</span> <span class=mi>1114</span><span class=p>,</span> <span class=s1>&#39;R&#39;</span><span class=p>:</span> <span class=mi>1180</span><span class=p>,</span> <span class=s1>&#39;S&#39;</span><span class=p>:</span> <span class=mi>1250</span><span class=p>,</span> <span class=s1>&#39;T&#39;</span><span class=p>:</span> <span class=mi>1324</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;U&#39;</span><span class=p>:</span> <span class=mi>1402</span><span class=p>,</span> <span class=s1>&#39;V&#39;</span><span class=p>:</span> <span class=mi>1485</span><span class=p>,</span> <span class=s1>&#39;W&#39;</span><span class=p>:</span> <span class=mi>1573</span><span class=p>,</span> <span class=s1>&#39;X&#39;</span><span class=p>:</span> <span class=mi>1666</span><span class=p>,</span> <span class=s1>&#39;Y&#39;</span><span class=p>:</span> <span class=mi>1765</span><span class=p>,</span> <span class=s1>&#39;Z&#39;</span><span class=p>:</span> <span class=mi>1870</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_closest_char</span><span class=p>(</span><span class=n>target_freq</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>FREQ_MAP</span> <span class=ow>or</span> <span class=n>target_freq</span> <span class=o>&lt;</span> <span class=n>LOW_FREQ_THRESHOLD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 找到最接近的频率对应的字符</span>
</span></span><span class=line><span class=cl>    <span class=n>closest_char</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>FREQ_MAP</span><span class=o>.</span><span class=n>keys</span><span class=p>(),</span> 
</span></span><span class=line><span class=cl>                      <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>char</span><span class=p>:</span> <span class=nb>abs</span><span class=p>(</span><span class=n>FREQ_MAP</span><span class=p>[</span><span class=n>char</span><span class=p>]</span> <span class=o>-</span> <span class=n>target_freq</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 检查频率差异是否在可接受范围内</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>FREQ_MAP</span><span class=p>[</span><span class=n>closest_char</span><span class=p>]</span> <span class=o>-</span> <span class=n>target_freq</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>FREQ_DIFF_THRESHOLD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>closest_char</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_wav_sequentially</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>chunk_duration_ms</span><span class=o>=</span><span class=n>DEFAULT_CHUNK_DURATION_MS</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sample_rate</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>wavfile</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 如果是立体声，只使用左声道</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>ndim</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 计算每个块的大小（样本数）</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>sample_rate</span> <span class=o>*</span> <span class=n>chunk_duration_ms</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>num_chunks</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>//</span> <span class=n>chunk_size</span>
</span></span><span class=line><span class=cl>    <span class=n>decoded_chars</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>last_char</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 采样率: </span><span class=si>{</span><span class=n>sample_rate</span><span class=si>}</span><span class=s2> Hz, 块时长: </span><span class=si>{</span><span class=n>chunk_duration_ms</span><span class=si>}</span><span class=s2> ms, 总块数: </span><span class=si>{</span><span class=n>num_chunks</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_chunks</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=n>i</span> <span class=o>*</span> <span class=n>chunk_size</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=n>chunk_size</span>
</span></span><span class=line><span class=cl>        <span class=n>chunk</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 对当前块进行 FFT 分析</span>
</span></span><span class=line><span class=cl>        <span class=n>fft_spectrum</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfft</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fft_freq</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfftfreq</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>),</span> <span class=mf>1.0</span> <span class=o>/</span> <span class=n>sample_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 找到主频率（忽略直流分量）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>fft_spectrum</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>peak_index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>fft_spectrum</span><span class=p>[</span><span class=mi>1</span><span class=p>:]))</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>dominant_frequency</span> <span class=o>=</span> <span class=n>fft_freq</span><span class=p>[</span><span class=n>peak_index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 查找对应的字符</span>
</span></span><span class=line><span class=cl>            <span class=n>char</span> <span class=o>=</span> <span class=n>find_closest_char</span><span class=p>(</span><span class=n>dominant_frequency</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 为了避免一个长音被重复记录，只有当字符变化时才记录</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>char</span> <span class=ow>and</span> <span class=n>char</span> <span class=o>!=</span> <span class=n>last_char</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>decoded_chars</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>last_char</span> <span class=o>=</span> <span class=n>char</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>final_message</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decoded_chars</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 解码出的字符序列: </span><span class=si>{</span><span class=n>final_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 字符数量: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>decoded_chars</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>final_message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>    
</span></span><span class=line><span class=cl>    <span class=n>wav_file</span> <span class=o>=</span> <span class=s2>&#34;video.wav&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>analyze_wav_sequentially</span><span class=p>(</span><span class=n>wav_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>func</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=midi-思路><span>MIDI 思路</span>
<a href=#midi-%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=直接用audacity打开可以看到字符><span>直接用audacity打开可以看到字符</span>
<a href=#%e7%9b%b4%e6%8e%a5%e7%94%a8audacity%e6%89%93%e5%bc%80%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%e5%ad%97%e7%ac%a6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251117213142553.png alt=/posts/1ad9200/imgs/image-20251117213142553.png height=583 width=1400></p><h4 class=heading-element id=velato编程语言><span>velato编程语言</span>
<a href=#velato%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>项目地址：https://velato.net/</p><p>例题1-2020祥云杯 带音乐家</p><p>例题2-2022 0xGame Week4 听首音乐？</p><h4 class=heading-element id=从流量中提取midi文件><span>从流量中提取MIDI文件</span>
<a href=#%e4%bb%8e%e6%b5%81%e9%87%8f%e4%b8%ad%e6%8f%90%e5%8f%96midi%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251118154114092.png alt=/posts/1ad9200/imgs/image-20251118154114092.png height=1836 width=2804></p><p>这里恢复的时候要注意结合发送数据的时间戳</p><p>Midi数据(一共三字节)：第一字节代表事件(note on/note off)，第二字节代表音符，第三字节代表力度</p><p>然后这里还有可能通过 Midi 音符的排列传输二维码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mido</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PPQ</span> <span class=o>=</span> <span class=mi>480</span>  <span class=c1># 每四分音符的 tick 数</span>
</span></span><span class=line><span class=cl><span class=n>BPM</span> <span class=o>=</span> <span class=mf>120.0</span>  <span class=c1># 节拍速度</span>
</span></span><span class=line><span class=cl><span class=n>MIN_DURATION_MS</span> <span class=o>=</span> <span class=mf>120.0</span>  <span class=c1># 音符最小持续时间（毫秒）</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_midi_events</span><span class=p>(</span><span class=n>input_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(lines) # 1722159321.608646000\t904064</span>
</span></span><span class=line><span class=cl>    <span class=n>events</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>parts</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ts_str</span><span class=p>,</span> <span class=n>hexdata</span> <span class=o>=</span> <span class=n>parts</span>
</span></span><span class=line><span class=cl>        <span class=n>ts</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>ts_str</span><span class=p>)</span>  <span class=c1># 时间戳</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>hexdata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=mh>0x90</span> <span class=o>&lt;=</span> <span class=n>status</span> <span class=o>&lt;=</span> <span class=mh>0x9F</span> <span class=ow>and</span> <span class=n>velocity</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>events</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ts</span><span class=p>,</span> <span class=s2>&#34;note_on&#34;</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=mh>0x80</span> <span class=o>&lt;=</span> <span class=n>status</span> <span class=o>&lt;=</span> <span class=mh>0x8F</span> <span class=ow>or</span> <span class=p>(</span><span class=mh>0x90</span> <span class=o>&lt;=</span> <span class=n>status</span> <span class=o>&lt;=</span> <span class=mh>0x9F</span> <span class=ow>and</span> <span class=n>velocity</span> <span class=o>==</span> <span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>events</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ts</span><span class=p>,</span> <span class=s2>&#34;note_off&#34;</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>events</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>group_rows</span><span class=p>(</span><span class=n>events</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rows</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>current</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>prev</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 只使用 note_on 事件来分组行</span>
</span></span><span class=line><span class=cl>    <span class=n>note_on_events</span> <span class=o>=</span> <span class=p>[</span><span class=n>ev</span> <span class=k>for</span> <span class=n>ev</span> <span class=ow>in</span> <span class=n>events</span> <span class=k>if</span> <span class=n>ev</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;note_on&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ts</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span> <span class=ow>in</span> <span class=n>note_on_events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 如果大于阈值0.01s，就是下一行的数据</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>prev</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>ts</span> <span class=o>-</span> <span class=n>prev</span> <span class=o>&gt;</span> <span class=mf>0.01</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>rows</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>current</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>current</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>current</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>note</span><span class=p>)</span>  <span class=c1># 同一行的都加入</span>
</span></span><span class=line><span class=cl>        <span class=n>prev</span> <span class=o>=</span> <span class=n>ts</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=n>rows</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>current</span><span class=p>)</span>  <span class=c1># 添加一整行的数据</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>rows</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>render_matrix</span><span class=p>(</span><span class=n>rows</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>note_set</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>  <span class=c1># 利用集合去重</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>row</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>note_set</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># print(note_set)</span>
</span></span><span class=line><span class=cl>    <span class=n>all_notes</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>note_set</span><span class=p>)</span>  <span class=c1># 从小到大排序</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(all_notes)</span>
</span></span><span class=line><span class=cl>    <span class=n>note_to_idx</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 音符对应到列</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>note</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>all_notes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>note_to_idx</span><span class=p>[</span><span class=n>note</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>H</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>rows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>W</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>all_notes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>H</span><span class=p>,</span> <span class=n>W</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>rows</span><span class=p>):</span>  <span class=c1># 填充矩阵</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>row</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>col</span> <span class=o>=</span> <span class=n>note_to_idx</span><span class=p>[</span><span class=n>n</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>matrix</span><span class=p>[</span><span class=n>y</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>matrix</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save_png</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>out_img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 矩阵中大于 0 的置为 0（黑色），等于 0 的置为 255（白色）</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>fromarray</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>matrix</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s2>&#34;uint8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>H</span><span class=p>,</span> <span class=n>W</span> <span class=o>=</span> <span class=n>matrix</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=n>W</span> <span class=o>*</span> <span class=mi>20</span><span class=p>,</span> <span class=n>H</span> <span class=o>*</span> <span class=mi>20</span><span class=p>),</span> <span class=n>Image</span><span class=o>.</span><span class=n>NEAREST</span><span class=p>)</span>  <span class=c1># 放大二维码</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>out_img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 图像已保存：</span><span class=si>{</span><span class=n>out_img</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>enforce_min_note_duration</span><span class=p>(</span><span class=n>events</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 按需延长 Note Off 的时间，保证音符不少于 MIN_DURATION_MS</span>
</span></span><span class=line><span class=cl>    <span class=n>min_duration</span> <span class=o>=</span> <span class=n>MIN_DURATION_MS</span> <span class=o>/</span> <span class=mf>1000.0</span>
</span></span><span class=line><span class=cl>    <span class=n>active_notes</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 记录活跃的 note_on 事件</span>
</span></span><span class=line><span class=cl>    <span class=n>processed_events</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ts</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span> <span class=o>=</span> <span class=n>event</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event_type</span> <span class=o>==</span> <span class=s2>&#34;note_on&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span> <span class=o>=</span> <span class=n>note</span>
</span></span><span class=line><span class=cl>            <span class=n>active_notes</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>ts</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>processed_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>event_type</span> <span class=o>==</span> <span class=s2>&#34;note_off&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span> <span class=o>=</span> <span class=n>note</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>active_notes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>start_ts</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>active_notes</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>min_end</span> <span class=o>=</span> <span class=n>start_ts</span> <span class=o>+</span> <span class=n>min_duration</span>
</span></span><span class=line><span class=cl>                <span class=c1># 如果持续时间太短，延长 Note Off 的时间戳</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>ts</span> <span class=o>&lt;</span> <span class=n>min_end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>new_event</span> <span class=o>=</span> <span class=p>(</span><span class=n>min_end</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>processed_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>processed_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>del</span> <span class=n>active_notes</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>processed_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 对处理后的事件按时间戳排序</span>
</span></span><span class=line><span class=cl>    <span class=n>processed_events</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>processed_events</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_midi</span><span class=p>(</span><span class=n>events</span><span class=p>,</span> <span class=n>output_midi</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 确保所有音符都有最小持续时间</span>
</span></span><span class=line><span class=cl>    <span class=n>processed_events</span> <span class=o>=</span> <span class=n>enforce_min_note_duration</span><span class=p>(</span><span class=n>events</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 创建 MIDI 文件</span>
</span></span><span class=line><span class=cl>    <span class=n>mid</span> <span class=o>=</span> <span class=n>mido</span><span class=o>.</span><span class=n>MidiFile</span><span class=p>(</span><span class=n>ticks_per_beat</span><span class=o>=</span><span class=n>PPQ</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>track</span> <span class=o>=</span> <span class=n>mido</span><span class=o>.</span><span class=n>MidiTrack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>mid</span><span class=o>.</span><span class=n>tracks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>track</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 设置曲速</span>
</span></span><span class=line><span class=cl>    <span class=n>tempo_us</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>mido</span><span class=o>.</span><span class=n>bpm2tempo</span><span class=p>(</span><span class=n>BPM</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>track</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mido</span><span class=o>.</span><span class=n>MetaMessage</span><span class=p>(</span><span class=s2>&#34;set_tempo&#34;</span><span class=p>,</span> <span class=n>tempo</span><span class=o>=</span><span class=n>tempo_us</span><span class=p>,</span> <span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 将事件转换为MIDI消息</span>
</span></span><span class=line><span class=cl>    <span class=n>prev_time</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>processed_events</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>processed_events</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>processed_events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ts</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>note</span><span class=p>,</span> <span class=n>velocity</span> <span class=o>=</span> <span class=n>event</span>
</span></span><span class=line><span class=cl>        <span class=n>rel_time</span> <span class=o>=</span> <span class=n>ts</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算与前一个事件的时间差（秒）</span>
</span></span><span class=line><span class=cl>        <span class=n>delta</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>rel_time</span> <span class=o>-</span> <span class=n>prev_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 将秒转换为 MIDI tick 数</span>
</span></span><span class=line><span class=cl>        <span class=n>ticks</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>round</span><span class=p>(</span><span class=n>mido</span><span class=o>.</span><span class=n>second2tick</span><span class=p>(</span><span class=n>delta</span><span class=p>,</span> <span class=n>PPQ</span><span class=p>,</span> <span class=n>tempo_us</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 创建MIDI消息</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event_type</span> <span class=o>==</span> <span class=s2>&#34;note_on&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span> <span class=o>=</span> <span class=n>mido</span><span class=o>.</span><span class=n>Message</span><span class=p>(</span><span class=s2>&#34;note_on&#34;</span><span class=p>,</span> <span class=n>note</span><span class=o>=</span><span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=o>=</span><span class=n>velocity</span><span class=p>,</span> <span class=n>time</span><span class=o>=</span><span class=n>ticks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>event_type</span> <span class=o>==</span> <span class=s2>&#34;note_off&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span> <span class=o>=</span> <span class=n>mido</span><span class=o>.</span><span class=n>Message</span><span class=p>(</span><span class=s2>&#34;note_off&#34;</span><span class=p>,</span> <span class=n>note</span><span class=o>=</span><span class=n>note</span><span class=p>,</span> <span class=n>velocity</span><span class=o>=</span><span class=n>velocity</span><span class=p>,</span> <span class=n>time</span><span class=o>=</span><span class=n>ticks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=n>track</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>prev_time</span> <span class=o>=</span> <span class=n>rel_time</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>track</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mido</span><span class=o>.</span><span class=n>MetaMessage</span><span class=p>(</span><span class=s2>&#34;end_of_track&#34;</span><span class=p>,</span> <span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>mid</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>output_midi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] MIDI 文件已保存：</span><span class=si>{</span><span class=n>output_midi</span><span class=si>}</span><span class=s2>（共 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>processed_events</span><span class=p>)</span><span class=si>}</span><span class=s2> 个事件）&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>input_data</span> <span class=o>=</span> <span class=s2>&#34;1.txt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out_img</span> <span class=o>=</span> <span class=s2>&#34;1.png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>out_midi</span> <span class=o>=</span> <span class=s2>&#34;1.mid&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>events</span> <span class=o>=</span> <span class=n>parse_midi_events</span><span class=p>(</span><span class=n>input_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 提取到 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>events</span><span class=p>)</span><span class=si>}</span><span class=s2> 个 MIDI 事件&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>build_midi</span><span class=p>(</span><span class=n>events</span><span class=p>,</span> <span class=n>out_midi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 生成图像（只使用 note_on 事件）</span>
</span></span><span class=line><span class=cl>    <span class=n>note_on_events</span> <span class=o>=</span> <span class=p>[</span><span class=n>ev</span> <span class=k>for</span> <span class=n>ev</span> <span class=ow>in</span> <span class=n>events</span> <span class=k>if</span> <span class=n>ev</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;note_on&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 其中 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>note_on_events</span><span class=p>)</span><span class=si>}</span><span class=s2> 个 NOTE ON 事件&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>rows</span> <span class=o>=</span> <span class=n>group_rows</span><span class=p>(</span><span class=n>events</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] 分成 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>rows</span><span class=p>)</span><span class=si>}</span><span class=s2> 行&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>matrix</span> <span class=o>=</span> <span class=n>render_matrix</span><span class=p>(</span><span class=n>rows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>save_png</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>out_img</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>例题1-2025浙江省赛 小小作曲家</p><h4 class=heading-element id=lsb隐写><span>LSB隐写</span>
<a href=#lsb%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mido</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_lsb_from_midi</span><span class=p>(</span><span class=n>midi_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>mid</span> <span class=o>=</span> <span class=n>mido</span><span class=o>.</span><span class=n>MidiFile</span><span class=p>(</span><span class=n>midi_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>binary_data</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>track</span> <span class=ow>in</span> <span class=n>mid</span><span class=o>.</span><span class=n>tracks</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>track</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>msg</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;note_on&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>velocity</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>velocity</span>
</span></span><span class=line><span class=cl>                <span class=n>lsb</span> <span class=o>=</span> <span class=n>velocity</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>binary_data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>lsb</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>binary_str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>binary_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bytes_list</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>binary_str</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>],</span> <span class=mi>2</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>binary_str</span><span class=p>),</span> <span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>bytes_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>extract_lsb_from_midi</span><span class=p>(</span><span class=s1>&#39;hide.mid&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=ogg思路><span>OGG思路</span>
<a href=#ogg%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以尝试binwalk一下，可能OGG文件后面藏了些其他数据，比如ISO镜像。。</p><p>例题1-2025CATCTF 寻找miku</p><h2 class=heading-element id=misc取证题思路><span>Misc——取证题思路</span>
<a href=#misc%e5%8f%96%e8%af%81%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>详见作者博客中的 <strong><a href=https://goodlunatic.github.io/posts/761da51/ target=_blank rel="external nofollow noopener noreferrer">Misc-Forensics</a></strong> 这篇文章</p><h2 class=heading-element id=miscosint社工题思路><span>Misc——OSINT社工题思路</span>
<a href=#miscosint%e7%a4%be%e5%b7%a5%e9%a2%98%e6%80%9d%e8%b7%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=1用谷歌必应yandex识图><span>1、用谷歌/必应/yandex识图</span>
<a href=#1%e7%94%a8%e8%b0%b7%e6%ad%8c%e5%bf%85%e5%ba%94yandex%e8%af%86%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=2使用百度地图查看实景地图><span>2、使用百度地图查看实景地图</span>
<a href=#2%e4%bd%bf%e7%94%a8%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%be%e6%9f%a5%e7%9c%8b%e5%ae%9e%e6%99%af%e5%9c%b0%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=3有时候会给你个图片哈希让选手去找原图><span>3、有时候会给你个图片哈希，让选手去找原图</span>
<a href=#3%e6%9c%89%e6%97%b6%e5%80%99%e4%bc%9a%e7%bb%99%e4%bd%a0%e4%b8%aa%e5%9b%be%e7%89%87%e5%93%88%e5%b8%8c%e8%ae%a9%e9%80%89%e6%89%8b%e5%8e%bb%e6%89%be%e5%8e%9f%e5%9b%be class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h3 class=heading-element id=4给个-git-提交的哈希让选手去-github-找提交的具体内容><span>4、给个 Git 提交的哈希，让选手去 Github 找提交的具体内容</span>
<a href=#4%e7%bb%99%e4%b8%aa-git-%e6%8f%90%e4%ba%a4%e7%9a%84%e5%93%88%e5%b8%8c%e8%ae%a9%e9%80%89%e6%89%8b%e5%8e%bb-github-%e6%89%be%e6%8f%90%e4%ba%a4%e7%9a%84%e5%85%b7%e4%bd%93%e5%86%85%e5%ae%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h2 class=heading-element id=others><span>Others</span>
<a href=#others class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=hashcat的使用><span>Hashcat的使用</span>
<a href=#hashcat%e7%9a%84%e4%bd%bf%e7%94%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以输入<code>hashcat --help</code>查看帮助菜单</p><h4 class=heading-element id=哈希对照表><span>哈希对照表</span>
<a href=#%e5%93%88%e5%b8%8c%e5%af%b9%e7%85%a7%e8%a1%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>可以在官网的这个文档查看：https://hashcat.net/wiki/doku.php?id=example_hashes</p><h4 class=heading-element id=爆破参数><span>爆破参数</span>
<a href=#%e7%88%86%e7%a0%b4%e5%8f%82%e6%95%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-a                       指定爆破模式
</span></span><span class=line><span class=cl>-m                       指定哈希类型
</span></span><span class=line><span class=cl>-o                       将输出结果储存到指定文件
</span></span><span class=line><span class=cl>--force                  忽略警告
</span></span><span class=line><span class=cl>--show                   仅显示破解的hash密码和对应的明文
</span></span><span class=line><span class=cl>--remove                 从源文件中删除破解成功的hash
</span></span><span class=line><span class=cl>-1                       自定义字符集  -1 ?l?u?d     <span class=c1># 字符集1包含大小写字母和数字</span>
</span></span><span class=line><span class=cl>-2                       自定义字符集  -2 0123asd    ?2<span class=o>={</span>0123asd<span class=o>}</span>
</span></span><span class=line><span class=cl>-3                       自定义字符集  -3 0123asd    ?3<span class=o>={</span>0123asd<span class=o>}</span>
</span></span><span class=line><span class=cl>-i                       启用增量破解模式
</span></span><span class=line><span class=cl>--increment-min          设置密码最小长度
</span></span><span class=line><span class=cl>--increment-max          设置密码最大长度</span></span></code></pre></td></tr></table></div></div><p>爆破模式</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 比较常用的就0和3</span>
</span></span><span class=line><span class=cl><span class=m>0</span> <span class=p>|</span> Straight（字典破解）
</span></span><span class=line><span class=cl><span class=m>1</span> <span class=p>|</span> Combination（组合破解）
</span></span><span class=line><span class=cl><span class=m>3</span> <span class=p>|</span> Brute-force（掩码暴力破解）
</span></span><span class=line><span class=cl><span class=m>6</span> <span class=p>|</span> Hybrid Wordlist + Mask（字典+掩码破解）
</span></span><span class=line><span class=cl><span class=m>7</span> <span class=p>|</span> Hybrid Mask + Wordlist（掩码+字典破解）</span></span></code></pre></td></tr></table></div></div><p>掩码设置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>l | abcdefghijklmnopqrstuvwxyz          小写字母
</span></span><span class=line><span class=cl>u | ABCDEFGHIJKLMNOPQRSTUVWXYZ          大写字母
</span></span><span class=line><span class=cl>d | 0123456789                  	    纯数字
</span></span><span class=line><span class=cl>h | 0123456789abcdef                    常见小写字母和数字
</span></span><span class=line><span class=cl>H | 0123456789ABCDEF                    常见大写字母和数字
</span></span><span class=line><span class=cl>s |  !&#34;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~   特殊字符
</span></span><span class=line><span class=cl>a | ?l?u?d?s                            键盘上所有可见的字符
</span></span><span class=line><span class=cl>b | 0x00 - 0xff                         字节类型</span></span></code></pre></td></tr></table></div></div><p>常用哈希类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>0</span>     <span class=p>|</span> MD5
</span></span><span class=line><span class=cl><span class=m>100</span>   <span class=p>|</span> SHA1
</span></span><span class=line><span class=cl><span class=m>1000</span>  <span class=p>|</span> NTLM
</span></span><span class=line><span class=cl><span class=m>3000</span>  <span class=p>|</span> LM-Hash
</span></span><span class=line><span class=cl><span class=m>1400</span>  <span class=p>|</span> SHA256
</span></span><span class=line><span class=cl><span class=m>1700</span>  <span class=p>|</span> SHA512
</span></span><span class=line><span class=cl><span class=m>17200</span> <span class=p>|</span> PKZIP <span class=o>(</span>Compressed<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>17220</span> <span class=p>|</span> PKZIP <span class=o>(</span>Compressed Multi-File<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>11600</span> <span class=p>|</span> 7-zip
</span></span><span class=line><span class=cl><span class=m>13000</span> <span class=p>|</span> RAR-5</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=比赛中使用的一些例子><span>比赛中使用的一些例子</span>
<a href=#%e6%af%94%e8%b5%9b%e4%b8%ad%e4%bd%bf%e7%94%a8%e7%9a%84%e4%b8%80%e4%ba%9b%e4%be%8b%e5%ad%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><blockquote><p><strong>INFO: All hashes found as potfile and/or empty entries! Use &ndash;show to display them.</strong></p><p>出现这条信息说明已经有爆破这条hash的记录，可以直接用&ndash;show参数查看</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 7位小写字母的MD5爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>0</span> --force <span class=s1>&#39;7a47c6db227df60a6d67245d7d8063f3&#39;</span> <span class=s1>&#39;?l?l?l?l?l?l?l&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1-8位纯数字MD5爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>0</span> --force <span class=s1>&#39;4488cec2aea535179e085367d8a17d75&#39;</span> --increment --increment-min <span class=m>1</span> --increment-max <span class=m>8</span> <span class=s1>&#39;?d?d?d?d?d?d?d?d&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 自定义字符集MD5爆破</span>
</span></span><span class=line><span class=cl>hashcat --custom-charset1 <span class=s1>&#39;?d?l?u&#39;</span> -a <span class=m>3</span> -m <span class=m>100</span> <span class=s1>&#39;55872a8639ad1b6516de29de7c33a16de511697d&#39;</span> <span class=s1>&#39;?1?1?1?1?1?1?1?1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>0</span> -1 <span class=s1>&#39;123456abcdf!@+-&#39;</span> 9054fa315ce16f7f0955b4af06d1aa1b --increment --increment-min <span class=m>1</span> --increment-max <span class=m>8</span> ?1?1?1?1?1?1?1?1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>0</span> -1 <span class=s1>&#39;?d?u?l?s&#39;</span> <span class=s1>&#39;d37fc9ee39dd45a7717e3e3e9415f65d&#39;</span> --increment --increment-min <span class=m>1</span> --increment-max <span class=m>8</span> <span class=s1>&#39;?1?1?1?1?1?1?1?1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 字典爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>0</span> ede900ac1424436b55dc3c9f20cb97a8 rockyou.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 字典组合爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>1</span> 25f9e794323b453885f5181f1b624d0b pwd1.txt pwd2.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 字典+掩码爆破</span>
</span></span><span class=line><span class=cl>hashcat64.exe -a <span class=m>6</span> 9dc9d5ed5031367d42543763423c24ee password.txt ?l?l?l?l?l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mysql4.1/5的PASSWORD函数</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>300</span> --force 6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 ?d?d?d?d?d?d
</span></span><span class=line><span class=cl><span class=c1># mssql</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>132</span> --force 0x01008c8006c224f71f6bf0036f78d863c3c4ff53f8c3c48edafb ?l?l?l?l?l?d?d?d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA1字母加数字爆破</span>
</span></span><span class=line><span class=cl>hashcat --custom-charset1 ?d?l?u -a <span class=m>3</span> -m <span class=m>100</span> f865b53623b121fd34ee5426c792e5c33af8c227 ?1?1?1?1?1?1?1?1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sha512crypt $6$, SHA512 (Unix)破解</span>
</span></span><span class=line><span class=cl><span class=c1># 可以cat /etc/shadow获取</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>1800</span> --force <span class=nv>$6$mxuA5cdy$XZRk0CvnPFqOgVopqiPEFAFK72SogKVwwwp7gWaUOb7b6tVwfCpcSUsCEk64ktLLYmzyew</span>/xd0O0hPG/yrm2X. ?l?l?l?l
</span></span><span class=line><span class=cl><span class=c1># 不用整理用户名，使用--username</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>1800</span> --force qiyou:<span class=nv>$6$QDq75ki3$jsKm7qTDHz</span>/xBob0kF1Lp170Cgg0i5Tslf3JW/sm9k9Q916mBTyilU3PoOsbRdxV8TAmzvdgNjrCuhfg3jKMY1 ?l?l?l?l?l --username
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Windows NT-hash，LM-hash破解</span>
</span></span><span class=line><span class=cl><span class=c1># 可以用saminside获取NT-hash,LM-hash的值</span>
</span></span><span class=line><span class=cl>NT-hash:
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>1000</span> 209C6174DA490CAEB422F3FA5A7AE634 ?l?l?l?l?l
</span></span><span class=line><span class=cl>LM-hash:
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>3000</span> F0D412BD764FFE81AAD3B435B51404EE ?l?l?l?l?l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#w ordpress密码hash破解</span>
</span></span><span class=line><span class=cl><span class=c1># 具体加密脚本在./wp-includes/class-phpass.php的HashPassword函数</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>400</span> --force <span class=nv>$P$BYEYcHEj3vDhV1lwGBv6rpxurKOEWY</span>/ ?d?d?d?d?d?d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># discuz用户密码hash破解</span>
</span></span><span class=line><span class=cl><span class=c1># 其密码加密方式为 md5(md5($pass).$salt)</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>2611</span> --force 14e1b600b1fd579f47433b88e8d85291: ?d?d?d?d?d?d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 爆破WIFI密码</span>
</span></span><span class=line><span class=cl><span class=c1># 首先先把我们的握手包转化为hccapx格式，现在最新版的hashcat只支持hccapx格式了</span>
</span></span><span class=line><span class=cl>官方在线转化https://hashcat.net/cap2hccapx/
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>2500</span> 1.hccapx 1391040?d?d?d?d</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=结合-john-生成哈希并爆破><span>结合 john 生成哈希并爆破</span>
<a href=#%e7%bb%93%e5%90%88-john-%e7%94%9f%e6%88%90%e5%93%88%e5%b8%8c%e5%b9%b6%e7%88%86%e7%a0%b4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>这种情况下，我们可以把要破解密码的文件拉入 Kali-Linux</p><p>先使用 Kali-Linux 中自带的 john the ripper 生成哈希值，然后再使用 hashcat 爆破</p><h5 class=heading-element id=zip2john><span>zip2john</span>
<a href=#zip2john class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在kali中执行以下命令</span>
</span></span><span class=line><span class=cl>zip2john 1.zip
</span></span><span class=line><span class=cl><span class=c1># 然后使用hashcat爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>13600</span> <span class=nv>$zip2$*</span>0*3*0*554bb43ff71cb0cac76326f292119dfd*ff23*5*24b28885ee*d4fe362bb1e91319ab53*$/zip2$ --force ?d?d?d?d?d?d
</span></span><span class=line><span class=cl><span class=c1># 当然我们也可以先把 hash 保存到 hash.txt 中再爆破</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=rar2john><span>rar2john</span>
<a href=#rar2john class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在kali中执行以下命令</span>
</span></span><span class=line><span class=cl>rar2john 1.rar
</span></span><span class=line><span class=cl><span class=c1># 然后使用hashcat爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>0</span> -m <span class=m>13000</span> <span class=nv>$rar5$16$befa0045561624e61f9492af87a701c0$15$163434</span>f0a694efb4188db76470987ff4<span class=nv>$8$6</span>b5337dc1af48050 rockyou.txt
</span></span><span class=line><span class=cl><span class=c1># 当然我们也可以先把 hash 保存到 hash.txt 中再爆破</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=office2john><span>office2john</span>
<a href=#office2john class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在kali中执行以下命令</span>
</span></span><span class=line><span class=cl>office2john 1.docx
</span></span><span class=line><span class=cl><span class=c1># 然后使用hashcat爆破</span>
</span></span><span class=line><span class=cl>hashcat -a <span class=m>3</span> -m <span class=m>9600</span> <span class=nv>$office$*</span>2013*100000*256*16*e4a3eb62e8d3576f861f9eded75e0525*9eeb35f0849a7800d48113440b4bbb9c*577f8d8b2e1c5f60fed76e62327b38d28f25230f6c7dfd66588d9ca8097aabb9 --force ?d?d?d?d?d?d
</span></span><span class=line><span class=cl><span class=c1># 当然我们也可以先把 hash 保存到 hash.txt 中再爆破</span></span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=deepsound2john><span>deepsound2john</span>
<a href=#deepsound2john class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在kali中执行以下命令</span>
</span></span><span class=line><span class=cl>deepsound2john 1.wav
</span></span><span class=line><span class=cl><span class=c1># 然后使用john或者hashcat爆破</span>
</span></span><span class=line><span class=cl><span class=c1># 当然我们也可以先把 hash 保存到 hash.txt 中再爆破</span>
</span></span><span class=line><span class=cl>john hash.txt</span></span></code></pre></td></tr></table></div></div><p>例题1-2024ISCC 重隐</p><h3 class=heading-element id=字节序><span>字节序</span>
<a href=#%e5%ad%97%e8%8a%82%e5%ba%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>字节的排列方式有两个通用规则</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>大端序（Big-Endian）将数据的低位字节存放在内存的高位地址，高位字节存放在低位地址。这种排列方式与数据用字节表示时的书写顺序一致，符合人类的阅读习惯。
</span></span><span class=line><span class=cl>小端序（Little-Endian），将一个多位数的低位放在较小的地址处，高位放在较大的地址处，则称小端序。小端序与人类的阅读习惯相反，但更符合计算机读取内存的方式，因为CPU读取内存中的数据时，是从低地址向高地址方向进行读取的。</span></span></code></pre></td></tr></table></div></div><p><strong>为什么要有字节序</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>因为计算机电路先处理低位字节，效率比较高，因为计算都是从低位开始的。所以，计算机的内部处理都是小端字节序。在计算机内部，小端序被广泛应用于现代 CPU 内部存储数据；而在其他场景，比如网络传输和文件存储则使用大端序。</span></span></code></pre></td></tr></table></div></div><p><strong>例子：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>zip压缩包的文件头是：504B0304
</span></span><span class=line><span class=cl>大端序：0x504B0304
</span></span><span class=line><span class=cl>小端序：0x04034B50</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=字节序的转换><span>字节序的转换</span>
<a href=#%e5%ad%97%e8%8a%82%e5%ba%8f%e7%9a%84%e8%bd%ac%e6%8d%a2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>数据量小的话可以直接用 CyberChef 转换</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20251118155942412.png alt=/posts/1ad9200/imgs/image-20251118155942412.png height=1168 width=2176></p><p><strong>使用Python中的struct模块来处理大小端序</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>display_binary</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>#将字节数据转化为十六进制表示形式</span>
</span></span><span class=line><span class=cl>    <span class=c1># return &#39; &#39;.join([&#39;{:02x}&#39;.format(byte) for byte in data])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>byte</span><span class=si>:</span><span class=s2>02x</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>byte</span> <span class=ow>in</span> <span class=n>data</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定义要打包的数据</span>
</span></span><span class=line><span class=cl><span class=n>int_data</span> <span class=o>=</span> <span class=mi>10240099</span>
</span></span><span class=line><span class=cl><span class=n>float_data</span> <span class=o>=</span> <span class=mf>123.456</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用默认端序（小端序）打包</span>
</span></span><span class=line><span class=cl><span class=n>packed_int_little</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;I&#39;</span><span class=p>,</span> <span class=n>int_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>packed_float_little</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=n>float_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用大端序打包</span>
</span></span><span class=line><span class=cl><span class=n>packed_int_big</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&gt;I&#39;</span><span class=p>,</span> <span class=n>int_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>packed_float_big</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&gt;f&#39;</span><span class=p>,</span> <span class=n>float_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 打印打包的结果,display_binary()是以十六进制的形式显示</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Packed data (Little Endian):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>packed_int_little</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Int:&#34;</span><span class=p>,</span> <span class=n>display_binary</span><span class=p>(</span><span class=n>packed_int_little</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>packed_float_little</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Float:&#34;</span><span class=p>,</span> <span class=n>display_binary</span><span class=p>(</span><span class=n>packed_float_little</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Packed data (Big Endian):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>packed_int_big</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Int:&#34;</span><span class=p>,</span> <span class=n>display_binary</span><span class=p>(</span><span class=n>packed_int_big</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>packed_float_big</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Float:&#34;</span><span class=p>,</span> <span class=n>display_binary</span><span class=p>(</span><span class=n>packed_float_big</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 解包数据,由于返回的是一个元组，所以需要[0]</span>
</span></span><span class=line><span class=cl><span class=n>unpacked_int_little</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;I&#39;</span><span class=p>,</span> <span class=n>packed_int_little</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>unpacked_float_little</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=n>packed_float_little</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>unpacked_int_big</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&gt;I&#39;</span><span class=p>,</span> <span class=n>packed_int_big</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>unpacked_float_big</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&gt;f&#39;</span><span class=p>,</span> <span class=n>packed_float_big</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 打印解包的结果</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Unpacked data (Little Endian):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Int:&#34;</span><span class=p>,</span> <span class=n>unpacked_int_little</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Float:&#34;</span><span class=p>,</span> <span class=n>unpacked_float_little</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Unpacked data (Big Endian):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Int:&#34;</span><span class=p>,</span> <span class=n>unpacked_int_big</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Float:&#34;</span><span class=p>,</span> <span class=n>unpacked_float_big</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 验证打包和解包是否保持数据的完整性(float类型的数据先打包再解包后可能会有误差)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>int_data</span> <span class=o>==</span> <span class=n>unpacked_int_little</span>
</span></span><span class=line><span class=cl><span class=c1># assert float_data == unpacked_float_little</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>int_data</span> <span class=o>==</span> <span class=n>unpacked_int_big</span>
</span></span><span class=line><span class=cl><span class=c1># assert float_data == unpacked_float_big</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Data integrity maintained!&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><strong>十六进制数据大小端序转换</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>hex_data</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;0x00006c66 0x00006761 0x0000617b 0x00006168 0x00005f21 0x00006f79 0x00005f75 0x00006f66 0x00006e75 0x00005f64 0x00007469 0x00007d21 0x00000000 &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>swap_endianness</span><span class=p>(</span><span class=n>hex_string</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hex_bytes</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>hex_string</span><span class=p>[</span><span class=mi>2</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>    <span class=c1># 直接使用 bytes 类型的数据翻转即可</span>
</span></span><span class=line><span class=cl>    <span class=n>swapped_bytes</span> <span class=o>=</span> <span class=n>hex_bytes</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>swapped_hex</span> <span class=o>=</span> <span class=n>swapped_bytes</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>swapped_hex</span> <span class=o>=</span> <span class=s1>&#39;0x&#39;</span> <span class=o>+</span> <span class=n>swapped_hex</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>swapped_hex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solved</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># hex_data = input(&#34;请输入待转换的数据\n&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=n>hex_list</span> <span class=o>=</span> <span class=n>hex_data</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>hex_num</span> <span class=ow>in</span> <span class=n>hex_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>swapped_hex</span> <span class=o>=</span> <span class=n>swap_endianness</span><span class=p>(</span><span class=n>hex_num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>swapped_hex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>swapped_hex</span><span class=p>[</span><span class=mi>2</span><span class=p>:])</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solved</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=linux-tar命令><span>Linux tar命令</span>
<a href=#linux-tar%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=打包压缩><span>打包压缩</span>
<a href=#%e6%89%93%e5%8c%85%e5%8e%8b%e7%bc%a9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 打包单独的文件</span>
</span></span><span class=line><span class=cl>tar -cvf target.tar filename.txt
</span></span><span class=line><span class=cl><span class=c1># 打包整个目录</span>
</span></span><span class=line><span class=cl>tar -cvf target.tar directory
</span></span><span class=line><span class=cl><span class=c1># -c 表示创建新的tar包</span>
</span></span><span class=line><span class=cl><span class=c1># -v 表示显示详细信息</span>
</span></span><span class=line><span class=cl><span class=c1># -f 表示指定目标文件名</span>
</span></span><span class=line><span class=cl><span class=c1># 如果是.tar.gz，就用下面这个命令</span>
</span></span><span class=line><span class=cl>tar -czvf out.tar.gz ./*</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=解压提取><span>解压提取</span>
<a href=#%e8%a7%a3%e5%8e%8b%e6%8f%90%e5%8f%96 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#把压缩包中的所有文件解压到当前目录</span>
</span></span><span class=line><span class=cl>tar -xvf target.tar
</span></span><span class=line><span class=cl><span class=c1>#把压缩包解压到指定目录</span>
</span></span><span class=line><span class=cl>tar -xvf target.tar -C path
</span></span><span class=line><span class=cl><span class=c1># 如果是.tar.gz，就用下面这个命令</span>
</span></span><span class=line><span class=cl>tar -xzvf file.tar.gz</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=pyc隐写><span>pyc隐写</span>
<a href=#pyc%e9%9a%90%e5%86%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>使用开源工具：https://github.com/AngelKitty/stegosaurus</p><p>对隐写的内容进行提取即可</p><p><img loading=lazy src=/posts/1ad9200/imgs/image-20241113181609346.png alt=/posts/1ad9200/imgs/image-20241113181609346.png height=167 width=865></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-11-22 14:14:05">更新于 2025-11-22&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/1ad9200/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://goodlunatic.github.io/posts/1ad9200/ data-title="[持续更新] CTF-Misc Guide" data-hashtags=Misc,CTF><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://goodlunatic.github.io/posts/1ad9200/ data-hashtag=Misc><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://goodlunatic.github.io/posts/1ad9200/ data-title="[持续更新] CTF-Misc Guide"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/misc/ class=post-tag title="标签 - Misc">Misc</a><a href=/tags/ctf/ class=post-tag title="标签 - CTF">CTF</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/bb1da35/ class=post-nav-item rel=prev title=星球朋友们问的一些来路不明的题><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>星球朋友们问的一些来路不明的题</a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=goodlunatic/goodlunatic.github.io data-repo-id=R_kgDOQHqgBw data-category=Announcements data-category-id=DIC_kwDOQHqgB84Cw_4D data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2-20251023040336-063af2cd">FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://goodlunatic.github.io target=_blank rel="external nofollow noopener noreferrer">Lunatic</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/goodlunatic title="Visit Lunatic's Github" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/posts/1ad9200/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>